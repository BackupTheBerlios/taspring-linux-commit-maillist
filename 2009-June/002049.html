<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r7279 - Lobby/TASClient
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2009-June/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7279%20-%20Lobby/TASClient&In-Reply-To=%3C20090629005743.37D563B7F0%40it-l.eu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002048.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r7279 - Lobby/TASClient</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7279%20-%20Lobby/TASClient&In-Reply-To=%3C20090629005743.37D563B7F0%40it-l.eu%3E"
       TITLE="[Taspring-linux-commit] r7279 - Lobby/TASClient">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Mon Jun 29 02:57:43 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002048.html">[Taspring-linux-commit] Global Leadership in HandCare - Consumer, Professional and Industrial Products OTC : FLKI
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2049">[ date ]</a>
              <a href="thread.html#2049">[ thread ]</a>
              <a href="subject.html#2049">[ subject ]</a>
              <a href="author.html#2049">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: satirik
Date: 2009-06-29 02:57:41 +0200 (Mon, 29 Jun 2009)
New Revision: 7279

Modified:
   Lobby/TASClient/AgreementUnit.dfm
   Lobby/TASClient/AutoStartRectsUnit.dfm
   Lobby/TASClient/BattleFormUnit.pas
   Lobby/TASClient/MainUnit.dfm
   Lobby/TASClient/MainUnit.pas
   Lobby/TASClient/PreferencesFormUnit.pas
   Lobby/TASClient/ReplaysUnit.dfm
   Lobby/TASClient/ReplaysUnit.pas
   Lobby/TASClient/SplashScreenUnit.dfm
   Lobby/TASClient/SplashScreenUnit.pas
   Lobby/TASClient/TASClient.dof
   Lobby/TASClient/TASClient.dpr
   Lobby/TASClient/TASClient.res
Log:
* launching replay with space in the filename bug fixed
* new parameter &quot;-inifile tasclient.ini&quot;
* two new TASClient.ini values :
[General]
RegistryKey=\Software\TASClient
[SplashScreen]
DisableFadeIn=1

Modified: Lobby/TASClient/AgreementUnit.dfm
===================================================================
--- Lobby/TASClient/AgreementUnit.dfm	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/AgreementUnit.dfm	2009-06-29 00:57:41 UTC (rev 7279)
@@ -1,14 +1,14 @@
 object AgreementForm: TAgreementForm
-  Left = 901
-  Top = 302
+  Left = 447
+  Top = 119
   BorderIcons = []
   BorderStyle = bsDialog
   Caption = 'Agreement'
   ClientHeight = 451
   ClientWidth = 584
   Color = clBtnFace
-  Constraints.MaxHeight = 1000
-  Constraints.MaxWidth = 1680
+  Constraints.MaxHeight = 750
+  Constraints.MaxWidth = 1280
   Font.Charset = DEFAULT_CHARSET
   Font.Color = clWindowText
   Font.Height = -11

Modified: Lobby/TASClient/AutoStartRectsUnit.dfm
===================================================================
--- Lobby/TASClient/AutoStartRectsUnit.dfm	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/AutoStartRectsUnit.dfm	2009-06-29 00:57:41 UTC (rev 7279)
@@ -23,7 +23,6 @@
     Top = 0
     Width = 385
     Height = 255
-    Caption = 'SpTBXPanel1'
     Align = alClient
     TabOrder = 0
     TBXStyleBackground = True

Modified: Lobby/TASClient/BattleFormUnit.pas
===================================================================
--- Lobby/TASClient/BattleFormUnit.pas	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/BattleFormUnit.pas	2009-06-29 00:57:41 UTC (rev 7279)
@@ -1249,7 +1249,6 @@
   Utility.LoadMiniMap(TMapItem(MapListForm.Maps[MapIndex]).MapName,minimap);
   BattleForm.MapImage.Picture.Assign(minimap);
   TMapItem(MapListForm.Maps[MapIndex]).LoadMinimap(False,minimap);
-  MapImage.Visible := True;
 
   TotalMetal := 0;
   MapMetalWidth := 0;

Modified: Lobby/TASClient/MainUnit.dfm
===================================================================
--- Lobby/TASClient/MainUnit.dfm	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/MainUnit.dfm	2009-06-29 00:57:41 UTC (rev 7279)
@@ -1,6 +1,6 @@
 object MainForm: TMainForm
-  Left = 546
-  Top = 121
+  Left = 359
+  Top = 188
   Width = 850
   Height = 538
   Caption = '.'

Modified: Lobby/TASClient/MainUnit.pas
===================================================================
--- Lobby/TASClient/MainUnit.pas	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/MainUnit.pas	2009-06-29 00:57:41 UTC (rev 7279)
@@ -591,7 +591,6 @@
   MODS_CACHE_FOLDER = CACHE_FOLDER + '\' + 'mods'; // we store info of local mods there like default mod options
   LOG_FOLDER = LOBBY_FOLDER + '\' + 'logs'; // this is where we store chat logs
   VAR_FOLDER = LOBBY_FOLDER + '\var';
-  CUSTOM_TASCLIENT_FILE = 'TASClient.ini';
   GROUPS_FILE = VAR_FOLDER + '\' + 'groups.ini';
   AWAY_MSGS_FILE = VAR_FOLDER + '\' + 'away_messages.ini';
   AUTOJOIN_SETTINGS = VAR_FOLDER + '\' + 'autojoin.ini';
@@ -1685,6 +1684,9 @@
 
   SCROLLING_NEWS_RSS_URL: string = '<A HREF="http://www.springinfo.info/?feed=rss2">http://www.springinfo.info/?feed=rss2</A>';
   NEWS_URL:string = '<A HREF="http://www.springinfo.info/tasclient.php/">http://www.springinfo.info/tasclient.php/</A>';
+  DISABLE_FADEIN: boolean = false;
+  TASCLIENT_REGISTRY_KEY: string = '\Software\TASClient';
+  CUSTOM_TASCLIENT_FILE:string = 'TASClient.ini';
 
   MainForm: TMainForm;
 
@@ -1819,6 +1821,7 @@
   function Enqueue(s: WideString): Integer; forward;
   function ClientSortCompare(Item1, Item2: Pointer): Integer;
   function BattleSortCompare(Item1, Item2: Pointer): Integer;
+  procedure LoadTASClientIni(FileName: string);
 
 
 implementation
@@ -3646,6 +3649,7 @@
   TP_GlobalIgnoreClass (TWebBrowserWrapper);
   TP_GlobalIgnoreClass (TExRichEdit);
   TP_GlobalIgnoreClass (TRichEdit);
+  TP_GlobalIgnoreClassProperty(TFont,'Name');
   TP_Ignore (self,'.Caption');
   TP_Ignore (self,'MainTitleBar.Caption');
   TP_Ignore (self,'SortLabel');
@@ -7225,11 +7229,11 @@
      s := Lines[lix];
      Inc(co) ;
      k := co;
-     while (k &gt; 0) and (s[k] &lt;&gt; ' ') and (s[k] &lt;&gt; '&lt;') do k:=k-1;
+     while (k &gt; 0) and (s[k] &lt;&gt; ' ') and (s[k] &lt;&gt; '&lt;') and (s[k] &lt;&gt; '(') do k:=k-1;
      Inc(k);
      Inc(co) ;
      j := co;
-     while (j &lt;= Length(s)) and (s[j] &lt;&gt; ' ') and (s[j] &lt;&gt; '&gt;') do Inc(j) ;
+     while (j &lt;= Length(s)) and (s[j] &lt;&gt; ' ') and (s[j] &lt;&gt; '&gt;') and (s[j] &lt;&gt; ')') do Inc(j) ;
      SelectedWord := Copy(s, k, j - k) ;
 
      if Sender = BattleForm.ChatRichEdit then
@@ -7333,11 +7337,11 @@
 var
   s: WideString;
   sl: TWideStringList;
-  tmp: string;
+  tmp: WideString;
   i: integer;
-  cmd: string;
+  cmd: WideString;
   msgLines : TWideStringList;
-  tmpLine: string;
+  tmpLine: WideString;
 begin
   if (Key = Ord('W')) and (ssCtrl in Shift) then
   begin
@@ -11918,4 +11922,57 @@
   Misc.OpenURLInDefaultBrowser(_('<A HREF="http://springrts.com/wiki/FAQ">http://springrts.com/wiki/FAQ</A>'));
 end;
 
+procedure LoadTASClientIni(FileName: string);
+var
+  Ini : TIniFile;
+  tmpStr: string;
+begin
+  try
+    //FileName := ExtractFilePath(Application.ExeName) + CUSTOM_TASCLIENT_FILE;
+    if FileExists(FileName) then
+    begin
+      if MidStr(FileName,2,2) &lt;&gt; ':\' then
+        FileName := ExtractFilePath(Application.ExeName)+FileName;
+      Ini := TIniFile.Create(FileName);
+      TASCLIENT_REGISTRY_KEY := Ini.ReadString('General','RegistryKey',TASCLIENT_REGISTRY_KEY);
+      NEWS_URL := Ini.ReadString('News','NewsURL',NEWS_URL);
+      SCROLLING_NEWS_RSS_URL := Ini.ReadString('News','ScrollingNewsRSSFeed',SCROLLING_NEWS_RSS_URL);
+      DISABLE_FADEIN := Ini.ReadBool('SplashScreen','DisableFadeIn',false);
+      tmpStr := Ini.ReadString('SplashScreen','Image','');
+      if tmpStr &lt;&gt; '' then
+      begin
+        if MidStr(tmpStr,2,2) &lt;&gt; ':\' then
+          tmpStr := ExtractFilePath(Application.ExeName)+tmpStr;
+        try
+          SplashScreenForm.Image1.Picture.LoadFromFile(tmpStr);
+        except
+        end;
+      end;
+
+      // version label
+      tmpStr := Ini.ReadString('SplashScreen','VersionLabelX','');
+      if tmpStr &lt;&gt; '' then
+        try SplashScreenForm.VersionLabel.Left := StrToInt(tmpStr); except end;
+      tmpStr := Ini.ReadString('SplashScreen','VersionLabelY','');
+      if tmpStr &lt;&gt; '' then
+        try SplashScreenForm.VersionLabel.Top := StrToInt(tmpStr); except end;
+      tmpStr := Ini.ReadString('SplashScreen','VersionLabelColor','');
+      if tmpStr &lt;&gt; '' then
+        try SplashScreenForm.VersionLabel.Font.Color := StandardRGBToColor(HexToInt(tmpStr)); except end;
+
+      // InfoLabel
+      tmpStr := Ini.ReadString('SplashScreen','InfoLabelX','');
+      if tmpStr &lt;&gt; '' then
+        try SplashScreenForm.InfoLabel.Left := StrToInt(tmpStr); except end;
+      tmpStr := Ini.ReadString('SplashScreen','InfoLabelY','');
+      if tmpStr &lt;&gt; '' then
+        try SplashScreenForm.InfoLabel.Top := StrToInt(tmpStr); except end;
+      tmpStr := Ini.ReadString('SplashScreen','InfoLabelColor','');
+      if tmpStr &lt;&gt; '' then
+        try SplashScreenForm.InfoLabel.Font.Color := StandardRGBToColor(HexToInt(tmpStr)); except end;
+    end;
+  except
+  end;
+end;
+
 end.

Modified: Lobby/TASClient/PreferencesFormUnit.pas
===================================================================
--- Lobby/TASClient/PreferencesFormUnit.pas	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/PreferencesFormUnit.pas	2009-06-29 00:57:41 UTC (rev 7279)
@@ -349,95 +349,95 @@
 procedure TPreferencesForm.ReadPreferencesRecordFromRegistry(var Preferences: TPreferences);
 begin
   try
-    try Preferences.ServerIP := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ServerIP'); except end;
-    try Preferences.ServerPort := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ServerPort'); except end;
-    try Preferences.TabStyle := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'TabStyle'); except end;
-    try Preferences.TimeStamps := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'TimeStamps'); except end;
-    try Preferences.Username := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Username'); except end;
-    try Preferences.Password := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Password'); except end;
-    try Preferences.UseLogonForm := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseLogonForm'); except end;
+    try Preferences.ServerIP := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ServerIP'); except end;
+    try Preferences.ServerPort := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ServerPort'); except end;
+    try Preferences.TabStyle := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'TabStyle'); except end;
+    try Preferences.TimeStamps := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'TimeStamps'); except end;
+    try Preferences.Username := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'Username'); except end;
+    try Preferences.Password := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'Password'); except end;
+    try Preferences.UseLogonForm := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'UseLogonForm'); except end;
     if (Length(Preferences.Password) &lt;&gt; 24)  and (Length(Preferences.Password) &gt; 0) then // not md5 password = old system
       Preferences.Password := Misc.GetMD5Hash(Preferences.Password);
     try
-      Preferences.RememberPasswords := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'RememberPasswords');
+      Preferences.RememberPasswords := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'RememberPasswords');
     except
       Preferences.RememberPasswords := Preferences.Password &lt;&gt; '';
     end;
 
-    try Preferences.LadderPassword := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LadderPassword'); except end;
-    try Preferences.ConnectOnStartup := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ConnectOnStartup'); except end;
-    try Preferences.SortStyle := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'SortStyle'); except end;
-    try Preferences.BattleSortStyle := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'BattleSortStyle'); except end;
-    try Preferences.BattleSortDirection := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'BattleSortDirection'); except end;
-    try Preferences.BattleClientSortStyle := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'BattleClientSortStyle'); except end;
-    try Preferences.BattleClientSortDirection := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'BattleClientSortDirection'); except end;
-    try Preferences.FilterJoinLeftMessages := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'FilterJoinLeftMessages'); except end;
-    try Preferences.FilterBattleJoinLeftMessages := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'FilterBattleJoinLeftMessages'); except end;
-    try Preferences.AutoCompletionFromCurrentChannel := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'AutoCompletionFromCurrentChannel'); except end;
-    try Preferences.ShowFlags := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ShowFlags'); except end;
-    try Preferences.DisplayUnitsIconsAndNames := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'DisplayUnitsIconsAndNames'); except end;
-    try Preferences.MarkUnknownMaps := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'MarkUnknownMapsNMods'); except end;
-    try Preferences.TaskbarButtons := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'TaskbarButtons'); except end;
-    try Preferences.JoinMainChannel := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'JoinMainChannel'); except end;
-    try Preferences.ReconnectToBackup := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ReconnectToBackup'); except end;
-    try Preferences.SaveLogs := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'SaveLogs'); except end;
-    try Preferences.UseSoundNotifications := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseSoundNotifications'); except end;
-    try Preferences.UseProxy := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseProxy'); except end;
-    try Preferences.ProxyAddress := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ProxyAddress'); except end;
-    try Preferences.ProxyPort := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ProxyPort'); except end;
-    try Preferences.ProxyUsername := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ProxyUsername'); except end;
-    try Preferences.ProxyPassword:= Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ProxyPassword'); except end;
-    try Preferences.HighlightColor:= Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'HighlightColor'); except end;
-    try Preferences.UseNotificationsForHighlights := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseNotificationsForHighlights'); except end;
-    try Preferences.AutoUpdateToBeta := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'CheckForNewVersion'); except end;
-    try Preferences.EnableSpringDownloader := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'EnableSpringDownloader'); except end;
-    try Preferences.UseIgnoreList := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseIgnoreList'); except end;
-    try Preferences.WarnIfUsingNATTraversing := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'WarnIfUsingNATTraversing'); except end;
-    try Preferences.AutoFocusOnPM := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'AutoFocusOnPM'); except end;
-    try Preferences.LastOpenMap := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LastOpenMap'); except end;
-    try Preferences.MapSortStyle := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'MapSortStyle'); except end;
-    try Preferences.ThemeType := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ThemeType'); except end;
-    try Preferences.Theme := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Theme'); except end;
-    try Preferences.DisableAllSounds := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'DisableAllSounds'); except end;
-    try Preferences.SortLocal := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'SortLocal'); except end;
-    try Preferences.UploadReplay := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'AskUploadReplay'); except end;
-    try Preferences.DisplayQuickJoinPanel := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'DisplayQuickJoinPanelv2'); except end;
-    try Preferences.LanguageCode := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LanguageCode'); except end;
+    try Preferences.LadderPassword := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LadderPassword'); except end;
+    try Preferences.ConnectOnStartup := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ConnectOnStartup'); except end;
+    try Preferences.SortStyle := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'SortStyle'); except end;
+    try Preferences.BattleSortStyle := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'BattleSortStyle'); except end;
+    try Preferences.BattleSortDirection := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'BattleSortDirection'); except end;
+    try Preferences.BattleClientSortStyle := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'BattleClientSortStyle'); except end;
+    try Preferences.BattleClientSortDirection := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'BattleClientSortDirection'); except end;
+    try Preferences.FilterJoinLeftMessages := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'FilterJoinLeftMessages'); except end;
+    try Preferences.FilterBattleJoinLeftMessages := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'FilterBattleJoinLeftMessages'); except end;
+    try Preferences.AutoCompletionFromCurrentChannel := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'AutoCompletionFromCurrentChannel'); except end;
+    try Preferences.ShowFlags := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ShowFlags'); except end;
+    try Preferences.DisplayUnitsIconsAndNames := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisplayUnitsIconsAndNames'); except end;
+    try Preferences.MarkUnknownMaps := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'MarkUnknownMapsNMods'); except end;
+    try Preferences.TaskbarButtons := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'TaskbarButtons'); except end;
+    try Preferences.JoinMainChannel := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'JoinMainChannel'); except end;
+    try Preferences.ReconnectToBackup := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ReconnectToBackup'); except end;
+    try Preferences.SaveLogs := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'SaveLogs'); except end;
+    try Preferences.UseSoundNotifications := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'UseSoundNotifications'); except end;
+    try Preferences.UseProxy := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'UseProxy'); except end;
+    try Preferences.ProxyAddress := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ProxyAddress'); except end;
+    try Preferences.ProxyPort := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ProxyPort'); except end;
+    try Preferences.ProxyUsername := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ProxyUsername'); except end;
+    try Preferences.ProxyPassword:= Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ProxyPassword'); except end;
+    try Preferences.HighlightColor:= Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'HighlightColor'); except end;
+    try Preferences.UseNotificationsForHighlights := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'UseNotificationsForHighlights'); except end;
+    try Preferences.AutoUpdateToBeta := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'CheckForNewVersion'); except end;
+    try Preferences.EnableSpringDownloader := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'EnableSpringDownloader'); except end;
+    try Preferences.UseIgnoreList := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'UseIgnoreList'); except end;
+    try Preferences.WarnIfUsingNATTraversing := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'WarnIfUsingNATTraversing'); except end;
+    try Preferences.AutoFocusOnPM := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'AutoFocusOnPM'); except end;
+    try Preferences.LastOpenMap := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LastOpenMap'); except end;
+    try Preferences.MapSortStyle := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'MapSortStyle'); except end;
+    try Preferences.ThemeType := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ThemeType'); except end;
+    try Preferences.Theme := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'Theme'); except end;
+    try Preferences.DisableAllSounds := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisableAllSounds'); except end;
+    try Preferences.SortLocal := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'SortLocal'); except end;
+    try Preferences.UploadReplay := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'AskUploadReplay'); except end;
+    try Preferences.DisplayQuickJoinPanel := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisplayQuickJoinPanelv2'); except end;
+    try Preferences.LanguageCode := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LanguageCode'); except end;
     try
-      Preferences.EnableScripts := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ScriptsEnabled2');
+      Preferences.EnableScripts := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ScriptsEnabled2');
       Preferences.ScriptsDisabled := not Preferences.EnableScripts;
     except end;
-    try Preferences.ScriptWarningMsgShown := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ScriptWarningMsgShown'); except end;
-    try Preferences.LimitChatLogs := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LimitChatLogs'); except end;
+    try Preferences.ScriptWarningMsgShown := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ScriptWarningMsgShown'); except end;
+    try Preferences.LimitChatLogs := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LimitChatLogs'); except end;
     try
-      Preferences.ChatLogsLimit := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ChatLogsLimit');
+      Preferences.ChatLogsLimit := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ChatLogsLimit');
       Preferences.ChatLogsLimit := max(ChatLogsLimitTracker.Min,min(ChatLogsLimitTracker.Max,Preferences.ChatLogsLimit));
     except end;
-    try Preferences.SPSkin := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'SPTheme'); except end;
-    try Preferences.DisableNews := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'DisableNews'); except end;
-    try Preferences.DisableMapDetailsLoading := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'DisableMapDetailsLoading'); except end;
-    try Preferences.LoadMetalHeightMinimaps := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LoadMetalHeightMinimaps'); except end;
+    try Preferences.SPSkin := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'SPTheme'); except end;
+    try Preferences.DisableNews := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisableNews'); except end;
+    try Preferences.DisableMapDetailsLoading := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisableMapDetailsLoading'); except end;
+    try Preferences.LoadMetalHeightMinimaps := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LoadMetalHeightMinimaps'); except end;
 
 
-    try CommonFont.Name := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'FontName'); except end;
-    try CommonFont.Size := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'FontSize'); except end;
+    try CommonFont.Name := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'FontName'); except end;
+    try CommonFont.Size := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'FontSize'); except end;
     try ((MainForm.PageControl1.Pages[0] as TMyTabSheet).Controls[1] as TExRichEdit).Font.Assign(CommonFont); except end;
-    try Colors.Normal := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'Normal'); except end;
-    try Colors.MyText := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'MyText'); except end;
-    try Colors.AdminText := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'AdminText'); except end;
-    try Colors.Data := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'Data'); except end;
-    try Colors.Error := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'Error'); except end;
-    try Colors.Info := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'Info'); except end;
-    try Colors.MinorInfo := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'MinorInfo'); except end;
-    try Colors.ChanJoin := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'ChanJoin'); except end;
-    try Colors.ChanLeft := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'ChanLeft'); except end;
-    try Colors.MOTD := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'MOTD'); except end;
-    try Colors.SayEx := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'SayEx'); except end;
-    try Colors.Topic := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'Topic'); except end;
-    try Colors.OldMsgs := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'OldMsgs'); except end;
-    try Colors.ClientAway := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\OtherColors', 'ClientAway'); except end;
-    try Colors.MapModUnavailable := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\OtherColors', 'MapModUnavailable'); except end;
-    try Colors.BotText := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\OtherColors', 'BotText'); except end;
+    try Colors.Normal := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'Normal'); except end;
+    try Colors.MyText := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'MyText'); except end;
+    try Colors.AdminText := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'AdminText'); except end;
+    try Colors.Data := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'Data'); except end;
+    try Colors.Error := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'Error'); except end;
+    try Colors.Info := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'Info'); except end;
+    try Colors.MinorInfo := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'MinorInfo'); except end;
+    try Colors.ChanJoin := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'ChanJoin'); except end;
+    try Colors.ChanLeft := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'ChanLeft'); except end;
+    try Colors.MOTD := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'MOTD'); except end;
+    try Colors.SayEx := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'SayEx'); except end;
+    try Colors.Topic := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'Topic'); except end;
+    try Colors.OldMsgs := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'OldMsgs'); except end;
+    try Colors.ClientAway := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\OtherColors', 'ClientAway'); except end;
+    try Colors.MapModUnavailable := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\OtherColors', 'MapModUnavailable'); except end;
+    try Colors.BotText := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\OtherColors', 'BotText'); except end;
   except
   end;
 end;
@@ -447,102 +447,102 @@
   i: Integer;
 begin
   try
-    try MainForm.Left := GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Left'); except end;
-    try MainForm.Top := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Top'); except end;
-    try MainForm.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Width'); except end;
-    try MainForm.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Height'); except end;
-//***    try MainForm.WindowState := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'WindowState'); except end;
+    try MainForm.Left := GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Left'); except end;
+    try MainForm.Top := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Top'); except end;
+    try MainForm.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Width'); except end;
+    try MainForm.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Height'); except end;
+//***    try MainForm.WindowState := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'WindowState'); except end;
 // we will apply the above line after we load everything because it has some strange effect: if we left main window in minimized mode (when we closed the program), this line will update the form before we finished initializing it (setting WindowState property probably triggers form's Update method). This is why we do it later.
-    try MainForm.Panel2.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Splitter1'); except end;
-    try MainForm.PageControl1.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Splitter2'); except end;
-    try MainForm.EnableFilters.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'EnableFilters'); except end;
-    try MainForm.FiltersTabs.ActiveTabIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'FiltersActiveTab'); except end;
-    try ReplaysForm.FiltersTabs.ActiveTabIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'ReplayFiltersActiveTab'); except end;
+    try MainForm.Panel2.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Splitter1'); except end;
+    try MainForm.PageControl1.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Splitter2'); except end;
+    try MainForm.EnableFilters.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'EnableFilters'); except end;
+    try MainForm.FiltersTabs.ActiveTabIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'FiltersActiveTab'); except end;
+    try ReplaysForm.FiltersTabs.ActiveTabIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'ReplayFiltersActiveTab'); except end;
 
     with MainForm.VDTBattles.Header.Columns do
       for i := 0 to Count-1 do
       try
-        Items[i].Width := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Column' + IntToStr(i));
-        Items[i].Position := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'ColumnPosition' + IntToStr(i));
+        Items[i].Width := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Column' + IntToStr(i));
+        Items[i].Position := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'ColumnPosition' + IntToStr(i));
       except
       end;
     FixFormBounds(MainForm);
 
-    try BattleForm.Left := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Left'); except end;
-    try BattleForm.Top := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Top'); except end;
-    try BattleForm.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Width'); except end;
-    try BattleForm.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Height'); except end;
-    try BattleForm.WindowState := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'WindowState'); except end;
-    try BattleForm.Panel1.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Splitter4'); except end;
-    try BattleForm.Panel4.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Splitter2'); except end;
-    //try BattleForm.Panel6.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Splitter3'); except end;
-    try BattleForm.KeepRatioItem.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'KeepMinimapRatio'); except end;
-    try BattleForm.SpringSettingsProfile := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'SpringSettingsProfile'); except end;
-    try BattleForm.mnuAutoLockOnStart.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'AutoLockOnStart'); except end;
+    try BattleForm.Left := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Left'); except end;
+    try BattleForm.Top := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Top'); except end;
+    try BattleForm.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Width'); except end;
+    try BattleForm.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Height'); except end;
+    try BattleForm.WindowState := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'WindowState'); except end;
+    try BattleForm.Panel1.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Splitter4'); except end;
+    try BattleForm.Panel4.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Splitter2'); except end;
+    //try BattleForm.Panel6.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Splitter3'); except end;
+    try BattleForm.KeepRatioItem.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'KeepMinimapRatio'); except end;
+    try BattleForm.SpringSettingsProfile := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'SpringSettingsProfile'); except end;
+    try BattleForm.mnuAutoLockOnStart.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'AutoLockOnStart'); except end;
 
-    try AutoTeamsForm.ClansCheckBox.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\AutoTeam', 'ClanBalance'); except end;
-    try AutoTeamsForm.NoNewIdsCheckBox.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\AutoTeam', 'KeepIds'); except end;
+    try AutoTeamsForm.ClansCheckBox.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\AutoTeam', 'ClanBalance'); except end;
+    try AutoTeamsForm.NoNewIdsCheckBox.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\AutoTeam', 'KeepIds'); except end;
     AutoTeamsForm.NoNewIdsCheckBoxClick(nil);
 
     {--&gt;} AllowBattleDetailsUpdate := False;
-    //try BattleForm.StartPosRadioGroup.ItemIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'StartPos'); except end;
-    //try BattleForm.GameEndRadioGroup.ItemIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'GameEnd'); except end;
-    //try BattleForm.LimitDGunCheckBox.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'LimitDGun'); except end;
-    try BattleForm.MySideButton.Tag := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Side'); except end;
-    //try BattleForm.UnitsTracker.Value := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Units'); except end;
-    //try BattleForm.LockGameSpeedCheckBox.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'LockSpeed'); except end;
+    //try BattleForm.StartPosRadioGroup.ItemIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'StartPos'); except end;
+    //try BattleForm.GameEndRadioGroup.ItemIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'GameEnd'); except end;
+    //try BattleForm.LimitDGunCheckBox.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'LimitDGun'); except end;
+    try BattleForm.MySideButton.Tag := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Side'); except end;
+    //try BattleForm.UnitsTracker.Value := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Units'); except end;
+    //try BattleForm.LockGameSpeedCheckBox.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'LockSpeed'); except end;
 
 
     {--&gt;} AllowBattleDetailsUpdate := True;
     with BattleForm.VDTBattleClients.Header.Columns do
       for i := 0 to Count-1 do
       try
-        Items[i].Width := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Column' + IntToStr(i));
-        Items[i].Position := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'ColumnPosition' + IntToStr(i));
+        Items[i].Width := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Column' + IntToStr(i));
+        Items[i].Position := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'ColumnPosition' + IntToStr(i));
       except
       end;
     FixFormBounds(BattleForm);
 
-    try OnlineMapsForm.Left := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\OnlineMapsForm', 'Left'); except end;
-    try OnlineMapsForm.Top := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\OnlineMapsForm', 'Top'); except end;
-    try OnlineMapsForm.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\OnlineMapsForm', 'Width'); except end;
-    try OnlineMapsForm.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\OnlineMapsForm', 'Height'); except end;
-    try OnlineMapsForm.WindowState := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\OnlineMapsForm', 'WindowState'); except end;
+    try OnlineMapsForm.Left := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\OnlineMapsForm', 'Left'); except end;
+    try OnlineMapsForm.Top := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\OnlineMapsForm', 'Top'); except end;
+    try OnlineMapsForm.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\OnlineMapsForm', 'Width'); except end;
+    try OnlineMapsForm.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\OnlineMapsForm', 'Height'); except end;
+    try OnlineMapsForm.WindowState := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\OnlineMapsForm', 'WindowState'); except end;
     FixFormBounds(OnlineMapsForm);
 
-    try NotificationsForm.CheckBox1.Checked := GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\NotificationsForm', 'CheckBox1'); except end;
+    try NotificationsForm.CheckBox1.Checked := GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\NotificationsForm', 'CheckBox1'); except end;
 
-    try HostBattleForm.PortEdit.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'Port'); except end;
-    try HostBattleForm.TitleEdit.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'Description'); except end;
-    try HostBattleForm.AutoSendDescCheckbox.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'DescriptionAutoSend'); except end;
-    try HostBattleForm.PasswordEdit.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'Password'); except end;
-    try HostBattleForm.ModsComboBox.ItemIndex := Max(0, HostBattleForm.ModsComboBox.Items.IndexOf(Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'Mod'))); except end;
-    try HostBattleForm.NATRadioGroup.ItemIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'NATTechnique'); except end;
-    try HostBattleForm.PlayersTracker.Value := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'NbPlayer'); except end;
+    try HostBattleForm.PortEdit.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'Port'); except end;
+    try HostBattleForm.TitleEdit.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'Description'); except end;
+    try HostBattleForm.AutoSendDescCheckbox.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'DescriptionAutoSend'); except end;
+    try HostBattleForm.PasswordEdit.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'Password'); except end;
+    try HostBattleForm.ModsComboBox.ItemIndex := Max(0, HostBattleForm.ModsComboBox.Items.IndexOf(Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'Mod'))); except end;
+    try HostBattleForm.NATRadioGroup.ItemIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'NATTechnique'); except end;
+    try HostBattleForm.PlayersTracker.Value := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'NbPlayer'); except end;
 
-    try MapListForm.Left := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MapListForm', 'Left'); except end;
-    try MapListForm.Top := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MapListForm', 'Top'); except end;
-    try MapListForm.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MapListForm', 'Width'); except end;
-    try MapListForm.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MapListForm', 'Height'); except end;
-    try MapListForm.WindowState := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MapListForm', 'WindowState'); except end;
+    try MapListForm.Left := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MapListForm', 'Left'); except end;
+    try MapListForm.Top := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MapListForm', 'Top'); except end;
+    try MapListForm.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MapListForm', 'Width'); except end;
+    try MapListForm.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MapListForm', 'Height'); except end;
+    try MapListForm.WindowState := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MapListForm', 'WindowState'); except end;
     FixFormBounds(MapListForm);  
 
     // read custom team colors to registry:
     // (first assign default team colors in case if reading from registry fails)
     TeamColors := DefaultTeamColors;
     for i := 0 to High(TeamColors) do
-      try TeamColors[i] := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\TeamColors', 'Color' + IntToStr(i)); except end;
+      try TeamColors[i] := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\TeamColors', 'Color' + IntToStr(i)); except end;
 
-    try ReplaysForm.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\ReplaysForm', 'Width'); except end;
-    try ReplaysForm.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\ReplaysForm', 'Height'); except end;
-    try ReplaysForm.chkEnableFilters.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\ReplaysForm', 'FiltersEnabled'); except end;
-    try ReplaysForm.BottomPanel.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\ReplaysForm', 'Spliter1'); except end;
+    try ReplaysForm.Width := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\ReplaysForm', 'Width'); except end;
+    try ReplaysForm.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\ReplaysForm', 'Height'); except end;
+    try ReplaysForm.chkEnableFilters.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\ReplaysForm', 'FiltersEnabled'); except end;
+    try ReplaysForm.BottomPanel.Height := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\ReplaysForm', 'Spliter1'); except end;
 
-    try TipsForm.chkShowTips.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\TipsForm', 'ShowTips'); except end;
+    try TipsForm.chkShowTips.Checked := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\TipsForm', 'ShowTips'); except end;
 
-    try TemplateEditorForm.ProfileTemplate.Lines.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\TemplateEditor', 'LayoutGlobal'); except end;
-    try TemplateEditorForm.LayoutPropertyChange.Lines.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\TemplateEditor', 'LayoutProperty'); except end;
-    try TemplateEditorForm.RecordPropertyChange.Lines.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\TemplateEditor', 'RecordProperty'); except end;
+    try TemplateEditorForm.ProfileTemplate.Lines.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\TemplateEditor', 'LayoutGlobal'); except end;
+    try TemplateEditorForm.LayoutPropertyChange.Lines.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\TemplateEditor', 'LayoutProperty'); except end;
+    try TemplateEditorForm.RecordPropertyChange.Lines.Text := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\TemplateEditor', 'RecordProperty'); except end;
 
     ReadPreferencesRecordFromRegistry(Preferences);
   except
@@ -565,184 +565,184 @@
     GetWindowPlacement(MainForm.Handle, @Pl);
     R := Pl.rcNormalPosition;
 
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Left', rdInteger, R.Left);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Top', rdInteger, R.Top);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Width', rdInteger, R.Right-R.Left);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Height', rdInteger, R.Bottom-R.Top);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'WindowState', rdInteger, MainForm.WindowState);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Splitter1', rdInteger, MainForm.Panel2.Width);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Splitter2', rdInteger, MainForm.PageControl1.Height);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'EnableFilters', rdInteger, Misc.BoolToInt(MainForm.EnableFilters.Checked));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'FiltersActiveTab', rdInteger, MainForm.FiltersTabs.ActiveTabIndex);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'ReplayFiltersActiveTab', rdInteger, ReplaysForm.FiltersTabs.ActiveTabIndex);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Left', rdInteger, R.Left);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Top', rdInteger, R.Top);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Width', rdInteger, R.Right-R.Left);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Height', rdInteger, R.Bottom-R.Top);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'WindowState', rdInteger, MainForm.WindowState);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Splitter1', rdInteger, MainForm.Panel2.Width);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Splitter2', rdInteger, MainForm.PageControl1.Height);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'EnableFilters', rdInteger, Misc.BoolToInt(MainForm.EnableFilters.Checked));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'FiltersActiveTab', rdInteger, MainForm.FiltersTabs.ActiveTabIndex);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'ReplayFiltersActiveTab', rdInteger, ReplaysForm.FiltersTabs.ActiveTabIndex);
 
     with MainForm.VDTBattles.Header.Columns do
       for i := 0 to Count-1 do
       begin
-        Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'Column' + IntToStr(i), rdInteger, Items[i].Width);
-        Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'ColumnPosition' + IntToStr(i), rdInteger, Items[i].Position);
+        Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'Column' + IntToStr(i), rdInteger, Items[i].Width);
+        Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'ColumnPosition' + IntToStr(i), rdInteger, Items[i].Position);
       end;
 
     Pl.Length := SizeOf(TWindowPlacement);
     GetWindowPlacement(BattleForm.Handle, @Pl);
     R := Pl.rcNormalPosition;
 
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Left', rdInteger, R.Left);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Top', rdInteger, R.Top);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Width', rdInteger, R.Right-R.Left);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Height', rdInteger, R.Bottom-R.Top);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'WindowState', rdInteger, BattleForm.WindowState);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Splitter4', rdInteger, BattleForm.Panel1.Height);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Splitter2', rdInteger, BattleForm.Panel4.Height);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Splitter3', rdInteger, BattleForm.Panel6.Width);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'KeepMinimapRatio', rdInteger, Misc.BoolToInt(BattleForm.KeepRatioItem.Checked));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'SpringSettingsProfile', rdString, BattleForm.SpringSettingsProfile);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'AutoLockOnStart', rdInteger, Misc.BoolToInt(BattleForm.mnuAutoLockOnStart.Checked));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Side', rdInteger, BattleForm.MySideButton.Tag);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Left', rdInteger, R.Left);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Top', rdInteger, R.Top);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Width', rdInteger, R.Right-R.Left);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Height', rdInteger, R.Bottom-R.Top);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'WindowState', rdInteger, BattleForm.WindowState);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Splitter4', rdInteger, BattleForm.Panel1.Height);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Splitter2', rdInteger, BattleForm.Panel4.Height);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Splitter3', rdInteger, BattleForm.Panel6.Width);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'KeepMinimapRatio', rdInteger, Misc.BoolToInt(BattleForm.KeepRatioItem.Checked));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'SpringSettingsProfile', rdString, BattleForm.SpringSettingsProfile);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'AutoLockOnStart', rdInteger, Misc.BoolToInt(BattleForm.mnuAutoLockOnStart.Checked));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Side', rdInteger, BattleForm.MySideButton.Tag);
 
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\AutoTeam', 'ClanBalance', rdInteger, Misc.BoolToInt(AutoTeamsForm.ClansCheckBox.Checked));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\AutoTeam', 'KeepIds', rdInteger, Misc.BoolToInt(AutoTeamsForm.NoNewIdsCheckBox.Checked));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\AutoTeam', 'ClanBalance', rdInteger, Misc.BoolToInt(AutoTeamsForm.ClansCheckBox.Checked));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\AutoTeam', 'KeepIds', rdInteger, Misc.BoolToInt(AutoTeamsForm.NoNewIdsCheckBox.Checked));
 
     with BattleForm.VDTBattleClients.Header.Columns do
       for i := 0 to Count-1 do
       begin
-        Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'Column' + IntToStr(i), rdInteger, Items[i].Width);
-        Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm', 'ColumnPosition' + IntToStr(i), rdInteger, Items[i].Position);
+        Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'Column' + IntToStr(i), rdInteger, Items[i].Width);
+        Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm', 'ColumnPosition' + IntToStr(i), rdInteger, Items[i].Position);
       end;
 
     Pl.Length := SizeOf(TWindowPlacement);
     GetWindowPlacement(OnlineMapsForm.Handle, @Pl);
     R := Pl.rcNormalPosition;
 
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\OnlineMapsForm', 'Left', rdInteger, R.Left);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\OnlineMapsForm', 'Top', rdInteger, R.Top);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\OnlineMapsForm', 'Width', rdInteger, R.Right-R.Left);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\OnlineMapsForm', 'Height', rdInteger, R.Bottom-R.Top);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\OnlineMapsForm', 'WindowState', rdInteger, OnlineMapsForm.WindowState);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\OnlineMapsForm', 'Left', rdInteger, R.Left);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\OnlineMapsForm', 'Top', rdInteger, R.Top);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\OnlineMapsForm', 'Width', rdInteger, R.Right-R.Left);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\OnlineMapsForm', 'Height', rdInteger, R.Bottom-R.Top);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\OnlineMapsForm', 'WindowState', rdInteger, OnlineMapsForm.WindowState);
 
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\NotificationsForm', 'CheckBox1', rdInteger, Misc.BoolToInt(NotificationsForm.CheckBox1.Checked));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\NotificationsForm', 'CheckBox1', rdInteger, Misc.BoolToInt(NotificationsForm.CheckBox1.Checked));
 
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'Port', rdString, HostBattleForm.PortEdit.Text);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'Description', rdString, HostBattleForm.TitleEdit.Text);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'DescriptionAutoSend', rdInteger, Misc.BoolToInt(HostBattleForm.AutoSendDescCheckbox.Checked));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'Password', rdString, HostBattleForm.PasswordEdit.Text);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'Mod', rdString, HostBattleForm.ModsComboBox.Text);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'NATTechnique', rdInteger, HostBattleForm.NATRadioGroup.ItemIndex);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\HostBattleForm', 'NbPlayer', rdInteger, HostBattleForm.PlayersTracker.Value);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'Port', rdString, HostBattleForm.PortEdit.Text);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'Description', rdString, HostBattleForm.TitleEdit.Text);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'DescriptionAutoSend', rdInteger, Misc.BoolToInt(HostBattleForm.AutoSendDescCheckbox.Checked));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'Password', rdString, HostBattleForm.PasswordEdit.Text);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'Mod', rdString, HostBattleForm.ModsComboBox.Text);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'NATTechnique', rdInteger, HostBattleForm.NATRadioGroup.ItemIndex);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\HostBattleForm', 'NbPlayer', rdInteger, HostBattleForm.PlayersTracker.Value);
 
 
     Pl.Length := SizeOf(TWindowPlacement);
     GetWindowPlacement(MapListForm.Handle, @Pl);
     R := Pl.rcNormalPosition;
 
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MapListForm', 'Width', rdInteger, R.Right-R.Left);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MapListForm', 'Height', rdInteger, R.Bottom-R.Top);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MapListForm', 'WindowState', rdInteger, MapListForm.WindowState);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MapListForm', 'Width', rdInteger, R.Right-R.Left);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MapListForm', 'Height', rdInteger, R.Bottom-R.Top);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MapListForm', 'WindowState', rdInteger, MapListForm.WindowState);
 
     Pl.Length := SizeOf(TWindowPlacement);
     GetWindowPlacement(ReplaysForm.Handle, @Pl);
     R := Pl.rcNormalPosition;
 
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\ReplaysForm', 'Left', rdInteger, R.Left);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\ReplaysForm', 'Top', rdInteger, R.Top);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\ReplaysForm', 'Width', rdInteger, R.Right-R.Left);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\ReplaysForm', 'Height', rdInteger, R.Bottom-R.Top);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\ReplaysForm', 'FiltersEnabled', rdInteger, ReplaysForm.chkEnableFilters.Checked);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\ReplaysForm', 'Spliter1', rdInteger, ReplaysForm.BottomPanel.Height);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\ReplaysForm', 'Left', rdInteger, R.Left);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\ReplaysForm', 'Top', rdInteger, R.Top);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\ReplaysForm', 'Width', rdInteger, R.Right-R.Left);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\ReplaysForm', 'Height', rdInteger, R.Bottom-R.Top);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\ReplaysForm', 'FiltersEnabled', rdInteger, ReplaysForm.chkEnableFilters.Checked);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\ReplaysForm', 'Spliter1', rdInteger, ReplaysForm.BottomPanel.Height);
 
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\TipsForm', 'ShowTips', rdInteger, Misc.BoolToInt(TipsForm.chkShowTips.Checked));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\TipsForm', 'ShowTips', rdInteger, Misc.BoolToInt(TipsForm.chkShowTips.Checked));
 
     // write custom team colors to registry:
     for i := 0 to High(TeamColors) do
-      Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\TeamColors', 'Color' + IntToStr(i), rdInteger, TeamColors[i]);
+      Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\TeamColors', 'Color' + IntToStr(i), rdInteger, TeamColors[i]);
 
     // write preferences record to registry:
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ServerIP', rdString, Preferences.ServerIP);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ServerPort', rdString, Preferences.ServerPort);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'TabStyle', rdInteger, Preferences.TabStyle);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'TimeStamps', rdInteger, Misc.BoolToInt(Preferences.TimeStamps));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Username', rdString, Preferences.Username);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ServerIP', rdString, Preferences.ServerIP);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ServerPort', rdString, Preferences.ServerPort);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'TabStyle', rdInteger, Preferences.TabStyle);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'TimeStamps', rdInteger, Misc.BoolToInt(Preferences.TimeStamps));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'Username', rdString, Preferences.Username);
     if Preferences.RememberPasswords then
     begin
-      Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Password', rdString, Preferences.Password);
-      Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LadderPassword', rdString, Preferences.LadderPassword);
+      Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'Password', rdString, Preferences.Password);
+      Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LadderPassword', rdString, Preferences.LadderPassword);
     end
     else
     begin
-      Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Password', rdString, '');
-      Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LadderPassword', rdString, '');
+      Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'Password', rdString, '');
+      Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LadderPassword', rdString, '');
     end;
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'RememberPasswords', rdInteger, Misc.BoolToInt(Preferences.RememberPasswords));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseLogonForm', rdInteger, Misc.BoolToInt(Preferences.UseLogonForm));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ConnectOnStartup', rdInteger, Misc.BoolToInt(Preferences.ConnectOnStartup));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'SortStyle', rdInteger, Preferences.SortStyle);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'BattleSortStyle', rdInteger, Preferences.BattleSortStyle);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'BattleSortDirection', rdInteger, Preferences.BattleSortDirection);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'BattleClientSortStyle', rdInteger, Preferences.BattleClientSortStyle);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'BattleClientSortDirection', rdInteger, Preferences.BattleClientSortDirection);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'FilterJoinLeftMessages', rdInteger, Misc.BoolToInt(Preferences.FilterJoinLeftMessages));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'FilterBattleJoinLeftMessages', rdInteger, Misc.BoolToInt(Preferences.FilterBattleJoinLeftMessages));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'AutoCompletionFromCurrentChannel', rdInteger, Misc.BoolToInt(Preferences.AutoCompletionFromCurrentChannel));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ShowFlags', rdInteger, Misc.BoolToInt(Preferences.ShowFlags));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'DisplayUnitsIconsAndNames', rdInteger, Misc.BoolToInt(Preferences.DisplayUnitsIconsAndNames));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'MarkUnknownMapsNMods', rdInteger, Misc.BoolToInt(Preferences.MarkUnknownMaps));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'TaskbarButtons', rdInteger, Misc.BoolToInt(Preferences.TaskbarButtons));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'JoinMainChannel', rdInteger, Misc.BoolToInt(Preferences.JoinMainChannel));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ReconnectToBackup', rdInteger, Misc.BoolToInt(Preferences.ReconnectToBackup));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'SaveLogs', rdInteger, Misc.BoolToInt(Preferences.SaveLogs));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseSoundNotifications', rdInteger, Misc.BoolToInt(Preferences.UseSoundNotifications));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseProxy', rdInteger, Misc.BoolToInt(Preferences.UseProxy));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ProxyAddress', rdString, Preferences.ProxyAddress);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ProxyPort', rdinteger, Preferences.ProxyPort);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ProxyUsername', rdString, Preferences.ProxyUsername);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ProxyPassword', rdString, Preferences.ProxyPassword);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'HighlightColor', rdString, Preferences.HighlightColor);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseNotificationsForHighlights', rdInteger, Preferences.UseNotificationsForHighlights);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'CheckForNewVersion', rdInteger, Misc.BoolToInt(Preferences.AutoUpdateToBeta));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'EnableSpringDownloader', rdInteger, Misc.BoolToInt(Preferences.EnableSpringDownloader));
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseIgnoreList', rdInteger, Preferences.UseIgnoreList);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'WarnIfUsingNATTraversing', rdInteger, Preferences.WarnIfUsingNATTraversing);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'AutoFocusOnPM', rdInteger, Preferences.AutoFocusOnPM);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LastOpenMap', rdString, Preferences.LastOpenMap);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'MapSortStyle', rdInteger, Preferences.MapSortStyle);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ThemeType', rdInteger, Preferences.ThemeType);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Theme', rdString, Preferences.Theme);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'DisableAllSounds', rdInteger, Preferences.DisableAllSounds);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'SortLocal', rdInteger, Preferences.SortLocal);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'AskUploadReplay', rdInteger, Preferences.UploadReplay);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'FontName', rdString, CommonFont.Name);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'FontSize', rdInteger, CommonFont.Size);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'DisplayQuickJoinPanelv2', rdInteger, Preferences.DisplayQuickJoinPanel);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ScriptsEnabled2', rdInteger, Preferences.EnableScripts);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ScriptWarningMsgShown', rdInteger, Preferences.ScriptWarningMsgShown);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LimitChatLogs', rdInteger, Preferences.LimitChatLogs);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ChatLogsLimit', rdInteger, Preferences.ChatLogsLimit);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'SPTheme', rdString, Preferences.SPSkin);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'DisableNews', rdInteger, Preferences.DisableNews);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LanguageCode', rdString, Preferences.LanguageCode);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'DisableMapDetailsLoading', rdInteger, Preferences.DisableMapDetailsLoading);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LoadMetalHeightMinimaps', rdInteger, Preferences.LoadMetalHeightMinimaps);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'RememberPasswords', rdInteger, Misc.BoolToInt(Preferences.RememberPasswords));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'UseLogonForm', rdInteger, Misc.BoolToInt(Preferences.UseLogonForm));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ConnectOnStartup', rdInteger, Misc.BoolToInt(Preferences.ConnectOnStartup));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'SortStyle', rdInteger, Preferences.SortStyle);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'BattleSortStyle', rdInteger, Preferences.BattleSortStyle);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'BattleSortDirection', rdInteger, Preferences.BattleSortDirection);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'BattleClientSortStyle', rdInteger, Preferences.BattleClientSortStyle);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'BattleClientSortDirection', rdInteger, Preferences.BattleClientSortDirection);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'FilterJoinLeftMessages', rdInteger, Misc.BoolToInt(Preferences.FilterJoinLeftMessages));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'FilterBattleJoinLeftMessages', rdInteger, Misc.BoolToInt(Preferences.FilterBattleJoinLeftMessages));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'AutoCompletionFromCurrentChannel', rdInteger, Misc.BoolToInt(Preferences.AutoCompletionFromCurrentChannel));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ShowFlags', rdInteger, Misc.BoolToInt(Preferences.ShowFlags));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisplayUnitsIconsAndNames', rdInteger, Misc.BoolToInt(Preferences.DisplayUnitsIconsAndNames));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'MarkUnknownMapsNMods', rdInteger, Misc.BoolToInt(Preferences.MarkUnknownMaps));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'TaskbarButtons', rdInteger, Misc.BoolToInt(Preferences.TaskbarButtons));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'JoinMainChannel', rdInteger, Misc.BoolToInt(Preferences.JoinMainChannel));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ReconnectToBackup', rdInteger, Misc.BoolToInt(Preferences.ReconnectToBackup));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'SaveLogs', rdInteger, Misc.BoolToInt(Preferences.SaveLogs));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'UseSoundNotifications', rdInteger, Misc.BoolToInt(Preferences.UseSoundNotifications));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'UseProxy', rdInteger, Misc.BoolToInt(Preferences.UseProxy));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ProxyAddress', rdString, Preferences.ProxyAddress);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ProxyPort', rdinteger, Preferences.ProxyPort);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ProxyUsername', rdString, Preferences.ProxyUsername);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ProxyPassword', rdString, Preferences.ProxyPassword);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'HighlightColor', rdString, Preferences.HighlightColor);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'UseNotificationsForHighlights', rdInteger, Preferences.UseNotificationsForHighlights);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'CheckForNewVersion', rdInteger, Misc.BoolToInt(Preferences.AutoUpdateToBeta));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'EnableSpringDownloader', rdInteger, Misc.BoolToInt(Preferences.EnableSpringDownloader));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'UseIgnoreList', rdInteger, Preferences.UseIgnoreList);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'WarnIfUsingNATTraversing', rdInteger, Preferences.WarnIfUsingNATTraversing);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'AutoFocusOnPM', rdInteger, Preferences.AutoFocusOnPM);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LastOpenMap', rdString, Preferences.LastOpenMap);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'MapSortStyle', rdInteger, Preferences.MapSortStyle);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ThemeType', rdInteger, Preferences.ThemeType);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'Theme', rdString, Preferences.Theme);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisableAllSounds', rdInteger, Preferences.DisableAllSounds);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'SortLocal', rdInteger, Preferences.SortLocal);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'AskUploadReplay', rdInteger, Preferences.UploadReplay);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'FontName', rdString, CommonFont.Name);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'FontSize', rdInteger, CommonFont.Size);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisplayQuickJoinPanelv2', rdInteger, Preferences.DisplayQuickJoinPanel);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ScriptsEnabled2', rdInteger, Preferences.EnableScripts);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ScriptWarningMsgShown', rdInteger, Preferences.ScriptWarningMsgShown);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LimitChatLogs', rdInteger, Preferences.LimitChatLogs);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ChatLogsLimit', rdInteger, Preferences.ChatLogsLimit);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'SPTheme', rdString, Preferences.SPSkin);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisableNews', rdInteger, Preferences.DisableNews);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LanguageCode', rdString, Preferences.LanguageCode);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisableMapDetailsLoading', rdInteger, Preferences.DisableMapDetailsLoading);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LoadMetalHeightMinimaps', rdInteger, Preferences.LoadMetalHeightMinimaps);
 
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'MyText', rdInteger, Colors.MyText);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'AdminText', rdInteger, Colors.AdminText);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'Normal', rdInteger, Colors.Normal);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'Data', rdInteger, Colors.Data);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'Error', rdInteger, Colors.Error);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'Info', rdInteger, Colors.Info);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'MinorInfo', rdInteger, Colors.MinorInfo);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'ChanJoin', rdInteger, Colors.ChanJoin);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'ChanLeft', rdInteger, Colors.ChanLeft);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'MOTD', rdInteger, Colors.MOTD);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'SayEx', rdInteger, Colors.SayEx);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'Topic', rdInteger, Colors.Topic);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\ChatColors', 'OldMsgs', rdInteger, Colors.OldMsgs);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\OtherColors', 'ClientAway', rdInteger, Colors.ClientAway);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\OtherColors', 'MapModUnavailable', rdInteger, Colors.MapModUnavailable);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences\OtherColors', 'BotText', rdInteger, Colors.BotText);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'MyText', rdInteger, Colors.MyText);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'AdminText', rdInteger, Colors.AdminText);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'Normal', rdInteger, Colors.Normal);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'Data', rdInteger, Colors.Data);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'Error', rdInteger, Colors.Error);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'Info', rdInteger, Colors.Info);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'MinorInfo', rdInteger, Colors.MinorInfo);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'ChanJoin', rdInteger, Colors.ChanJoin);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'ChanLeft', rdInteger, Colors.ChanLeft);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'MOTD', rdInteger, Colors.MOTD);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'SayEx', rdInteger, Colors.SayEx);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'Topic', rdInteger, Colors.Topic);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\ChatColors', 'OldMsgs', rdInteger, Colors.OldMsgs);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\OtherColors', 'ClientAway', rdInteger, Colors.ClientAway);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\OtherColors', 'MapModUnavailable', rdInteger, Colors.MapModUnavailable);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences\OtherColors', 'BotText', rdInteger, Colors.BotText);
 
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\TemplateEditor', 'LayoutGlobal', rdString, TemplateEditorForm.ProfileTemplate.Lines.Text);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\TemplateEditor', 'LayoutProperty', rdString, TemplateEditorForm.LayoutPropertyChange.Lines.Text);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\TemplateEditor', 'RecordProperty', rdString, TemplateEditorForm.RecordPropertyChange.Lines.Text);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\TemplateEditor', 'LayoutGlobal', rdString, TemplateEditorForm.ProfileTemplate.Lines.Text);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\TemplateEditor', 'LayoutProperty', rdString, TemplateEditorForm.LayoutPropertyChange.Lines.Text);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\TemplateEditor', 'RecordProperty', rdString, TemplateEditorForm.RecordPropertyChange.Lines.Text);
   except
   end;
 end;
@@ -750,11 +750,11 @@
 procedure TPreferencesForm.SaveDefaultBattlePreferencesToRegistry;
 begin
   try
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm\Default', 'StartPos', rdInteger, BattleForm.StartPosRadioGroup.ItemIndex);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm\Default', 'GameEnd', rdInteger, BattleForm.GameEndRadioGroup.ItemIndex);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm\Default', 'StartMetal', rdInteger, BattleForm.MetalTracker.Value);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm\Default', 'StartEnergy', rdInteger, BattleForm.EnergyTracker.Value);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm\Default', 'MaxUnits', rdInteger, BattleForm.UnitsTracker.Value);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm\Default', 'StartPos', rdInteger, BattleForm.StartPosRadioGroup.ItemIndex);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm\Default', 'GameEnd', rdInteger, BattleForm.GameEndRadioGroup.ItemIndex);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm\Default', 'StartMetal', rdInteger, BattleForm.MetalTracker.Value);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm\Default', 'StartEnergy', rdInteger, BattleForm.EnergyTracker.Value);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm\Default', 'MaxUnits', rdInteger, BattleForm.UnitsTracker.Value);
   except
     MessageDlg(_('Unable to write preferences to windows registry!'), mtError, [mbOK], 0);
   end;
@@ -762,11 +762,11 @@
 
 procedure TPreferencesForm.LoadDefaultBattlePreferencesFromRegistry;
 begin
-  try BattleForm.StartPosRadioGroup.ItemIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm\Default', 'StartPos'); except end;
-  try BattleForm.GameEndRadioGroup.ItemIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm\Default', 'GameEnd'); except end;
-  try BattleForm.MetalTracker.Value := Min(BattleForm.MetalTracker.Maximum,Max(BattleForm.MetalTracker.Minimum,Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm\Default', 'StartMetal'))); except end;
-  try BattleForm.EnergyTracker.Value := Min(BattleForm.EnergyTracker.Maximum,Max(BattleForm.EnergyTracker.Minimum,Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm\Default', 'StartEnergy'))); except end;
-  try BattleForm.UnitsTracker.Value := Min(BattleForm.UnitsTracker.Maximum,Max(BattleForm.UnitsTracker.Minimum,Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\BattleForm\Default', 'MaxUnits'))); except end;
+  try BattleForm.StartPosRadioGroup.ItemIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm\Default', 'StartPos'); except end;
+  try BattleForm.GameEndRadioGroup.ItemIndex := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm\Default', 'GameEnd'); except end;
+  try BattleForm.MetalTracker.Value := Min(BattleForm.MetalTracker.Maximum,Max(BattleForm.MetalTracker.Minimum,Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm\Default', 'StartMetal'))); except end;
+  try BattleForm.EnergyTracker.Value := Min(BattleForm.EnergyTracker.Maximum,Max(BattleForm.EnergyTracker.Minimum,Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm\Default', 'StartEnergy'))); except end;
+  try BattleForm.UnitsTracker.Value := Min(BattleForm.UnitsTracker.Maximum,Max(BattleForm.UnitsTracker.Minimum,Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\BattleForm\Default', 'MaxUnits'))); except end;
 end;
 
 { call this method after all forms have been initialized, just before hiding the splash screen!
@@ -776,7 +776,7 @@
   controls properly sized and aligned - since initialization hasn't been completed yet. }
 procedure TPreferencesForm.ApplyPostInitializationPreferences;
 begin
-  try MainForm.WindowState := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Forms\MainForm', 'WindowState'); except end;
+  try MainForm.WindowState := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Forms\MainForm', 'WindowState'); except end;
 end;
 
 { will check form's bounds and adjust them if they appear outside the visible area etc.

Modified: Lobby/TASClient/ReplaysUnit.dfm
===================================================================
--- Lobby/TASClient/ReplaysUnit.dfm	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/ReplaysUnit.dfm	2009-06-29 00:57:41 UTC (rev 7279)
@@ -1,6 +1,6 @@
 object ReplaysForm: TReplaysForm
-  Left = 655
-  Top = 73
+  Left = 332
+  Top = 113
   Width = 790
   Height = 599
   Caption = 'Replays'

Modified: Lobby/TASClient/ReplaysUnit.pas
===================================================================
--- Lobby/TASClient/ReplaysUnit.pas	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/ReplaysUnit.pas	2009-06-29 00:57:41 UTC (rev 7279)
@@ -1085,7 +1085,7 @@
       end;
     end;
   end;
-  ShellExecute(MainForm.Handle, 'open', PChar(springDir+'spring.exe'), PChar(AnsiString(Replay.FileName)), PChar(springDir), SW_MAX);
+  ShellExecute(MainForm.Handle, 'open', PChar(springDir+'spring.exe'), PChar('&quot;'+AnsiString(Replay.FileName)+'&quot;'), PChar(springDir), SW_MAX);
 end;
 
 procedure TReplaysForm.DeleteButtonClick(Sender: TObject);

Modified: Lobby/TASClient/SplashScreenUnit.dfm
===================================================================
--- Lobby/TASClient/SplashScreenUnit.dfm	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/SplashScreenUnit.dfm	2009-06-29 00:57:41 UTC (rev 7279)
@@ -17,7 +17,6 @@
   OldCreateOrder = False
   Position = poScreenCenter
   Scaled = False
-  OnCreate = FormCreate
   OnShow = FormShow
   PixelsPerInch = 96
   TextHeight = 13

Modified: Lobby/TASClient/SplashScreenUnit.pas
===================================================================
--- Lobby/TASClient/SplashScreenUnit.pas	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/SplashScreenUnit.pas	2009-06-29 00:57:41 UTC (rev 7279)
@@ -15,7 +15,6 @@
     procedure CreateParams(var Params: TCreateParams); override;
     procedure UpdateText(Text: string);
     function MsgBox(const Msg: string; DlgType: TMsgDlgType; Buttons: TMsgDlgButtons; HelpCtx: Longint): Word;
-    procedure FormCreate(Sender: TObject);
     procedure FormShow(Sender: TObject);
   private
     { Private declarations }
@@ -61,56 +60,6 @@
   Result := MessageDlg(Msg,DlgType,Buttons,HelpCtx);
 end;
 
-procedure TSplashScreenForm.FormCreate(Sender: TObject);
-var
-  FileName: String;
-  Ini : TIniFile;
-  tmpStr: string;
-begin
-  try
-    FileName := ExtractFilePath(Application.ExeName) + CUSTOM_TASCLIENT_FILE;
-    if FileExists(FileName) then
-    begin
-      Ini := TIniFile.Create(FileName);
-      NEWS_URL := Ini.ReadString('News','NewsURL',NEWS_URL);
-      SCROLLING_NEWS_RSS_URL := Ini.ReadString('News','ScrollingNewsRSSFeed',SCROLLING_NEWS_RSS_URL);
-      tmpStr := Ini.ReadString('SplashScreen','Image','');
-      if tmpStr &lt;&gt; '' then
-      begin
-        if MidStr(tmpStr,2,2) &lt;&gt; ':\' then
-          tmpStr := ExtractFilePath(Application.ExeName)+tmpStr;
-        try
-          Image1.Picture.LoadFromFile(tmpStr);
-        except
-        end;
-      end;
-
-      // version label
-      tmpStr := Ini.ReadString('SplashScreen','VersionLabelX','');
-      if tmpStr &lt;&gt; '' then
-        try VersionLabel.Left := StrToInt(tmpStr); except end;
-      tmpStr := Ini.ReadString('SplashScreen','VersionLabelY','');
-      if tmpStr &lt;&gt; '' then
-        try VersionLabel.Top := StrToInt(tmpStr); except end;
-      tmpStr := Ini.ReadString('SplashScreen','VersionLabelColor','');
-      if tmpStr &lt;&gt; '' then
-        try VersionLabel.Font.Color := StandardRGBToColor(HexToInt(tmpStr)); except end;
-
-      // InfoLabel
-      tmpStr := Ini.ReadString('SplashScreen','InfoLabelX','');
-      if tmpStr &lt;&gt; '' then
-        try InfoLabel.Left := StrToInt(tmpStr); except end;
-      tmpStr := Ini.ReadString('SplashScreen','InfoLabelY','');
-      if tmpStr &lt;&gt; '' then
-        try InfoLabel.Top := StrToInt(tmpStr); except end;
-      tmpStr := Ini.ReadString('SplashScreen','InfoLabelColor','');
-      if tmpStr &lt;&gt; '' then
-        try InfoLabel.Font.Color := StandardRGBToColor(HexToInt(tmpStr)); except end;
-    end;
-  except
-  end;
-end;
-
 procedure TSplashScreenForm.FormShow(Sender: TObject);
 begin
   SplashScreenForm.ClientWidth := Image1.Width;

Modified: Lobby/TASClient/TASClient.dof
===================================================================
--- Lobby/TASClient/TASClient.dof	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/TASClient.dof	2009-06-29 00:57:41 UTC (rev 7279)
@@ -100,7 +100,7 @@
 DebugSourceDirs=
 UsePackages=0
 [Parameters]
-RunParams=
+RunParams=-inifile &quot;C:\Program Files\Spring\TASClient.ini&quot;
 HostApplication=C:\Program Files\Spring\TASClient.exe
 Launcher=
 UseLauncher=0
@@ -115,7 +115,7 @@
 MajorVer=0
 MinorVer=47
 Release=0
-Build=621
+Build=623
 Debug=0
 PreRelease=0
 Special=0
@@ -126,7 +126,7 @@
 [Version Info Keys]
 CompanyName=
 FileDescription=Spring RTS Engine lobby client
-FileVersion=0.47.0.621
+FileVersion=0.47.0.623
 InternalName=
 LegalCopyright=
 LegalTrademarks=

Modified: Lobby/TASClient/TASClient.dpr
===================================================================
--- Lobby/TASClient/TASClient.dpr	2009-06-22 21:09:31 UTC (rev 7278)
+++ Lobby/TASClient/TASClient.dpr	2009-06-29 00:57:41 UTC (rev 7279)
@@ -135,7 +135,8 @@
   Debug.Log := False;
   
   // read command line arguments:
-  for i := 1 to ParamCount do
+  i:=1;
+  while i &lt;= ParamCount do
   begin
     MainUnit.RunningUnderWine := MainUnit.RunningUnderWine or (UpperCase(ParamStr(i)) = '-WINE');
     MainUnit.RunningWithMainMenu := MainUnit.RunningWithMainMenu or (UpperCase(ParamStr(i)) = '-MENU');
@@ -143,6 +144,18 @@
     MainUnit.Debug.Enabled := MainUnit.Debug.Enabled or (UpperCase(ParamStr(i)) = '-DEBUG');
     MainUnit.Debug.Log := MainUnit.Debug.Log or (UpperCase(ParamStr(i)) = '-LOG');
 
+    if UpperCase(ParamStr(i)) = '-INIFILE' then
+    begin
+      Inc(i);
+      if i &lt;= ParamCount then
+      begin
+        CUSTOM_TASCLIENT_FILE := ParamStr(i);
+        if not FileExists(CUSTOM_TASCLIENT_FILE) then
+          MessageDlg(_('File not found : ')+CUSTOM_TASCLIENT_FILE,mtWarning,[mbOK],0)
+      end
+      else
+        MessageDlg(_('Wrong -inifile usage : -inifile filename'),mtWarning,[mbOK],0);
+    end;
     if UpperCase(ParamStr(i)) = '-SERVER' then
       if (ParamCount = i) or (Pos(':',ParamStr(i+1)) = 0) then
         MessageDlg(_('Wrong -server usage : -server myserver.com:8200'),mtWarning,[mbOk],0)
@@ -155,6 +168,7 @@
           MessageDlg(_('Wrong -server usage : -server myserver.com:8200'),mtWarning,[mbOk],0);
         end;
       end;
+    Inc(i);
   end;
 
   if MainUnit.Debug.Enabled then
@@ -162,6 +176,14 @@
 
   if MainUnit.Debug.Enabled then
     Misc.TryToAddLog(MainUnit.StartDebugLog,'Loading preferences ...');
+
+  // first create splash screen (but preferences must already be loaded!):
+  SplashScreenForm := TSplashScreenForm.Create(nil);
+  SplashScreenForm.VersionLabel.Caption := VERSION_NUMBER;
+  SplashScreenForm.Show;
+
+  // load the tasclient.ini file
+  LoadTASClientIni(CUSTOM_TASCLIENT_FILE);
     
   // preload preferences, since we need to know about &quot;TaskbarButtons&quot; field before we create other forms:
   Preferences := DEFAULT_PREFERENCES;
@@ -172,19 +194,21 @@
   if MainUnit.Debug.Enabled then
     Misc.TryToAddLog(MainUnit.StartDebugLog,'Displaying splashscreen ...');
 
-  // first create splash screen (but preferences must already be loaded!):
-  SplashScreenForm := TSplashScreenForm.Create(nil);
-  SplashScreenForm.VersionLabel.Caption := VERSION_NUMBER;
-  SplashScreenForm.Show;
-
-  if MainUnit.Debug.Enabled then
-    Misc.TryToAddLog(MainUnit.StartDebugLog,'Splashscreen fadein ...');
-
-  while SplashScreenForm.AlphaBlendValue &lt; 255 do
+  if not DISABLE_FADEIN then
   begin
-    SplashScreenForm.AlphaBlendValue := Min(255,SplashScreenForm.AlphaBlendValue+8);
+    if MainUnit.Debug.Enabled then
+      Misc.TryToAddLog(MainUnit.StartDebugLog,'Splashscreen fadein ...');
+    while SplashScreenForm.AlphaBlendValue &lt; 255 do
+    begin
+      SplashScreenForm.AlphaBlendValue := Min(255,SplashScreenForm.AlphaBlendValue+8);
+      SplashScreenForm.Refresh;
+      Sleep(20);
+    end;
+  end
+  else
+  begin
+    SplashScreenForm.AlphaBlendValue := 255;
     SplashScreenForm.Refresh;
-    Sleep(20);
   end;
 
   if MainUnit.Debug.Enabled then

Modified: Lobby/TASClient/TASClient.res
===================================================================
(Binary files differ)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002048.html">[Taspring-linux-commit] Global Leadership in HandCare - Consumer, Professional and Industrial Products OTC : FLKI
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2049">[ date ]</a>
              <a href="thread.html#2049">[ thread ]</a>
              <a href="subject.html#2049">[ subject ]</a>
              <a href="author.html#2049">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
