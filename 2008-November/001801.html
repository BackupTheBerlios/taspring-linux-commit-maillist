<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r7032 - in trunk/rts: ExternalAI Game	Game/UI Lua Map Rendering/UnitModels Sim/Features Sim/Misc	Sim/MoveTypes Sim/Objects Sim/Units Sim/Units/CommandAI	Sim/Units/UnitTypes
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7032%20-%20in%20trunk/rts%3A%20ExternalAI%20Game%0A%09Game/UI%20Lua%20Map%20Rendering/UnitModels%20Sim/Features%20Sim/Misc%0A%09Sim/MoveTypes%20Sim/Objects%20Sim/Units%20Sim/Units/CommandAI%0A%09Sim/Units/UnitTypes&In-Reply-To=%3C20081113043342.E154546E9%40progate.clan-sy.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001800.html">
   <LINK REL="Next"  HREF="001802.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r7032 - in trunk/rts: ExternalAI Game	Game/UI Lua Map Rendering/UnitModels Sim/Features Sim/Misc	Sim/MoveTypes Sim/Objects Sim/Units Sim/Units/CommandAI	Sim/Units/UnitTypes</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7032%20-%20in%20trunk/rts%3A%20ExternalAI%20Game%0A%09Game/UI%20Lua%20Map%20Rendering/UnitModels%20Sim/Features%20Sim/Misc%0A%09Sim/MoveTypes%20Sim/Objects%20Sim/Units%20Sim/Units/CommandAI%0A%09Sim/Units/UnitTypes&In-Reply-To=%3C20081113043342.E154546E9%40progate.clan-sy.com%3E"
       TITLE="[Taspring-linux-commit] r7032 - in trunk/rts: ExternalAI Game	Game/UI Lua Map Rendering/UnitModels Sim/Features Sim/Misc	Sim/MoveTypes Sim/Objects Sim/Units Sim/Units/CommandAI	Sim/Units/UnitTypes">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Thu Nov 13 05:33:42 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001800.html">[Taspring-linux-commit] r7031 - trunk/rts/Rendering/Env
</A></li>
        <LI>Next message: <A HREF="001802.html">[Taspring-linux-commit] r7033 - in trunk: . AI AI/Global/AAI	AI/Global/JCAI AI/Global/KAI-0.2 AI/Global/KAIK-0.13	AI/Global/NTai/AI/NTai/Agents AI/Global/NTai/AI/NTai/Helpers/Terrain	AI/Global/NTai/AI/NTai/Tasks AI/Global/NTai/AI/NTai/Units	AI/Global/RAI rts tools/DedicatedServer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1801">[ date ]</a>
              <a href="thread.html#1801">[ thread ]</a>
              <a href="subject.html#1801">[ subject ]</a>
              <a href="author.html#1801">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: lurker
Date: 2008-11-13 05:33:41 +0100 (Thu, 13 Nov 2008)
New Revision: 7032

Modified:
   trunk/rts/ExternalAI/AICallback.cpp
   trunk/rts/Game/Game.cpp
   trunk/rts/Game/GameHelper.cpp
   trunk/rts/Game/SelectedUnits.cpp
   trunk/rts/Game/SelectedUnitsAI.cpp
   trunk/rts/Game/UI/GuiHandler.cpp
   trunk/rts/Lua/LuaFeatureDefs.cpp
   trunk/rts/Lua/LuaUnitDefs.cpp
   trunk/rts/Map/BaseGroundDrawer.cpp
   trunk/rts/Map/BasicMapDamage.cpp
   trunk/rts/Rendering/UnitModels/UnitDrawer.cpp
   trunk/rts/Sim/Features/Feature.cpp
   trunk/rts/Sim/Features/FeatureDef.h
   trunk/rts/Sim/Features/FeatureHandler.cpp
   trunk/rts/Sim/Misc/GroundBlockingObjectMap.cpp
   trunk/rts/Sim/Misc/RadarHandler.cpp
   trunk/rts/Sim/Misc/RadarHandler.h
   trunk/rts/Sim/MoveTypes/AirMoveType.cpp
   trunk/rts/Sim/MoveTypes/GroundMoveType.cpp
   trunk/rts/Sim/MoveTypes/TAAirMoveType.cpp
   trunk/rts/Sim/Objects/SolidObject.cpp
   trunk/rts/Sim/Objects/SolidObject.h
   trunk/rts/Sim/Units/CommandAI/BuilderCAI.cpp
   trunk/rts/Sim/Units/CommandAI/CommandAI.cpp
   trunk/rts/Sim/Units/UnitDef.h
   trunk/rts/Sim/Units/UnitDefHandler.cpp
   trunk/rts/Sim/Units/UnitHandler.cpp
   trunk/rts/Sim/Units/UnitLoader.cpp
   trunk/rts/Sim/Units/UnitTypes/Builder.cpp
Log:
* Unit and feature ysize -&gt; zsize

Modified: trunk/rts/ExternalAI/AICallback.cpp
===================================================================
--- trunk/rts/ExternalAI/AICallback.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/ExternalAI/AICallback.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -1069,8 +1069,8 @@
 			int zs=(int)(z/SQUARE_SIZE);
 			bool good=true;
 			int xsize=bi.GetXSize();
-			int ysize=bi.GetYSize();
-			for(int z2=std::max(0,zs-ysize/2-minDist);z2&lt;std::min(gs-&gt;mapy,zs+(ysize+1)/2+minDist);++z2){
+			int zsize=bi.GetZSize();
+			for(int z2=std::max(0,zs-zsize/2-minDist);z2&lt;std::min(gs-&gt;mapy,zs+(zsize+1)/2+minDist);++z2){
 				for(int x2=std::max(0,xs-xsize/2-minDist);x2&lt;std::min(gs-&gt;mapx,xs+(xsize+1)/2+minDist);++x2){
 					CSolidObject* so = groundBlockingObjectMap-&gt;GroundBlockedUnsafe(z2 * gs-&gt;mapx + x2);
 					if(so &amp;&amp; so-&gt;immobile &amp;&amp; !dynamic_cast&lt;CFeature*&gt;(so)){
@@ -1080,7 +1080,7 @@
 				}
 			}
 			//Checking factories near - factory can open yard for building
-			if (good) for(int z2=std::max(0,zs-ysize/2-minDist-2);z2&lt;std::min(gs-&gt;mapy,zs+(ysize+1)/2+minDist+2);++z2){
+			if (good) for(int z2=std::max(0,zs-zsize/2-minDist-2);z2&lt;std::min(gs-&gt;mapy,zs+(zsize+1)/2+minDist+2);++z2){
 				for(int x2=std::max(0,xs-xsize/2-minDist-2);x2&lt;std::min(gs-&gt;mapx,xs+(xsize+1)/2+minDist+2);++x2){
 					CSolidObject* so = groundBlockingObjectMap-&gt;GroundBlockedUnsafe(z2 * gs-&gt;mapx + x2);
 					if(so &amp;&amp; so-&gt;immobile &amp;&amp; dynamic_cast&lt;CFactory*&gt;(so) &amp;&amp; ((CFactory*)so)-&gt;opening){

Modified: trunk/rts/Game/Game.cpp
===================================================================
--- trunk/rts/Game/Game.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Game/Game.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -2243,7 +2243,7 @@
 
 			if (unitDef != NULL) {
 				int xsize = unitDef-&gt;xsize;
-				int zsize = unitDef-&gt;ysize;
+				int zsize = unitDef-&gt;zsize;
 				int squareSize = (int) streflop::ceil(streflop::sqrt((float) numRequestedUnits));
 				int total = numRequestedUnits;
 
@@ -2275,7 +2275,7 @@
 				const FeatureDef* featureDef = featureHandler-&gt;GetFeatureDef(unitName);
 				if (featureDef) {
 					int xsize = featureDef-&gt;xsize;
-					int zsize = featureDef-&gt;ysize;
+					int zsize = featureDef-&gt;zsize;
 					int squareSize = (int) streflop::ceil(streflop::sqrt((float) numRequestedUnits));
 					int total = amount; // FIXME -- feature count limit?
 

Modified: trunk/rts/Game/GameHelper.cpp
===================================================================
--- trunk/rts/Game/GameHelper.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Game/GameHelper.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -900,7 +900,7 @@
 	else
 		pos.x = floor((buildInfo.pos.x + 8) / (SQUARE_SIZE * 2)) * SQUARE_SIZE * 2;
 
-	if (buildInfo.GetYSize() &amp; 2)
+	if (buildInfo.GetZSize() &amp; 2)
 		pos.z = floor((buildInfo.pos.z    ) / (SQUARE_SIZE * 2)) * SQUARE_SIZE * 2 + 8;
 	else
 		pos.z = floor((buildInfo.pos.z + 8) / (SQUARE_SIZE * 2)) * SQUARE_SIZE * 2;

Modified: trunk/rts/Game/SelectedUnits.cpp
===================================================================
--- trunk/rts/Game/SelectedUnits.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Game/SelectedUnits.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -481,10 +481,10 @@
 				continue;
 			}
 
-			glVertexf3(unit-&gt;drawPos + float3( unit-&gt;xsize * 4, 0,  unit-&gt;ysize * 4));
-			glVertexf3(unit-&gt;drawPos + float3(-unit-&gt;xsize * 4, 0,  unit-&gt;ysize * 4));
-			glVertexf3(unit-&gt;drawPos + float3(-unit-&gt;xsize * 4, 0, -unit-&gt;ysize * 4));
-			glVertexf3(unit-&gt;drawPos + float3( unit-&gt;xsize * 4, 0, -unit-&gt;ysize * 4));
+			glVertexf3(unit-&gt;drawPos + float3( unit-&gt;xsize * 4, 0,  unit-&gt;zsize * 4));
+			glVertexf3(unit-&gt;drawPos + float3(-unit-&gt;xsize * 4, 0,  unit-&gt;zsize * 4));
+			glVertexf3(unit-&gt;drawPos + float3(-unit-&gt;xsize * 4, 0, -unit-&gt;zsize * 4));
+			glVertexf3(unit-&gt;drawPos + float3( unit-&gt;xsize * 4, 0, -unit-&gt;zsize * 4));
 		}
 		glEnd();
 	}

Modified: trunk/rts/Game/SelectedUnitsAI.cpp
===================================================================
--- trunk/rts/Game/SelectedUnitsAI.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Game/SelectedUnitsAI.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -258,7 +258,7 @@
 		CUnit* unit=uh-&gt;units[*ui];
 		if(unit){
 			const UnitDef* ud = unit-&gt;unitDef;
-			sumLength += (int)((ud-&gt;xsize + ud-&gt;ysize)/2);
+			sumLength += (int)((ud-&gt;xsize + ud-&gt;zsize)/2);
 
 			float3 unitPos;
 			if (queueing) {
@@ -374,7 +374,7 @@
 	CUnit* u = uh-&gt;units[unit];
 	if (u) {
 		const UnitDef* ud = u-&gt;unitDef;
-		unitSize = (int)((ud-&gt;xsize + ud-&gt;ysize)/2);
+		unitSize = (int)((ud-&gt;xsize + ud-&gt;zsize)/2);
 	}
 	float3 retPos(nextCornerPos.x+unitSize*8*2+addSpace, 0, nextCornerPos.z);
 	float3 movePos(nextCornerPos.x+unitSize*8+addSpace, 0, nextCornerPos.z); //posit in coordinates of &quot;front&quot;

Modified: trunk/rts/Game/UI/GuiHandler.cpp
===================================================================
--- trunk/rts/Game/UI/GuiHandler.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Game/UI/GuiHandler.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -2492,23 +2492,23 @@
 
 	if(other.def &amp;&amp; GetQueueKeystate() &amp;&amp; keys[SDLK_LCTRL]){		//circle build around building
 		int oxsize=other.GetXSize()*SQUARE_SIZE;
-		int oysize=other.GetYSize()*SQUARE_SIZE;
+		int ozsize=other.GetZSize()*SQUARE_SIZE;
 		int xsize=startInfo.GetXSize()*SQUARE_SIZE;
-		int ysize=startInfo.GetYSize()*SQUARE_SIZE;
+		int zsize=startInfo.GetZSize()*SQUARE_SIZE;
 
 		start =end=helper-&gt;Pos2BuildPos(other);
 		start.x-=oxsize/2;
-		start.z-=oysize/2;
+		start.z-=ozsize/2;
 		end.x+=oxsize/2;
-		end.z+=oysize/2;
+		end.z+=ozsize/2;
 
 		int nvert=1+oxsize/xsize;
-		int nhori=1+oysize/xsize;
+		int nhori=1+ozsize/xsize;
 
-		FillRowOfBuildPos(startInfo, end.x  +ysize/2, start.z+xsize/2,      0, +xsize, nhori, 3, true, ret);
-		FillRowOfBuildPos(startInfo, end.x  -xsize/2, end.z  +ysize/2, -xsize,      0, nvert, 2, true, ret);
-		FillRowOfBuildPos(startInfo, start.x-ysize/2, end.z  -xsize/2,      0, -xsize, nhori, 1, true, ret);
-		FillRowOfBuildPos(startInfo, start.x+xsize/2, start.z-ysize/2, +xsize,      0, nvert, 0, true, ret);
+		FillRowOfBuildPos(startInfo, end.x  +zsize/2, start.z+xsize/2,      0, +xsize, nhori, 3, true, ret);
+		FillRowOfBuildPos(startInfo, end.x  -xsize/2, end.z  +zsize/2, -xsize,      0, nvert, 2, true, ret);
+		FillRowOfBuildPos(startInfo, start.x-zsize/2, end.z  -xsize/2,      0, -xsize, nhori, 1, true, ret);
+		FillRowOfBuildPos(startInfo, start.x+xsize/2, start.z-zsize/2, +xsize,      0, nvert, 0, true, ret);
 
 	} else { // rectangle or line
 		float3 delta = end - start;
@@ -2517,7 +2517,7 @@
 		int xnum=(int)((fabs(delta.x)+xsize*1.4f)/xsize);
 		float xstep=(int)((0&lt;delta.x) ? xsize : -xsize);
 
-		float zsize=SQUARE_SIZE*(startInfo.GetYSize()+buildSpacing*2);
+		float zsize=SQUARE_SIZE*(startInfo.GetZSize()+buildSpacing*2);
 		int znum=(int)((fabs(delta.z)+zsize*1.4f)/zsize);
 		float zstep=(int)((0&lt;delta.z) ? zsize : -zsize);
 

Modified: trunk/rts/Lua/LuaFeatureDefs.cpp
===================================================================
--- trunk/rts/Lua/LuaFeatureDefs.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Lua/LuaFeatureDefs.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -427,7 +427,7 @@
 	ADD_FLOAT(&quot;mass&quot;, fd.mass);
 
 	ADD_INT(&quot;xsize&quot;, fd.xsize);
-	ADD_INT(&quot;ysize&quot;, fd.ysize);
+	ADD_INT(&quot;zsize&quot;, fd.zsize);
 
 	/*
 	ADD_FLOAT(&quot;hitSphereScale&quot;,    fd.collisionSphereScale);

Modified: trunk/rts/Lua/LuaUnitDefs.cpp
===================================================================
--- trunk/rts/Lua/LuaUnitDefs.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Lua/LuaUnitDefs.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -842,7 +842,7 @@
 //	unsigned char* yardmaps[4];			//Iterations of the Ymap for building rotation
 
 	ADD_INT(&quot;xsize&quot;, ud.xsize);
-	ADD_INT(&quot;ysize&quot;, ud.ysize);
+	ADD_INT(&quot;zsize&quot;, ud.zsize);
 
 	ADD_INT(&quot;buildangle&quot;, ud.buildangle);
 

Modified: trunk/rts/Map/BaseGroundDrawer.cpp
===================================================================
--- trunk/rts/Map/BaseGroundDrawer.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Map/BaseGroundDrawer.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -383,7 +383,7 @@
 				const int airMipLevel = loshandler-&gt;airMipLevel;
 				if (drawRadarAndJammer) {
 					const int rxsize = radarhandler-&gt;xsize;
-					const int rysize = radarhandler-&gt;ysize;
+					const int rzsize = radarhandler-&gt;zsize;
 					const int posScale = highResInfoTexWanted ? SQUARE_SIZE : (SQUARE_SIZE * 2);
 					for (int y = starty; y &lt; endy; ++y) {
 						const float zPos = y * posScale;
@@ -407,8 +407,8 @@
 							const unsigned short* radarMap  = myRadar;
 							const unsigned short* jammerMap = myJammer;
 #endif // SONAR_JAMMER_MAPS
-							const int inRadar = InterpolateLos(radarMap,  rxsize, rysize, 3 + lowRes, 255, x, y);
-							const int inJam   = InterpolateLos(jammerMap, rxsize, rysize, 3 + lowRes, 255, x, y);
+							const int inRadar = InterpolateLos(radarMap,  rxsize, rzsize, 3 + lowRes, 255, x, y);
+							const int inJam   = InterpolateLos(jammerMap, rxsize, rzsize, 3 + lowRes, 255, x, y);
 
 							const int index = (a * 4);
 							for (int c = 0; c &lt; 3; c++) {

Modified: trunk/rts/Map/BasicMapDamage.cpp
===================================================================
--- trunk/rts/Map/BasicMapDamage.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Map/BasicMapDamage.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -117,7 +117,7 @@
 			CUnit* unit = *ui;
 			float totalDif = 0.0f;
 
-			for (int z = unit-&gt;mapPos.y; z &lt; unit-&gt;mapPos.y + unit-&gt;ysize; z++) {
+			for (int z = unit-&gt;mapPos.y; z &lt; unit-&gt;mapPos.y + unit-&gt;zsize; z++) {
 				for (int x = unit-&gt;mapPos.x; x &lt; unit-&gt;mapPos.x + unit-&gt;xsize; x++) {
 					// calculate the distance and normalize it
 					float dist = pos.distance2D(float3(x * SQUARE_SIZE, 0, z * SQUARE_SIZE));
@@ -134,7 +134,7 @@
 				}
 			}
 
-			totalDif /= unit-&gt;xsize * unit-&gt;ysize;
+			totalDif /= unit-&gt;xsize * unit-&gt;zsize;
 			if (totalDif != 0) {
 				ExploBuilding eb;
 				eb.id = (*ui)-&gt;id;
@@ -142,7 +142,7 @@
 				eb.tx1 = unit-&gt;mapPos.x;
 				eb.tx2 = unit-&gt;mapPos.x + unit-&gt;xsize;
 				eb.tz1 = unit-&gt;mapPos.y;
-				eb.tz2 = unit-&gt;mapPos.y + unit-&gt;ysize;
+				eb.tz2 = unit-&gt;mapPos.y + unit-&gt;zsize;
 				e-&gt;buildings.push_back(eb);
 			}
 		}

Modified: trunk/rts/Rendering/UnitModels/UnitDrawer.cpp
===================================================================
--- trunk/rts/Rendering/UnitModels/UnitDrawer.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Rendering/UnitModels/UnitDrawer.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -890,15 +890,15 @@
 				pos = helper-&gt;Pos2BuildPos(bi);
 
 				float xsize = bi.GetXSize() * 4;
-				float ysize = bi.GetYSize() * 4;
+				float zsize = bi.GetZSize() * 4;
 				glColor4f(0.2f, 1, 0.2f, 0.7f);
 				glDisable(GL_TEXTURE_2D);
 				glBegin(GL_LINE_STRIP);
-				glVertexf3(pos+float3( xsize, 1,  ysize));
-				glVertexf3(pos+float3(-xsize, 1,  ysize));
-				glVertexf3(pos+float3(-xsize, 1, -ysize));
-				glVertexf3(pos+float3( xsize, 1, -ysize));
-				glVertexf3(pos+float3( xsize, 1,  ysize));
+				glVertexf3(pos+float3( xsize, 1,  zsize));
+				glVertexf3(pos+float3(-xsize, 1,  zsize));
+				glVertexf3(pos+float3(-xsize, 1, -zsize));
+				glVertexf3(pos+float3( xsize, 1, -zsize));
+				glVertexf3(pos+float3( xsize, 1,  zsize));
 				glEnd();
 				glColor4f(1, 1, 1, 0.3f);
 				glEnable(GL_TEXTURE_2D);

Modified: trunk/rts/Sim/Features/Feature.cpp
===================================================================
--- trunk/rts/Sim/Features/Feature.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Features/Feature.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -159,7 +159,7 @@
 	health   = def-&gt;maxHealth;
 	blocking = def-&gt;blocking;
 	xsize    = def-&gt;xsize;
-	ysize    = def-&gt;ysize;
+	zsize    = def-&gt;zsize;
 	mass     = def-&gt;mass;
 	noSelect = def-&gt;noSelect;
 

Modified: trunk/rts/Sim/Features/FeatureDef.h
===================================================================
--- trunk/rts/Sim/Features/FeatureDef.h	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Features/FeatureDef.h	2008-11-13 04:33:41 UTC (rev 7032)
@@ -23,7 +23,7 @@
 		upright(false), drawType(0), modelType(0),
 		resurrectable(false), destructable(false), reclaimable(true), blocking(false),
 		burnable(false), floating(false), noSelect(false), geoThermal(false),
-		xsize(0), ysize(0) {}
+		xsize(0), zsize(0) {}
 
 	S3DOModel* LoadModel(int team) const;
 	CollisionVolume* collisionVolume;
@@ -74,7 +74,7 @@
 	/// each size is 8 units
 	int xsize;
 	/// each size is 8 units
-	int ysize;
+	int zsize;
 
 	std::map&lt;std::string, std::string&gt; customParams;
 };

Modified: trunk/rts/Sim/Features/FeatureHandler.cpp
===================================================================
--- trunk/rts/Sim/Features/FeatureHandler.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Features/FeatureHandler.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -66,7 +66,7 @@
 		CR_MEMBER(deathFeature),
 		CR_MEMBER(smokeTime),
 		CR_MEMBER(xsize),
-		CR_MEMBER(ysize)
+		CR_MEMBER(zsize)
 		));
 
 
@@ -262,7 +262,7 @@
 
 	// our resolution is double TA's
 	fd-&gt;xsize = fdTable.GetInt(&quot;footprintX&quot;, 1) * 2;
-	fd-&gt;ysize = fdTable.GetInt(&quot;footprintZ&quot;, 1) * 2;
+	fd-&gt;zsize = fdTable.GetInt(&quot;footprintZ&quot;, 1) * 2;
 
 	const float defMass = (fd-&gt;metal * 0.4f) + (fd-&gt;maxHealth * 0.1f);
 	fd-&gt;mass = fdTable.GetFloat(&quot;mass&quot;, defMass);
@@ -328,7 +328,7 @@
 			fd-&gt;reclaimTime = 250;
 			fd-&gt;maxHealth = 5;
 			fd-&gt;xsize = 2;
-			fd-&gt;ysize = 2;
+			fd-&gt;zsize = 2;
 			fd-&gt;myName = name;
 			fd-&gt;description = &quot;Tree&quot;;
 			fd-&gt;mass = 20;
@@ -351,7 +351,7 @@
 			fd-&gt;reclaimTime = 0;
 			fd-&gt;maxHealth = 0;
 			fd-&gt;xsize = 0;
-			fd-&gt;ysize = 0;
+			fd-&gt;zsize = 0;
 			fd-&gt;myName = name;
 			fd-&gt;mass = 100000;
 			// geothermals have no collision volume at all

Modified: trunk/rts/Sim/Misc/GroundBlockingObjectMap.cpp
===================================================================
--- trunk/rts/Sim/Misc/GroundBlockingObjectMap.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Misc/GroundBlockingObjectMap.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -45,7 +45,7 @@
 	const int minXSqr = bx;
 	const int minZSqr = bz;
 	const int maxXSqr = bx + object-&gt;xsize;
-	const int maxZSqr = bz + object-&gt;ysize;
+	const int maxZSqr = bz + object-&gt;zsize;
 
 	for (int zSqr = minZSqr; zSqr &lt; maxZSqr; zSqr++) {
 		for (int xSqr = minXSqr; xSqr &lt; maxXSqr; xSqr++) {
@@ -83,7 +83,7 @@
 	const int minXSqr = bx;
 	const int minZSqr = bz;
 	const int maxXSqr = bx + object-&gt;xsize;
-	const int maxZSqr = bz + object-&gt;ysize;
+	const int maxZSqr = bz + object-&gt;zsize;
 
 	for (int z = 0; minZSqr + z &lt; maxZSqr; z++) {
 		for (int x = 0; minXSqr + x &lt; maxXSqr; x++) {
@@ -113,7 +113,7 @@
 	const int bx = object-&gt;mapPos.x;
 	const int bz = object-&gt;mapPos.y;
 	const int sx = object-&gt;xsize;
-	const int sz = object-&gt;ysize;
+	const int sz = object-&gt;zsize;
 
 	for (int z = bz; z &lt; bz + sz; ++z) {
 		for (int x = bx; x &lt; bx + sx; ++x) {
@@ -209,7 +209,7 @@
 {
 	const int objID = GetObjectID(yard);
 
-	for (int z = yard-&gt;mapPos.y; z &lt; yard-&gt;mapPos.y + yard-&gt;ysize; ++z) {
+	for (int z = yard-&gt;mapPos.y; z &lt; yard-&gt;mapPos.y + yard-&gt;zsize; ++z) {
 		for (int x = yard-&gt;mapPos.x; x &lt; yard-&gt;mapPos.x + yard-&gt;xsize; ++x) {
 			const int idx = z * gs-&gt;mapx + x;
 			BlockingMapCell&amp; cell = groundBlockingMap[idx];

Modified: trunk/rts/Sim/Misc/RadarHandler.cpp
===================================================================
--- trunk/rts/Sim/Misc/RadarHandler.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Misc/RadarHandler.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -19,7 +19,7 @@
 	CR_MEMBER(radarErrorSize),
 	CR_MEMBER(baseRadarErrorSize),
 	CR_MEMBER(xsize),
-	CR_MEMBER(ysize),
+	CR_MEMBER(zsize),
 	CR_MEMBER(targFacEffect),
 	CR_RESERVED(32)
 ));
@@ -30,7 +30,7 @@
 
 void CRadarHandler::Serialize(creg::ISerializer&amp; s)
 {
-	const int size = xsize*ysize*2;
+	const int size = xsize*zsize*2;
 
 	// NOTE This could be tricky if gs is serialized after radarHandler.
 	for (int a = 0; a &lt; teamHandler-&gt;ActiveAllyTeams(); ++a) {
@@ -54,10 +54,10 @@
 : circularRadar(circularRadar),
   baseRadarErrorSize(96),
   xsize(gs-&gt;mapx / RADAR_SIZE),
-  ysize(gs-&gt;mapy / RADAR_SIZE),
+  zsize(gs-&gt;mapy / RADAR_SIZE),
   targFacEffect(2)
 {
-	const int size = xsize * ysize;
+	const int size = xsize * zsize;
 
 	commonJammerMap.resize(size, 0);
 	commonSonarJammerMap.resize(size, 0);
@@ -159,7 +159,7 @@
 	const int sx = std::max(0, pos.x - radius);
 	const int ex = std::min(xsize - 1, pos.x + radius);
 	const int sy = std::max(0, pos.y - radius);
-	const int ey = std::min(ysize - 1, pos.y + radius);
+	const int ey = std::min(zsize - 1, pos.y + radius);
 
 	const int rr = (radius * radius);
 
@@ -205,7 +205,7 @@
 
 		for (linei = line.begin(); linei != line.end(); ++linei) {
 			if (((xradar + linei-&gt;x) &lt; xsize) &amp;&amp;
-			    ((yradar + linei-&gt;y) &lt; ysize)) {
+			    ((yradar + linei-&gt;y) &lt; zsize)) {
 				int rsquare = (xradar + linei-&gt;x) + (yradar + linei-&gt;y) * xsize;
 				int msquare = (xmap + linei-&gt;x * 4) + (ymap + linei-&gt;y * 4) * gs-&gt;hmapx;
 				float dh = readmap-&gt;mipHeightmap[1][msquare] - baseHeight;
@@ -253,7 +253,7 @@
 				}
 			}
 			if (((xradar - linei-&gt;y) &gt;= 0) &amp;&amp;
-			    ((yradar + linei-&gt;x) &lt; ysize)) {
+			    ((yradar + linei-&gt;x) &lt; zsize)) {
 				int rsquare = (xradar - linei-&gt;y) + (yradar + linei-&gt;x) * xsize;
 				int msquare = (xmap - linei-&gt;y * 4) + (ymap + linei-&gt;x * 4) * gs-&gt;hmapx;
 				float dh = readmap-&gt;mipHeightmap[1][msquare] - baseHeight;

Modified: trunk/rts/Sim/Misc/RadarHandler.h
===================================================================
--- trunk/rts/Sim/Misc/RadarHandler.h	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Misc/RadarHandler.h	2008-11-13 04:33:41 UTC (rev 7032)
@@ -36,7 +36,7 @@
 	{
 		const int gx = (int)pos.x / (SQUARE_SIZE * RADAR_SIZE);
 		const int gz = (int)pos.z / (SQUARE_SIZE * RADAR_SIZE);
-		const int rowIdx = std::max(0, std::min(ysize - 1, gz));
+		const int rowIdx = std::max(0, std::min(zsize - 1, gz));
 		const int colIdx = std::max(0, std::min(xsize - 1, gx));
 		return (rowIdx * xsize) + colIdx;
 	}
@@ -112,7 +112,7 @@
 	float baseRadarErrorSize;
 
 	int xsize;
-	int ysize;
+	int zsize;
 
 	float targFacEffect;
 

Modified: trunk/rts/Sim/MoveTypes/AirMoveType.cpp
===================================================================
--- trunk/rts/Sim/MoveTypes/AirMoveType.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/MoveTypes/AirMoveType.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -1176,7 +1176,7 @@
 	int2 mp = owner-&gt;GetMapPos();
 	owner-&gt;pos = tpos;
 
-	for (int z = mp.y; z &lt; mp.y + owner-&gt;ysize; z++) {
+	for (int z = mp.y; z &lt; mp.y + owner-&gt;zsize; z++) {
 		for (int x = mp.x; x &lt; mp.x + owner-&gt;xsize; x++) {
 			if (groundBlockingObjectMap-&gt;GroundBlockedUnsafe(z * gs-&gt;mapx + x)) {
 				return ret;

Modified: trunk/rts/Sim/MoveTypes/GroundMoveType.cpp
===================================================================
--- trunk/rts/Sim/MoveTypes/GroundMoveType.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/MoveTypes/GroundMoveType.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -1156,7 +1156,7 @@
 	// calculate the distance in (x,z) depending
 	// on the shape of the object footprints
 	float dist2D;
-	if (object1-&gt;xsize == object1-&gt;ysize || object2-&gt;xsize == object2-&gt;ysize) {
+	if (object1-&gt;xsize == object1-&gt;zsize || object2-&gt;xsize == object2-&gt;zsize) {
 		// use xsize as a cylindrical radius.
 		float3 distVec = (object1-&gt;midPos - object2-&gt;midPos);
 		dist2D = distVec.Length2D() - (object1-&gt;xsize + object2-&gt;xsize) * SQUARE_SIZE / 2 + 2 * marginal;
@@ -1167,7 +1167,7 @@
 		float zdiff = streflop::fabs(object1-&gt;midPos.z - object2-&gt;midPos.z);
 
 		distVec.x = xdiff - (object1-&gt;xsize + object2-&gt;xsize) * SQUARE_SIZE / 2 + 2 * marginal;
-		distVec.z = zdiff - (object1-&gt;ysize + object2-&gt;ysize) * SQUARE_SIZE / 2 + 2 * marginal;
+		distVec.z = zdiff - (object1-&gt;zsize + object2-&gt;zsize) * SQUARE_SIZE / 2 + 2 * marginal;
 
 		if (distVec.x &gt; 0.0f &amp;&amp; distVec.z &gt; 0.0f) {
 			dist2D = distVec.Length2D();
@@ -1436,7 +1436,7 @@
 		int retest = 0;
 
 		do {
-			const float zmove = (owner-&gt;mapPos.y + owner-&gt;ysize / 2) * SQUARE_SIZE;
+			const float zmove = (owner-&gt;mapPos.y + owner-&gt;zsize / 2) * SQUARE_SIZE;
 			const float xmove = (owner-&gt;mapPos.x + owner-&gt;xsize / 2) * SQUARE_SIZE;
 
 			if (fabs(owner-&gt;frontdir.x) &gt; fabs(owner-&gt;frontdir.z)) {
@@ -1444,29 +1444,29 @@
 					haveCollided |= CheckColV(newmp.y, newmp.x, newmp.x + owner-&gt;xsize - 1,  zmove - 3.99f, owner-&gt;mapPos.y);
 					newmp = owner-&gt;GetMapPos();
 				} else if (newmp.y &gt; owner-&gt;mapPos.y) {
-					haveCollided |= CheckColV(newmp.y + owner-&gt;ysize - 1, newmp.x, newmp.x + owner-&gt;xsize - 1,  zmove + 3.99f, owner-&gt;mapPos.y + owner-&gt;ysize - 1);
+					haveCollided |= CheckColV(newmp.y + owner-&gt;zsize - 1, newmp.x, newmp.x + owner-&gt;xsize - 1,  zmove + 3.99f, owner-&gt;mapPos.y + owner-&gt;zsize - 1);
 					newmp = owner-&gt;GetMapPos();
 				}
 				if (newmp.x &lt; owner-&gt;mapPos.x) {
-					haveCollided |= CheckColH(newmp.x, newmp.y, newmp.y + owner-&gt;ysize - 1,  xmove - 3.99f, owner-&gt;mapPos.x);
+					haveCollided |= CheckColH(newmp.x, newmp.y, newmp.y + owner-&gt;zsize - 1,  xmove - 3.99f, owner-&gt;mapPos.x);
 					newmp = owner-&gt;GetMapPos();
 				} else if (newmp.x &gt; owner-&gt;mapPos.x) {
-					haveCollided |= CheckColH(newmp.x + owner-&gt;xsize - 1, newmp.y, newmp.y + owner-&gt;ysize - 1,  xmove + 3.99f, owner-&gt;mapPos.x + owner-&gt;xsize - 1);
+					haveCollided |= CheckColH(newmp.x + owner-&gt;xsize - 1, newmp.y, newmp.y + owner-&gt;zsize - 1,  xmove + 3.99f, owner-&gt;mapPos.x + owner-&gt;xsize - 1);
 					newmp = owner-&gt;GetMapPos();
 				}
 			} else {
 				if (newmp.x &lt; owner-&gt;mapPos.x) {
-					haveCollided |= CheckColH(newmp.x, newmp.y, newmp.y + owner-&gt;ysize - 1,  xmove - 3.99f, owner-&gt;mapPos.x);
+					haveCollided |= CheckColH(newmp.x, newmp.y, newmp.y + owner-&gt;zsize - 1,  xmove - 3.99f, owner-&gt;mapPos.x);
 					newmp = owner-&gt;GetMapPos();
 				} else if (newmp.x &gt; owner-&gt;mapPos.x) {
-					haveCollided |= CheckColH(newmp.x + owner-&gt;xsize - 1, newmp.y, newmp.y + owner-&gt;ysize - 1,  xmove + 3.99f, owner-&gt;mapPos.x + owner-&gt;xsize - 1);
+					haveCollided |= CheckColH(newmp.x + owner-&gt;xsize - 1, newmp.y, newmp.y + owner-&gt;zsize - 1,  xmove + 3.99f, owner-&gt;mapPos.x + owner-&gt;xsize - 1);
 					newmp = owner-&gt;GetMapPos();
 				}
 				if (newmp.y &lt; owner-&gt;mapPos.y) {
 					haveCollided |= CheckColV(newmp.y, newmp.x, newmp.x + owner-&gt;xsize - 1,  zmove - 3.99f, owner-&gt;mapPos.y);
 					newmp = owner-&gt;GetMapPos();
 				} else if (newmp.y &gt; owner-&gt;mapPos.y) {
-					haveCollided |= CheckColV(newmp.y + owner-&gt;ysize - 1, newmp.x, newmp.x + owner-&gt;xsize - 1,  zmove + 3.99f, owner-&gt;mapPos.y + owner-&gt;ysize - 1);
+					haveCollided |= CheckColV(newmp.y + owner-&gt;zsize - 1, newmp.x, newmp.x + owner-&gt;xsize - 1,  zmove + 3.99f, owner-&gt;mapPos.y + owner-&gt;zsize - 1);
 					newmp = owner-&gt;GetMapPos();
 				}
 			}

Modified: trunk/rts/Sim/MoveTypes/TAAirMoveType.cpp
===================================================================
--- trunk/rts/Sim/MoveTypes/TAAirMoveType.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/MoveTypes/TAAirMoveType.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -973,7 +973,7 @@
 	int2 mp = owner-&gt;GetMapPos();
 	owner-&gt;pos = tpos;
 
-	for (int z = mp.y; z &lt; mp.y + owner-&gt;ysize; z++) {
+	for (int z = mp.y; z &lt; mp.y + owner-&gt;zsize; z++) {
 		for (int x = mp.x; x &lt; mp.x + owner-&gt;xsize; x++) {
 			CObject* o = groundBlockingObjectMap-&gt;GroundBlockedUnsafe(z * gs-&gt;mapx + x);
 			if (o &amp;&amp; o != owner) {

Modified: trunk/rts/Sim/Objects/SolidObject.cpp
===================================================================
--- trunk/rts/Sim/Objects/SolidObject.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Objects/SolidObject.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -18,7 +18,7 @@
 	CR_MEMBER(immobile),
 	CR_MEMBER(blockHeightChanges),
 	CR_MEMBER(xsize),
-	CR_MEMBER(ysize),
+	CR_MEMBER(zsize),
 	CR_MEMBER(height),
 	CR_MEMBER(heading),
 	CR_ENUM_MEMBER(physicalState),
@@ -42,7 +42,7 @@
 	blockHeightChanges(false),
 	floatOnWater(false),
 	xsize(1),
-	ysize(1),
+	zsize(1),
 	height(1),
 
 	physicalState(Ghost),
@@ -123,7 +123,7 @@
 {
 	int2 p;
 	p.x = (int(pos.x + SQUARE_SIZE / 2) / SQUARE_SIZE) - xsize / 2;
-	p.y = (int(pos.z + SQUARE_SIZE / 2) / SQUARE_SIZE) - ysize / 2;
+	p.y = (int(pos.z + SQUARE_SIZE / 2) / SQUARE_SIZE) - zsize / 2;
 
 	if (p.x &lt; 0)
 		p.x = 0;
@@ -132,8 +132,8 @@
 
 	if (p.y &lt; 0)
 		p.y = 0;
-	if (p.y &gt; gs-&gt;mapy - ysize)
-		p.y = gs-&gt;mapy - ysize;
+	if (p.y &gt; gs-&gt;mapy - zsize)
+		p.y = gs-&gt;mapy - zsize;
 
 	return p;
 }

Modified: trunk/rts/Sim/Objects/SolidObject.h
===================================================================
--- trunk/rts/Sim/Objects/SolidObject.h	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Objects/SolidObject.h	2008-11-13 04:33:41 UTC (rev 7032)
@@ -43,7 +43,7 @@
 	bool immobile;								// Immobile objects can not be moved. (Except perhaps along y-axis, to make them stay on ground.)
 	bool blockHeightChanges;					// map height cannot change under this object
 	int xsize;									// The x-size of this object, according to its footprint.
-	int ysize;									// The z-size of this object, according to its footprint. (NOTE: This one should have been called zsize!)
+	int zsize;									// The z-size of this object, according to its footprint.
 	float height;								// The height of this object.
 	SyncedSshort heading;								// Contains the same information as frontdir, but in a short signed integer.
 	

Modified: trunk/rts/Sim/Units/CommandAI/BuilderCAI.cpp
===================================================================
--- trunk/rts/Sim/Units/CommandAI/BuilderCAI.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Units/CommandAI/BuilderCAI.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -1507,12 +1507,12 @@
 			BuildInfo bi(*ci);
 			bi.pos = helper-&gt;Pos2BuildPos(bi);
 			const float xsize = bi.GetXSize()*4;
-			const float ysize = bi.GetYSize()*4;
+			const float zsize = bi.GetZSize()*4;
 			glBegin(GL_LINE_LOOP);
-			glVertexf3(bi.pos + float3(+xsize, 1, +ysize));
-			glVertexf3(bi.pos + float3(-xsize, 1, +ysize));
-			glVertexf3(bi.pos + float3(-xsize, 1, -ysize));
-			glVertexf3(bi.pos + float3(+xsize, 1, -ysize));
+			glVertexf3(bi.pos + float3(+xsize, 1, +zsize));
+			glVertexf3(bi.pos + float3(-xsize, 1, +zsize));
+			glVertexf3(bi.pos + float3(-xsize, 1, -zsize));
+			glVertexf3(bi.pos + float3(+xsize, 1, -zsize));
 			glEnd();
 			if (bi.pos.y &lt; 0.0f) {
 				const float s[4] = { 0.0f, 0.0f, 1.0f, 0.5f }; // start color
@@ -1520,9 +1520,9 @@
 
 				const float h = bi.pos.y;
 				const float x1 = bi.pos.x - xsize;
-				const float z1 = bi.pos.z - ysize;
+				const float z1 = bi.pos.z - zsize;
 				const float x2 = bi.pos.x + xsize;
-				const float z2 = bi.pos.z + ysize;
+				const float z2 = bi.pos.z + zsize;
 
 				glPushAttrib(GL_CURRENT_BIT);
 				glBegin(GL_LINES);

Modified: trunk/rts/Sim/Units/CommandAI/CommandAI.cpp
===================================================================
--- trunk/rts/Sim/Units/CommandAI/CommandAI.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Units/CommandAI/CommandAI.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -971,7 +971,7 @@
 					BuildInfo bt(t);
 					if (bc.def &amp;&amp; bt.def
 					    &amp;&amp; fabs(bc.pos.x - bt.pos.x) * 2 &lt;= std::max(bc.GetXSize(), bt.GetXSize()) * SQUARE_SIZE
-					    &amp;&amp; fabs(bc.pos.z - bt.pos.z) * 2 &lt;= std::max(bc.GetYSize(), bt.GetYSize()) * SQUARE_SIZE) {
+					    &amp;&amp; fabs(bc.pos.z - bt.pos.z) * 2 &lt;= std::max(bc.GetZSize(), bt.GetZSize()) * SQUARE_SIZE) {
 						return ci;
 					}
 				} else {
@@ -1069,9 +1069,9 @@
 						const float dist2X = 2.0f * fabs(cbi.pos.x - tbi.pos.x);
 						const float dist2Z = 2.0f * fabs(cbi.pos.z - tbi.pos.z);
 						const float addSizeX = SQUARE_SIZE * (cbi.GetXSize() + tbi.GetXSize());
-						const float addSizeZ = SQUARE_SIZE * (cbi.GetYSize() + tbi.GetYSize());
+						const float addSizeZ = SQUARE_SIZE * (cbi.GetZSize() + tbi.GetZSize());
 						const float maxSizeX = SQUARE_SIZE * std::max(cbi.GetXSize(), tbi.GetXSize());
-						const float maxSizeZ = SQUARE_SIZE * std::max(cbi.GetYSize(), tbi.GetYSize());
+						const float maxSizeZ = SQUARE_SIZE * std::max(cbi.GetZSize(), tbi.GetZSize());
 						if (cbi.def &amp;&amp; tbi.def &amp;&amp;
 						    ((dist2X &gt; maxSizeX) || (dist2Z &gt; maxSizeZ)) &amp;&amp;
 						    ((dist2X &lt; addSizeX) &amp;&amp; (dist2Z &lt; addSizeZ))) {

Modified: trunk/rts/Sim/Units/UnitDef.h
===================================================================
--- trunk/rts/Sim/Units/UnitDef.h	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Units/UnitDef.h	2008-11-13 04:33:41 UTC (rev 7032)
@@ -309,7 +309,7 @@
 	unsigned char* yardmaps[4];						// Iterations of the Ymap for building rotation
 
 	int xsize;										// each size is 8 units
-	int ysize;										// each size is 8 units
+	int zsize;										// each size is 8 units
 
 	int buildangle;
 
@@ -423,8 +423,8 @@
 	BuildInfo(const Command&amp; c) { Parse(c); }
 	BuildInfo(const std::string&amp; name, const float3&amp; p, int facing);
 
-	int GetXSize() const { return (buildFacing&amp;1)==0 ? def-&gt;xsize : def-&gt;ysize; }
-	int GetYSize() const { return (buildFacing&amp;1)==1 ? def-&gt;xsize : def-&gt;ysize; }
+	int GetXSize() const { return (buildFacing&amp;1)==0 ? def-&gt;xsize : def-&gt;zsize; }
+	int GetZSize() const { return (buildFacing&amp;1)==1 ? def-&gt;xsize : def-&gt;zsize; }
 	bool Parse(const Command&amp; c);
 	void FillCmd(Command&amp; c) const;
 

Modified: trunk/rts/Sim/Units/UnitDefHandler.cpp
===================================================================
--- trunk/rts/Sim/Units/UnitDefHandler.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Units/UnitDefHandler.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -705,7 +705,7 @@
 
 	// TA has only half our res so multiply size with 2
 	ud.xsize = udTable.GetInt(&quot;footprintX&quot;, 1) * 2;
-	ud.ysize = udTable.GetInt(&quot;footprintZ&quot;, 1) * 2;
+	ud.zsize = udTable.GetInt(&quot;footprintZ&quot;, 1) * 2;
 
 	ud.needGeo = false;
 	if ((ud.type == &quot;Building&quot;) || (ud.type == &quot;Factory&quot;)) {
@@ -944,15 +944,15 @@
 
 	//Creates the map.
 	for (int u=0;u&lt;4;u++)
-		def-&gt;yardmaps[u] = SAFE_NEW unsigned char[def-&gt;xsize * def-&gt;ysize];
+		def-&gt;yardmaps[u] = SAFE_NEW unsigned char[def-&gt;xsize * def-&gt;zsize];
 
-	unsigned char *originalMap = SAFE_NEW unsigned char[def-&gt;xsize * def-&gt;ysize / 4];		//TAS resolution is double of TA resolution.
-	memset(originalMap, 255, def-&gt;xsize * def-&gt;ysize / 4);
+	unsigned char *originalMap = SAFE_NEW unsigned char[def-&gt;xsize * def-&gt;zsize / 4];		//TAS resolution is double of TA resolution.
+	memset(originalMap, 255, def-&gt;xsize * def-&gt;zsize / 4);
 
 	if(!yardmapStr.empty()){
 		std::string::iterator si = yardmapStr.begin();
 		int x, y;
-		for(y = 0; y &lt; def-&gt;ysize / 2; y++) {
+		for(y = 0; y &lt; def-&gt;zsize / 2; y++) {
 			for(x = 0; x &lt; def-&gt;xsize / 2; x++) {
 				if(*si == 'g')
 					def-&gt;needGeo=true;
@@ -970,12 +970,12 @@
 				break;
 		}
 	}
-	for(int y = 0; y &lt; def-&gt;ysize; y++)
+	for(int y = 0; y &lt; def-&gt;zsize; y++)
 		for(int x = 0; x &lt; def-&gt;xsize; x++){
 			def-&gt;yardmaps[0][x + y*def-&gt;xsize] = originalMap[x/2 + y/2*def-&gt;xsize/2];
-			def-&gt;yardmaps[1][(def-&gt;ysize*def-&gt;xsize)-(def-&gt;ysize*(x+1)-(y+1)+1)] = originalMap[x/2 + y/2*def-&gt;xsize/2];
-			def-&gt;yardmaps[2][(def-&gt;ysize*def-&gt;xsize)-(x + y*def-&gt;xsize+1)] = originalMap[x/2 + y/2*def-&gt;xsize/2];
-			def-&gt;yardmaps[3][def-&gt;ysize*(x+1)-(y+1)] = originalMap[x/2 + y/2*def-&gt;xsize/2];
+			def-&gt;yardmaps[1][(def-&gt;zsize*def-&gt;xsize)-(def-&gt;zsize*(x+1)-(y+1)+1)] = originalMap[x/2 + y/2*def-&gt;xsize/2];
+			def-&gt;yardmaps[2][(def-&gt;zsize*def-&gt;xsize)-(x + y*def-&gt;xsize+1)] = originalMap[x/2 + y/2*def-&gt;xsize/2];
+			def-&gt;yardmaps[3][def-&gt;zsize*(x+1)-(y+1)] = originalMap[x/2 + y/2*def-&gt;xsize/2];
 		}
 	delete[] originalMap;
 }

Modified: trunk/rts/Sim/Units/UnitHandler.cpp
===================================================================
--- trunk/rts/Sim/Units/UnitHandler.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Units/UnitHandler.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -341,13 +341,13 @@
 	const float* heightmap=readmap-&gt;GetHeightmap();
 
 	int xsize=1;
-	int ysize=1;
+	int zsize=1;
 
 	float maxDif=unitdef-&gt;maxHeightDif;
 	int x1 = (int)max(0.f,(pos.x-(xsize*0.5f*SQUARE_SIZE))/SQUARE_SIZE);
 	int x2 = min(gs-&gt;mapx,x1+xsize);
-	int z1 = (int)max(0.f,(pos.z-(ysize*0.5f*SQUARE_SIZE))/SQUARE_SIZE);
-	int z2 = min(gs-&gt;mapy,z1+ysize);
+	int z1 = (int)max(0.f,(pos.z-(zsize*0.5f*SQUARE_SIZE))/SQUARE_SIZE);
+	int z2 = min(gs-&gt;mapy,z1+zsize);
 
 	if (x1 &gt; gs-&gt;mapx) x1 = gs-&gt;mapx;
 	if (x2 &lt; 0) x2 = 0;
@@ -383,25 +383,25 @@
 {
 	feature = NULL;
 	int xsize = buildInfo.GetXSize();
-	int ysize = buildInfo.GetYSize();
+	int zsize = buildInfo.GetZSize();
 	float3 pos = buildInfo.pos;
 
 	int x1 = (int) (pos.x - (xsize * 0.5f * SQUARE_SIZE));
 	int x2 = x1 + xsize * SQUARE_SIZE;
-	int z1 = (int) (pos.z - (ysize * 0.5f * SQUARE_SIZE));
-	int z2 = z1 + ysize * SQUARE_SIZE;
+	int z1 = (int) (pos.z - (zsize * 0.5f * SQUARE_SIZE));
+	int z2 = z1 + zsize * SQUARE_SIZE;
 	float h=GetBuildHeight(pos,buildInfo.def);
 
 	int canBuild = 2;
 
 	if (buildInfo.def-&gt;needGeo) {
 		canBuild = 0;
-		std::vector&lt;CFeature*&gt; features=qf-&gt;GetFeaturesExact(pos,max(xsize,ysize)*6);
+		std::vector&lt;CFeature*&gt; features=qf-&gt;GetFeaturesExact(pos,max(xsize,zsize)*6);
 
 		for (std::vector&lt;CFeature*&gt;::iterator fi=features.begin();fi!=features.end();++fi) {
 			if ((*fi)-&gt;def-&gt;geoThermal
 			    &amp;&amp; fabs((*fi)-&gt;pos.x - pos.x) &lt; (xsize * 4 - 4)
-			    &amp;&amp; fabs((*fi)-&gt;pos.z - pos.z) &lt; (ysize * 4 - 4)){
+			    &amp;&amp; fabs((*fi)-&gt;pos.z - pos.z) &lt; (zsize * 4 - 4)){
 				canBuild = 2;
 				break;
 			}
@@ -492,13 +492,13 @@
 	glBegin(GL_QUADS);
 
 	int xsize=buildInfo.GetXSize();
-	int ysize=buildInfo.GetYSize();
+	int zsize=buildInfo.GetZSize();
 	const float3&amp; pos = buildInfo.pos;
 
 	int x1 = (int) (pos.x-(xsize*0.5f*SQUARE_SIZE));
 	int x2 = x1+xsize*SQUARE_SIZE;
-	int z1 = (int) (pos.z-(ysize*0.5f*SQUARE_SIZE));
-	int z2 = z1+ysize*SQUARE_SIZE;
+	int z1 = (int) (pos.z-(zsize*0.5f*SQUARE_SIZE));
+	int z2 = z1+zsize*SQUARE_SIZE;
 	float h=GetBuildHeight(pos,buildInfo.def);
 
 	int canbuild=2;
@@ -506,10 +506,10 @@
 	if(buildInfo.def-&gt;needGeo)
 	{
 		canbuild=0;
-		std::vector&lt;CFeature*&gt; features=qf-&gt;GetFeaturesExact(pos,max(xsize,ysize)*6);
+		std::vector&lt;CFeature*&gt; features=qf-&gt;GetFeaturesExact(pos,max(xsize,zsize)*6);
 
 		for(std::vector&lt;CFeature*&gt;::iterator fi=features.begin();fi!=features.end();++fi){
-			if((*fi)-&gt;def-&gt;geoThermal &amp;&amp; fabs((*fi)-&gt;pos.x-pos.x)&lt;xsize*4-4 &amp;&amp; fabs((*fi)-&gt;pos.z-pos.z)&lt;ysize*4-4){
+			if((*fi)-&gt;def-&gt;geoThermal &amp;&amp; fabs((*fi)-&gt;pos.x-pos.x)&lt;xsize*4-4 &amp;&amp; fabs((*fi)-&gt;pos.z-pos.z)&lt;zsize*4-4){
 				canbuild=2;
 				break;
 			}
@@ -529,7 +529,7 @@
 				for(;ci != cv.end() &amp;&amp; tbs; ci++){
 					BuildInfo bc(*ci);
 					if(max(bc.pos.x-x-SQUARE_SIZE,x-bc.pos.x)*2 &lt; bc.GetXSize()*SQUARE_SIZE
-						&amp;&amp; max(bc.pos.z-z-SQUARE_SIZE,z-bc.pos.z)*2 &lt; bc.GetYSize()*SQUARE_SIZE){
+						&amp;&amp; max(bc.pos.z-z-SQUARE_SIZE,z-bc.pos.z)*2 &lt; bc.GetZSize()*SQUARE_SIZE){
 						tbs=0;
 					}
 				}
@@ -690,7 +690,7 @@
 				if((*ci).id &lt; 0 &amp;&amp; (*ci).params.size() &gt;= 3){
 					BuildInfo bi(*ci);
 					tempF1 = pos + dir*((bi.pos.y - pos.y)/dir.y) - bi.pos;
-					if(bi.def &amp;&amp; bi.GetXSize()/2*SQUARE_SIZE &gt; fabs(tempF1.x) &amp;&amp; bi.GetYSize()/2*SQUARE_SIZE &gt; fabs(tempF1.z)){
+					if(bi.def &amp;&amp; bi.GetXSize()/2*SQUARE_SIZE &gt; fabs(tempF1.x) &amp;&amp; bi.GetZSize()/2*SQUARE_SIZE &gt; fabs(tempF1.z)){
 						return (*ci);
 					}
 				}

Modified: trunk/rts/Sim/Units/UnitLoader.cpp
===================================================================
--- trunk/rts/Sim/Units/UnitLoader.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Units/UnitLoader.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -124,8 +124,8 @@
 
 	unit-&gt;beingBuilt = build;
 
-	unit-&gt;xsize = ((facing &amp; 1) == 0) ? ud-&gt;xsize : ud-&gt;ysize;
-	unit-&gt;ysize = ((facing &amp; 1) == 1) ? ud-&gt;xsize : ud-&gt;ysize;
+	unit-&gt;xsize = ((facing &amp; 1) == 0) ? ud-&gt;xsize : ud-&gt;zsize;
+	unit-&gt;zsize = ((facing &amp; 1) == 1) ? ud-&gt;xsize : ud-&gt;zsize;
 	unit-&gt;buildFacing = facing;
 	unit-&gt;power = ud-&gt;power;
 	unit-&gt;maxHealth = ud-&gt;health;
@@ -524,9 +524,9 @@
 		bi.pos = helper-&gt;Pos2BuildPos(bi);
 		const float hss = 0.5f * SQUARE_SIZE;
 		const int tx1 = (int) std::max(0.0f ,(bi.pos.x - (bi.GetXSize() * hss)) / SQUARE_SIZE);
-		const int tz1 = (int) std::max(0.0f ,(bi.pos.z - (bi.GetYSize() * hss)) / SQUARE_SIZE);
+		const int tz1 = (int) std::max(0.0f ,(bi.pos.z - (bi.GetZSize() * hss)) / SQUARE_SIZE);
 		const int tx2 = std::min(gs-&gt;mapx, tx1 + bi.GetXSize());
-		const int tz2 = std::min(gs-&gt;mapy, tz1 + bi.GetYSize());
+		const int tz2 = std::min(gs-&gt;mapy, tz1 + bi.GetZSize());
 
 		for (int z = tz1; z &lt;= tz2; z++) {
 			for (int x = tx1; x &lt;= tx2; x++) {

Modified: trunk/rts/Sim/Units/UnitTypes/Builder.cpp
===================================================================
--- trunk/rts/Sim/Units/UnitTypes/Builder.cpp	2008-11-13 04:16:43 UTC (rev 7031)
+++ trunk/rts/Sim/Units/UnitTypes/Builder.cpp	2008-11-13 04:33:41 UTC (rev 7032)
@@ -407,8 +407,8 @@
 		//resume levelling the ground
 		tx1 = (int)max((float)0,(target-&gt;pos.x - (target-&gt;unitDef-&gt;xsize*0.5f*SQUARE_SIZE))/SQUARE_SIZE);
 		tx2 = min(gs-&gt;mapx,tx1+target-&gt;unitDef-&gt;xsize);
-		tz1 = (int)max((float)0,(target-&gt;pos.z - (target-&gt;unitDef-&gt;ysize*0.5f*SQUARE_SIZE))/SQUARE_SIZE);
-		tz2 = min(gs-&gt;mapy,tz1+target-&gt;unitDef-&gt;ysize);
+		tz1 = (int)max((float)0,(target-&gt;pos.z - (target-&gt;unitDef-&gt;zsize*0.5f*SQUARE_SIZE))/SQUARE_SIZE);
+		tz2 = min(gs-&gt;mapy,tz1+target-&gt;unitDef-&gt;zsize);
 		terraformCenter = target-&gt;pos;
 		terraformRadius = (tx1 - tx2) * SQUARE_SIZE;
 		terraformType=Terraform_Building;
@@ -574,8 +574,8 @@
 	else {
 		tx1 = (int)max((float)0,(b-&gt;pos.x - (b-&gt;unitDef-&gt;xsize*0.5f*SQUARE_SIZE))/SQUARE_SIZE);
 		tx2 = min(gs-&gt;mapx,tx1+b-&gt;unitDef-&gt;xsize);
-		tz1 = (int)max((float)0,(b-&gt;pos.z - (b-&gt;unitDef-&gt;ysize*0.5f*SQUARE_SIZE))/SQUARE_SIZE);
-		tz2 = min(gs-&gt;mapy,tz1+b-&gt;unitDef-&gt;ysize);
+		tz1 = (int)max((float)0,(b-&gt;pos.z - (b-&gt;unitDef-&gt;zsize*0.5f*SQUARE_SIZE))/SQUARE_SIZE);
+		tz2 = min(gs-&gt;mapy,tz1+b-&gt;unitDef-&gt;zsize);
 
 		b-&gt;terraformLeft = CalculateBuildTerraformCost(buildInfo);
 		b-&gt;groundLevelled=false;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001800.html">[Taspring-linux-commit] r7031 - trunk/rts/Rendering/Env
</A></li>
	<LI>Next message: <A HREF="001802.html">[Taspring-linux-commit] r7033 - in trunk: . AI AI/Global/AAI	AI/Global/JCAI AI/Global/KAI-0.2 AI/Global/KAIK-0.13	AI/Global/NTai/AI/NTai/Agents AI/Global/NTai/AI/NTai/Helpers/Terrain	AI/Global/NTai/AI/NTai/Tasks AI/Global/NTai/AI/NTai/Units	AI/Global/RAI rts tools/DedicatedServer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1801">[ date ]</a>
              <a href="thread.html#1801">[ thread ]</a>
              <a href="subject.html#1801">[ subject ]</a>
              <a href="author.html#1801">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
