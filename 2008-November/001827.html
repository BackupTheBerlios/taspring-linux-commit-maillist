<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r7058 - in trunk: rts/ExternalAI rts/Game	rts/Game/Camera rts/Game/StartScripts rts/Game/UI rts/Lua	rts/Map rts/Map/SM3 rts/Map/SMF rts/Rendering	rts/Rendering/Env rts/Rendering/GL rts/Rendering/Textures	rts/Rendering/UnitModels rts/Sim/Features rts/Sim/Misc	rts/Sim/Path rts/Sim/Projectiles rts/Sim/Units rts/System	rts/System/FileSystem rts/System/Platform	rts/System/Platform/Linux rts/System/Platform/Mac	rts/System/Platform/Win tools/DedicatedServer tools/unitsync
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7058%20-%20in%20trunk%3A%20rts/ExternalAI%20rts/Game%0A%09rts/Game/Camera%20rts/Game/StartScripts%20rts/Game/UI%20rts/Lua%0A%09rts/Map%20rts/Map/SM3%20rts/Map/SMF%20rts/Rendering%0A%09rts/Rendering/Env%20rts/Rendering/GL%20rts/Rendering/Textures%0A%09rts/Rendering/UnitModels%20rts/Sim/Features%20rts/Sim/Misc%0A%09rts/Sim/Path%20rts/Sim/Projectiles%20rts/Sim/Units%20rts/System%0A%09rts/System/FileSystem%20rts/System/Platform%0A%09rts/System/Platform/Linux%20rts/System/Platform/Mac%0A%09rts/System/Platform/Win%20tools/DedicatedServer%20tools/unitsync&In-Reply-To=%3C20081117175715.D40614731%40progate.clan-sy.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001826.html">
   <LINK REL="Next"  HREF="001828.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r7058 - in trunk: rts/ExternalAI rts/Game	rts/Game/Camera rts/Game/StartScripts rts/Game/UI rts/Lua	rts/Map rts/Map/SM3 rts/Map/SMF rts/Rendering	rts/Rendering/Env rts/Rendering/GL rts/Rendering/Textures	rts/Rendering/UnitModels rts/Sim/Features rts/Sim/Misc	rts/Sim/Path rts/Sim/Projectiles rts/Sim/Units rts/System	rts/System/FileSystem rts/System/Platform	rts/System/Platform/Linux rts/System/Platform/Mac	rts/System/Platform/Win tools/DedicatedServer tools/unitsync</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7058%20-%20in%20trunk%3A%20rts/ExternalAI%20rts/Game%0A%09rts/Game/Camera%20rts/Game/StartScripts%20rts/Game/UI%20rts/Lua%0A%09rts/Map%20rts/Map/SM3%20rts/Map/SMF%20rts/Rendering%0A%09rts/Rendering/Env%20rts/Rendering/GL%20rts/Rendering/Textures%0A%09rts/Rendering/UnitModels%20rts/Sim/Features%20rts/Sim/Misc%0A%09rts/Sim/Path%20rts/Sim/Projectiles%20rts/Sim/Units%20rts/System%0A%09rts/System/FileSystem%20rts/System/Platform%0A%09rts/System/Platform/Linux%20rts/System/Platform/Mac%0A%09rts/System/Platform/Win%20tools/DedicatedServer%20tools/unitsync&In-Reply-To=%3C20081117175715.D40614731%40progate.clan-sy.com%3E"
       TITLE="[Taspring-linux-commit] r7058 - in trunk: rts/ExternalAI rts/Game	rts/Game/Camera rts/Game/StartScripts rts/Game/UI rts/Lua	rts/Map rts/Map/SM3 rts/Map/SMF rts/Rendering	rts/Rendering/Env rts/Rendering/GL rts/Rendering/Textures	rts/Rendering/UnitModels rts/Sim/Features rts/Sim/Misc	rts/Sim/Path rts/Sim/Projectiles rts/Sim/Units rts/System	rts/System/FileSystem rts/System/Platform	rts/System/Platform/Linux rts/System/Platform/Mac	rts/System/Platform/Win tools/DedicatedServer tools/unitsync">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Mon Nov 17 18:57:14 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001826.html">[Taspring-linux-commit] r7057 - in trunk/rts: System/Platform/Win	lib/luabind/luabind/detail
</A></li>
        <LI>Next message: <A HREF="001828.html">[Taspring-linux-commit] r7059 - in trunk: rts/Game rts/Game/Camera	rts/Map rts/System tools/unitsync
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1827">[ date ]</a>
              <a href="thread.html#1827">[ thread ]</a>
              <a href="subject.html#1827">[ subject ]</a>
              <a href="author.html#1827">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: Auswaschbar
Date: 2008-11-17 18:57:12 +0100 (Mon, 17 Nov 2008)
New Revision: 7058

Added:
   trunk/rts/System/ConfigHandler.cpp
   trunk/rts/System/ConfigHandler.h
Removed:
   trunk/rts/System/Platform/ConfigHandler.cpp
   trunk/rts/System/Platform/ConfigHandler.h
   trunk/rts/System/Platform/Linux/DotfileHandler.cpp
   trunk/rts/System/Platform/Linux/DotfileHandler.h
   trunk/rts/System/Platform/Mac/UserDefsHandler.h
   trunk/rts/System/Platform/Mac/UserDefsHandler.mm
   trunk/rts/System/Platform/Win/RegHandler.cpp
   trunk/rts/System/Platform/Win/RegHandler.h
Modified:
   trunk/rts/ExternalAI/AICallback.cpp
   trunk/rts/ExternalAI/GlobalAIHandler.cpp
   trunk/rts/ExternalAI/GlobalAIHandler.h
   trunk/rts/Game/Camera/CameraController.cpp
   trunk/rts/Game/Camera/FPSController.cpp
   trunk/rts/Game/Camera/FreeController.cpp
   trunk/rts/Game/Camera/OrbitController.cpp
   trunk/rts/Game/Camera/OverheadController.cpp
   trunk/rts/Game/Camera/RotOverheadController.cpp
   trunk/rts/Game/Camera/SmoothController.cpp
   trunk/rts/Game/Camera/TWController.cpp
   trunk/rts/Game/CameraHandler.cpp
   trunk/rts/Game/Game.cpp
   trunk/rts/Game/GameServer.cpp
   trunk/rts/Game/PreGame.cpp
   trunk/rts/Game/SelectMenu.cpp
   trunk/rts/Game/SelectedUnits.cpp
   trunk/rts/Game/StartScripts/AirScript.cpp
   trunk/rts/Game/UI/GameSetupDrawer.cpp
   trunk/rts/Game/UI/GuiHandler.cpp
   trunk/rts/Game/UI/InfoConsole.cpp
   trunk/rts/Game/UI/LuaUI.cpp
   trunk/rts/Game/UI/MiniMap.cpp
   trunk/rts/Game/UI/MouseHandler.cpp
   trunk/rts/Game/UI/TooltipConsole.cpp
   trunk/rts/Lua/LuaOpenGL.cpp
   trunk/rts/Lua/LuaUnsyncedCtrl.cpp
   trunk/rts/Map/BaseGroundDrawer.cpp
   trunk/rts/Map/HeightLinePalette.cpp
   trunk/rts/Map/HeightMapTexture.cpp
   trunk/rts/Map/MetalMap.cpp
   trunk/rts/Map/ReadMap.cpp
   trunk/rts/Map/SM3/Sm3GroundDrawer.cpp
   trunk/rts/Map/SM3/Sm3Map.cpp
   trunk/rts/Map/SMF/BFGroundDrawer.cpp
   trunk/rts/Map/SMF/SmfReadMap.cpp
   trunk/rts/Rendering/Env/AdvSky.cpp
   trunk/rts/Rendering/Env/BaseSky.cpp
   trunk/rts/Rendering/Env/BaseTreeDrawer.cpp
   trunk/rts/Rendering/Env/BaseWater.cpp
   trunk/rts/Rendering/Env/BasicSky.cpp
   trunk/rts/Rendering/Env/BumpWater.cpp
   trunk/rts/Rendering/Env/GrassDrawer.cpp
   trunk/rts/Rendering/GL/glList.cpp
   trunk/rts/Rendering/GL/myGL.cpp
   trunk/rts/Rendering/GroundDecalHandler.cpp
   trunk/rts/Rendering/ShadowHandler.cpp
   trunk/rts/Rendering/Textures/TextureHandler.cpp
   trunk/rts/Rendering/UnitModels/UnitDrawer.cpp
   trunk/rts/Rendering/VerticalSync.cpp
   trunk/rts/Sim/Features/FeatureHandler.cpp
   trunk/rts/Sim/Misc/ModInfo.cpp
   trunk/rts/Sim/Path/PathEstimator.cpp
   trunk/rts/Sim/Projectiles/ExplosionGenerator.cpp
   trunk/rts/Sim/Projectiles/ProjectileHandler.cpp
   trunk/rts/Sim/Units/UnitDefHandler.cpp
   trunk/rts/Sim/Units/UnitHandler.cpp
   trunk/rts/Sim/Units/UnitTracker.cpp
   trunk/rts/System/FileSystem/DataDirLocater.cpp
   trunk/rts/System/FileSystem/FileSystem.cpp
   trunk/rts/System/LogOutput.cpp
   trunk/rts/System/NetProtocol.cpp
   trunk/rts/System/Platform/Linux/OpenALSound.cpp
   trunk/rts/System/Platform/Win/DxSound.cpp
   trunk/rts/System/Sound.cpp
   trunk/rts/System/SpringApp.cpp
   trunk/tools/DedicatedServer/CMakeLists.txt
   trunk/tools/DedicatedServer/main.cpp
   trunk/tools/unitsync/CMakeLists.txt
   trunk/tools/unitsync/javabind.cpp
   trunk/tools/unitsync/unitsync.cpp
Log:
* in win32, settings are now stored in \Users\user name\AppData\Local\springsettings.cfg instead of the registry


Modified: trunk/rts/ExternalAI/AICallback.cpp
===================================================================
--- trunk/rts/ExternalAI/AICallback.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/ExternalAI/AICallback.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -17,7 +17,7 @@
 #include &quot;Map/MetalMap.h&quot;
 #include &quot;Map/ReadMap.h&quot;
 #include &quot;NetProtocol.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Platform/errorhandler.h&quot;
 #include &quot;FileSystem/FileSystem.h&quot;
 #include &quot;Rendering/InMapDraw.h&quot;

Modified: trunk/rts/ExternalAI/GlobalAIHandler.cpp
===================================================================
--- trunk/rts/ExternalAI/GlobalAIHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/ExternalAI/GlobalAIHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -28,7 +28,7 @@
 	static bool init=false;
 	static bool Catch;
 	if (!init) {
-		Catch=configHandler.GetInt (&quot;CatchAIExceptions&quot;, 1)!=0;
+		Catch=configHandler.Get (&quot;CatchAIExceptions&quot;, 1)!=0;
 		init=true;
 	}
 	return Catch;

Modified: trunk/rts/ExternalAI/GlobalAIHandler.h
===================================================================
--- trunk/rts/ExternalAI/GlobalAIHandler.h	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/ExternalAI/GlobalAIHandler.h	2008-11-17 17:57:12 UTC (rev 7058)
@@ -2,7 +2,7 @@
 #define GLOBALAIHANDLER_H
 
 #include &quot;Object.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;float3.h&quot;
 #include &quot;Sim/Misc/GlobalConstants.h&quot;
 #include &lt;map&gt;

Modified: trunk/rts/Game/Camera/CameraController.cpp
===================================================================
--- trunk/rts/Game/Camera/CameraController.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/Camera/CameraController.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -3,7 +3,7 @@
 
 #include &quot;CameraController.h&quot;
 
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 
 
 CCameraController::CCameraController() : pos(2000, 70, 1800)

Modified: trunk/rts/Game/Camera/FPSController.cpp
===================================================================
--- trunk/rts/Game/Camera/FPSController.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/Camera/FPSController.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -3,7 +3,7 @@
 
 #include &quot;FPSController.h&quot;
 
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;Map/Ground.h&quot;
@@ -15,8 +15,8 @@
 CFPSController::CFPSController()
 	: oldHeight(300)
 {
-	scrollSpeed = configHandler.GetInt(&quot;FPSScrollSpeed&quot;, 10) * 0.1f;
-	enabled = !!configHandler.GetInt(&quot;FPSEnabled&quot;, 1);
+	scrollSpeed = configHandler.Get(&quot;FPSScrollSpeed&quot;, 10) * 0.1f;
+	enabled = !!configHandler.Get(&quot;FPSEnabled&quot;, 1);
 	fov = configHandler.GetFloat(&quot;FPSFOV&quot;, 45.0f);
 }
 

Modified: trunk/rts/Game/Camera/FreeController.cpp
===================================================================
--- trunk/rts/Game/Camera/FreeController.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/Camera/FreeController.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -6,7 +6,7 @@
 
 #include &quot;FreeController.h&quot;
 
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;Map/Ground.h&quot;
@@ -44,9 +44,9 @@
 	}
 	pos -= (dir * 1000.0f);
 
-	enabled     = !!configHandler.GetInt(&quot;CamFreeEnabled&quot;,   0);
-	invertAlt   = !!configHandler.GetInt(&quot;CamFreeInvertAlt&quot;, 0);
-	goForward   = !!configHandler.GetInt(&quot;CamFreeGoForward&quot;, 0);
+	enabled     = !!configHandler.Get(&quot;CamFreeEnabled&quot;,   0);
+	invertAlt   = !!configHandler.Get(&quot;CamFreeInvertAlt&quot;, 0);
+	goForward   = !!configHandler.Get(&quot;CamFreeGoForward&quot;, 0);
 	fov         = configHandler.GetFloat(&quot;CamFreeFOV&quot;,           45.0f);
 	scrollSpeed = configHandler.GetFloat(&quot;CamFreeScrollSpeed&quot;,  500.0f);
 	gravity     = configHandler.GetFloat(&quot;CamFreeGravity&quot;,     -500.0f);

Modified: trunk/rts/Game/Camera/OrbitController.cpp
===================================================================
--- trunk/rts/Game/Camera/OrbitController.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/Camera/OrbitController.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -8,7 +8,7 @@
 #include &quot;Game/UI/MouseHandler.h&quot;
 #include &quot;Map/Ground.h&quot;
 #include &quot;LogOutput.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 
 extern Uint8* keys;
 
@@ -25,7 +25,7 @@
 	rotation(0.0f), cRotation(0.0f),
 	elevation(0.0f), cElevation(0.0f)
 {
-	enabled = !!configHandler.GetInt(&quot;OrbitControllerEnabled&quot;, 1);
+	enabled = !!configHandler.Get(&quot;OrbitControllerEnabled&quot;, 1);
 
 	orbitSpeedFact = configHandler.GetFloat(&quot;OrbitControllerOrbitSpeed&quot;, 0.25f);
 	panSpeedFact   = configHandler.GetFloat(&quot;OrbitControllerPanSpeed&quot;,   2.00f);

Modified: trunk/rts/Game/Camera/OverheadController.cpp
===================================================================
--- trunk/rts/Game/Camera/OverheadController.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/Camera/OverheadController.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -6,7 +6,7 @@
 
 #include &quot;OverheadController.h&quot;
 
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
 #include &quot;Game/CameraHandler.h&quot;
 #include &quot;Game/UI/MouseHandler.h&quot;
@@ -25,9 +25,9 @@
 	changeAltHeight(true),
 	flipped(false)
 {
-	scrollSpeed = configHandler.GetInt(&quot;OverheadScrollSpeed&quot;,10)*0.1f;
+	scrollSpeed = configHandler.Get(&quot;OverheadScrollSpeed&quot;,10)*0.1f;
 	tiltSpeed = configHandler.GetFloat(&quot;OverheadTiltSpeed&quot;,1.0f);
-	enabled = !!configHandler.GetInt(&quot;OverheadEnabled&quot;,1);
+	enabled = !!configHandler.Get(&quot;OverheadEnabled&quot;,1);
 	fov = configHandler.GetFloat(&quot;OverheadFOV&quot;, 45.0f);
 }
 

Modified: trunk/rts/Game/Camera/RotOverheadController.cpp
===================================================================
--- trunk/rts/Game/Camera/RotOverheadController.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/Camera/RotOverheadController.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -3,7 +3,7 @@
 
 #include &quot;RotOverheadController.h&quot;
 
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;Map/Ground.h&quot;
@@ -13,8 +13,8 @@
 	: oldHeight(500)
 {
 	mouseScale = configHandler.GetFloat(&quot;RotOverheadMouseScale&quot;, 0.01f);
-	scrollSpeed = configHandler.GetInt(&quot;RotOverheadScrollSpeed&quot;,10)*0.1f;
-	enabled=!!configHandler.GetInt(&quot;RotOverheadEnabled&quot;,1);
+	scrollSpeed = configHandler.Get(&quot;RotOverheadScrollSpeed&quot;,10)*0.1f;
+	enabled=!!configHandler.Get(&quot;RotOverheadEnabled&quot;,1);
 	fov = configHandler.GetFloat(&quot;RotOverheadFOV&quot;, 45.0f);
 }
 

Modified: trunk/rts/Game/Camera/SmoothController.cpp
===================================================================
--- trunk/rts/Game/Camera/SmoothController.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/Camera/SmoothController.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -8,7 +8,7 @@
 
 #include &quot;SmoothController.h&quot;
 
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
 #include &quot;Game/CameraHandler.h&quot;
 #include &quot;Game/UI/MouseHandler.h&quot;
@@ -29,9 +29,9 @@
 	maxHeight(10000),
 	speedFactor(1)
 {
-	scrollSpeed = configHandler.GetInt(&quot;SmoothScrollSpeed&quot;,10)*0.1f;
+	scrollSpeed = configHandler.Get(&quot;SmoothScrollSpeed&quot;,10)*0.1f;
 	tiltSpeed = configHandler.GetFloat(&quot;SmoothTiltSpeed&quot;,1.0f);
-	enabled = !!configHandler.GetInt(&quot;SmoothEnabled&quot;,1);
+	enabled = !!configHandler.Get(&quot;SmoothEnabled&quot;,1);
 	fov = configHandler.GetFloat(&quot;SmoothFOV&quot;, 45.0f);
 	lastSource = Noone;
 }

Modified: trunk/rts/Game/Camera/TWController.cpp
===================================================================
--- trunk/rts/Game/Camera/TWController.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/Camera/TWController.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -7,7 +7,7 @@
 
 #include &quot;TWController.h&quot;
 
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;Map/Ground.h&quot;
@@ -19,8 +19,8 @@
 
 CTWController::CTWController()
 {
-	scrollSpeed = configHandler.GetInt(&quot;TWScrollSpeed&quot;,10) * 0.1f;
-	enabled = !!configHandler.GetInt(&quot;TWEnabled&quot;,1);
+	scrollSpeed = configHandler.Get(&quot;TWScrollSpeed&quot;,10) * 0.1f;
+	enabled = !!configHandler.Get(&quot;TWEnabled&quot;,1);
 	fov = configHandler.GetFloat(&quot;TWFOV&quot;, 45.0f);
 }
 

Modified: trunk/rts/Game/CameraHandler.cpp
===================================================================
--- trunk/rts/Game/CameraHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/CameraHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -16,7 +16,7 @@
 #include &quot;Camera/OverviewController.h&quot;
 #include &quot;Camera/TWController.h&quot;
 #include &quot;Camera/OrbitController.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;GlobalUnsynced.h&quot;
 
@@ -49,7 +49,7 @@
 	if (!modeName.empty()) {
 		modeIndex = GetModeIndex(modeName);
 	} else {
-		modeIndex = configHandler.GetInt(&quot;CamMode&quot;, 1);
+		modeIndex = configHandler.Get(&quot;CamMode&quot;, 1);
 	}
 	const unsigned int mode =
 		(unsigned int)std::max(0, std::min(modeIndex, (int)camCtrls.size() - 1));

Modified: trunk/rts/Game/Game.cpp
===================================================================
--- trunk/rts/Game/Game.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/Game.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -67,7 +67,7 @@
 #include &quot;Map/ReadMap.h&quot;
 #include &quot;NetProtocol.h&quot;
 #include &quot;DemoRecorder.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;FileSystem/FileSystem.h&quot;
 #include &quot;Rendering/Env/BaseSky.h&quot;
 #include &quot;Rendering/Env/BaseTreeDrawer.h&quot;
@@ -264,16 +264,16 @@
 	drawMapMarks = true;
 	hideInterface = false;
 
-	windowedEdgeMove   = !!configHandler.GetInt(&quot;WindowedEdgeMove&quot;,   1);
-	fullscreenEdgeMove = !!configHandler.GetInt(&quot;FullscreenEdgeMove&quot;, 1);
+	windowedEdgeMove   = !!configHandler.Get(&quot;WindowedEdgeMove&quot;,   1);
+	fullscreenEdgeMove = !!configHandler.Get(&quot;FullscreenEdgeMove&quot;, 1);
 
-	showFPS   = !!configHandler.GetInt(&quot;ShowFPS&quot;,   0);
-	showClock = !!configHandler.GetInt(&quot;ShowClock&quot;, 1);
+	showFPS   = !!configHandler.Get(&quot;ShowFPS&quot;,   0);
+	showClock = !!configHandler.Get(&quot;ShowClock&quot;, 1);
 
 	crossSize = configHandler.GetFloat(&quot;CrossSize&quot;, 10.0f);
 
 	playerRoster.SetSortTypeByCode(
-	  (PlayerRoster::SortType)configHandler.GetInt(&quot;ShowPlayerInfo&quot;, 1));
+	  (PlayerRoster::SortType)configHandler.Get(&quot;ShowPlayerInfo&quot;, 1));
 
 	const string inputTextGeo = configHandler.GetString(&quot;InputTextGeo&quot;, &quot;&quot;);
 	ParseInputTextGeometry(&quot;default&quot;);
@@ -286,7 +286,7 @@
 	writingPos = 0;
 	userPrompt = &quot;&quot;;
 
-	CLuaHandle::SetModUICtrl(!!configHandler.GetInt(&quot;LuaModUICtrl&quot;, 1));
+	CLuaHandle::SetModUICtrl(!!configHandler.Get(&quot;LuaModUICtrl&quot;, 1));
 
 	consoleHistory = SAFE_NEW CConsoleHistory;
 	wordCompletion = SAFE_NEW CWordCompletion;
@@ -302,13 +302,13 @@
 
 	ENTER_UNSYNCED;
 	sound = CSound::GetSoundSystem();
-	gameSoundVolume = configHandler.GetInt(&quot;SoundVolume&quot;, 60) * 0.01f;
-	unitReplyVolume = configHandler.GetInt(&quot;UnitReplyVolume&quot;, configHandler.GetInt(&quot;UnitReplySoundVolume&quot;, 80) ) * 0.01f;
+	gameSoundVolume = configHandler.Get(&quot;SoundVolume&quot;, 60) * 0.01f;
+	unitReplyVolume = configHandler.Get(&quot;UnitReplyVolume&quot;, configHandler.Get(&quot;UnitReplySoundVolume&quot;, 80) ) * 0.01f;
 	soundEnabled = true;
 	sound-&gt;SetVolume(gameSoundVolume);
 	sound-&gt;SetUnitReplyVolume(unitReplyVolume);
 
-	moveWarnings = !!configHandler.GetInt(&quot;MoveWarnings&quot;, 1);
+	moveWarnings = !!configHandler.Get(&quot;MoveWarnings&quot;, 1);
 
 	camera = SAFE_NEW CCamera();
 	cam2 = SAFE_NEW CCamera();
@@ -456,7 +456,7 @@
 		PrintLoadMsg(&quot;Loading LuaGaia&quot;);
 		CLuaGaia::LoadHandler();
 	}
-	if (!!configHandler.GetInt(&quot;LuaUI&quot;, 1)) {
+	if (!!configHandler.Get(&quot;LuaUI&quot;, 1)) {
 		PrintLoadMsg(&quot;Loading LuaUI&quot;);
 		CLuaUI::LoadHandler();
 	}
@@ -530,7 +530,7 @@
 CGame::~CGame()
 {
 	if (treeDrawer) {
-		configHandler.SetInt(&quot;TreeRadius&quot;,
+		configHandler.Set(&quot;TreeRadius&quot;,
 		                     (unsigned int)(treeDrawer-&gt;baseTreeDistance * 256));
 	}
 
@@ -908,7 +908,7 @@
 		selectedUnits.ClearSelected();
 	}
 	else if (cmd == &quot;shadows&quot;) {
-		const int current = configHandler.GetInt(&quot;Shadows&quot;, 0);
+		const int current = configHandler.Get(&quot;Shadows&quot;, 0);
 		if (current &lt; 0) {
 			logOutput.Print(&quot;Shadows have been disabled with %i&quot;, current);
 			logOutput.Print(&quot;Change your configuration and restart to use them&quot;);
@@ -926,12 +926,12 @@
 			const char* args = action.extra.c_str();
 			const int argcount = sscanf(args, &quot;%i %i&quot;, &amp;next, &amp;mapsize);
 			if (argcount &gt; 1) {
-				configHandler.SetInt(&quot;ShadowMapSize&quot;, mapsize);
+				configHandler.Set(&quot;ShadowMapSize&quot;, mapsize);
 			}
 		} else {
 			next = (current == 0) ? 1 : 0;
 		}
-		configHandler.SetInt(&quot;Shadows&quot;, next);
+		configHandler.Set(&quot;Shadows&quot;, next);
 		logOutput.Print(&quot;Set Shadows to %i&quot;, next);
 		shadowHandler = SAFE_NEW CShadowHandler();
 	}
@@ -942,10 +942,10 @@
 		if (!action.extra.empty()) {
 			next = std::max(0, atoi(action.extra.c_str()) % 5);
 		} else {
-			const int current = configHandler.GetInt(&quot;ReflectiveWater&quot;, 1);
+			const int current = configHandler.Get(&quot;ReflectiveWater&quot;, 1);
 			next = (std::max(0, current) + 1) % 5;
 		}
-		configHandler.SetInt(&quot;ReflectiveWater&quot;, next);
+		configHandler.Set(&quot;ReflectiveWater&quot;, next);
 		logOutput.Print(&quot;Set water rendering mode to %i (%s)&quot;, next, rmodes[next]);
 		water = CBaseWater::GetWater(water);
 	}
@@ -989,7 +989,7 @@
 		const std::string::size_type pos = action.extra.find_first_of(&quot; &quot;);
 		if (pos != std::string::npos) {
 			const std::string varName = action.extra.substr(0, pos);
-			configHandler.SetInt(varName, atoi(action.extra.substr(pos+1).c_str()));
+			configHandler.Set(varName, atoi(action.extra.substr(pos+1).c_str()));
 		}
 	}
 	else if (cmd == &quot;sets&quot;) {
@@ -1233,7 +1233,7 @@
 		if (endPtr != startPtr) {
 			gameSoundVolume = std::max(0.0f, std::min(1.0f, volume));
 			sound-&gt;SetVolume(gameSoundVolume);
-			configHandler.SetInt(&quot;SoundVolume&quot;, (int)(gameSoundVolume * 100.0f));
+			configHandler.Set(&quot;SoundVolume&quot;, (int)(gameSoundVolume * 100.0f));
 		}
 	}
 	else if (cmd == &quot;unitreplyvolume&quot;) {
@@ -1243,7 +1243,7 @@
 		if (endPtr != startPtr) {
 			unitReplyVolume = std::max(0.0f, std::min(1.0f, volume));
 			sound-&gt;SetUnitReplyVolume(unitReplyVolume);
-			configHandler.SetInt(&quot;UnitReplyVolume&quot;,(int)(unitReplyVolume * 100.0f));
+			configHandler.Set(&quot;UnitReplyVolume&quot;,(int)(unitReplyVolume * 100.0f));
 		}
 	}
 	else if (cmd == &quot;savegame&quot;){
@@ -1403,7 +1403,7 @@
 			mouse-&gt;hardwareCursor = !!atoi(action.extra.c_str());
 		}
 		mouse-&gt;UpdateHwCursor();
-		configHandler.SetInt(&quot;HardwareCursor&quot;, (int)mouse-&gt;hardwareCursor);
+		configHandler.Set(&quot;HardwareCursor&quot;, (int)mouse-&gt;hardwareCursor);
 	}
 	else if (cmd == &quot;increaseviewradius&quot;) {
 		gd-&gt;IncreaseDetail();
@@ -1618,7 +1618,7 @@
 		} else {
 			showClock = !!atoi(action.extra.c_str());
 		}
-		configHandler.SetInt(&quot;ShowClock&quot;, showClock ? 1 : 0);
+		configHandler.Set(&quot;ShowClock&quot;, showClock ? 1 : 0);
 	}
 	else if (cmd == &quot;cross&quot;) {
 		if (action.extra.empty()) {
@@ -1638,7 +1638,7 @@
 		} else {
 			showFPS = !!atoi(action.extra.c_str());
 		}
-		configHandler.SetInt(&quot;ShowFPS&quot;, showFPS ? 1 : 0);
+		configHandler.Set(&quot;ShowFPS&quot;, showFPS ? 1 : 0);
 	}
 	else if (cmd == &quot;info&quot;) {
 		if (action.extra.empty()) {
@@ -1653,7 +1653,7 @@
 		if (playerRoster.GetSortType() != PlayerRoster::Disabled) {
 			logOutput.Print(&quot;Sorting roster by %s&quot;, playerRoster.GetSortName());
 		}
-		configHandler.SetInt(&quot;ShowPlayerInfo&quot;, (int)playerRoster.GetSortType());
+		configHandler.Set(&quot;ShowPlayerInfo&quot;, (int)playerRoster.GetSortType());
 	}
 	else if (cmd == &quot;techlevels&quot;) {
 		unitDefHandler-&gt;SaveTechLevels(&quot;&quot;, modInfo.filename); // stdout
@@ -1772,7 +1772,7 @@
 		} else {
 			moveWarnings = !!atoi(action.extra.c_str());
 		}
-		configHandler.SetInt(&quot;MoveWarnings&quot;, moveWarnings ? 1 : 0);
+		configHandler.Set(&quot;MoveWarnings&quot;, moveWarnings ? 1 : 0);
 		logOutput.Print(string(&quot;movewarnings &quot;) +
 		                (moveWarnings ? &quot;enabled&quot; : &quot;disabled&quot;));
 	}
@@ -1805,7 +1805,7 @@
 			modUICtrl = !!atoi(action.extra.c_str());
 		}
 		CLuaHandle::SetModUICtrl(modUICtrl);
-		configHandler.SetInt(&quot;LuaModUICtrl&quot;, modUICtrl ? 1 : 0);
+		configHandler.Set(&quot;LuaModUICtrl&quot;, modUICtrl ? 1 : 0);
 	}
 	else if (cmd == &quot;minimap&quot;) {
 		if (minimap != NULL) {
@@ -1867,7 +1867,7 @@
 		if (!action.extra.empty()) {
 			const int iconDist = atoi(action.extra.c_str());
 			unitDrawer-&gt;SetUnitIconDist((float)iconDist);
-			configHandler.SetInt(&quot;UnitIconDist&quot;, iconDist);
+			configHandler.Set(&quot;UnitIconDist&quot;, iconDist);
 			logOutput.Print(&quot;Set UnitIconDist to %i&quot;, iconDist);
 		}
 	}
@@ -1875,7 +1875,7 @@
 		if (!action.extra.empty()) {
 			const int drawDist = atoi(action.extra.c_str());
 			unitDrawer-&gt;SetUnitDrawDist((float)drawDist);
-			configHandler.SetInt(&quot;UnitLodDist&quot;, drawDist);
+			configHandler.Set(&quot;UnitLodDist&quot;, drawDist);
 			logOutput.Print(&quot;Set UnitLodDist to %i&quot;, drawDist);
 		}
 	}

Modified: trunk/rts/Game/GameServer.cpp
===================================================================
--- trunk/rts/Game/GameServer.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/GameServer.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -41,7 +41,7 @@
 #include &quot;AutohostInterface.h&quot;
 #include &quot;Util.h&quot;
 #include &quot;GlobalUnsynced.h&quot; // for syncdebug
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;FileSystem/CRC.h&quot;
 #include &quot;Player.h&quot;
 #include &quot;Sim/Misc/GlobalSynced.h&quot;

Modified: trunk/rts/Game/PreGame.cpp
===================================================================
--- trunk/rts/Game/PreGame.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/PreGame.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -31,7 +31,7 @@
 #include &quot;Lua/LuaRules.h&quot;
 #include &quot;Lua/LuaParser.h&quot;
 #include &quot;Map/MapParser.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;FileSystem/FileSystem.h&quot;
 #include &quot;Rendering/glFont.h&quot;
 #include &quot;Rendering/Textures/TAPalette.h&quot;

Modified: trunk/rts/Game/SelectMenu.cpp
===================================================================
--- trunk/rts/Game/SelectMenu.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/SelectMenu.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -19,7 +19,7 @@
 #include &quot;FileSystem/FileHandler.h&quot;
 #include &quot;FileSystem/VFSHandler.h&quot;
 #include &quot;FileSystem/FileSystem.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;StartScripts/ScriptHandler.h&quot;
 
 using std::string;
@@ -38,7 +38,7 @@
 	game-&gt;AddPair(&quot;IsHost&quot;, 1);
 	game-&gt;add_name_value(&quot;MyPlayerName&quot;, playername);
 	
-	game-&gt;AddPair(&quot;NoHelperAIs&quot;, configHandler.GetInt(&quot;NoHelperAIs&quot;, 0));
+	game-&gt;AddPair(&quot;NoHelperAIs&quot;, configHandler.Get(&quot;NoHelperAIs&quot;, 0));
 	
 	TdfParser::TdfSection* player0 = game-&gt;construct_subsection(&quot;PLAYER0&quot;);
 	player0-&gt;add_name_value(&quot;Name&quot;, playername);

Modified: trunk/rts/Game/SelectedUnits.cpp
===================================================================
--- trunk/rts/Game/SelectedUnits.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/SelectedUnits.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -34,7 +34,7 @@
 #include &quot;Sim/Units/CommandAI/LineDrawer.h&quot;
 #include &quot;Sim/Units/UnitTypes/TransportUnit.h&quot;
 #include &quot;EventHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;PlayerHandler.h&quot;
 #include &quot;Camera.h&quot;
 #include &quot;Sound.h&quot;
@@ -65,7 +65,7 @@
 
 void CSelectedUnits::Init()
 {
-	buildIconsFirst = !!configHandler.GetInt(&quot;BuildIconsFirst&quot;, 0);
+	buildIconsFirst = !!configHandler.Get(&quot;BuildIconsFirst&quot;, 0);
 }
 
 

Modified: trunk/rts/Game/StartScripts/AirScript.cpp
===================================================================
--- trunk/rts/Game/StartScripts/AirScript.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/StartScripts/AirScript.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -10,7 +10,7 @@
 #include &quot;Sim/Units/UnitDefHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
 #include &quot;Sim/MoveTypes/AirMoveType.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;Map/Ground.h&quot;
 #include &quot;GlobalUnsynced.h&quot;
@@ -53,7 +53,7 @@
 
 void CAirScript::GameStart()
 {
-	doRoll=!configHandler.GetInt(&quot;ReflectiveWater&quot;,1);
+	doRoll=!configHandler.Get(&quot;ReflectiveWater&quot;,1);
 
 	ENTER_MIXED;
 	tcp=camera-&gt;pos;

Modified: trunk/rts/Game/UI/GameSetupDrawer.cpp
===================================================================
--- trunk/rts/Game/UI/GameSetupDrawer.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/UI/GameSetupDrawer.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -11,7 +11,7 @@
 #include &quot;GameSetupDrawer.h&quot;
 
 #include &quot;NetProtocol.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Game/CameraHandler.h&quot;
 #include &quot;Game/PlayerHandler.h&quot;
 #include &quot;Game/GameSetup.h&quot;
@@ -54,7 +54,7 @@
 		if (!modeName.empty()) {
 			camHandler-&gt;SetCameraMode(modeName);
 		} else {
-			const int modeIndex = configHandler.GetInt(&quot;CamMode&quot;, 1);
+			const int modeIndex = configHandler.Get(&quot;CamMode&quot;, 1);
 			camHandler-&gt;SetCameraMode(modeIndex);
 		}
 	}

Modified: trunk/rts/Game/UI/GuiHandler.cpp
===================================================================
--- trunk/rts/Game/UI/GuiHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/UI/GuiHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -53,7 +53,7 @@
 #include &quot;EventHandler.h&quot;
 #include &quot;FileSystem/SimpleParser.h&quot;
 #include &quot;LogOutput.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Util.h&quot;
 #include &quot;myMath.h&quot;
 
@@ -89,13 +89,13 @@
 
 	LoadConfig(&quot;ctrlpanel.txt&quot;);
 
-	miniMapMarker = !!configHandler.GetInt(&quot;MiniMapMarker&quot;, 1);
-	invertQueueKey = !!configHandler.GetInt(&quot;InvertQueueKey&quot;, 0);
+	miniMapMarker = !!configHandler.Get(&quot;MiniMapMarker&quot;, 1);
+	invertQueueKey = !!configHandler.Get(&quot;InvertQueueKey&quot;, 0);
 
 	autoShowMetal = mapInfo-&gt;gui.autoShowMetal;
 
 	useStencil = false;
-	if (GLEW_NV_depth_clamp &amp;&amp; !!configHandler.GetInt(&quot;StencilBufferBits&quot;, 1)) {
+	if (GLEW_NV_depth_clamp &amp;&amp; !!configHandler.Get(&quot;StencilBufferBits&quot;, 1)) {
 		GLint stencilBits;
 		glGetIntegerv(GL_STENCIL_BITS, &amp;stencilBits);
 		useStencil = (stencilBits &gt;= 1);
@@ -1642,7 +1642,7 @@
 			invertQueueKey = !!atoi(action.extra.c_str());
 		}
 		needShift = false;
-		configHandler.SetInt(&quot;InvertQueueKey&quot;, invertQueueKey ? 1 : 0);
+		configHandler.Set(&quot;InvertQueueKey&quot;, invertQueueKey ? 1 : 0);
 		return true;
 	}
 

Modified: trunk/rts/Game/UI/InfoConsole.cpp
===================================================================
--- trunk/rts/Game/UI/InfoConsole.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/UI/InfoConsole.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -16,7 +16,7 @@
 #endif
 
 #include &quot;Sync/SyncTracer.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;InputReceiver.h&quot;
 
 
@@ -34,8 +34,8 @@
 	data.clear();
 
 	lastTime=0;
-	lifetime     = configHandler.GetInt(&quot;InfoMessageTime&quot;, 400);
-	verboseLevel = configHandler.GetInt(&quot;VerboseLevel&quot;, 0);
+	lifetime     = configHandler.Get(&quot;InfoMessageTime&quot;, 400);
+	verboseLevel = configHandler.Get(&quot;VerboseLevel&quot;, 0);
 
 	const std::string geo = configHandler.GetString(&quot;InfoConsoleGeometry&quot;,
                                                   &quot;0.26 0.96 0.41 0.205&quot;);

Modified: trunk/rts/Game/UI/LuaUI.cpp
===================================================================
--- trunk/rts/Game/UI/LuaUI.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/UI/LuaUI.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -72,7 +72,7 @@
 #include &quot;SpringApp.h&quot;
 #include &quot;FileSystem/FileHandler.h&quot;
 #include &quot;FileSystem/VFSHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;FileSystem/FileSystem.h&quot;
 #include &quot;Util.h&quot;
 

Modified: trunk/rts/Game/UI/MiniMap.cpp
===================================================================
--- trunk/rts/Game/UI/MiniMap.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/UI/MiniMap.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -28,7 +28,7 @@
 #include &quot;Map/ReadMap.h&quot;
 #include &quot;MiniMap.h&quot;
 #include &quot;MouseHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Rendering/GL/glExtra.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;Rendering/GL/VertexArray.h&quot;
@@ -100,9 +100,9 @@
 		ParseGeometry(geo);
 	}
 
-	fullProxy = !!configHandler.GetInt(&quot;MiniMapFullProxy&quot;, 1);
+	fullProxy = !!configHandler.Get(&quot;MiniMapFullProxy&quot;, 1);
 
-	buttonSize = configHandler.GetInt(&quot;MiniMapButtonSize&quot;, 16);
+	buttonSize = configHandler.Get(&quot;MiniMapButtonSize&quot;, 16);
 
 	unitBaseSize =
 		atof(configHandler.GetString(&quot;MiniMapUnitSize&quot;, &quot;2.5&quot;).c_str());
@@ -114,13 +114,13 @@
 	cursorScale =
 		atof(configHandler.GetString(&quot;MiniMapCursorScale&quot;, &quot;-0.5&quot;).c_str());
 
-	useIcons = !!configHandler.GetInt(&quot;MiniMapIcons&quot;, 1);
+	useIcons = !!configHandler.Get(&quot;MiniMapIcons&quot;, 1);
 
-	drawCommands = std::max(0, configHandler.GetInt(&quot;MiniMapDrawCommands&quot;, 1));
+	drawCommands = std::max(0, configHandler.Get(&quot;MiniMapDrawCommands&quot;, 1));
 
-	drawProjectiles = !!configHandler.GetInt(&quot;MiniMapDrawProjectiles&quot;, 1);
+	drawProjectiles = !!configHandler.Get(&quot;MiniMapDrawProjectiles&quot;, 1);
 
-	simpleColors = !!configHandler.GetInt(&quot;SimpleMiniMapColors&quot;, 0);
+	simpleColors = !!configHandler.Get(&quot;SimpleMiniMapColors&quot;, 0);
 
 	myColor[0]    = (unsigned char)(0.2f * 255);
 	myColor[1]    = (unsigned char)(0.9f * 255);

Modified: trunk/rts/Game/UI/MouseHandler.cpp
===================================================================
--- trunk/rts/Game/UI/MouseHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/UI/MouseHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -24,7 +24,7 @@
 #include &quot;Map/Ground.h&quot;
 #include &quot;Map/MapDamage.h&quot;
 #include &quot;Lua/LuaInputReceiver.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Platform/errorhandler.h&quot;
 #include &quot;Rendering/glFont.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
@@ -84,17 +84,17 @@
 	SDL_ShowCursor(SDL_DISABLE);
 
 #ifndef __APPLE__
-	hardwareCursor = !!configHandler.GetInt(&quot;HardwareCursor&quot;, 0);
+	hardwareCursor = !!configHandler.Get(&quot;HardwareCursor&quot;, 0);
 #else
 	hardwareCursor = false;
 #endif
 
 	soundMultiselID = sound-&gt;GetWaveId(&quot;sounds/button9.wav&quot;);
 
-	invertMouse = !!configHandler.GetInt(&quot;InvertMouse&quot;,1);
-	doubleClickTime = (float)configHandler.GetInt(&quot;DoubleClickTime&quot;, 200) / 1000.0f;
+	invertMouse = !!configHandler.Get(&quot;InvertMouse&quot;,1);
+	doubleClickTime = (float)configHandler.Get(&quot;DoubleClickTime&quot;, 200) / 1000.0f;
 
-	scrollWheelSpeed = (float)configHandler.GetInt(&quot;ScrollWheelSpeed&quot;, 25);
+	scrollWheelSpeed = (float)configHandler.Get(&quot;ScrollWheelSpeed&quot;, 25);
 	scrollWheelSpeed = std::max(-255.0f, std::min(255.0f, scrollWheelSpeed));
 }
 

Modified: trunk/rts/Game/UI/TooltipConsole.cpp
===================================================================
--- trunk/rts/Game/UI/TooltipConsole.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Game/UI/TooltipConsole.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -19,7 +19,7 @@
 #include &quot;Sim/Units/Unit.h&quot;
 #include &quot;Sim/Units/UnitHandler.h&quot;
 #include &quot;EventHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Util.h&quot;
 
 CTooltipConsole* tooltip = 0;
@@ -37,7 +37,7 @@
 		h = 0.10f;
 	}
 
-	outFont = !!configHandler.GetInt(&quot;TooltipOutlineFont&quot;, 0);
+	outFont = !!configHandler.Get(&quot;TooltipOutlineFont&quot;, 0);
 }
 
 

Modified: trunk/rts/Lua/LuaOpenGL.cpp
===================================================================
--- trunk/rts/Lua/LuaOpenGL.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Lua/LuaOpenGL.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -63,7 +63,7 @@
 #include &quot;Sim/Units/CommandAI/LineDrawer.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;Matrix44f.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 
 using std::max;
 using std::string;
@@ -114,7 +114,7 @@
 
 	haveGL20 = !!GLEW_VERSION_2_0;
 
-	if (haveGL20 &amp;&amp; !!configHandler.GetInt(&quot;LuaShaders&quot;, 1)) {
+	if (haveGL20 &amp;&amp; !!configHandler.Get(&quot;LuaShaders&quot;, 1)) {
 		canUseShaders = true;
 	}
 }

Modified: trunk/rts/Lua/LuaUnsyncedCtrl.cpp
===================================================================
--- trunk/rts/Lua/LuaUnsyncedCtrl.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Lua/LuaUnsyncedCtrl.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -1369,7 +1369,7 @@
 	}
 	const string name = luaL_checkstring(L, 1);
 	const int def     = luaL_optint(L, 2, 0);
-	const int value = configHandler.GetInt(name, def);
+	const int value = configHandler.Get(name, def);
 	lua_pushnumber(L, value);
 	return 1;
 }
@@ -1382,7 +1382,7 @@
 	}
 	const string name = luaL_checkstring(L, 1);
 	const int value   = luaL_checkint(L, 2);
-	configHandler.SetInt(name, value);
+	configHandler.Set(name, value);
 	return 0;
 }
 

Modified: trunk/rts/Map/BaseGroundDrawer.cpp
===================================================================
--- trunk/rts/Map/BaseGroundDrawer.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Map/BaseGroundDrawer.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -18,7 +18,7 @@
 #include &quot;Sim/Units/UnitDef.h&quot;
 #include &quot;Sim/Units/UnitDefHandler.h&quot;
 #include &quot;Sim/Units/UnitHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;FastMath.h&quot;
 
 CBaseGroundDrawer::CBaseGroundDrawer(void)
@@ -48,8 +48,8 @@
 
 	highResInfoTexWanted = false;
 
-	highResLosTex = !!configHandler.GetInt(&quot;HighResLos&quot;, 0);
-// 	smoothLosTex = !!configHandler.GetInt(&quot;SmoothLos&quot;, 1);
+	highResLosTex = !!configHandler.Get(&quot;HighResLos&quot;, 0);
+// 	smoothLosTex = !!configHandler.Get(&quot;SmoothLos&quot;, 1);
 
 	jamColor[0] = (int)(losColorScale * 0.25f);
 	jamColor[1] = (int)(losColorScale * 0.0f);

Modified: trunk/rts/Map/HeightLinePalette.cpp
===================================================================
--- trunk/rts/Map/HeightLinePalette.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Map/HeightLinePalette.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -1,6 +1,6 @@
 #include &quot;HeightLinePalette.h&quot;
 
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 
 
 /** @brief Generates the height line palette.
@@ -9,7 +9,7 @@
 
 CHeightLinePalette::CHeightLinePalette()
 {
-	if(configHandler.GetInt(&quot;ColorElev&quot;,1)){
+	if(configHandler.Get(&quot;ColorElev&quot;,1)){
 		for(int a=0;a&lt;86;++a){
 			heightLinePal[a*3+0]=255-a*3;
 			heightLinePal[a*3+1]=a*3;

Modified: trunk/rts/Map/HeightMapTexture.cpp
===================================================================
--- trunk/rts/Map/HeightMapTexture.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Map/HeightMapTexture.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -8,7 +8,7 @@
 
 #include &quot;ReadMap.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 
 /******************************************************************************/
 /******************************************************************************/
@@ -40,7 +40,7 @@
 	}
 	init = true;
 
-	if (!configHandler.GetInt(&quot;HeightMapTexture&quot;, 1)) {
+	if (!configHandler.Get(&quot;HeightMapTexture&quot;, 1)) {
 		return;
 	}
 

Modified: trunk/rts/Map/MetalMap.cpp
===================================================================
--- trunk/rts/Map/MetalMap.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Map/MetalMap.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -3,7 +3,7 @@
 
 #include &quot;MetalMap.h&quot;
 #include &quot;ReadMap.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 
 CR_BIND(CMetalMap,(NULL, 0, 0, 0.0f));
 
@@ -30,7 +30,7 @@
 //		extractionMap[i] = 0.0f;
 //	}
 
-	int whichPalette = configHandler.GetInt(&quot;MetalMapPalette&quot;, 0);
+	int whichPalette = configHandler.Get(&quot;MetalMapPalette&quot;, 0);
 
 	if (whichPalette == 1){
 		/* Swap the green and blue channels. making metal go

Modified: trunk/rts/Map/ReadMap.cpp
===================================================================
--- trunk/rts/Map/ReadMap.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Map/ReadMap.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -11,7 +11,7 @@
 #include &quot;ReadMap.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;Ground.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;MapDamage.h&quot;
 #include &quot;MapInfo.h&quot;
 #include &quot;MetalMap.h&quot;

Modified: trunk/rts/Map/SM3/Sm3GroundDrawer.cpp
===================================================================
--- trunk/rts/Map/SM3/Sm3GroundDrawer.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Map/SM3/Sm3GroundDrawer.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -11,7 +11,7 @@
 #include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;Map/MapInfo.h&quot;
 #include &quot;GlobalUnsynced.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 
 #include &lt;SDL_keysym.h&gt;
 extern unsigned char *keys;
@@ -23,7 +23,7 @@
 	tr = map-&gt;renderer;
 	rc = tr-&gt;AddRenderContext (&amp;cam, true);
 
-	tr-&gt;config.detailMod = configHandler.GetInt(&quot;SM3TerrainDetail&quot;, 200) / 100.0f;
+	tr-&gt;config.detailMod = configHandler.Get(&quot;SM3TerrainDetail&quot;, 200) / 100.0f;
 
 	if (shadowHandler-&gt;drawShadows) {
 		shadowrc = tr-&gt;AddRenderContext (&amp;shadowCam,false);
@@ -40,7 +40,7 @@
 CSm3GroundDrawer::~CSm3GroundDrawer()
 {
 	glSafeDeleteProgram( groundShadowVP );
-	configHandler.SetInt(&quot;SM3TerrainDetail&quot;, int(tr-&gt;config.detailMod * 100));
+	configHandler.Set(&quot;SM3TerrainDetail&quot;, int(tr-&gt;config.detailMod * 100));
 }
 
 static void SpringCamToTerrainCam(CCamera &amp;sc, terrain::Camera&amp; tc)

Modified: trunk/rts/Map/SM3/Sm3Map.cpp
===================================================================
--- trunk/rts/Map/SM3/Sm3Map.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Map/SM3/Sm3Map.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -10,7 +10,7 @@
 #include &quot;Map/MapInfo.h&quot;
 #include &quot;Map/MapParser.h&quot;
 #include &quot;Rendering/ShadowHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Platform/errorhandler.h&quot;
 #include &quot;Platform/byteorder.h&quot;
 #include &quot;FileSystem/FileHandler.h&quot;
@@ -75,7 +75,7 @@
 
 		renderer-&gt;config.cacheTextures=false;
 
-		renderer-&gt;config.forceFallbackTexturing = !!configHandler.GetInt(&quot;SM3ForceFallbackTex&quot;, 0);
+		renderer-&gt;config.forceFallbackTexturing = !!configHandler.Get(&quot;SM3ForceFallbackTex&quot;, 0);
 
 		if (!renderer-&gt;config.forceFallbackTexturing &amp;&amp; GLEW_ARB_fragment_shader &amp;&amp; GLEW_ARB_shading_language_100) {
 			renderer-&gt;config.useBumpMaps = true;
@@ -97,7 +97,7 @@
 		}
 
 /*		int numStages=atoi(mapDefParser.SGetValueDef(&quot;0&quot;, &quot;map\\terrain\\numtexturestages&quot;).c_str());
-		int maxStages=configHandler.GetInt(&quot;SM3MaxTextureStages&quot;, 10);
+		int maxStages=configHandler.Get(&quot;SM3MaxTextureStages&quot;, 10);
 		if (numStages &gt; maxStages) {
 			renderer-&gt;config.cacheTextures = true;
 			renderer-&gt;config.cacheTextureSize = 256;

Modified: trunk/rts/Map/SMF/BFGroundDrawer.cpp
===================================================================
--- trunk/rts/Map/SMF/BFGroundDrawer.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Map/SMF/BFGroundDrawer.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -11,7 +11,7 @@
 #include &quot;SmfReadMap.h&quot;
 #include &quot;Rendering/ShadowHandler.h&quot;
 #include &quot;Rendering/GroundDecalHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;FastMath.h&quot;
 #include &quot;GlobalUnsynced.h&quot;
 #include &quot;mmgr.h&quot;
@@ -49,7 +49,7 @@
 
 	textures = SAFE_NEW CBFGroundTextures(map);
 
-	viewRadius = configHandler.GetInt(&quot;GroundDetail&quot;, 40);
+	viewRadius = configHandler.Get(&quot;GroundDetail&quot;, 40);
 	viewRadius += (viewRadius &amp; 1);
 
 	waterDrawn = false;
@@ -70,8 +70,8 @@
 	}
 
 #ifdef USE_GML
-	multiThreadDrawGround=configHandler.GetInt(&quot;MultiThreadDrawGround&quot;, 1);
-	multiThreadDrawGroundShadow=configHandler.GetInt(&quot;MultiThreadDrawGroundShadow&quot;, 0);
+	multiThreadDrawGround=configHandler.Get(&quot;MultiThreadDrawGround&quot;, 1);
+	multiThreadDrawGroundShadow=configHandler.Get(&quot;MultiThreadDrawGroundShadow&quot;, 0);
 #endif
 }
 
@@ -88,7 +88,7 @@
 		}
 	}
 
-	configHandler.SetInt(&quot;GroundDetail&quot;, viewRadius);
+	configHandler.Set(&quot;GroundDetail&quot;, viewRadius);
 
 	if (waterPlaneCamInDispList) {
 		glDeleteLists(waterPlaneCamInDispList,1);
@@ -96,8 +96,8 @@
 	}
 
 #ifdef USE_GML
-	configHandler.SetInt(&quot;MultiThreadDrawGround&quot;, multiThreadDrawGround);
-	configHandler.SetInt(&quot;MultiThreadDrawGroundShadow&quot;, multiThreadDrawGroundShadow);
+	configHandler.Set(&quot;MultiThreadDrawGround&quot;, multiThreadDrawGround);
+	configHandler.Set(&quot;MultiThreadDrawGroundShadow&quot;, multiThreadDrawGroundShadow);
 #endif
 }
 

Modified: trunk/rts/Map/SMF/SmfReadMap.cpp
===================================================================
--- trunk/rts/Map/SMF/SmfReadMap.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Map/SMF/SmfReadMap.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -4,7 +4,7 @@
 #include &quot;Map/MapInfo.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;FileSystem/FileHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;BFGroundTextures.h&quot;
 #include &quot;BFGroundDrawer.h&quot;
 #include &quot;LogOutput.h&quot;
@@ -37,7 +37,7 @@
 	PrintLoadMsg(&quot;Opening map file&quot;);
 
 	ConfigureAnisotropy();
-	usePBO = !!configHandler.GetInt(&quot;UsePBO&quot;, 1);
+	usePBO = !!configHandler.Get(&quot;UsePBO&quot;, 1);
 
 	for(int a=0;a&lt;1024;++a){
 		for(int b=0;b&lt;3;++b){

Modified: trunk/rts/Rendering/Env/AdvSky.cpp
===================================================================
--- trunk/rts/Rendering/Env/AdvSky.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/Env/AdvSky.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -15,7 +15,7 @@
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;TimeProfiler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Matrix44f.h&quot;
 #include &quot;GlobalUnsynced.h&quot;
 
@@ -70,7 +70,7 @@
 	lastCloudUpdate=-30;
 	dynamicSky=true;
 	CreateClouds();
-	dynamicSky=!!configHandler.GetInt(&quot;DynamicSky&quot;,0);
+	dynamicSky=!!configHandler.Get(&quot;DynamicSky&quot;,0);
 
 	InitSun();
 	oldCoverBaseX=-5;

Modified: trunk/rts/Rendering/Env/BaseSky.cpp
===================================================================
--- trunk/rts/Rendering/Env/BaseSky.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/Env/BaseSky.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -5,7 +5,7 @@
 #include &quot;BasicSky.h&quot;
 #include &quot;AdvSky.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;SkyBox.h&quot;
 #include &quot;Map/MapInfo.h&quot;
 #include &quot;Map/ReadMap.h&quot;
@@ -25,7 +25,7 @@
 {
 	if(!mapInfo-&gt;atmosphere.skyBox.empty())
 		return SAFE_NEW CSkyBox(&quot;maps/&quot; + mapInfo-&gt;atmosphere.skyBox);
-	else if(GLEW_ARB_fragment_program &amp;&amp; configHandler.GetInt(&quot;AdvSky&quot;,1) &amp;&amp; ProgramStringIsNative(GL_FRAGMENT_PROGRAM_ARB,&quot;clouds.fp&quot;))
+	else if(GLEW_ARB_fragment_program &amp;&amp; configHandler.Get(&quot;AdvSky&quot;,1) &amp;&amp; ProgramStringIsNative(GL_FRAGMENT_PROGRAM_ARB,&quot;clouds.fp&quot;))
 		return SAFE_NEW CAdvSky();
 	else
 		return SAFE_NEW CBasicSky();

Modified: trunk/rts/Rendering/Env/BaseTreeDrawer.cpp
===================================================================
--- trunk/rts/Rendering/Env/BaseTreeDrawer.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/Env/BaseTreeDrawer.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -5,7 +5,7 @@
 #include &quot;BasicTreeDrawer.h&quot;
 #include &quot;AdvTreeDrawer.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
 #include &quot;Sim/Misc/GlobalConstants.h&quot;
 
@@ -14,7 +14,7 @@
 CBaseTreeDrawer::CBaseTreeDrawer(void)
 {
 	drawTrees=true;
-	baseTreeDistance=configHandler.GetInt(&quot;TreeRadius&quot;,(unsigned int) (5.5f*256))/256.0f;
+	baseTreeDistance=configHandler.Get(&quot;TreeRadius&quot;,(unsigned int) (5.5f*256))/256.0f;
 }
 
 CBaseTreeDrawer::~CBaseTreeDrawer(void)
@@ -23,7 +23,7 @@
 CBaseTreeDrawer* CBaseTreeDrawer::GetTreeDrawer(void)
 {
 	CBaseTreeDrawer* td;
-	if(GLEW_ARB_vertex_program &amp;&amp; configHandler.GetInt(&quot;3DTrees&quot;,1)){
+	if(GLEW_ARB_vertex_program &amp;&amp; configHandler.Get(&quot;3DTrees&quot;,1)){
 		GLint maxTexel;
 		glGetIntegerv(GL_MAX_TEXTURE_UNITS_ARB,&amp;maxTexel);
 		if(maxTexel&gt;=4){

Modified: trunk/rts/Rendering/Env/BaseWater.cpp
===================================================================
--- trunk/rts/Rendering/Env/BaseWater.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/Env/BaseWater.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -6,7 +6,7 @@
 #include &quot;AdvWater.h&quot;
 #include &quot;BumpWater.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;DynWater.h&quot;
 #include &quot;RefractWater.h&quot;
@@ -39,7 +39,7 @@
 CBaseWater* CBaseWater::GetWater(CBaseWater* old)
 {
 	CBaseWater* water = NULL;
-	const int configValue = configHandler.GetInt(&quot;ReflectiveWater&quot;,1);
+	const int configValue = configHandler.Get(&quot;ReflectiveWater&quot;,1);
 	
 	if(water==NULL &amp;&amp; configValue==2 &amp;&amp; GLEW_ARB_fragment_program &amp;&amp; GLEW_ARB_texture_float &amp;&amp;
 	   ProgramStringIsNative(GL_FRAGMENT_PROGRAM_ARB,&quot;waterDyn.fp&quot;)) {

Modified: trunk/rts/Rendering/Env/BasicSky.cpp
===================================================================
--- trunk/rts/Rendering/Env/BasicSky.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/Env/BasicSky.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -17,7 +17,7 @@
 #include &quot;Map/ReadMap.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;TimeProfiler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;GlobalUnsynced.h&quot;
 #include &quot;Matrix44f.h&quot;
 #include &quot;LogOutput.h&quot;
@@ -73,7 +73,7 @@
 	lastCloudUpdate=-30;
 	dynamicSky=true;
 	CreateClouds();
-	dynamicSky=!!configHandler.GetInt(&quot;DynamicSky&quot;,0);
+	dynamicSky=!!configHandler.Get(&quot;DynamicSky&quot;,0);
 
 	InitSun();
 	oldCoverBaseX=-5;

Modified: trunk/rts/Rendering/Env/BumpWater.cpp
===================================================================
--- trunk/rts/Rendering/Env/BumpWater.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/Env/BumpWater.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -29,7 +29,7 @@
 #include &quot;FileSystem/FileHandler.h&quot;
 #include &quot;FastMath.h&quot;
 #include &quot;EventHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;TimeProfiler.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;GlobalUnsynced.h&quot;
@@ -224,16 +224,16 @@
 CBumpWater::CBumpWater()
 {
 	/** LOAD USER CONFIGS **/
-	reflTexSize  = next_power_of_2(configHandler.GetInt(&quot;BumpWaterTexSizeReflection&quot;, 512));
-	reflection   = !!configHandler.GetInt(&quot;BumpWaterReflection&quot;, 1);
-	refraction   = configHandler.GetInt(&quot;BumpWaterRefraction&quot;, 1);  /// 0:=off, 1:=screencopy, 2:=own rendering cycle
+	reflTexSize  = next_power_of_2(configHandler.Get(&quot;BumpWaterTexSizeReflection&quot;, 512));
+	reflection   = !!configHandler.Get(&quot;BumpWaterReflection&quot;, 1);
+	refraction   = configHandler.Get(&quot;BumpWaterRefraction&quot;, 1);  /// 0:=off, 1:=screencopy, 2:=own rendering cycle
 	anisotropy   = atof(configHandler.GetString(&quot;BumpWaterAnisotropy&quot;, &quot;0.0&quot;).c_str());
-	depthCopy    = !!configHandler.GetInt(&quot;BumpWaterUseDepthTexture&quot;, 1);
-	depthBits    = configHandler.GetInt(&quot;BumpWaterDepthBits&quot;, (gu-&gt;atiHacks)?16:24);
-	blurRefl     = !!configHandler.GetInt(&quot;BumpWaterBlurReflection&quot;, 0);
-	shoreWaves   = (!!configHandler.GetInt(&quot;BumpWaterShoreWaves&quot;, 1)) &amp;&amp; mapInfo-&gt;water.shoreWaves;
-	endlessOcean = (!!configHandler.GetInt(&quot;BumpWaterEndlessOcean&quot;, 1)) &amp;&amp; mapInfo-&gt;hasWaterPlane;
-	dynWaves     = (!!configHandler.GetInt(&quot;BumpWaterDynamicWaves&quot;, 1)) &amp;&amp; (mapInfo-&gt;water.numTiles&gt;1);
+	depthCopy    = !!configHandler.Get(&quot;BumpWaterUseDepthTexture&quot;, 1);
+	depthBits    = configHandler.Get(&quot;BumpWaterDepthBits&quot;, (gu-&gt;atiHacks)?16:24);
+	blurRefl     = !!configHandler.Get(&quot;BumpWaterBlurReflection&quot;, 0);
+	shoreWaves   = (!!configHandler.Get(&quot;BumpWaterShoreWaves&quot;, 1)) &amp;&amp; mapInfo-&gt;water.shoreWaves;
+	endlessOcean = (!!configHandler.Get(&quot;BumpWaterEndlessOcean&quot;, 1)) &amp;&amp; mapInfo-&gt;hasWaterPlane;
+	dynWaves     = (!!configHandler.Get(&quot;BumpWaterDynamicWaves&quot;, 1)) &amp;&amp; (mapInfo-&gt;water.numTiles&gt;1);
 
 	if (refraction&gt;1)
 		drawSolid = true;

Modified: trunk/rts/Rendering/Env/GrassDrawer.cpp
===================================================================
--- trunk/rts/Rendering/Env/GrassDrawer.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/Env/GrassDrawer.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -13,7 +13,7 @@
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;myMath.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;FileSystem/FileHandler.h&quot;
 #include &quot;Map/MapInfo.h&quot;
 #include &quot;Map/ReadMap.h&quot;
@@ -39,7 +39,7 @@
 
 CGrassDrawer::CGrassDrawer()
 {
-	int detail=configHandler.GetInt(&quot;GrassDetail&quot;,3);
+	int detail=configHandler.Get(&quot;GrassDetail&quot;,3);
 
 	if(detail==0){
 		grassOff=true;

Modified: trunk/rts/Rendering/GL/glList.cpp
===================================================================
--- trunk/rts/Rendering/GL/glList.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/GL/glList.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -11,7 +11,7 @@
 #include &quot;myGL.h&quot;
 #include &quot;Game/UI/MouseHandler.h&quot;
 #include &quot;Rendering/glFont.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Util.h&quot;
 
 const float itemFontScale = 1.5f;
@@ -167,8 +167,8 @@
 	* *
 	****************************************
 	// Get screen res, so that the selected item is always within the middle 60% of screen
-	int iResX = configHandler.GetInt(&quot;XResolution&quot;, 1024);
-	int iResY = configHandler.GetInt(&quot;YResolution&quot;, 768);
+	int iResX = configHandler.Get(&quot;XResolution&quot;, 1024);
+	int iResY = configHandler.Get(&quot;YResolution&quot;, 768);
 
 	// Keep tabs on the last place. change this ONLY AFTER a scroll
 	static int siOldPlace = place;

Modified: trunk/rts/Rendering/GL/myGL.cpp
===================================================================
--- trunk/rts/Rendering/GL/myGL.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/GL/myGL.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -12,7 +12,7 @@
 #include &quot;Game/GameVersion.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;Platform/errorhandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;FPUCheck.h&quot;
 #include &quot;GlobalUnsynced.h&quot;

Modified: trunk/rts/Rendering/GroundDecalHandler.cpp
===================================================================
--- trunk/rts/Rendering/GroundDecalHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/GroundDecalHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -10,7 +10,7 @@
 #include &quot;Map/Ground.h&quot;
 #include &quot;Map/MapInfo.h&quot;
 #include &quot;Map/ReadMap.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;ShadowHandler.h&quot;
 #include &quot;GL/myGL.h&quot;
 #include &quot;GL/VertexArray.h&quot;
@@ -33,8 +33,8 @@
 CGroundDecalHandler::CGroundDecalHandler(void)
 {
 	drawDecals = false;
-	decalLevel = std::max(0, std::min(5, configHandler.GetInt(&quot;GroundDecals&quot;, 1)));
-	groundScarAlphaFade = configHandler.GetInt(&quot;GroundScarAlphaFade&quot;, 0);
+	decalLevel = std::max(0, std::min(5, configHandler.Get(&quot;GroundDecals&quot;, 1)));
+	groundScarAlphaFade = configHandler.Get(&quot;GroundScarAlphaFade&quot;, 0);
 
 	if (decalLevel == 0) {
 		return;

Modified: trunk/rts/Rendering/ShadowHandler.cpp
===================================================================
--- trunk/rts/Rendering/ShadowHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/ShadowHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -2,7 +2,7 @@
 #include &quot;mmgr.h&quot;
 
 #include &quot;ShadowHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
 #include &quot;UnitModels/UnitDrawer.h&quot;
 #include &quot;Map/BaseGroundDrawer.h&quot;
@@ -48,14 +48,14 @@
 		GLEW_ARB_shadow &amp;&amp;
 		GLEW_ARB_depth_texture &amp;&amp;
 		GLEW_ARB_texture_env_combine;
-	const int configValue = configHandler.GetInt(&quot;Shadows&quot;, 0);
+	const int configValue = configHandler.Get(&quot;Shadows&quot;, 0);
 
 	if (configValue &lt; 0 || !haveShadowExts) {
 		logOutput.Print(&quot;shadows disabled or required OpenGL extension missing&quot;);
 		return;
 	}
 
-	shadowMapSize = configHandler.GetInt(&quot;ShadowMapSize&quot;, DEFAULT_SHADOWMAPSIZE);
+	shadowMapSize = configHandler.Get(&quot;ShadowMapSize&quot;, DEFAULT_SHADOWMAPSIZE);
 
 	if (tmpFirstInstance) {
 		// this already checks for GLEW_ARB_fragment_program

Modified: trunk/rts/Rendering/Textures/TextureHandler.cpp
===================================================================
--- trunk/rts/Rendering/Textures/TextureHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/Textures/TextureHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -16,7 +16,7 @@
 #include &quot;Sim/Misc/GlobalSynced.h&quot;
 #include &quot;Sim/Misc/TeamHandler.h&quot;
 #include &quot;LogOutput.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Platform/errorhandler.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;Rendering/ShadowHandler.h&quot;

Modified: trunk/rts/Rendering/UnitModels/UnitDrawer.cpp
===================================================================
--- trunk/rts/Rendering/UnitModels/UnitDrawer.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/UnitModels/UnitDrawer.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -16,7 +16,7 @@
 #include &quot;Map/Ground.h&quot;
 #include &quot;Map/MapInfo.h&quot;
 #include &quot;Map/ReadMap.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Rendering/Env/BaseSky.h&quot;
 #include &quot;Rendering/Env/BaseWater.h&quot;
 #include &quot;Rendering/FartextureHandler.h&quot;
@@ -76,11 +76,11 @@
 		texturehandler = SAFE_NEW CTextureHandler;
 	}
 
-	SetUnitDrawDist((float)configHandler.GetInt(&quot;UnitLodDist&quot;,  200));
-	SetUnitIconDist((float)configHandler.GetInt(&quot;UnitIconDist&quot;, 200));
+	SetUnitDrawDist((float)configHandler.Get(&quot;UnitLodDist&quot;,  200));
+	SetUnitIconDist((float)configHandler.Get(&quot;UnitIconDist&quot;, 200));
 
-	specTexSize = configHandler.GetInt(&quot;CubeTexSizeSpecular&quot;, 128);
-	reflTexSize = configHandler.GetInt(&quot;CubeTexSizeReflection&quot;, 128);
+	specTexSize = configHandler.Get(&quot;CubeTexSizeSpecular&quot;, 128);
+	reflTexSize = configHandler.Get(&quot;CubeTexSizeReflection&quot;, 128);
 
 	LODScale           = GetLODFloat(&quot;LODScale&quot;,           1.0f);
 	LODScaleShadow     = GetLODFloat(&quot;LODScaleShadow&quot;,     1.0f);
@@ -100,7 +100,7 @@
 	unitShadowDensity = mapInfo-&gt;light.unitShadowDensity;
 
 	float3 specularSunColor = mapInfo-&gt;light.specularSunColor;
-	advShading = !!configHandler.GetInt(&quot;AdvUnitShading&quot;, GLEW_ARB_fragment_program ? 1: 0);
+	advShading = !!configHandler.Get(&quot;AdvUnitShading&quot;, GLEW_ARB_fragment_program ? 1: 0);
 
 	if (advShading &amp;&amp; !GLEW_ARB_fragment_program) {
 		logOutput.Print(&quot;You are missing an OpenGL extension needed to use advanced unit shading (GL_ARB_fragment_program)&quot;);
@@ -152,8 +152,8 @@
 		CreateSpecularFace(GL_TEXTURE_CUBE_MAP_NEGATIVE_Z_ARB,specTexSize,float3( 1, 1,-1),float3(-2, 0, 0),float3(0,-2, 0),mapInfo-&gt;light.sunDir,100,specularSunColor);
 	}
 #ifdef USE_GML
-	multiThreadDrawUnit=configHandler.GetInt(&quot;MultiThreadDrawUnit&quot;, 1);
-	multiThreadDrawUnitShadow=configHandler.GetInt(&quot;MultiThreadDrawUnitShadow&quot;, 1);
+	multiThreadDrawUnit=configHandler.Get(&quot;MultiThreadDrawUnit&quot;, 1);
+	multiThreadDrawUnitShadow=configHandler.Get(&quot;MultiThreadDrawUnitShadow&quot;, 1);
 #endif
 }
 
@@ -194,8 +194,8 @@
 		gbi = ghostBuildingsS3O.erase(gbi);
 	}
 #ifdef USE_GML
-	configHandler.SetInt(&quot;MultiThreadDrawUnit&quot;, multiThreadDrawUnit);
-	configHandler.SetInt(&quot;MultiThreadDrawUnitShadow&quot;, multiThreadDrawUnitShadow);
+	configHandler.Set(&quot;MultiThreadDrawUnit&quot;, multiThreadDrawUnit);
+	configHandler.Set(&quot;MultiThreadDrawUnitShadow&quot;, multiThreadDrawUnitShadow);
 #endif
 }
 

Modified: trunk/rts/Rendering/VerticalSync.cpp
===================================================================
--- trunk/rts/Rendering/VerticalSync.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Rendering/VerticalSync.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -13,7 +13,7 @@
 #include &quot;VerticalSync.h&quot;
 #include &quot;GL/myGL.h&quot;
 #include &quot;LogOutput.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 
 
 CVerticalSync VSync;
@@ -36,13 +36,13 @@
 
 void CVerticalSync::Init()
 {
-	SetFrames(configHandler.GetInt(&quot;VSync&quot;, -1));
+	SetFrames(configHandler.Get(&quot;VSync&quot;, -1));
 }
 
 
 void CVerticalSync::SetFrames(int f)
 {
-	configHandler.SetInt(&quot;VSync&quot;, f);
+	configHandler.Set(&quot;VSync&quot;, f);
 	
 	frames = f;
 

Modified: trunk/rts/Sim/Features/FeatureHandler.cpp
===================================================================
--- trunk/rts/Sim/Features/FeatureHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Sim/Features/FeatureHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -28,7 +28,7 @@
 #include &quot;GlobalUnsynced.h&quot;
 #include &quot;EventHandler.h&quot;
 #include &quot;TimeProfiler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;creg/STL_List.h&quot;
 #include &quot;creg/STL_Set.h&quot;
 #include &quot;Exceptions.h&quot;

Modified: trunk/rts/Sim/Misc/ModInfo.cpp
===================================================================
--- trunk/rts/Sim/Misc/ModInfo.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Sim/Misc/ModInfo.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -10,7 +10,7 @@
 #include &quot;Sim/Units/Unit.h&quot;
 #include &quot;Sim/Units/UnitTypes/Builder.h&quot;
 #include &quot;LogOutput.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;FileSystem/ArchiveScanner.h&quot;
 #include &quot;Exceptions.h&quot;
 
@@ -50,7 +50,7 @@
 	allowTeamColors = nanosprayTbl.GetBool(&quot;allow_team_colors&quot;, true);
 	if (allowTeamColors) {
 		// Load the users preference for team coloured nanospray
-		gu-&gt;teamNanospray = !!configHandler.GetInt(&quot;TeamNanoSpray&quot;, 0);
+		gu-&gt;teamNanospray = !!configHandler.Get(&quot;TeamNanoSpray&quot;, 0);
 	}
 
 	// constructions

Modified: trunk/rts/Sim/Path/PathEstimator.cpp
===================================================================
--- trunk/rts/Sim/Path/PathEstimator.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Sim/Path/PathEstimator.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -10,7 +10,7 @@
 #include &quot;LogOutput.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;FileSystem/FileHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 
 #include &quot;Map/Ground.h&quot;
 #include &quot;Game/SelectedUnits.h&quot;
@@ -176,7 +176,7 @@
 }
 
 void CPathEstimator::InitEstimator(const std::string&amp; name) {
-	int numThreads = configHandler.GetInt(&quot;HardwareThreadCount&quot;, 0);
+	int numThreads = configHandler.Get(&quot;HardwareThreadCount&quot;, 0);
 
 #if 0	// FIXME mantis #1033
 #if (BOOST_VERSION &gt;= 103500)

Modified: trunk/rts/Sim/Projectiles/ExplosionGenerator.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/ExplosionGenerator.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Sim/Projectiles/ExplosionGenerator.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -10,7 +10,7 @@
 #include &quot;Game/Camera.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;Map/Ground.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;Rendering/GroundFlash.h&quot;
 #include &quot;Rendering/Textures/ColorMap.h&quot;

Modified: trunk/rts/Sim/Projectiles/ProjectileHandler.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/ProjectileHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Sim/Projectiles/ProjectileHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -13,7 +13,7 @@
 #include &quot;Lua/LuaParser.h&quot;
 #include &quot;Map/Ground.h&quot;
 #include &quot;Map/MapInfo.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Rendering/GroundFlash.h&quot;
 #include &quot;Rendering/ShadowHandler.h&quot;
 #include &quot;Rendering/GL/IFramebuffer.h&quot;
@@ -66,7 +66,7 @@
 {
 	PrintLoadMsg(&quot;Creating projectile texture&quot;);
 
-	maxParticles = configHandler.GetInt(&quot;MaxParticles&quot;,4000);
+	maxParticles = configHandler.Get(&quot;MaxParticles&quot;,4000);
 
 	currentParticles = 0;
 	particleSaturation = 0;

Modified: trunk/rts/Sim/Units/UnitDefHandler.cpp
===================================================================
--- trunk/rts/Sim/Units/UnitDefHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Sim/Units/UnitDefHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -17,7 +17,7 @@
 #include &quot;Lua/LuaParser.h&quot;
 #include &quot;Map/MapInfo.h&quot;
 #include &quot;Map/ReadMap.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Rendering/GroundDecalHandler.h&quot;
 #include &quot;Rendering/IconHandler.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;

Modified: trunk/rts/Sim/Units/UnitHandler.cpp
===================================================================
--- trunk/rts/Sim/Units/UnitHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Sim/Units/UnitHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -33,7 +33,7 @@
 #include &quot;LogOutput.h&quot;
 #include &quot;TimeProfiler.h&quot;
 #include &quot;myMath.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Sync/SyncTracer.h&quot;
 #include &quot;creg/STL_Deque.h&quot;
 #include &quot;creg/STL_List.h&quot;

Modified: trunk/rts/Sim/Units/UnitTracker.cpp
===================================================================
--- trunk/rts/Sim/Units/UnitTracker.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/Sim/Units/UnitTracker.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -9,7 +9,7 @@
 #include &quot;Game/Camera.h&quot;
 #include &quot;Game/SelectedUnits.h&quot;
 #include &quot;Map/Ground.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;GlobalUnsynced.h&quot;
 #include &quot;LogOutput.h&quot;
 
@@ -234,7 +234,7 @@
 {
 	if(firstUpdate){
 		firstUpdate=false;
-		doRoll=!configHandler.GetInt(&quot;ReflectiveWater&quot;,1);
+		doRoll=!configHandler.Get(&quot;ReflectiveWater&quot;,1);
 	}
 
 	CUnit* u = GetTrackUnit();

Copied: trunk/rts/System/ConfigHandler.cpp (from rev 7055, trunk/rts/System/Platform/ConfigHandler.cpp)
===================================================================
--- trunk/rts/System/ConfigHandler.cpp	                        (rev 0)
+++ trunk/rts/System/ConfigHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -0,0 +1,269 @@
+/**
+ * @file ConfigHandler.cpp
+ * @brief config implementation
+ * @author Christopher Han &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">xiphux at gmail.com</A>&gt;
+ *
+ * Implementation of config structure class
+ * Copyright (C) 2005.  Licensed under the terms of the
+ * GNU GPL, v2 or later.
+ */
+#include &quot;StdAfx.h&quot;
+#include &quot;ConfigHandler.h&quot;
+
+#include &lt;fcntl.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;string.h&gt;
+#include &lt;stdexcept&gt;
+#include &lt;unistd.h&gt;
+
+#ifdef WIN32
+	#include &lt;io.h&gt;
+	#include &lt;direct.h&gt;
+	#include &lt;windows.h&gt;
+	#include &lt;shlobj.h&gt;
+	#include &lt;shlwapi.h&gt;
+	#ifndef SHGFP_TYPE_CURRENT
+		#define SHGFP_TYPE_CURRENT 0
+	#endif
+#endif
+
+#include &quot;Game/GameVersion.h&quot;
+
+using std::string;
+
+ConfigHandler* _configHandler;
+
+/**
+ * @brief POSIX file locking class
+ */
+class ScopedFileLock
+{
+public:
+	ScopedFileLock(int fd, bool write);
+	~ScopedFileLock();
+private:
+	int filedes;
+};
+
+/**
+ * @brief lock fd
+ *
+ * Lock file descriptor fd for reading (write == false) or writing
+ * (write == true).
+ */
+ScopedFileLock::ScopedFileLock(int fd, bool write) : filedes(fd)
+{
+#ifndef _WIN32
+	struct flock lock;
+	lock.l_type = write ? F_WRLCK : F_RDLCK;
+	lock.l_whence = SEEK_SET;
+	lock.l_start = 0;
+	lock.l_len = 0;
+	if (fcntl(filedes, F_SETLKW, &amp;lock)) {
+		// not a fatal error
+		//handleerror(0, &quot;Could not lock config file&quot;, &quot;DotfileHandler&quot;, 0);
+	}
+#endif
+}
+
+/**
+ * @brief unlock fd
+ */
+ScopedFileLock::~ScopedFileLock()
+{
+#ifndef _WIN32
+	struct flock lock;
+	lock.l_type = F_UNLCK;
+	lock.l_whence = SEEK_SET;
+	lock.l_start = 0;
+	lock.l_len = 0;
+	if (fcntl(filedes, F_SETLKW, &amp;lock)) {
+		// not a fatal error
+		//handleerror(0, &quot;Could not unlock config file&quot;, &quot;DotfileHandler&quot;, 0);
+	}
+#endif
+}
+
+
+/**
+ * Instantiates a copy of the current platform's config class.
+ * Re-instantiates if the configHandler already existed.
+ */
+std::string ConfigHandler::Instantiate(std::string configSource)
+{
+	Deallocate();
+
+	if (configSource.empty()) {
+		configSource = GetDefaultConfig();
+	}
+	_configHandler = new ConfigHandler(configSource);
+	return configSource;
+}
+
+
+/**
+ * Destroys existing ConfigHandler instance.
+ */
+void ConfigHandler::Deallocate()
+{
+	// can not use SafeDelete because ~ConfigHandler is protected
+	delete _configHandler;
+	_configHandler = NULL;
+}
+
+ConfigHandler::ConfigHandler(const std::string&amp; configFile)
+{
+	filename = configFile;
+	FILE* file;
+
+	if ((file = fopen(filename.c_str(), &quot;r&quot;))) {
+		ScopedFileLock scoped_lock(fileno(file), false);
+		Read(file);
+	} else {
+		if (!(file = fopen(filename.c_str(), &quot;a&quot;)))
+			throw std::runtime_error(&quot;DotfileHandler: Could not write to config file&quot;);
+	}
+	fclose(file);
+}
+
+ConfigHandler::~ConfigHandler()
+{
+}
+
+
+/**
+ * @brief Gets string value from config
+ *
+ * If string value isn't set, it returns def AND it sets data[name] = def,
+ * so the defaults end up in the config file.
+ */
+string ConfigHandler::GetString(const string name, const string def)
+{
+	std::map&lt;string,string&gt;::iterator pos = data.find(name);
+	if (pos == data.end()) {
+		SetString(name, def);
+		return def;
+	}
+	return pos-&gt;second;
+}
+
+
+/**
+ * @brief Sets a config string
+ *
+ * This does:
+ * 1) Lock file.
+ * 2) Read file (in case another program modified something)
+ * 3) Set data[name] = value.
+ * 4) Write file (so we keep the settings in the event of a crash or error)
+ * 5) Unlock file.
+ *
+ * Pretty hackish, but Windows registry changes
+ * save immediately, while with DotfileHandler the
+ * data is stored in an internal data structure for
+ * fast access.  So we want to keep the settings in
+ * the event of a crash, but at the same time we don't
+ * want conflicts when multiple instances are running
+ * at the same time (which would cause data loss)
+ * (e.g. unitsync and spring).
+ */
+void ConfigHandler::SetString(const string name, const string value)
+{
+	FILE* file = fopen(filename.c_str(), &quot;r+&quot;);
+
+	if (file) {
+		ScopedFileLock scoped_lock(fileno(file), true);
+		Read(file);
+		data[name] = value;
+		Write(file);
+	} else
+		data[name] = value;
+
+	// must be outside above 'if (file)' block because of the lock.
+		if (file)
+			fclose(file);
+}
+
+/**
+ * @brief Get the name of the default configuration file
+ */
+string ConfigHandler::GetDefaultConfig()
+{
+	string cfg;
+#ifndef _WIN32
+	const string base = &quot;.springrc&quot;;
+	const string home = getenv(&quot;HOME&quot;);
+
+	const string defCfg = home + &quot;/&quot; + base;
+	const string verCfg = defCfg + &quot;-&quot; + SpringVersion::Get();
+
+
+	struct stat st;
+	if (stat(verCfg.c_str(), &amp;st) == 0) {
+		cfg = verCfg; // use the versionned config file
+	} else {
+		cfg = defCfg; // use the default config file
+	}
+#else
+	// appdata
+	TCHAR strPath[MAX_PATH];
+	SHGetFolderPath( NULL, CSIDL_LOCAL_APPDATA, NULL, SHGFP_TYPE_CURRENT, strPath);
+	cfg = strPath;
+	cfg += &quot;\\springsettings.cfg&quot;; // e.g. F:\Dokumente und Einstellungen\MyUser\Anwendungsdaten
+#endif
+	
+	return cfg;
+}
+
+/**
+ * @brief strip whitespace
+ *
+ * Strips whitespace off the string [begin, end] by setting the first
+ * non-whitespace character from the end to 0 and returning a pointer
+ * to the first non-whitespace character from the begin.
+ *
+ * Precondition: end must point to the last character of the string,
+ * ie. the one before the terminating null.
+ */
+char* ConfigHandler::Strip(char* begin, char* end) {
+	while (isspace(*begin)) ++begin;
+	while (end &gt;= begin &amp;&amp; isspace(*end)) --end;
+	*(end + 1) = 0;
+	return begin;
+}
+
+/**
+ * @brief process one line read from file
+ *
+ * Parses the 'key=value' assignment in buf and sets data[key] to value.
+ */
+void ConfigHandler::AppendLine(char* buf) {
+	char* eq = strchr(buf, '=');
+	if (eq) {
+		char* key = Strip(buf, eq - 1);
+		char* value = Strip(eq + 1, strchr(eq + 1, 0) - 1);
+		data[key] = value;
+	}
+}
+
+/**
+ * @brief Rewind file and re-read it.
+ */
+void ConfigHandler::Read(FILE* file)
+{
+	char buf[500];
+	rewind(file);
+	while (fgets(buf, sizeof(buf), file))
+		AppendLine(buf);
+}
+
+/**
+ * @brief Truncate file and write data to it.
+ */
+void ConfigHandler::Write(FILE* file)
+{
+	rewind(file);
+	ftruncate(fileno(file), 0);
+	for(std::map&lt;string,string&gt;::iterator iter = data.begin(); iter != data.end(); ++iter)
+		fprintf(file, &quot;%s=%s\n&quot;, iter-&gt;first.c_str(), iter-&gt;second.c_str());
+}


Property changes on: trunk/rts/System/ConfigHandler.cpp
___________________________________________________________________
Name: svn:mergeinfo
   + 
Name: svn:eol-style
   + native

Copied: trunk/rts/System/ConfigHandler.h (from rev 7055, trunk/rts/System/Platform/ConfigHandler.h)
===================================================================
--- trunk/rts/System/ConfigHandler.h	                        (rev 0)
+++ trunk/rts/System/ConfigHandler.h	2008-11-17 17:57:12 UTC (rev 7058)
@@ -0,0 +1,118 @@
+/**
+ * @file ConfigHandler.h
+ * @brief config base
+ * @author Christopher Han &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">xiphux at gmail.com</A>&gt;
+ *
+ * Definition of config structure class
+ * Copyright (C) 2005.  Licensed under the terms of the
+ * GNU GPL, v2 or later.
+ */
+#ifndef CONFIGHANDLER_H
+#define CONFIGHANDLER_H
+
+#include &lt;string&gt;
+#include &lt;sstream&gt;
+#include &lt;map&gt;
+#include &lt;stdio.h&gt;
+
+#ifdef __FreeBSD__
+#include &lt;sys/stat.h&gt;
+#endif
+
+/**
+ * @brief config handler base
+ *
+ * This is the abstract configuration handler class used
+ * for polymorphic configuration.  Platform-specifics should derive
+ * from this.
+ */
+class ConfigHandler
+{
+public:
+	/**
+	* @brief set string
+	* @param name name of key to set
+	* @param value string value to set
+	 */
+	void SetString(std::string name, std::string value);
+
+	/**
+	 * @brief get string
+	 * @param name name of key to get
+	 * @param def default string value to use if key is not found
+	 * @return string value
+	 */
+	std::string GetString(std::string name, std::string def);
+	
+	template&lt;typename T&gt;
+	void Set(const std::string&amp; name, const T&amp; value)
+	{
+		
+		std::ostringstream buffer;
+		buffer &lt;&lt; value;
+		SetString(name, buffer.str());
+	}
+	
+	template&lt;typename T&gt;
+	T Get(const std::string&amp; name, const T&amp; def)
+	{
+		std::map&lt;std::string, std::string&gt;::iterator pos = data.find(name);
+		if (pos == data.end()) {
+			Set(name, def);
+			return def;
+		}
+		std::istringstream buf(pos-&gt;second);
+		T temp;
+		buf &gt;&gt; temp;
+		return temp;
+	}
+	
+	void SetFloat(const std::string&amp; name, const float&amp; value) {Set(name,value);};
+	float GetFloat(const std::string&amp; name, const float&amp; value) {return Get(name,value);};
+
+	/**
+	 * @brief instantiate global configHandler
+	 * @return name of the configfile used
+	 */
+	static std::string Instantiate(std::string configSource);
+
+	/**
+	 * @brief deallocate
+	 */
+	static void Deallocate();
+
+private:
+	ConfigHandler(const std::string&amp; configFile);
+	~ConfigHandler();
+	
+	/**
+	 * @brief config file name
+	 */
+	std::string filename;
+
+	/**
+	 * @brief data map
+	 *
+	 * Map used to internally cache data
+	 * instead of constantly rereading from the file
+	 */
+	std::map&lt;std::string, std::string&gt; data;
+
+	/**
+	 * @brief Get the name of the default configuration file
+	 */
+	static std::string GetDefaultConfig();
+	
+	// helper functions
+	void Read(FILE* file);
+	void Write(FILE* file);
+	char* Strip(char* begin, char* end);
+	void AppendLine(char* buf);
+};
+
+extern ConfigHandler* _configHandler;
+
+// quick hack so I don't have to change . to -&gt; in the entire project
+#define configHandler (*_configHandler)
+
+#endif /* CONFIGHANDLER_H */


Property changes on: trunk/rts/System/ConfigHandler.h
___________________________________________________________________
Name: svn:mergeinfo
   + 
Name: svn:eol-style
   + native

Modified: trunk/rts/System/FileSystem/DataDirLocater.cpp
===================================================================
--- trunk/rts/System/FileSystem/DataDirLocater.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/FileSystem/DataDirLocater.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -24,7 +24,7 @@
 #include &lt;string.h&gt;
 #include &quot;FileSystem/VFSHandler.h&quot;
 #include &quot;LogOutput.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;FileSystem.h&quot;
 #include &quot;mmgr.h&quot;
 #include &quot;Exceptions.h&quot;

Modified: trunk/rts/System/FileSystem/FileSystem.cpp
===================================================================
--- trunk/rts/System/FileSystem/FileSystem.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/FileSystem/FileSystem.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -34,7 +34,7 @@
 
 #include &quot;FileSystem/ArchiveScanner.h&quot;
 #include &quot;FileSystem/VFSHandler.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;Util.h&quot;
 #include &quot;mmgr.h&quot;

Modified: trunk/rts/System/LogOutput.cpp
===================================================================
--- trunk/rts/System/LogOutput.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/LogOutput.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -15,7 +15,7 @@
 #include &quot;Util.h&quot;
 #include &quot;float3.h&quot;
 #include &quot;Sim/Misc/GlobalSynced.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;mmgr.h&quot;
 
 using std::string;

Modified: trunk/rts/System/NetProtocol.cpp
===================================================================
--- trunk/rts/System/NetProtocol.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/NetProtocol.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -15,7 +15,7 @@
 #include &quot;Game/GameSetup.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;DemoRecorder.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Net/UDPConnection.h&quot;
 #include &quot;Net/LocalConnection.h&quot;
 #include &quot;Net/UDPSocket.h&quot;
@@ -36,7 +36,7 @@
 	boost::shared_ptr&lt;netcode::UDPSocket&gt; sock(new netcode::UDPSocket(sourceport));
 	sock-&gt;SetBlocking(false);
 	netcode::UDPConnection* conn = new netcode::UDPConnection(sock, server_addr, portnum);
-	conn-&gt;SetMTU(configHandler.GetInt(&quot;MaximumTransmissionUnit&quot;, 0));
+	conn-&gt;SetMTU(configHandler.Get(&quot;MaximumTransmissionUnit&quot;, 0));
 	server.reset(conn);
 	server-&gt;SendData(CBaseNetProtocol::Get().SendAttemptConnect(myName, myVersion));
 	server-&gt;Flush(true);

Deleted: trunk/rts/System/Platform/ConfigHandler.cpp
===================================================================
--- trunk/rts/System/Platform/ConfigHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/Platform/ConfigHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -1,93 +0,0 @@
-/**
- * @file ConfigHandler.cpp
- * @brief config implementation
- * @author Christopher Han &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">xiphux at gmail.com</A>&gt;
- *
- * Implementation of config structure class
- * Copyright (C) 2005.  Licensed under the terms of the
- * GNU GPL, v2 or later.
- */
-#include &quot;StdAfx.h&quot;
-#include &quot;ConfigHandler.h&quot;
-#ifdef _WIN32
-#include &quot;Win/RegHandler.h&quot;
-#elif defined(__APPLE__)
-extern &quot;C&quot; void PreInitMac();
-#include &quot;Mac/UserDefsHandler.h&quot;
-#else
-#include &quot;Linux/DotfileHandler.h&quot;
-#endif
-#include &lt;sstream&gt;
-#include &quot;Game/GameVersion.h&quot;
-
-
-ConfigHandler* _configHandler;
-
-
-/**
- * Instantiates a copy of the current platform's config class.
- * Re-instantiates if the configHandler already existed.
- */
-void ConfigHandler::Instantiate(std::string configSource)
-{
-	Deallocate();
-
-	if (configSource.empty()) {
-#ifdef _WIN32
-		configSource = &quot;Software\\SJ\\Spring&quot;;
-		const std::string version = SpringVersion::Get();
-		if (version.size()&gt;0 &amp;&amp; version[version.size()-1] == '+')
-			configSource += &quot; SVN&quot;;
-#elif defined(__APPLE__)
-		configSource = &quot;this string is not currently used&quot;;
-#else
-		configSource = DotfileHandler::GetDefaultConfig();
-#endif
-	}
-
-#ifdef _WIN32
-	_configHandler = SAFE_NEW RegHandler(configSource);
-#elif defined(__APPLE__)
-	PreInitMac();
-	_configHandler = SAFE_NEW UserDefsHandler(); // Config path is based on bundle id
-#else
-	_configHandler = SAFE_NEW DotfileHandler(configSource);
-#endif
-}
-
-
-/**
- * Destroys existing ConfigHandler instance.
- */
-void ConfigHandler::Deallocate()
-{
-	// can not use SafeDelete because ~ConfigHandler is protected
-	delete _configHandler;
-	_configHandler = NULL;
-}
-
-
-ConfigHandler::~ConfigHandler()
-{
-}
-
-
-float ConfigHandler::GetFloat(const std::string&amp; name, const float def)
-{
-	std::ostringstream buf1;
-	buf1 &lt;&lt; def;
-
-	std::istringstream buffer(GetString(name, buf1.str()));
-	float val;
-	buffer &gt;&gt; val;
-	return val;
-}
-
-
-void ConfigHandler::SetFloat(const std::string&amp; name, float value)
-{
-	std::ostringstream buffer;
-	buffer &lt;&lt; value;
-
-	SetString(name, buffer.str());
-}

Deleted: trunk/rts/System/Platform/ConfigHandler.h
===================================================================
--- trunk/rts/System/Platform/ConfigHandler.h	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/Platform/ConfigHandler.h	2008-11-17 17:57:12 UTC (rev 7058)
@@ -1,84 +0,0 @@
-/**
- * @file ConfigHandler.h
- * @brief config base
- * @author Christopher Han &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">xiphux at gmail.com</A>&gt;
- *
- * Definition of config structure class
- * Copyright (C) 2005.  Licensed under the terms of the
- * GNU GPL, v2 or later.
- */
-#ifndef CONFIGHANDLER_H
-#define CONFIGHANDLER_H
-
-#include &lt;string&gt;
-
-/**
- * @brief config handler base
- *
- * This is the abstract configuration handler class used
- * for polymorphic configuration.  Platform-specifics should derive
- * from this.
- */
-class ConfigHandler
-{
-public:
-	/**
-	 * @brief set integer
-	 * @param name name of key to set
-	 * @param value integer value to set
-	 */
-	virtual void SetInt(std::string name, int value) = 0;
-
-	/**
-	 * @brief set string
-	 * @param name name of key to set
-	 * @param value string value to set
-	 */
-	virtual void SetString(std::string name, std::string value) = 0;
-
-	/**
-	 * @brief get string
-	 * @param name name of key to get
-	 * @param def default string value to use if key is not found
-	 * @return string value
-	 */
-	virtual std::string GetString(std::string name, std::string def) = 0;
-
-	/**
-	 * @brief get integer
-	 * @param name name of key to get
-	 * @param def default integer value to use if key is not found
-	 * @return integer value
-	 */
-	virtual int GetInt(std::string name, int def) = 0;
-
-	/**
-	@brief get float value
-	*/
-	virtual float GetFloat(const std::string&amp; name, const float def);
-
-	/**
-	@brief set float value
-	*/
-	virtual void SetFloat(const std::string&amp; name, float value);
-
-	/**
-	 * @brief instantiate global configHandler
-	 */
-	static void Instantiate(std::string configSource);
-
-	/**
-	 * @brief deallocate
-	 */
-	static void Deallocate();
-
-protected:
-	virtual ~ConfigHandler();
-};
-
-extern ConfigHandler* _configHandler;
-
-// quick hack so I don't have to change . to -&gt; in the entire project
-#define configHandler (*_configHandler)
-
-#endif /* CONFIGHANDLER_H */

Deleted: trunk/rts/System/Platform/Linux/DotfileHandler.cpp
===================================================================
--- trunk/rts/System/Platform/Linux/DotfileHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/Platform/Linux/DotfileHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -1,244 +0,0 @@
-/**
- * @file DotfileHandler.cpp
- * @brief Linux dotfile config implementation
- * @author Christopher Han &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">xiphux at gmail.com</A>&gt;
- * @author Tobi Vollebregt &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">tobivollebregt at gmail.com</A>&gt;
- *
- * DotfileHandler configuration class implementation
- * Copyright (C) 2005.  Licensed under the terms of the
- * GNU GPL, v2 or later.
- */
-
-#include &quot;StdAfx.h&quot;
-#include &quot;DotfileHandler.h&quot;
-#include &lt;sstream&gt;
-#include &lt;fcntl.h&gt;
-#include &lt;stdlib.h&gt;
-#include &lt;string.h&gt;
-#include &quot;Game/GameVersion.h&quot;
-#include &quot;Exceptions.h&quot;
-
-
-/**
- * @brief POSIX file locking class
- */
-class ScopedFileLock
-{
-	public:
-		ScopedFileLock(int fd, bool write);
-		~ScopedFileLock();
-	private:
-		int filedes;
-};
-
-/**
- * @brief lock fd
- *
- * Lock file descriptor fd for reading (write == false) or writing
- * (write == true).
- */
-ScopedFileLock::ScopedFileLock(int fd, bool write) : filedes(fd)
-{
-	struct flock lock;
-	lock.l_type = write ? F_WRLCK : F_RDLCK;
-	lock.l_whence = SEEK_SET;
-	lock.l_start = 0;
-	lock.l_len = 0;
-	if (fcntl(filedes, F_SETLKW, &amp;lock)) {
-		// not a fatal error
-		//handleerror(0, &quot;Could not lock config file&quot;, &quot;DotfileHandler&quot;, 0);
-	}
-}
-
-/**
- * @brief unlock fd
- */
-ScopedFileLock::~ScopedFileLock()
-{
-	struct flock lock;
-	lock.l_type = F_UNLCK;
-	lock.l_whence = SEEK_SET;
-	lock.l_start = 0;
-	lock.l_len = 0;
-	if (fcntl(filedes, F_SETLKW, &amp;lock)) {
-		// not a fatal error
-		//handleerror(0, &quot;Could not unlock config file&quot;, &quot;DotfileHandler&quot;, 0);
-	}
-}
-
-/**
- * @brief strip whitespace
- *
- * Strips whitespace off the string [begin, end] by setting the first
- * non-whitespace character from the end to 0 and returning a pointer
- * to the first non-whitespace character from the begin.
- *
- * Precondition: end must point to the last character of the string,
- * ie. the one before the terminating null.
- */
-char* DotfileHandler::Strip(char* begin, char* end) {
-	while (isspace(*begin)) ++begin;
-	while (end &gt;= begin &amp;&amp; isspace(*end)) --end;
-	*(end + 1) = 0;
-	return begin;
-}
-
-/**
- * @brief process one line read from file
- *
- * Parses the 'key=value' assignment in buf and sets data[key] to value.
- */
-void DotfileHandler::AppendLine(char* buf) {
-	char* eq = strchr(buf, '=');
-	if (eq) {
-		char* key = Strip(buf, eq - 1);
-		char* value = Strip(eq + 1, strchr(eq + 1, 0) - 1);
-		data[key] = value;
-	}
-}
-
-/**
- * @brief Open file
- *
- * Attempts to open an existing config file.
- * If none exists, create one.
- */
-DotfileHandler::DotfileHandler(const std::string&amp; fname) : filename(fname)
-{
-	FILE* file;
-
-	if ((file = fopen(fname.c_str(), &quot;r&quot;))) {
-		ScopedFileLock scoped_lock(fileno(file), false);
-		Read(file);
-	} else {
-		if (!(file = fopen(fname.c_str(), &quot;a&quot;)))
-			throw std::runtime_error(&quot;DotfileHandler: Could not write to config file&quot;);
-	}
-	fclose(file);
-}
-
-DotfileHandler::~DotfileHandler()
-{
-}
-
-/**
- * @brief Gets integer value from config
- */
-int DotfileHandler::GetInt(const string name, const int def)
-{
-	std::map&lt;string,string&gt;::iterator pos = data.find(name);
-	if (pos == data.end()) {
-		SetInt(name, def);
-		return def;
-	}
-	return atoi(pos-&gt;second.c_str());
-}
-
-/**
- * @brief Gets string value from config
- *
- * If string value isn't set, it returns def AND it sets data[name] = def,
- * so the defaults end up in the config file.
- */
-string DotfileHandler::GetString(const string name, const string def)
-{
-	std::map&lt;string,string&gt;::iterator pos = data.find(name);
-	if (pos == data.end()) {
-		SetString(name, def);
-		return def;
-	}
-	return pos-&gt;second;
-}
-
-/**
- * @brief Rewind file and re-read it.
- */
-void DotfileHandler::Read(FILE* file)
-{
-	char buf[500];
-	rewind(file);
-	while (fgets(buf, sizeof(buf), file))
-		AppendLine(buf);
-}
-
-/**
- * @brief Truncate file and write data to it.
- */
-void DotfileHandler::Write(FILE* file)
-{
-	rewind(file);
-	ftruncate(fileno(file), 0);
-	for(std::map&lt;string,string&gt;::iterator iter = data.begin(); iter != data.end(); ++iter)
-		fprintf(file, &quot;%s=%s\n&quot;, iter-&gt;first.c_str(), iter-&gt;second.c_str());
-}
-
-/**
- * @brief Sets a config string
- *
- * This does:
- * 1) Lock file.
- * 2) Read file (in case another program modified something)
- * 3) Set data[name] = value.
- * 4) Write file (so we keep the settings in the event of a crash or error)
- * 5) Unlock file.
- *
- * Pretty hackish, but Windows registry changes
- * save immediately, while with DotfileHandler the
- * data is stored in an internal data structure for
- * fast access.  So we want to keep the settings in
- * the event of a crash, but at the same time we don't
- * want conflicts when multiple instances are running
- * at the same time (which would cause data loss)
- * (e.g. unitsync and spring).
- */
-void DotfileHandler::SetString(const string name, const string value)
-{
-	FILE* file = fopen(filename.c_str(), &quot;r+&quot;);
-
-	if (file) {
-		ScopedFileLock scoped_lock(fileno(file), true);
-		Read(file);
-		data[name] = value;
-		Write(file);
-	} else
-		data[name] = value;
-
-	// must be outside above 'if (file)' block because of the lock.
-	if (file)
-		fclose(file);
-}
-
-/**
- * @brief Sets a config integer
- */
-void DotfileHandler::SetInt(const string name, const int value)
-{
-	std::stringstream ss;
-	ss &lt;&lt; value;
-	SetString(name, ss.str());
-}
-
-
-/**
- * @brief Get the name of the default configuration file
- */
-string DotfileHandler::GetDefaultConfig()
-{
-	const string base = &quot;.springrc&quot;;
-	const string home = getenv(&quot;HOME&quot;);
-
-	const string defCfg = home + &quot;/&quot; + base;
-	const string verCfg = defCfg + &quot;-&quot; + SpringVersion::Get();
-
-	string cfg;
-
-	struct stat st;
-	if (stat(verCfg.c_str(), &amp;st) == 0) {
-		cfg = verCfg; // use the versionned config file
-	} else {
-		cfg = defCfg; // use the default config file
-	}
-
-	return cfg;
-}
-

Deleted: trunk/rts/System/Platform/Linux/DotfileHandler.h
===================================================================
--- trunk/rts/System/Platform/Linux/DotfileHandler.h	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/Platform/Linux/DotfileHandler.h	2008-11-17 17:57:12 UTC (rev 7058)
@@ -1,105 +0,0 @@
-/**
- * @file DotfileHandler.h
- * @brief linux dotfile config base
- * @author Christopher Han &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">xiphux at gmail.com</A>&gt;
- * @author Tobi Vollebregt &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">tobivollebregt at gmail.com</A>&gt;
- *
- * DotfileHandler configuration class definition
- * Copyright (C) 2005.  Licensed under the terms of the
- * GNU GPL, v2 or later.
- */
-
-#ifndef _DOTFILEHANDLER_H
-#define _DOTFILEHANDLER_H
-
-#include &quot;Platform/ConfigHandler.h&quot;
-
-#ifdef __FreeBSD__
-#include &lt;sys/stat.h&gt;
-#endif
-
-#include &lt;stdio.h&gt;
-#include &lt;string&gt;
-#include &lt;map&gt;
-
-using std::string;
-
-/**
- * @brief DotfileHandler
- *
- * Linux dotfile handler config class, derived
- * from the abstract ConfigHandler.
- */
-class DotfileHandler: public ConfigHandler
-{
-public:
-
-	/**
-	 * @brief Constructor
-	 * @param fname path to config file
-	 */
-	DotfileHandler(const std::string&amp; fname);
-
-	/**
-	 * @brief Get the name of the default configuration file
-	 */
-	static string GetDefaultConfig();
-
-	/**
-	 * @brief Destructor
-	 */
-	virtual ~DotfileHandler();
-
-	/**
-	 * @brief set integer
-	 * @param name name of key to set
-	 * @param value integer value to set
-	 */
-	virtual void SetInt(std::string name, int value);
-
-	/**
-	 * @brief set string
-	 * @param name name of key to set
-	 * @param value string value to set
-	 */
-	virtual void SetString(std::string name, std::string value);
-
-	/**
-	 * @brief get string
-	 * @param name name of key to get
-	 * @param def default string value to use if key is not found
-	 * @return string value
-	 */
-	virtual std::string GetString(std::string name, std::string def);
-
-	/**
-	 * @brief get integer
-	 * @param name name of key to get
-	 * @param def default integer value to use if key is not found
-	 * @return integer value
-	 */
-	virtual int GetInt(std::string name, int def);
-
-private:
-
-	/**
-	 * @brief config file name
-	 */
-	std::string filename;
-
-	/**
-	 * @brief data map
-	 *
-	 * Map used to internally cache data
-	 * instead of constantly rereading from the file
-	 */
-	std::map&lt;string,string&gt; data;
-
-	// helper functions
-	void Read(FILE* file);
-	void Write(FILE* file);
-	char* Strip(char* begin, char* end);
-	void AppendLine(char* buf);
-};
-
-#endif /* _DOTFILEHANDLER_H */

Modified: trunk/rts/System/Platform/Linux/OpenALSound.cpp
===================================================================
--- trunk/rts/System/Platform/Linux/OpenALSound.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/Platform/Linux/OpenALSound.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -8,7 +8,7 @@
 #include &lt;AL/alc.h&gt;
 
 #include &quot;LogOutput.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
 #include &quot;Sim/Objects/WorldObject.h&quot;
 #include &quot;FileSystem/FileHandler.h&quot;
@@ -28,7 +28,7 @@
 {
 	Sources = NULL;
 
-	maxSounds = configHandler.GetInt(&quot;MaxSounds&quot;, 16);
+	maxSounds = configHandler.Get(&quot;MaxSounds&quot;, 16);
 	if (maxSounds &lt;= 0) {
 		throw content_error(&quot;Internal error, (maxSounds &lt;= 0) in COpenALSound&quot;);
 	}

Deleted: trunk/rts/System/Platform/Mac/UserDefsHandler.h
===================================================================
--- trunk/rts/System/Platform/Mac/UserDefsHandler.h	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/Platform/Mac/UserDefsHandler.h	2008-11-17 17:57:12 UTC (rev 7058)
@@ -1,26 +0,0 @@
-/*
- * ConfigHandler.cpp
- * Definition of PListHandler class
- * Copyright (C) 2006 Lorenz Pretterhofer
- */
-
-#ifndef USERDEFSHANDLER_H
-#define USERDEFSHANDLER_H
-
-#include &quot;Platform/ConfigHandler.h&quot;
-
-#import &quot;Foundation/NSDictionary.h&quot;
-
-class UserDefsHandler: public ConfigHandler
-{
-public:
-	virtual ~UserDefsHandler();
-	virtual void SetInt(std::string name, int value);
-	virtual void SetString(std::string name, std::string value);
-	virtual std::string GetString(std::string name, std::string def);
-	virtual int GetInt(std::string name, int def);
-	virtual float GetFloat(const std::string&amp; name, const float def);
-private:
-};
-
-#endif // USERDEFSHANDLER_H

Deleted: trunk/rts/System/Platform/Mac/UserDefsHandler.mm
===================================================================
--- trunk/rts/System/Platform/Mac/UserDefsHandler.mm	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/Platform/Mac/UserDefsHandler.mm	2008-11-17 17:57:12 UTC (rev 7058)
@@ -1,83 +0,0 @@
-/*
- * PListHandler.cpp
- * PlistHandler configuration class implementation
- * Copyright 2006 Lorenz Pretterhofer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">krysole at internode.on.net</A>&gt;
- */
-
-#include &quot;UserDefsHandler.h&quot;
-
-#import &quot;Foundation/Foundation.h&quot;
-
-UserDefsHandler::~UserDefsHandler()
-{
-	[[NSUserDefaults standardUserDefaults] synchronize];
-}
-
-void UserDefsHandler::SetInt(std::string name, int value)
-{
-	NSNumber *number;
-	NSString *key;
-	
-	key = [NSString stringWithCString:name.c_str() encoding:NSASCIIStringEncoding];
-	number = [NSNumber numberWithInt:value];
-	
-	[[NSUserDefaults standardUserDefaults] setObject:number forKey:key];
-}
-
-void UserDefsHandler::SetString(std::string name, std::string value)
-{
-	NSString *key, *val;
-	
-	key = [NSString stringWithCString:name.c_str() encoding:NSASCIIStringEncoding];
-	val = [NSString stringWithCString:value.c_str() encoding:NSASCIIStringEncoding];
-	
-	[[NSUserDefaults standardUserDefaults] setObject:val forKey:key];
-}
-
-std::string UserDefsHandler::GetString(std::string name, std::string def)
-{
-	NSString *key, *value;
-	
-	key = [NSString stringWithCString:name.c_str() encoding:NSASCIIStringEncoding];
-	
-	value = [[NSUserDefaults standardUserDefaults] objectForKey:key];
-	
-	if (value == nil) {
-		return def;
-	}
-	
-	// Won't throw with plain old c-strings
-	return [value cStringUsingEncoding:NSASCIIStringEncoding];
-}
-
-int UserDefsHandler::GetInt(std::string name, int def)
-{
-	NSString *key;
-	NSNumber *number;
-	
-	key = [NSString stringWithCString:name.c_str() encoding:NSASCIIStringEncoding];
-	
-	number = [[NSUserDefaults standardUserDefaults] objectForKey:key];
-	
-	if (number == nil) {
-		return def;
-	}
-	
-	return [number intValue];
-}
-
-float UserDefsHandler::GetFloat(const std::string&amp; name, const float def)
-{
-	NSString *key;
-	NSNumber *number;
-	
-	key = [NSString stringWithCString:name.c_str() encoding:NSASCIIStringEncoding];
-	
-	number = [[NSUserDefaults standardUserDefaults] objectForKey:key];
-	
-	if (number == nil) {
-		return def;
-	}
-	
-	return [number floatValue];
-}

Modified: trunk/rts/System/Platform/Win/DxSound.cpp
===================================================================
--- trunk/rts/System/Platform/Win/DxSound.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/Platform/Win/DxSound.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -9,7 +9,7 @@
 #endif
 
 #include &quot;LogOutput.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
 #include &quot;Sim/Objects/WorldObject.h&quot;
 #include &quot;DxSound.h&quot;
@@ -30,7 +30,7 @@
 
 CDxSound::CDxSound()
 {
-	maxSounds = configHandler.GetInt(&quot;MaxSounds&quot;, 16);
+	maxSounds = configHandler.Get(&quot;MaxSounds&quot;, 16);
 	if (maxSounds &lt;= 0) {
 		throw content_error(&quot;Internal error, (maxSounds &lt;= 0) in CDxSound&quot;);
 	}

Deleted: trunk/rts/System/Platform/Win/RegHandler.cpp
===================================================================
--- trunk/rts/System/Platform/Win/RegHandler.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/Platform/Win/RegHandler.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -1,64 +0,0 @@
-// RegHandler.cpp: implementation of the RegHandler class.
-//
-//////////////////////////////////////////////////////////////////////
-
-#include &quot;StdAfx.h&quot;
-#include &quot;RegHandler.h&quot;
-#include &lt;SDL_types.h&gt;
-#include &quot;mmgr.h&quot;
-
-using std::string;
-
-//////////////////////////////////////////////////////////////////////
-// Construction/Destruction
-//////////////////////////////////////////////////////////////////////
-
-RegHandler::RegHandler(string keyname, HKEY key)
-{
-	if (RegCreateKey(key, keyname.c_str(), &amp;regkey) != ERROR_SUCCESS)
-		MessageBox(0, &quot;Failed to create registry key&quot;, &quot;Registry error&quot;, 0);
-}
-
-RegHandler::~RegHandler()
-{
-	RegCloseKey(regkey);
-}
-
-
-int RegHandler::GetInt(string name, int def)
-{
-	unsigned char regbuf[100];
-	DWORD regLength=100; // this is windows specific stuff, so no need to use sdl types
-	DWORD regType=REG_DWORD;
-
-	if(RegQueryValueEx(regkey,name.c_str(),0,&amp;regType,regbuf,&amp;regLength)==ERROR_SUCCESS)
-		return *((int*)regbuf);
-	else
-		SetInt(name, def);
-		
-	return def;
-}
-
-string RegHandler::GetString(string name, string def)
-{
-	unsigned char regbuf[100];
-	DWORD regLength=100;
-	DWORD regType=REG_SZ;
-
-	if(RegQueryValueEx(regkey,name.c_str(),0,&amp;regType,regbuf,&amp;regLength)==ERROR_SUCCESS)
-		return string((char*)regbuf);
-	else
-		SetString(name, def);
-		
-	return def;
-}
-
-void RegHandler::SetString(string name, string value)
-{
-	RegSetValueEx(regkey,name.c_str(),0,REG_SZ,(unsigned char*)value.c_str(),value.size()+1);
-}
-
-void RegHandler::SetInt(string name, int value)
-{
-	RegSetValueEx(regkey,name.c_str(),0,REG_DWORD,(unsigned char*)&amp;value,sizeof(int));
-}

Deleted: trunk/rts/System/Platform/Win/RegHandler.h
===================================================================
--- trunk/rts/System/Platform/Win/RegHandler.h	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/Platform/Win/RegHandler.h	2008-11-17 17:57:12 UTC (rev 7058)
@@ -1,28 +0,0 @@
-// RegHandler.h: interface for the RegHandler class.
-//
-//////////////////////////////////////////////////////////////////////
-
-#ifndef REGHANDLER_H
-#define REGHANDLER_H
-
-#include &quot;Platform/ConfigHandler.h&quot;
-
-#include &lt;string&gt;
-#include &quot;win32.h&quot;
-#include &lt;winreg.h&gt;
-
-class RegHandler: public ConfigHandler 
-{
-public:
-	RegHandler(std::string keyname,HKEY key=HKEY_CURRENT_USER);
-	virtual ~RegHandler();
-	virtual void SetInt(std::string name, int value);
-	virtual void SetString(std::string name, std::string value);
-	virtual std::string GetString(std::string name, std::string def);
-	virtual int GetInt(std::string name, int def);
-protected:
-	HKEY regkey;
-};
-
-#endif // REGHANDLER_H
-

Modified: trunk/rts/System/Sound.cpp
===================================================================
--- trunk/rts/System/Sound.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/Sound.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -3,7 +3,7 @@
 #include &quot;Sound.h&quot;
 #include &quot;Sim/Units/Unit.h&quot;
 #include &quot;LogOutput.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Exceptions.h&quot;
 
 #ifdef _WIN32
@@ -21,7 +21,7 @@
 {
 	CSound* sound = NULL;
 
-	const int maxSounds = configHandler.GetInt(&quot;MaxSounds&quot;, 16);
+	const int maxSounds = configHandler.Get(&quot;MaxSounds&quot;, 16);
 	if (maxSounds &lt;= 0) {
 		logOutput.Print(&quot;Sound disabled with \&quot;MaxSounds=%i\&quot;&quot;, maxSounds);
 		return SAFE_NEW CNullSound;

Modified: trunk/rts/System/SpringApp.cpp
===================================================================
--- trunk/rts/System/SpringApp.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/rts/System/SpringApp.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -25,7 +25,7 @@
 #include &quot;Game/UI/KeyBindings.h&quot;
 #include &quot;Lua/LuaOpenGL.h&quot;
 #include &quot;Platform/BaseCmd.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;Platform/errorhandler.h&quot;
 #include &quot;FileSystem/FileSystem.h&quot;
 #include &quot;FileSystem/FileHandler.h&quot;
@@ -206,7 +206,7 @@
 
 	ParseCmdLine();
 
-	logOutput.SetMirrorToStdout(!!configHandler.GetInt(&quot;StdoutDebug&quot;,0));
+	logOutput.SetMirrorToStdout(!!configHandler.Get(&quot;StdoutDebug&quot;,0));
 
 	// log OS version
 	// TODO: improve version logging of non-Windows OSes
@@ -278,11 +278,11 @@
 	if (GLEW_ARB_texture_compression) {
 		// we don't even need to check it, 'cos groundtextures must have that extension
 		// default to off because it reduces quality (smallest mipmap level is bigger)
-		gu-&gt;compressTextures = !!configHandler.GetInt(&quot;CompressTextures&quot;, 0);
+		gu-&gt;compressTextures = !!configHandler.Get(&quot;CompressTextures&quot;, 0);
 	}
 
 	// use some ATI bugfixes?
-	gu-&gt;atiHacks = !!configHandler.GetInt(&quot;AtiHacks&quot;, (GLEW_ATI_envmap_bumpmap)?1:0 );
+	gu-&gt;atiHacks = !!configHandler.Get(&quot;AtiHacks&quot;, (GLEW_ATI_envmap_bumpmap)?1:0 );
 
 	// Initialize named texture handler
 	CNamedTextures::Init();
@@ -307,11 +307,11 @@
 {
 	if (!GL_ARB_multisample)
 		return false;
-	GLuint fsaa = configHandler.GetInt(&quot;FSAA&quot;,0);
+	GLuint fsaa = configHandler.Get(&quot;FSAA&quot;,0);
 	if (!fsaa)
 		return false;
 	SDL_GL_SetAttribute(SDL_GL_MULTISAMPLEBUFFERS,1);
-	GLuint fsaalevel = std::max(std::min(configHandler.GetInt(&quot;FSAALevel&quot;, 2), 8), 0);
+	GLuint fsaalevel = std::max(std::min(configHandler.Get(&quot;FSAALevel&quot;, 2), 8), 0);
 
 	make_even_number(fsaalevel);
 
@@ -377,7 +377,7 @@
 	//conditionally_set_flag(sdlflags, SDL_FULLSCREEN, fullscreen);
 	sdlflags |= fullscreen ? SDL_FULLSCREEN : 0;
 
-	int bitsPerPixel = configHandler.GetInt(&quot;BitsPerPixel&quot;, 0);
+	int bitsPerPixel = configHandler.Get(&quot;BitsPerPixel&quot;, 0);
 
 	if (bitsPerPixel == 32)
 	{
@@ -402,10 +402,10 @@
 #else
 	const int defaultDepthSize = 16;
 #endif
-	depthBufferBits = configHandler.GetInt(&quot;DepthBufferBits&quot;, defaultDepthSize);
+	depthBufferBits = configHandler.Get(&quot;DepthBufferBits&quot;, defaultDepthSize);
 
 	SDL_GL_SetAttribute(SDL_GL_DEPTH_SIZE, depthBufferBits);
-	SDL_GL_SetAttribute(SDL_GL_STENCIL_SIZE, configHandler.GetInt(&quot;StencilBufferBits&quot;, 1));
+	SDL_GL_SetAttribute(SDL_GL_STENCIL_SIZE, configHandler.Get(&quot;StencilBufferBits&quot;, 1));
 
 	SDL_GL_SetAttribute(SDL_GL_DOUBLEBUFFER, 1);
 
@@ -431,7 +431,7 @@
 
 	// setup GL smoothing
 	const int defaultSmooth = 0; // FSAA ? 0 : 3;  // until a few things get fixed
-	const int lineSmoothing = configHandler.GetInt(&quot;SmoothLines&quot;, defaultSmooth);
+	const int lineSmoothing = configHandler.Get(&quot;SmoothLines&quot;, defaultSmooth);
 	if (lineSmoothing &gt; 0) {
 		GLenum hint = GL_FASTEST;
 		if (lineSmoothing &gt;= 3) {
@@ -442,7 +442,7 @@
 		glEnable(GL_LINE_SMOOTH);
 		glHint(GL_LINE_SMOOTH_HINT, hint);
 	}
-	const int pointSmoothing = configHandler.GetInt(&quot;SmoothPoints&quot;, defaultSmooth);
+	const int pointSmoothing = configHandler.Get(&quot;SmoothPoints&quot;, defaultSmooth);
 	if (pointSmoothing &gt; 0) {
 		GLenum hint = GL_FASTEST;
 		if (pointSmoothing &gt;= 3) {
@@ -461,7 +461,7 @@
 	}
 
 	// there must be a way to see if this is necessary, compare old/new context pointers?
-	if (!!configHandler.GetInt(&quot;FixAltTab&quot;, 0)) {
+	if (!!configHandler.Get(&quot;FixAltTab&quot;, 0)) {
 		// free GL resources
 		GLContext::Free();
 
@@ -551,10 +551,10 @@
 		gu-&gt;winPosY = 0;
 	}
 
-	gu-&gt;dualScreenMode = !!configHandler.GetInt(&quot;DualScreenMode&quot;, 0);
+	gu-&gt;dualScreenMode = !!configHandler.Get(&quot;DualScreenMode&quot;, 0);
 	if (gu-&gt;dualScreenMode) {
 		gu-&gt;dualScreenMiniMapOnLeft =
-			!!configHandler.GetInt(&quot;DualScreenMiniMapOnLeft&quot;, 0);
+			!!configHandler.Get(&quot;DualScreenMiniMapOnLeft&quot;, 0);
 	} else {
 		gu-&gt;dualScreenMiniMapOnLeft = false;
 	}
@@ -608,8 +608,8 @@
 void SpringApp::LoadFonts()
 {
 	// Initialize font
-	const int charFirst = configHandler.GetInt(&quot;FontCharFirst&quot;, 32);
-	const int charLast  = configHandler.GetInt(&quot;FontCharLast&quot;, 255);
+	const int charFirst = configHandler.Get(&quot;FontCharFirst&quot;, 32);
+	const int charLast  = configHandler.Get(&quot;FontCharLast&quot;, 255);
 	std::string fontFile = configHandler.GetString(&quot;FontFile&quot;, &quot;fonts/Luxi.ttf&quot;);
 
 	const float fontSize = 0.027f;      // ~20 pixels at 1024x768
@@ -657,14 +657,12 @@
 	string configSource;
 	cmdline-&gt;result(&quot;config&quot;, configSource);
 	// it is not allowed to use configHandler before this line runs.
-	ConfigHandler::Instantiate(configSource);
+	logOutput.Print(&quot;using configuration source \&quot;&quot; + ConfigHandler::Instantiate(configSource) + &quot;\&quot;&quot;);
 
-	logOutput.Print(&quot;using configuration source \&quot;&quot; + configSource + &quot;\&quot;&quot;);
-
 #ifdef _DEBUG
 	fullscreen = false;
 #else
-	fullscreen = configHandler.GetInt(&quot;Fullscreen&quot;, 1) != 0;
+	fullscreen = configHandler.Get(&quot;Fullscreen&quot;, 1) != 0;
 #endif
 
 	// mutually exclusive options that cause spring to quit immediately
@@ -697,22 +695,22 @@
 
 
 	if (!cmdline-&gt;result(&quot;xresolution&quot;, screenWidth)) {
-		screenWidth = configHandler.GetInt(&quot;XResolution&quot;, XRES_DEFAULT);
+		screenWidth = configHandler.Get(&quot;XResolution&quot;, XRES_DEFAULT);
 	} else {
 		screenWidth = std::max(screenWidth, 1);
 	}
 
 	if (!cmdline-&gt;result(&quot;yresolution&quot;, screenHeight)) {
-		screenHeight = configHandler.GetInt(&quot;YResolution&quot;, YRES_DEFAULT);
+		screenHeight = configHandler.Get(&quot;YResolution&quot;, YRES_DEFAULT);
 	} else {
 		screenHeight = std::max(screenHeight, 1);
 	}
 
 #ifdef USE_GML
-	gmlThreadCountOverride = configHandler.GetInt(&quot;HardwareThreadCount&quot;, 0);
+	gmlThreadCountOverride = configHandler.Get(&quot;HardwareThreadCount&quot;, 0);
 #if GML_ENABLE_SIMLOOP
 	extern volatile int multiThreadSim;
-	multiThreadSim=configHandler.GetInt(&quot;MultiThreadSim&quot;, 1);
+	multiThreadSim=configHandler.Get(&quot;MultiThreadSim&quot;, 1);
 #endif
 #endif
 }

Modified: trunk/tools/DedicatedServer/CMakeLists.txt
===================================================================
--- trunk/tools/DedicatedServer/CMakeLists.txt	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/tools/DedicatedServer/CMakeLists.txt	2008-11-17 17:57:12 UTC (rev 7058)
@@ -4,21 +4,13 @@
 INCLUDE_DIRECTORIES(../../rts/System/Net/ ../../rts/System/ ../../rts/lib/lua/include)
 INCLUDE_DIRECTORIES(../../rts/ ../../rts/Game ../../rts/lib/7zip ../../rts/System)
 
-IF (UNIX)
-	SET(platformfiles
-		../../rts/System/Platform/Linux/DotfileHandler)
-ELSE (UNIX)
-	SET(platformfiles
-		../../rts/System/Platform/Win/RegHandler)
-ENDIF (UNIX)
-
 AUX_SOURCE_DIRECTORY(../../rts/System/FileSystem/ fsfiles)
 SET(system_files 
 	${fsfiles}
 	${platformfiles}
 	 ${netfiles}
 	../../rts/System/TdfParser
-	../../rts/System/Platform/ConfigHandler
+	../../rts/System/ConfigHandler
 	../../rts/System/LogOutput
 	../../rts/System/BaseNetProtocol
 	../../rts/System/Demo

Modified: trunk/tools/DedicatedServer/main.cpp
===================================================================
--- trunk/tools/DedicatedServer/main.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/tools/DedicatedServer/main.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -5,7 +5,7 @@
 #include &quot;System/FileSystem/ArchiveScanner.h&quot;
 #include &quot;System/FileSystem/VFSHandler.h&quot;
 #include &quot;System/FileSystem/FileHandler.h&quot;
-#include &quot;System/Platform/ConfigHandler.h&quot;
+#include &quot;System/ConfigHandler.h&quot;
 #include &quot;System/Exceptions.h&quot;
 #include &quot;System/UnsyncedRNG.h&quot;
 

Modified: trunk/tools/unitsync/CMakeLists.txt
===================================================================
--- trunk/tools/unitsync/CMakeLists.txt	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/tools/unitsync/CMakeLists.txt	2008-11-17 17:57:12 UTC (rev 7058)
@@ -37,15 +37,8 @@
 INCLUDE_DIRECTORIES(../../rts/System/Net/ ../../rts/lib/lua/include)
 INCLUDE_DIRECTORIES(../../rts/ ../../rts/Game ../../rts/lib/7zip ../../rts/System)
 
-IF (UNIX)
-	SET(platformfiles
-		../../rts/System/Platform/Linux/DotfileHandler)
-ELSE (UNIX)
-	SET(platformfiles
-		../../rts/System/Platform/Win/RegHandler)
-ENDIF (UNIX)
 list(APPEND platformfiles
-	../../rts/System/Platform/ConfigHandler)
+	../../rts/System/ConfigHandler)
 
 AUX_SOURCE_DIRECTORY(../../rts/System/FileSystem/ fsfiles)
 set(unitsync_files

Modified: trunk/tools/unitsync/javabind.cpp
===================================================================
--- trunk/tools/unitsync/javabind.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/tools/unitsync/javabind.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -6,7 +6,7 @@
 #include &quot;FileSystem/FileHandler.h&quot;
 #include &quot;FileSystem/VFSHandler.h&quot;
 #include &quot;Map/SMF/mapfile.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;FileSystem/FileSystem.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 

Modified: trunk/tools/unitsync/unitsync.cpp
===================================================================
--- trunk/tools/unitsync/unitsync.cpp	2008-11-17 04:06:23 UTC (rev 7057)
+++ trunk/tools/unitsync/unitsync.cpp	2008-11-17 17:57:12 UTC (rev 7058)
@@ -16,7 +16,7 @@
 #include &quot;Lua/LuaParser.h&quot;
 #include &quot;Map/MapParser.h&quot;
 #include &quot;Map/SMF/SmfMapFile.h&quot;
-#include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;ConfigHandler.h&quot;
 #include &quot;FileSystem/FileSystem.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;Sim/Misc/SideParser.h&quot;
@@ -2781,7 +2781,7 @@
 DLL_EXPORT int __stdcall GetSpringConfigInt( const char* name, const int defvalue )
 {
 	try {
-		return configHandler.GetInt( name, defvalue );
+		return configHandler.Get( name, defvalue );
 	}
 	UNITSYNC_CATCH_BLOCKS;
 	return defvalue;
@@ -2823,7 +2823,7 @@
 DLL_EXPORT void __stdcall SetSpringConfigInt(const char* name, const int value)
 {
 	try {
-		configHandler.SetInt( name, value );
+		configHandler.Set( name, value );
 	}
 	UNITSYNC_CATCH_BLOCKS;
 }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001826.html">[Taspring-linux-commit] r7057 - in trunk/rts: System/Platform/Win	lib/luabind/luabind/detail
</A></li>
	<LI>Next message: <A HREF="001828.html">[Taspring-linux-commit] r7059 - in trunk: rts/Game rts/Game/Camera	rts/Map rts/System tools/unitsync
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1827">[ date ]</a>
              <a href="thread.html#1827">[ thread ]</a>
              <a href="subject.html#1827">[ subject ]</a>
              <a href="author.html#1827">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
