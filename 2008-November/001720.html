<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r6951 - in branches/gmltest/rts: Game	Rendering Sim/Projectiles Sim/Projectiles/Unsynced	Sim/Projectiles/WeaponProjectiles Sim/Units System lib/gml
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r6951%20-%20in%20branches/gmltest/rts%3A%20Game%0A%09Rendering%20Sim/Projectiles%20Sim/Projectiles/Unsynced%0A%09Sim/Projectiles/WeaponProjectiles%20Sim/Units%20System%20lib/gml&In-Reply-To=%3C20081101194943.3396F4743%40progate.clan-sy.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001719.html">
   <LINK REL="Next"  HREF="001721.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r6951 - in branches/gmltest/rts: Game	Rendering Sim/Projectiles Sim/Projectiles/Unsynced	Sim/Projectiles/WeaponProjectiles Sim/Units System lib/gml</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r6951%20-%20in%20branches/gmltest/rts%3A%20Game%0A%09Rendering%20Sim/Projectiles%20Sim/Projectiles/Unsynced%0A%09Sim/Projectiles/WeaponProjectiles%20Sim/Units%20System%20lib/gml&In-Reply-To=%3C20081101194943.3396F4743%40progate.clan-sy.com%3E"
       TITLE="[Taspring-linux-commit] r6951 - in branches/gmltest/rts: Game	Rendering Sim/Projectiles Sim/Projectiles/Unsynced	Sim/Projectiles/WeaponProjectiles Sim/Units System lib/gml">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Sat Nov  1 20:49:43 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001719.html">[Taspring-linux-commit] r6950 - trunk/rts/Game
</A></li>
        <LI>Next message: <A HREF="001721.html">[Taspring-linux-commit] r6952 - in Lobby/TASClient: .	Python/scripts Python/scripts/layoutProfiles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1720">[ date ]</a>
              <a href="thread.html#1720">[ thread ]</a>
              <a href="subject.html#1720">[ subject ]</a>
              <a href="author.html#1720">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: zerver
Date: 2008-11-01 20:49:42 +0100 (Sat, 01 Nov 2008)
New Revision: 6951

Modified:
   branches/gmltest/rts/Game/ConsoleHistory.cpp
   branches/gmltest/rts/Rendering/GroundFlash.cpp
   branches/gmltest/rts/Rendering/GroundFlash.h
   branches/gmltest/rts/Sim/Projectiles/ExplosionGenerator.h
   branches/gmltest/rts/Sim/Projectiles/FireProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/FireProjectile.h
   branches/gmltest/rts/Sim/Projectiles/FlareProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/FlareProjectile.h
   branches/gmltest/rts/Sim/Projectiles/PieceProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/PieceProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Projectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Projectile.h
   branches/gmltest/rts/Sim/Projectiles/ProjectileHandler.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/BubbleProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/BubbleProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/DirtProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/DirtProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/GenericParticleProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/GenericParticleProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoThermSmokeProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoThermSmokeProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/GfxProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/GfxProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/MuzzleFlame.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/MuzzleFlame.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/RepulseGfx.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/RepulseGfx.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/SimpleParticleSystem.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/SimpleParticleSystem.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile2.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile2.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeTrailProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeTrailProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/TracerProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/TracerProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/WakeProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/WakeProjectile.h
   branches/gmltest/rts/Sim/Projectiles/Unsynced/WreckProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/Unsynced/WreckProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/BeamLaserProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/BeamLaserProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/EmgProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/EmgProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/ExplosiveProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/ExplosiveProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FireBallProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FireBallProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FlameProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FlameProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LargeBeamLaserProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LargeBeamLaserProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LaserProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LaserProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/MissileProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/MissileProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/StarburstProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/StarburstProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/TorpedoProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/TorpedoProjectile.h
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/WeaponProjectile.cpp
   branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/WeaponProjectile.h
   branches/gmltest/rts/Sim/Units/UnitHandler.cpp
   branches/gmltest/rts/System/LogOutput.cpp
   branches/gmltest/rts/System/SpringApp.cpp
   branches/gmltest/rts/lib/gml/gml.cpp
   branches/gmltest/rts/lib/gml/gml.h
Log:
try #8

Modified: branches/gmltest/rts/Game/ConsoleHistory.cpp
===================================================================
--- branches/gmltest/rts/Game/ConsoleHistory.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Game/ConsoleHistory.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -3,6 +3,7 @@
 //////////////////////////////////////////////////////////////////////
 
 #include &quot;StdAfx.h&quot;
+#include &quot;Rendering/GL/myGL.h&quot;
 
 #include &quot;mmgr.h&quot;
 
@@ -28,6 +29,8 @@
 
 void CConsoleHistory::ResetPosition()
 {
+	GML_STDMUTEX_LOCK(hist);
+
 	pos = lines.end();
 	return;
 }
@@ -35,6 +38,8 @@
 
 bool CConsoleHistory::AddLine(const std::string&amp; msg)
 {
+	GML_STDMUTEX_LOCK(hist);
+
 	std::string message;
 	if ((msg.find_first_of(&quot;aAsS&quot;) == 0) &amp;&amp; (msg[1] == ':')) {
 		message = msg.substr(2);
@@ -71,6 +76,8 @@
 
 std::string CConsoleHistory::NextLine(const std::string&amp; current)
 {
+	GML_STDMUTEX_LOCK(hist);
+
 	std::string prefix, message;
 	if ((current.find_first_of(&quot;aAsS&quot;) == 0) &amp;&amp; (current[1] == ':')) {
 		prefix  = current.substr(0, 2);
@@ -108,6 +115,8 @@
 
 std::string CConsoleHistory::PrevLine(const std::string&amp; current)
 {
+	GML_STDMUTEX_LOCK(hist);
+
 	std::string prefix, message;
 	if ((current.find_first_of(&quot;aAsS&quot;) == 0) &amp;&amp; (current[1] == ':')) {
 		prefix  = current.substr(0, 2);

Modified: branches/gmltest/rts/Rendering/GroundFlash.cpp
===================================================================
--- branches/gmltest/rts/Rendering/GroundFlash.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Rendering/GroundFlash.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -55,7 +55,7 @@
 
 CVertexArray* CGroundFlash::va=0;
 
-CGroundFlash::CGroundFlash(const float3&amp; p)
+CGroundFlash::CGroundFlash(const float3&amp; p GML_PARG_C)
 {
 	pos=p;
 	alwaysVisible=false;
@@ -69,8 +69,8 @@
 {
 }
 
-CStandardGroundFlash::CStandardGroundFlash(const float3&amp; p,float circleAlpha,float flashAlpha,float flashSize,float circleSpeed,float ttl, const float3&amp; col)
-	: CGroundFlash(p),
+CStandardGroundFlash::CStandardGroundFlash(const float3&amp; p,float circleAlpha,float flashAlpha,float flashSize,float circleSpeed,float ttl, const float3&amp; col GML_PARG_C)
+	: CGroundFlash(p GML_PARG_P),
 	circleAlpha(circleAlpha),
 	flashAlpha(flashAlpha),
 	flashSize(flashSize),
@@ -175,8 +175,8 @@
 	}
 }
 
-CSeismicGroundFlash::CSeismicGroundFlash(const float3&amp; p, AtlasedTexture texture, int ttl, int fade, float size, float sizeGrowth, float alpha, const float3&amp; col)
-	: CGroundFlash(p),
+CSeismicGroundFlash::CSeismicGroundFlash(const float3&amp; p, AtlasedTexture texture, int ttl, int fade, float size, float sizeGrowth, float alpha, const float3&amp; col GML_PARG_C)
+	: CGroundFlash(p GML_PARG_P),
 	sizeGrowth(sizeGrowth),
 	size(size),
 	texture(texture),
@@ -251,7 +251,7 @@
 {
 }
 
-void CSimpleGroundFlash::Init(const float3&amp; explosionPos, CUnit *owner)
+void CSimpleGroundFlash::Init(const float3&amp; explosionPos, CUnit *owner GML_PARG_C)
 {
 	pos += explosionPos;
 

Modified: branches/gmltest/rts/Rendering/GroundFlash.h
===================================================================
--- branches/gmltest/rts/Rendering/GroundFlash.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Rendering/GroundFlash.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -12,12 +12,12 @@
 public:
 	CR_DECLARE(CGroundFlash);
 
-	CGroundFlash(const float3&amp; p);
+	CGroundFlash(const float3&amp; p GML_PARG_H);
 	CGroundFlash();
 	virtual ~CGroundFlash(){};
 	virtual void Draw(){};
 	virtual bool Update(){return false;}; // returns false when it should be deleted
-	virtual void Init(const float3&amp; pos, CUnit *owner){};
+	virtual void Init(const float3&amp; pos, CUnit *owner GML_PARG_H){};
 
 	//bool alwaysVisible;
 	//float3 pos;
@@ -31,7 +31,7 @@
 	CR_DECLARE(CStandardGroundFlash);
 
 	CStandardGroundFlash();
-	CStandardGroundFlash(const float3&amp; pos, float circleAlpha,float flashAlpha,float flashSize,float circleSpeed,float ttl, const float3&amp; color=float3(1.0f,1.0f,0.7f));
+	CStandardGroundFlash(const float3&amp; pos, float circleAlpha,float flashAlpha,float flashSize,float circleSpeed,float ttl, const float3&amp; color=float3(1.0f,1.0f,0.7f) GML_PARG_H);
 	~CStandardGroundFlash();
 	void Draw();
 	bool Update(); // returns false when it should be deleted
@@ -58,7 +58,7 @@
 public:
 	CR_DECLARE(CSeismicGroundFlash);
 	~CSeismicGroundFlash();
-	CSeismicGroundFlash(const float3&amp; pos, AtlasedTexture texture, int ttl, int fade, float size, float sizeGrowth, float alpha, const float3&amp; col);
+	CSeismicGroundFlash(const float3&amp; pos, AtlasedTexture texture, int ttl, int fade, float size, float sizeGrowth, float alpha, const float3&amp; col GML_PARG_H);
 	void Draw();
 	bool Update(); // returns false when it should be deleted
 
@@ -82,7 +82,7 @@
 	CSimpleGroundFlash();
 	~CSimpleGroundFlash();
 
-	void Init(const float3&amp; explosionPos, CUnit *owner);
+	void Init(const float3&amp; explosionPos, CUnit *owner GML_PARG_H);
 	void Draw();
 	bool Update(); // returns false when it should be deleted
 

Modified: branches/gmltest/rts/Sim/Projectiles/ExplosionGenerator.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/ExplosionGenerator.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/ExplosionGenerator.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -1,6 +1,7 @@
 #ifndef EXPLOSION_GRAPHICS_H
 #define EXPLOSION_GRAPHICS_H
 
+#include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;Sim/Misc/DamageArray.h&quot;
 #include &quot;Lua/LuaParser.h&quot;
 #include &quot;Sim/Objects/WorldObject.h&quot;
@@ -18,7 +19,7 @@
 	CExpGenSpawnable(): CWorldObject(){};
 	CExpGenSpawnable(const float3&amp; pos): CWorldObject(pos) {};
 	virtual ~CExpGenSpawnable() {};
-	virtual void Init(const float3&amp; pos, CUnit* owner) = 0;
+	virtual void Init(const float3&amp; pos, CUnit* owner GML_PARG_H) = 0;
 };
 
 

Modified: branches/gmltest/rts/Sim/Projectiles/FireProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/FireProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/FireProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -39,8 +39,8 @@
 	));
 
 
-CFireProjectile::CFireProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner,int emitTtl,float emitRadius,int particleTtl,float particleSize)
-: CProjectile(pos,speed,owner, true),
+CFireProjectile::CFireProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner,int emitTtl,float emitRadius,int particleTtl,float particleSize GML_PARG_C)
+: CProjectile(pos,speed,owner, true GML_PARG_P),
 	ttl(emitTtl),
 	emitPos(pos),
 	emitRadius(emitRadius),

Modified: branches/gmltest/rts/Sim/Projectiles/FireProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/FireProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/FireProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -10,7 +10,7 @@
 	CR_DECLARE(CFireProjectile);
 	CR_DECLARE_SUB(SubParticle);
 public:
-	CFireProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner,int emitTtl,float emitRadius,int particleTtl,float particleSize);
+	CFireProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner,int emitTtl,float emitRadius,int particleTtl,float particleSize GML_PARG_H);
 	~CFireProjectile(void);
 
 	void Draw(void);

Modified: branches/gmltest/rts/Sim/Projectiles/FlareProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/FlareProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/FlareProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -28,8 +28,8 @@
 				CR_RESERVED(8)
 				));
 
-CFlareProjectile::CFlareProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner,int activateFrame)
-:	CProjectile(pos,speed,owner, true),
+CFlareProjectile::CFlareProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner,int activateFrame GML_PARG_C)
+:	CProjectile(pos,speed,owner, true GML_PARG_P),
 	activateFrame(activateFrame),
 	deathFrame(activateFrame+(owner?owner-&gt;unitDef-&gt;flareTime:1)),
 	numSub(0),

Modified: branches/gmltest/rts/Sim/Projectiles/FlareProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/FlareProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/FlareProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -9,7 +9,7 @@
 {
 public:
 	CR_DECLARE(CFlareProjectile);
-	CFlareProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner,int activateFrame);
+	CFlareProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner,int activateFrame GML_PARG_H);
 	~CFlareProjectile();
 	void Update(void);
 	void Draw(void);

Modified: branches/gmltest/rts/Sim/Projectiles/PieceProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/PieceProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/PieceProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -58,8 +58,8 @@
 	}
 }
 
-CPieceProjectile::CPieceProjectile(const float3&amp; pos, const float3&amp; speed, LocalS3DO* piece, int f, CUnit* owner, float radius):
-	CProjectile(pos, speed, owner, true),
+CPieceProjectile::CPieceProjectile(const float3&amp; pos, const float3&amp; speed, LocalS3DO* piece, int f, CUnit* owner, float radius GML_PARG_C):
+	CProjectile(pos, speed, owner, true GML_PARG_P),
 	dispList(piece? piece-&gt;displist: 0),
 	drawTrail(true),
 	oldSmoke(pos),

Modified: branches/gmltest/rts/Sim/Projectiles/PieceProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/PieceProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/PieceProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -46,7 +46,7 @@
 	int colorTeam;
 	
 public:
-	CPieceProjectile(const float3&amp; pos, const float3&amp; speed, LocalS3DO* piece, int flags, CUnit* owner, float radius);
+	CPieceProjectile(const float3&amp; pos, const float3&amp; speed, LocalS3DO* piece, int flags, CUnit* owner, float radius GML_PARG_H);
 	virtual ~CPieceProjectile(void);
 	void Update();
 	void Draw();

Modified: branches/gmltest/rts/Sim/Projectiles/Projectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Projectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Projectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -49,7 +49,7 @@
 }
 
 
-void CProjectile::Init(const float3&amp; explosionPos, CUnit* owner)
+void CProjectile::Init(const float3&amp; explosionPos, CUnit* owner GML_PARG_C)
 {
 	pos += explosionPos;
 	SetRadius(1.7f);
@@ -61,7 +61,7 @@
 }
 
 
-CProjectile::CProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner, bool synced, bool weapon)
+CProjectile::CProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner, bool synced, bool weapon GML_PARG_C)
 :	CExpGenSpawnable(pos),
 	owner(owner),
 	speed(speed),

Modified: branches/gmltest/rts/Sim/Projectiles/Projectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Projectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Projectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -33,14 +33,14 @@
 
 	virtual void Draw();
 	CProjectile(); // default constructor is needed for creg
-	CProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner, bool synced, bool weapon = false);
+	CProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner, bool synced, bool weapon = false GML_PARG_H);
 	virtual void Collision();
 	virtual void Collision(CUnit* unit);
 	virtual void Collision(CFeature* feature);
 	virtual ~CProjectile();
 	virtual void Update();
 	void DependentDied(CObject* o);
-	virtual void Init(const float3&amp; pos, CUnit* owner);
+	virtual void Init(const float3&amp; pos, CUnit* owner GML_PARG_H);
 
 	bool synced;
 	bool weapon;

Modified: branches/gmltest/rts/Sim/Projectiles/ProjectileHandler.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/ProjectileHandler.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/ProjectileHandler.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -717,7 +717,7 @@
 
 void CProjectileHandler::AddProjectile(CProjectile* p)
 {
-	GML_RECMUTEX_LOCK(proj); // AddProjectile
+//	GML_RECMUTEX_LOCK(proj); // AddProjectile
 
 	ps.push_back(p);
 
@@ -830,7 +830,7 @@
 
 void CProjectileHandler::AddGroundFlash(CGroundFlash* flash)
 {
-	GML_RECMUTEX_LOCK(proj); // AddGroundFlash
+//	GML_RECMUTEX_LOCK(proj); // AddGroundFlash
 	groundFlashes.push_back(flash);
 }
 

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -81,9 +81,9 @@
 		deleteMe = true;
 }
 
-void CBitmapMuzzleFlame::Init(const float3 &amp;pos, CUnit *owner)
+void CBitmapMuzzleFlame::Init(const float3 &amp;pos, CUnit *owner GML_PARG_C)
 {
-	CProjectile::Init(pos, owner);
+	CProjectile::Init(pos, owner GML_PARG_P);
 	life = 0;
 	createTime = gs-&gt;frameNum;
 	invttl = 1.0f/(float)ttl;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -13,7 +13,7 @@
 	~CBitmapMuzzleFlame(void);
 	void Draw(void);
 	void Update(void);
-	virtual void Init(const float3 &amp;pos, CUnit *owner);
+	virtual void Init(const float3 &amp;pos, CUnit *owner GML_PARG_H);
 
 	AtlasedTexture *sideTexture;
 	AtlasedTexture *frontTexture;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/BubbleProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/BubbleProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/BubbleProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -19,8 +19,8 @@
 	));
 
 
-CBubbleProjectile::CBubbleProjectile(float3 pos,float3 speed,float ttl,float startSize,float sizeExpansion, CUnit* owner, float alpha)
-: CProjectile(pos,speed,owner, false),
+CBubbleProjectile::CBubbleProjectile(float3 pos,float3 speed,float ttl,float startSize,float sizeExpansion, CUnit* owner, float alpha GML_PARG_C)
+: CProjectile(pos,speed,owner, false GML_PARG_P),
 	alpha(alpha),
 	startSize(startSize),
 	size(startSize*0.4f),

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/BubbleProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/BubbleProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/BubbleProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -8,7 +8,7 @@
 {
 	CR_DECLARE(CBubbleProjectile);
 public:
-	CBubbleProjectile(float3 pos,float3 speed,float ttl,float startSize,float sizeExpansion, CUnit* owner,float alpha);
+	CBubbleProjectile(float3 pos,float3 speed,float ttl,float startSize,float sizeExpansion, CUnit* owner,float alpha GML_PARG_H);
 	virtual ~CBubbleProjectile();
 	void Update();
 	void Draw();

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/DirtProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/DirtProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/DirtProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -32,8 +32,8 @@
 // Construction/Destruction
 //////////////////////////////////////////////////////////////////////
 
-CDirtProjectile::CDirtProjectile(const float3 pos,const float3 speed,const float ttl,const float size,const float expansion,float slowdown,CUnit* owner,const float3&amp; color)
-: CProjectile(pos,speed,owner, false),
+CDirtProjectile::CDirtProjectile(const float3 pos,const float3 speed,const float ttl,const float size,const float expansion,float slowdown,CUnit* owner,const float3&amp; color GML_PARG_C)
+: CProjectile(pos,speed,owner, false GML_PARG_P),
 	alpha(255),
 	size(size),
 	sizeExpansion(expansion),

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/DirtProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/DirtProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/DirtProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -16,7 +16,7 @@
 	virtual void Draw();
 	virtual void Update();
 	CDirtProjectile();
-	CDirtProjectile(const float3 pos,const float3 speed,const float ttl,const float size,const float expansion,float slowdown,CUnit* owner,const float3&amp; color);
+	CDirtProjectile(const float3 pos,const float3 speed,const float ttl,const float size,const float expansion,float slowdown,CUnit* owner,const float3&amp; color GML_PARG_H);
 	virtual ~CDirtProjectile();
 
 	float alpha;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -28,8 +28,8 @@
 	synced=false;
 }
 
-CExploSpikeProjectile::CExploSpikeProjectile(const float3&amp; pos,const float3&amp; speed,float length,float width,float alpha,float alphaDecay,CUnit* owner)
-:	CProjectile(pos,speed,owner, false),
+CExploSpikeProjectile::CExploSpikeProjectile(const float3&amp; pos,const float3&amp; speed,float length,float width,float alpha,float alphaDecay,CUnit* owner GML_PARG_C)
+:	CProjectile(pos,speed,owner, false GML_PARG_P),
 	length(length),
 	width(width),
 	alpha(alpha),
@@ -86,9 +86,9 @@
 	va-&gt;AddVertexTC(drawPos-l+w, ph-&gt;laserendtex.xstart, ph-&gt;laserendtex.yend, col);
 }
 
-void CExploSpikeProjectile::Init(const float3&amp; pos, CUnit *owner)
+void CExploSpikeProjectile::Init(const float3&amp; pos, CUnit *owner GML_PARG_C)
 {
-	CProjectile::Init(pos, owner);
+	CProjectile::Init(pos, owner GML_PARG_P);
 
 	lengthGrowth=dir.Length()*(0.5f+gu-&gt;usRandFloat()*0.4f);
 	dir/=lengthGrowth;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -9,7 +9,7 @@
 	CR_DECLARE(CExploSpikeProjectile);
 public:
 	CExploSpikeProjectile();
-	CExploSpikeProjectile(const float3&amp; pos,const float3&amp; speed,float length,float width,float alpha,float alphaDecay,CUnit* owner);
+	CExploSpikeProjectile(const float3&amp; pos,const float3&amp; speed,float length,float width,float alpha,float alphaDecay,CUnit* owner GML_PARG_H);
 	~CExploSpikeProjectile(void);
 	void Update(void);
 	void Draw(void);
@@ -22,7 +22,7 @@
 	float3 dir;
 	float3 color;
 
-	virtual void Init(const float3&amp; pos, CUnit *owner);
+	virtual void Init(const float3&amp; pos, CUnit *owner GML_PARG_H);
 };
 
 #endif

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/GenericParticleProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/GenericParticleProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/GenericParticleProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -24,8 +24,8 @@
 	CR_RESERVED(8)
 	));
 
-CGenericParticleProjectile::CGenericParticleProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner) :
-	CProjectile(pos, speed, owner, false)
+CGenericParticleProjectile::CGenericParticleProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner GML_PARG_C) :
+	CProjectile(pos, speed, owner, false GML_PARG_P)
 {
 	deleteMe=false;
 	checkCol=false;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/GenericParticleProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/GenericParticleProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/GenericParticleProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -9,7 +9,7 @@
 {
 	CR_DECLARE(CGenericParticleProjectile);
 public:
-	CGenericParticleProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner);
+	CGenericParticleProjectile(const float3&amp; pos,const float3&amp; speed,CUnit* owner GML_PARG_H);
 	~CGenericParticleProjectile(void);
 
 	virtual void Update();

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -23,8 +23,8 @@
 	CR_RESERVED(8)
 	));
 
-CGeoSquareProjectile::CGeoSquareProjectile(const float3&amp; p1,const float3&amp; p2,const float3&amp; v1,const float3&amp; v2,float w1,float w2)
-: CProjectile((p1+p2)*0.5f,ZeroVector,0, false),
+CGeoSquareProjectile::CGeoSquareProjectile(const float3&amp; p1,const float3&amp; p2,const float3&amp; v1,const float3&amp; v2,float w1,float w2 GML_PARG_C)
+: CProjectile((p1+p2)*0.5f,ZeroVector,0, false GML_PARG_P),
 	p1(p1),
 	p2(p2),
 	v1(v1),

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -7,7 +7,7 @@
 {
 	CR_DECLARE(CGeoSquareProjectile);
 public:
-	CGeoSquareProjectile(const float3&amp; p1,const float3&amp; p2,const float3&amp; v1,const float3&amp; v2,float w1,float w2);
+	CGeoSquareProjectile(const float3&amp; p1,const float3&amp; p2,const float3&amp; v1,const float3&amp; v2,float w1,float w2 GML_PARG_H);
 	virtual ~CGeoSquareProjectile(void);
 
 	float3 p1,p2,v1,v2;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoThermSmokeProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoThermSmokeProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoThermSmokeProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -12,8 +12,8 @@
 	CR_RESERVED(8)
 	));
 
-CGeoThermSmokeProjectile::CGeoThermSmokeProjectile(const float3&amp; pos,const float3&amp; speed,int ttl, CFeature* geo)
-: CSmokeProjectile(pos,speed,ttl,6,0.35f,0,0.8f), geo(geo)
+CGeoThermSmokeProjectile::CGeoThermSmokeProjectile(const float3&amp; pos,const float3&amp; speed,int ttl, CFeature* geo GML_PARG_C)
+: CSmokeProjectile(pos,speed,ttl,6,0.35f,0,0.8f GML_PARG_P), geo(geo)
 {}
 
 void CGeoThermSmokeProjectile::Update()

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoThermSmokeProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoThermSmokeProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/GeoThermSmokeProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -9,7 +9,7 @@
 {
 	CR_DECLARE(CGeoThermSmokeProjectile)
 public:
-	CGeoThermSmokeProjectile(const float3&amp; pos,const float3&amp; speed,int ttl,CFeature *geo);
+	CGeoThermSmokeProjectile(const float3&amp; pos,const float3&amp; speed,int ttl,CFeature *geo GML_PARG_H);
 	void Update();
 	CFeature *geo;
 

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/GfxProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/GfxProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/GfxProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -35,8 +35,8 @@
 	synced=false;
 }
 
-CGfxProjectile::CGfxProjectile(const float3&amp; pos,const float3&amp; speed,int lifeTime,const float3&amp; color)
-: CProjectile(pos,speed,0, false),
+CGfxProjectile::CGfxProjectile(const float3&amp; pos,const float3&amp; speed,int lifeTime,const float3&amp; color GML_PARG_C)
+: CProjectile(pos,speed,0, false GML_PARG_P),
 	lifeTime(lifeTime),
 	creationTime(gs-&gt;frameNum)
 {

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/GfxProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/GfxProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/GfxProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -14,7 +14,7 @@
 	void Update();
 	void Draw();
 	CGfxProjectile();
-	CGfxProjectile(const float3&amp; pos,const float3&amp; speed,int lifeTime,const float3&amp; color);
+	CGfxProjectile(const float3&amp; pos,const float3&amp; speed,int lifeTime,const float3&amp; color GML_PARG_H);
 	virtual ~CGfxProjectile();
 
 	int creationTime;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -40,8 +40,8 @@
 	texture = &amp;ph-&gt;heatcloudtex;
 }
 
-CHeatCloudProjectile::CHeatCloudProjectile(const float3 pos,const float3 speed,const  float temperature,const float size, CUnit* owner)
-: CProjectile(pos,speed,owner, false),
+CHeatCloudProjectile::CHeatCloudProjectile(const float3 pos,const float3 speed,const  float temperature,const float size, CUnit* owner GML_PARG_C)
+: CProjectile(pos,speed,owner, false GML_PARG_P),
 	heat(temperature),
 	maxheat(temperature),
 	heatFalloff(1),

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -15,7 +15,7 @@
 	virtual void Draw();
 	virtual void Update();
 	CHeatCloudProjectile();
-	CHeatCloudProjectile(const float3 pos,const float3 speed,const float temperature,const float size, CUnit* owner);  //projectile start at size 0 and ends at size size
+	CHeatCloudProjectile(const float3 pos,const float3 speed,const float temperature,const float size, CUnit* owner GML_PARG_H);  //projectile start at size 0 and ends at size size
 	virtual ~CHeatCloudProjectile();
 
 	float heat;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/MuzzleFlame.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/MuzzleFlame.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/MuzzleFlame.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -26,8 +26,8 @@
 //	s.Serialize(randSmokeDir, numSmoke*sizeof(float3));
 }
 
-CMuzzleFlame::CMuzzleFlame(const float3&amp; pos,const float3&amp; speed,const float3&amp; dir,float size)
-: CProjectile(pos,speed,0, false),
+CMuzzleFlame::CMuzzleFlame(const float3&amp; pos,const float3&amp; speed,const float3&amp; dir,float size GML_PARG_C)
+: CProjectile(pos,speed,0, false GML_PARG_P),
 	size(size),
 	dir(dir),
 	age(0)

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/MuzzleFlame.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/MuzzleFlame.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/MuzzleFlame.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -10,7 +10,7 @@
 
 	void creg_Serialize(creg::ISerializer&amp; s);
 public:
-	CMuzzleFlame(const float3&amp; pos,const float3&amp; speed,const float3&amp; dir,float size);
+	CMuzzleFlame(const float3&amp; pos,const float3&amp; speed,const float3&amp; dir,float size GML_PARG_H);
 	~CMuzzleFlame(void);
 
 	void Draw(void);

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/RepulseGfx.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/RepulseGfx.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/RepulseGfx.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -19,8 +19,8 @@
 	CR_RESERVED(8)
 	));
 
-CRepulseGfx::CRepulseGfx(CUnit* owner,CProjectile* repulsed,float maxDist,float3 color)
-: CProjectile(repulsed?repulsed-&gt;pos:float3(0,0,0),repulsed?repulsed-&gt;speed:float3(0,0,0),owner, false),
+CRepulseGfx::CRepulseGfx(CUnit* owner,CProjectile* repulsed,float maxDist,float3 color GML_PARG_C)
+: CProjectile(repulsed?repulsed-&gt;pos:float3(0,0,0),repulsed?repulsed-&gt;speed:float3(0,0,0),owner, false GML_PARG_P),
 	repulsed(repulsed),
 	age(0),
 	sqMaxDist(maxDist*maxDist+100),

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/RepulseGfx.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/RepulseGfx.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/RepulseGfx.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -10,7 +10,7 @@
 {
 	CR_DECLARE(CRepulseGfx);
 public:
-	CRepulseGfx(CUnit* owner,CProjectile* repulsed,float maxDist,float3 color);
+	CRepulseGfx(CUnit* owner,CProjectile* repulsed,float maxDist,float3 color GML_PARG_H);
 	~CRepulseGfx(void);
 
 	void DependentDied(CObject* o);

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -22,8 +22,8 @@
 
 CShieldPartProjectile::CShieldPartProjectile(
 	const float3&amp; centerPos, int xpart, int ypart, float sphereSize,
-	float3 color, float alpha, AtlasedTexture* texture, CUnit* owner):
-	CProjectile(centerPos, ZeroVector, owner, false),
+	float3 color, float alpha, AtlasedTexture* texture, CUnit* owner GML_PARG_C):
+	CProjectile(centerPos, ZeroVector, owner, false GML_PARG_P),
 	centerPos(centerPos),
 	sphereSize(sphereSize),
 	baseAlpha(alpha),

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -10,7 +10,7 @@
 {
 	CR_DECLARE(CShieldPartProjectile);
 public:
-	CShieldPartProjectile(const float3&amp; centerPos,int xpart,int ypart,float size,float3 color,float alpha, AtlasedTexture *texture,CUnit* owner);
+	CShieldPartProjectile(const float3&amp; centerPos,int xpart,int ypart,float size,float3 color,float alpha, AtlasedTexture *texture,CUnit* owner GML_PARG_H);
 	~CShieldPartProjectile(void);
 	void Draw(void);
 	void Update(void);

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/SimpleParticleSystem.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/SimpleParticleSystem.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/SimpleParticleSystem.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -141,9 +141,9 @@
 
 }
 
-void CSimpleParticleSystem::Init(const float3&amp; explosionPos, CUnit *owner)
+void CSimpleParticleSystem::Init(const float3&amp; explosionPos, CUnit *owner GML_PARG_C)
 {
-	CProjectile::Init(explosionPos, owner);
+	CProjectile::Init(explosionPos, owner GML_PARG_P);
 
 	particles = new Particle[numParticles];
 

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/SimpleParticleSystem.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/SimpleParticleSystem.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/SimpleParticleSystem.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -16,7 +16,7 @@
 
 	CSimpleParticleSystem(void);
 	virtual ~CSimpleParticleSystem(void);
-	virtual void Init(const float3&amp; explosionPos, CUnit *owner);
+	virtual void Init(const float3&amp; explosionPos, CUnit *owner GML_PARG_H);
 
 	float3 emitVector;
 	float3 emitMul;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -41,7 +41,7 @@
 	synced=false;
 }
 
-void CSmokeProjectile::Init(const float3&amp; pos, CUnit *owner)
+void CSmokeProjectile::Init(const float3&amp; pos, CUnit *owner GML_PARG_C)
 {
 	textureNum=(int)(gu-&gt;usRandInt() % ph-&gt;smoketex.size());
 
@@ -51,11 +51,11 @@
 	if(!owner)
 		alwaysVisible=true;
 
-	CProjectile::Init(pos, owner);
+	CProjectile::Init(pos, owner GML_PARG_P);
 }
 
-CSmokeProjectile::CSmokeProjectile(const float3&amp; pos,const float3&amp; speed,float ttl,float startSize,float sizeExpansion, CUnit* owner, float color)
-: CProjectile(pos, speed, owner, false),
+CSmokeProjectile::CSmokeProjectile(const float3&amp; pos,const float3&amp; speed,float ttl,float startSize,float sizeExpansion, CUnit* owner, float color GML_PARG_C)
+: CProjectile(pos, speed, owner, false GML_PARG_P),
 	color(color),
 	age(0),
 	startSize(startSize),

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -13,9 +13,9 @@
 
 	void Update();
 	void Draw();
-	void Init(const float3&amp; pos, CUnit *owner);
+	void Init(const float3&amp; pos, CUnit *owner GML_PARG_H);
 	CSmokeProjectile();
-	CSmokeProjectile(const float3&amp; pos,const float3&amp; speed,float ttl,float startSize,float sizeExpansion, CUnit* owner,float color=0.7f);
+	CSmokeProjectile(const float3&amp; pos,const float3&amp; speed,float ttl,float startSize,float sizeExpansion, CUnit* owner,float color=0.7f GML_PARG_H);
 	virtual ~CSmokeProjectile();
 
 	float color;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile2.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile2.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile2.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -44,7 +44,7 @@
 	synced=false;
 }
 
-void CSmokeProjectile2::Init(const float3&amp; pos, CUnit *owner)
+void CSmokeProjectile2::Init(const float3&amp; pos, CUnit *owner GML_PARG_C)
 {
 	textureNum=(int)(gu-&gt;usRandInt() % ph-&gt;smoketex.size());
 
@@ -56,11 +56,11 @@
 
 	wantedPos += pos;
 
-	CProjectile::Init(pos, owner);
+	CProjectile::Init(pos, owner GML_PARG_P);
 }
 
-CSmokeProjectile2::CSmokeProjectile2(float3 pos,float3 wantedPos,float3 speed,float ttl,float startSize,float sizeExpansion, CUnit* owner, float color)
-: CProjectile(pos,speed,owner, false),
+CSmokeProjectile2::CSmokeProjectile2(float3 pos,float3 wantedPos,float3 speed,float ttl,float startSize,float sizeExpansion, CUnit* owner, float color GML_PARG_C)
+: CProjectile(pos,speed,owner, false GML_PARG_P),
 	wantedPos(wantedPos),
 	color(color),
 	age(0),

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile2.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile2.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeProjectile2.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -13,9 +13,9 @@
 
 	void Update();
 	void Draw();
-	void Init(const float3&amp; pos, CUnit *owner);
+	void Init(const float3&amp; pos, CUnit *owner GML_PARG_H);
 	CSmokeProjectile2();
-	CSmokeProjectile2(float3 pos,float3 wantedPos,float3 speed,float ttl,float startSize,float sizeExpansion, CUnit* owner,float color=0.7f);
+	CSmokeProjectile2(float3 pos,float3 wantedPos,float3 speed,float ttl,float startSize,float sizeExpansion, CUnit* owner,float color=0.7f GML_PARG_H);
 	virtual ~CSmokeProjectile2();
 
 	float color;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeTrailProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeTrailProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeTrailProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -45,8 +45,8 @@
 // Construction/Destruction
 //////////////////////////////////////////////////////////////////////
 
-CSmokeTrailProjectile::CSmokeTrailProjectile(const float3&amp; pos1,const float3&amp; pos2,const float3&amp; dir1,const float3&amp; dir2, CUnit* owner,bool firstSegment,bool lastSegment,float size,float time,float color,bool drawTrail,CProjectile* drawCallback,AtlasedTexture* texture)
-: CProjectile((pos1+pos2)*0.5f,ZeroVector,owner, false),
+CSmokeTrailProjectile::CSmokeTrailProjectile(const float3&amp; pos1,const float3&amp; pos2,const float3&amp; dir1,const float3&amp; dir2, CUnit* owner,bool firstSegment,bool lastSegment,float size,float time,float color,bool drawTrail,CProjectile* drawCallback,AtlasedTexture* texture GML_PARG_C)
+: CProjectile((pos1+pos2)*0.5f,ZeroVector,owner, false GML_PARG_P),
 	pos1(pos1),
 	pos2(pos2),
 	creationTime(gs-&gt;frameNum),

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeTrailProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeTrailProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/SmokeTrailProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -14,7 +14,7 @@
 public:
 	void Update();
 	void Draw();
-	CSmokeTrailProjectile(const float3&amp; pos1,const float3&amp; pos2,const float3&amp; dir1,const float3&amp; dir2, CUnit* owner,bool firstSegment,bool lastSegment,float size=1,float time=80,float color=0.7f,bool drawTrail=true,CProjectile* drawCallback=0,AtlasedTexture* texture=0);
+	CSmokeTrailProjectile(const float3&amp; pos1,const float3&amp; pos2,const float3&amp; dir1,const float3&amp; dir2, CUnit* owner,bool firstSegment,bool lastSegment,float size=1,float time=80,float color=0.7f,bool drawTrail=true,CProjectile* drawCallback=0,AtlasedTexture* texture=0 GML_PARG_H);
 	virtual ~CSmokeTrailProjectile();
 
 	float3 pos1;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -29,8 +29,8 @@
 	CR_RESERVED(16)
 	));
 
-CSpherePartProjectile::CSpherePartProjectile(const float3&amp; centerPos,int xpart,int ypart,float expansionSpeed,float alpha,int ttl,CUnit* owner,const float3 &amp;color)
-: CProjectile(centerPos,ZeroVector,owner, false),
+CSpherePartProjectile::CSpherePartProjectile(const float3&amp; centerPos,int xpart,int ypart,float expansionSpeed,float alpha,int ttl,CUnit* owner,const float3 &amp;color GML_PARG_C)
+: CProjectile(centerPos,ZeroVector,owner, false GML_PARG_P),
 	centerPos(centerPos),
 	expansionSpeed(expansionSpeed),
 	sphereSize(expansionSpeed),
@@ -129,9 +129,9 @@
 	CR_MEMBER_ENDFLAG(CM_Config)
 ));
 
-void CSpherePartSpawner::Init(const float3&amp; pos, CUnit *owner)
+void CSpherePartSpawner::Init(const float3&amp; pos, CUnit *owner GML_PARG_C)
 {
-	CProjectile::Init(pos, owner);
+	CProjectile::Init(pos, owner GML_PARG_P);
 	deleteMe = true;
 	CSpherePartProjectile::CreateSphere(pos, alpha, ttl, expansionSpeed, owner, color);
 }

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -8,7 +8,7 @@
 {
 	CR_DECLARE(CSpherePartProjectile);
 public:
-	CSpherePartProjectile(const float3&amp; centerPos,int xpart,int ypart,float expansionSpeed,float alpha,int ttl,CUnit* owner,const float3 &amp;color);
+	CSpherePartProjectile(const float3&amp; centerPos,int xpart,int ypart,float expansionSpeed,float alpha,int ttl,CUnit* owner,const float3 &amp;color GML_PARG_H);
 	~CSpherePartProjectile(void);
 
 	float3 centerPos;
@@ -44,7 +44,7 @@
 	CSpherePartSpawner();
 	~CSpherePartSpawner();
 
-	virtual void Init(const float3&amp; pos, CUnit *owner);
+	virtual void Init(const float3&amp; pos, CUnit *owner GML_PARG_H);
 };
 
 #endif /* SPHEREPARTPROJECTILE_H */

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/TracerProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/TracerProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/TracerProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -26,8 +26,8 @@
 // Construction/Destruction
 //////////////////////////////////////////////////////////////////////
 
-CTracerProjectile::CTracerProjectile(const float3 pos, const float3 speed,const float range,CUnit* owner)
-: CProjectile(pos,speed,owner, false)
+CTracerProjectile::CTracerProjectile(const float3 pos, const float3 speed,const float range,CUnit* owner GML_PARG_C)
+: CProjectile(pos,speed,owner, false GML_PARG_P)
 {
 	SetRadius(1);
 	speedf=this-&gt;speed.Length();
@@ -44,13 +44,13 @@
 	checkCol=false;
 }
 
-void CTracerProjectile::Init(const float3&amp; pos, CUnit* owner)
+void CTracerProjectile::Init(const float3&amp; pos, CUnit* owner GML_PARG_C)
 {
 	speedf=this-&gt;speed.Length();
 	if (speedf==0.0f) speed=float3(1.0f,0.0f,0.0f);
 	dir=this-&gt;speed/speedf;
 
-	CProjectile::Init (pos, owner);
+	CProjectile::Init (pos, owner GML_PARG_P);
 }
 
 CTracerProjectile::~CTracerProjectile()

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/TracerProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/TracerProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/TracerProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -13,9 +13,9 @@
 
 	void Draw();
 	void Update();
-	void Init(const float3&amp; pos, CUnit *owner);
+	void Init(const float3&amp; pos, CUnit *owner GML_PARG_H);
 	CTracerProjectile();
-	CTracerProjectile(const float3 pos,const float3 speed,const float range,CUnit* owner);
+	CTracerProjectile(const float3 pos,const float3 speed,const float range,CUnit* owner GML_PARG_H);
 	virtual ~CTracerProjectile();
 	float speedf;
 	float length;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/WakeProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/WakeProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/WakeProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -28,8 +28,8 @@
 // Construction/Destruction
 //////////////////////////////////////////////////////////////////////
 
-CWakeProjectile::CWakeProjectile(const float3 pos,const float3 speed,float startSize,float sizeExpansion, CUnit* owner, float alpha,float alphaFalloff,float fadeupTime)
-: CProjectile(pos,speed,owner, false),
+CWakeProjectile::CWakeProjectile(const float3 pos,const float3 speed,float startSize,float sizeExpansion, CUnit* owner, float alpha,float alphaFalloff,float fadeupTime GML_PARG_C)
+: CProjectile(pos,speed,owner, false GML_PARG_P),
 	alpha(0),
 	alphaAdd(alpha/fadeupTime),
 	alphaAddTime((int)fadeupTime),

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/WakeProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/WakeProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/WakeProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -8,7 +8,7 @@
 {
 	CR_DECLARE(CWakeProjectile);
 public:
-	CWakeProjectile(const float3 pos,const float3 speed,float startSize,float sizeExpansion, CUnit* owner,float alpha,float alphaFalloff,float fadeupTime);
+	CWakeProjectile(const float3 pos,const float3 speed,float startSize,float sizeExpansion, CUnit* owner,float alpha,float alphaFalloff,float fadeupTime GML_PARG_H);
 	virtual ~CWakeProjectile();
 	void Update();
 	void Draw();

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/WreckProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/WreckProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/WreckProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -25,8 +25,8 @@
 // Construction/Destruction
 //////////////////////////////////////////////////////////////////////
 
-CWreckProjectile::CWreckProjectile(float3 pos,float3 speed,float temperature,CUnit* owner)
-: CProjectile(pos,speed,owner, false)
+CWreckProjectile::CWreckProjectile(float3 pos,float3 speed,float temperature,CUnit* owner GML_PARG_C)
+: CProjectile(pos,speed,owner, false GML_PARG_P)
 {
 	checkCol=false;
 	drawRadius=2;

Modified: branches/gmltest/rts/Sim/Projectiles/Unsynced/WreckProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/Unsynced/WreckProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/Unsynced/WreckProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -11,7 +11,7 @@
 public:
 	CR_DECLARE(CWreckProjectile);
 	void Update();
-	CWreckProjectile(float3 pos,float3 speed,float temperature,CUnit* owner);
+	CWreckProjectile(float3 pos,float3 speed,float temperature,CUnit* owner GML_PARG_H);
 	virtual ~CWreckProjectile();
 
 	void Draw(void);

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/BeamLaserProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/BeamLaserProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/BeamLaserProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -29,9 +29,9 @@
 CBeamLaserProjectile::CBeamLaserProjectile(const float3&amp; startPos, const float3&amp; endPos,
 	float startAlpha, float endAlpha, const float3&amp; color, const float3&amp; color2,
 	CUnit* owner, float thickness, float corethickness, float flaresize,
-	const WeaponDef* weaponDef, int ttl, float decay):
+	const WeaponDef* weaponDef, int ttl, float decay GML_PARG_C):
 
-	CWeaponProjectile((startPos + endPos) * 0.5f, ZeroVector, owner, 0, ZeroVector, weaponDef, 0, false,  ttl),
+	CWeaponProjectile((startPos + endPos) * 0.5f, ZeroVector, owner, 0, ZeroVector, weaponDef, 0, false,  ttl GML_PARG_P),
 	startPos(startPos),
 	endPos(endPos),
 	thickness(thickness),

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/BeamLaserProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/BeamLaserProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/BeamLaserProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -10,7 +10,7 @@
 	CBeamLaserProjectile(const float3&amp; startPos, const float3&amp; endPos,
 		float startAlpha, float endAlpha, const float3&amp; color, const float3&amp; color2,
 		CUnit* owner, float thickness, float corethickness, float flaresize,
-		const WeaponDef* weaponDef, int ttl, float decay);
+		const WeaponDef* weaponDef, int ttl, float decay GML_PARG_H);
 	~CBeamLaserProjectile(void);
 
 	float3 startPos;

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/EmgProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/EmgProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/EmgProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -20,8 +20,8 @@
 
 CEmgProjectile::CEmgProjectile(const float3&amp; pos, const float3&amp; speed,
 		CUnit* owner, const float3&amp; color, float intensity, int ttl,
-		const WeaponDef* weaponDef):
-	CWeaponProjectile(pos, speed, owner, 0, ZeroVector, weaponDef, 0, true,  ttl),
+		const WeaponDef* weaponDef GML_PARG_C):
+	CWeaponProjectile(pos, speed, owner, 0, ZeroVector, weaponDef, 0, true,  ttl GML_PARG_P),
 	color(color),
 	intensity(intensity)
 {

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/EmgProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/EmgProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/EmgProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -10,7 +10,7 @@
 	CR_DECLARE(CEmgProjectile);
 public:
 	CEmgProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner, const float3&amp; color,
-		float intensity, int ttl, const WeaponDef *weaponDef);
+		float intensity, int ttl, const WeaponDef *weaponDef GML_PARG_H);
 	virtual ~CEmgProjectile();
 	void Update(void);
 	void Draw(void);

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/ExplosiveProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/ExplosiveProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/ExplosiveProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -34,8 +34,8 @@
 
 CExplosiveProjectile::CExplosiveProjectile(const float3&amp; pos,
 		const float3&amp; speed, CUnit* owner, const WeaponDef *weaponDef, int ttl,
-		float areaOfEffect, float gravity):
-	CWeaponProjectile(pos, speed, owner, 0, ZeroVector, weaponDef, 0, true,  ttl),
+		float areaOfEffect, float gravity GML_PARG_C):
+	CWeaponProjectile(pos, speed, owner, 0, ZeroVector, weaponDef, 0, true,  ttl GML_PARG_P),
 	areaOfEffect(areaOfEffect),
 	curTime(0),
 	gravity(gravity)

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/ExplosiveProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/ExplosiveProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/ExplosiveProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -14,7 +14,7 @@
 public:
 	CExplosiveProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner,
 		const WeaponDef *weaponDef, int ttl = 100000, float areaOfEffect = 8,
-		float gravity = 0);
+		float gravity = 0 GML_PARG_H);
 	virtual ~CExplosiveProjectile();
 	virtual void Update();
 	void Draw(void);

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FireBallProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FireBallProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FireBallProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -28,8 +28,8 @@
 	));
 
 CFireBallProjectile::CFireBallProjectile(const float3&amp; pos, const float3&amp; speed,
-		CUnit* owner, CUnit* target, const float3 &amp;targetPos, const WeaponDef* weaponDef):
-	CWeaponProjectile(pos, speed, owner, target, targetPos, weaponDef, 0, true,  1)
+		CUnit* owner, CUnit* target, const float3 &amp;targetPos, const WeaponDef* weaponDef GML_PARG_C):
+	CWeaponProjectile(pos, speed, owner, target, targetPos, weaponDef, 0, true,  1 GML_PARG_P)
 {
 	if (weaponDef) {
 		SetRadius(weaponDef-&gt;collisionSize);

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FireBallProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FireBallProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FireBallProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -11,7 +11,7 @@
 	CR_DECLARE_SUB(Spark);
 public:
 	CFireBallProjectile(const float3&amp; pos,const float3&amp; speed, CUnit* owner,
-			CUnit *target, const float3 &amp;targetPos, const WeaponDef* weaponDef);
+			CUnit *target, const float3 &amp;targetPos, const WeaponDef* weaponDef GML_PARG_H);
 	~CFireBallProjectile(void);
 
 	void Draw();

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FlameProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FlameProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FlameProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -25,8 +25,8 @@
 
 
 CFlameProjectile::CFlameProjectile(const float3&amp; pos, const float3&amp; speed, const float3&amp; spread,
-		CUnit* owner, const WeaponDef* weaponDef, int ttl):
-	CWeaponProjectile(pos, speed, owner, 0, ZeroVector, weaponDef, 0, true,  ttl),
+		CUnit* owner, const WeaponDef* weaponDef, int ttl GML_PARG_C):
+	CWeaponProjectile(pos, speed, owner, 0, ZeroVector, weaponDef, 0, true,  ttl GML_PARG_P),
 	color(color),
 	color2(color2),
 	intensity(intensity),

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FlameProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FlameProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/FlameProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -10,7 +10,7 @@
 	CR_DECLARE(CFlameProjectile);
 public:
 	CFlameProjectile(const float3&amp; pos, const float3&amp; speed, const float3&amp; spread,
-		CUnit* owner, const WeaponDef* weaponDef, int ttl = 50);
+		CUnit* owner, const WeaponDef* weaponDef, int ttl = 50 GML_PARG_H);
 	~CFlameProjectile(void);
 	float3 color;
 	float3 color2;

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LargeBeamLaserProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LargeBeamLaserProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LargeBeamLaserProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -29,8 +29,8 @@
 	));
 
 CLargeBeamLaserProjectile::CLargeBeamLaserProjectile(const float3&amp; startPos, const float3&amp; endPos,
-		const float3&amp; color, const float3&amp; color2, CUnit* owner, const WeaponDef* weaponDef):
-	CWeaponProjectile(startPos + (endPos - startPos) * 0.5f, ZeroVector, owner, 0, ZeroVector, weaponDef, 0, false,  1),
+		const float3&amp; color, const float3&amp; color2, CUnit* owner, const WeaponDef* weaponDef GML_PARG_C):
+	CWeaponProjectile(startPos + (endPos - startPos) * 0.5f, ZeroVector, owner, 0, ZeroVector, weaponDef, 0, false,  1 GML_PARG_P),
 	startPos(startPos),
 	endPos(endPos),
 	decay(1.0f)

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LargeBeamLaserProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LargeBeamLaserProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LargeBeamLaserProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -9,7 +9,7 @@
 	CR_DECLARE(CLargeBeamLaserProjectile);
 public:
 	CLargeBeamLaserProjectile(const float3&amp; startPos, const float3&amp; endPos, const float3&amp; color, const float3&amp; color2,
-		CUnit* owner, const WeaponDef* weaponDef);
+		CUnit* owner, const WeaponDef* weaponDef GML_PARG_H);
 	~CLargeBeamLaserProjectile(void);
 
 	float3 startPos;

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LaserProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LaserProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LaserProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -33,8 +33,8 @@
 
 CLaserProjectile::CLaserProjectile(const float3&amp; pos, const float3&amp; speed,
 		CUnit* owner, float length, const float3&amp; color, const float3&amp; color2,
-		float intensity, const WeaponDef *weaponDef, int ttl)
-: CWeaponProjectile(pos,speed,owner,0,ZeroVector,weaponDef,0, true,  ttl),
+		float intensity, const WeaponDef *weaponDef, int ttl GML_PARG_C)
+: CWeaponProjectile(pos,speed,owner,0,ZeroVector,weaponDef,0, true,  ttl GML_PARG_P),
 	color(color),
 	color2(color2),
 	length(length),

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LaserProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LaserProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LaserProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -11,7 +11,7 @@
 public:
 	CLaserProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner,float length,
 		const float3&amp; color, const float3&amp; color2, float intensity, const WeaponDef *weaponDef,
-		int ttl = 1000);
+		int ttl = 1000 GML_PARG_H);
 	virtual ~CLaserProjectile();
 	void Draw(void);
 	void Update(void);

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -26,8 +26,8 @@
 
 CLightingProjectile::CLightingProjectile(const float3&amp; pos, const float3&amp; end,
 		CUnit* owner, const float3&amp; color, const WeaponDef *weaponDef,
-		int ttl, CWeapon* weap):
-	CWeaponProjectile(pos, ZeroVector, owner, 0, ZeroVector, weaponDef, 0, true,  ttl),
+		int ttl, CWeapon* weap GML_PARG_C):
+	CWeaponProjectile(pos, ZeroVector, owner, 0, ZeroVector, weaponDef, 0, true,  ttl GML_PARG_P),
 	color(color),
 	endPos(end),
 	weapon(weap)

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -11,7 +11,7 @@
 	CR_DECLARE(CLightingProjectile);
 public:
 	CLightingProjectile(const float3&amp; pos, const float3&amp; end, CUnit* owner, const float3&amp; color,
-		const WeaponDef *weaponDef, int ttl = 10, CWeapon* weap = 0);
+		const WeaponDef *weaponDef, int ttl = 10, CWeapon* weap = 0 GML_PARG_H);
 	~CLightingProjectile(void);
 
 	float3 color;

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/MissileProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/MissileProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/MissileProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -57,8 +57,8 @@
 
 CMissileProjectile::CMissileProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner,
 		float areaOfEffect, float maxSpeed, int ttl, CUnit* target, const WeaponDef *weaponDef,
-		float3 targetPos):
-	CWeaponProjectile(pos, speed, owner, target, targetPos, weaponDef, 0, true,  ttl),
+		float3 targetPos GML_PARG_C):
+	CWeaponProjectile(pos, speed, owner, target, targetPos, weaponDef, 0, true,  ttl GML_PARG_P),
 	maxSpeed(maxSpeed),
 	target(target),
 	dir(speed),

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/MissileProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/MissileProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/MissileProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -14,7 +14,7 @@
 	void UpdateGroundBounce();
 public:
 	CMissileProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner, float areaOfEffect,
-		float maxSpeed, int ttl, CUnit* target, const WeaponDef *weaponDef, float3 targetPos);
+		float maxSpeed, int ttl, CUnit* target, const WeaponDef *weaponDef, float3 targetPos GML_PARG_H);
 	~CMissileProjectile(void);
 	void DependentDied(CObject* o);
 	void Collision(CUnit* unit);

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/StarburstProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/StarburstProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/StarburstProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -56,8 +56,8 @@
 
 CStarburstProjectile::CStarburstProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner,
 		float3 targetPos, float areaOfEffect, float maxSpeed, float tracking, int uptime, CUnit* target,
-		const WeaponDef* weaponDef, CWeaponProjectile* interceptTarget, float maxdistance, float3 aimError):
-	CWeaponProjectile(pos, speed, owner, target, targetPos, weaponDef, interceptTarget, true,  200),
+		const WeaponDef* weaponDef, CWeaponProjectile* interceptTarget, float maxdistance, float3 aimError GML_PARG_C):
+	CWeaponProjectile(pos, speed, owner, target, targetPos, weaponDef, interceptTarget, true,  200 GML_PARG_P),
 	maxSpeed(maxSpeed),
 	tracking(tracking),
 	dir(speed),

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/StarburstProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/StarburstProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/StarburstProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -16,7 +16,7 @@
 	CStarburstProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner,
 			float3 targetPos,float areaOfEffect, float maxSpeed,float tracking,
 			int uptime, CUnit* target, const WeaponDef* weaponDef,
-			CWeaponProjectile* interceptTarget, float maxdistance, float3 aimError);
+			CWeaponProjectile* interceptTarget, float maxdistance, float3 aimError GML_PARG_H);
 	~CStarburstProjectile(void);
 	void Collision(CUnit* unit);
 	void Collision();

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/TorpedoProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/TorpedoProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/TorpedoProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -36,8 +36,8 @@
 
 CTorpedoProjectile::CTorpedoProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner,
 		float areaOfEffect, float maxSpeed, float tracking, int ttl, CUnit* target,
-		const WeaponDef *weaponDef):
-	CWeaponProjectile(pos, speed, owner, target, ZeroVector, weaponDef, 0, true,  ttl),
+		const WeaponDef *weaponDef GML_PARG_C):
+	CWeaponProjectile(pos, speed, owner, target, ZeroVector, weaponDef, 0, true,  ttl GML_PARG_P),
 	maxSpeed(maxSpeed),
 	tracking(tracking),
 	target(target),

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/TorpedoProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/TorpedoProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/TorpedoProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -10,7 +10,7 @@
 	CR_DECLARE(CTorpedoProjectile);
 public:
 	CTorpedoProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner, float areaOfEffect,
-		float maxSpeed, float tracking, int ttl, CUnit* target, const WeaponDef* weaponDef);
+		float maxSpeed, float tracking, int ttl, CUnit* target, const WeaponDef* weaponDef GML_PARG_H);
 	~CTorpedoProjectile(void);
 	void DependentDied(CObject* o);
 	void Collision(CUnit* unit);

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/WeaponProjectile.cpp
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/WeaponProjectile.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/WeaponProjectile.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -64,8 +64,8 @@
 CWeaponProjectile::CWeaponProjectile(const float3&amp; pos, const float3&amp; speed,
 		CUnit* owner, CUnit* target, const float3 &amp;targetPos,
 		const WeaponDef* weaponDef, CWeaponProjectile* interceptTarget,
-		bool synced, int ttl):
-	CProjectile(pos, speed, owner, synced, true),
+		bool synced, int ttl GML_PARG_C):
+	CProjectile(pos, speed, owner, synced, true GML_PARG_P),
 	weaponDef(weaponDef),
 	weaponDefName(weaponDef? weaponDef-&gt;name: std::string(&quot;&quot;)),
 	target(target),

Modified: branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/WeaponProjectile.h
===================================================================
--- branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/WeaponProjectile.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Projectiles/WeaponProjectiles/WeaponProjectile.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -16,7 +16,7 @@
 	CWeaponProjectile();
 	CWeaponProjectile(const float3&amp; pos, const float3&amp; speed, CUnit* owner,
 			CUnit* target, const float3 &amp;targetPos, const WeaponDef *weaponDef,
-			CWeaponProjectile* interceptTarget, bool synced, int ttl = 1);
+			CWeaponProjectile* interceptTarget, bool synced, int ttl = 1 GML_PARG_H);
 	virtual ~CWeaponProjectile();
 
 	virtual void Collision();

Modified: branches/gmltest/rts/Sim/Units/UnitHandler.cpp
===================================================================
--- branches/gmltest/rts/Sim/Units/UnitHandler.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/Sim/Units/UnitHandler.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -104,7 +104,7 @@
 	CR_MEMBER(metalMakerEfficiency),
 	CR_MEMBER(toBeRemoved),
 	CR_MEMBER(morphUnitToFeature),
-	CR_MEMBER(toBeRemoved),
+//	CR_MEMBER(toBeRemoved),
 	CR_MEMBER(toBeAdded),
 	CR_MEMBER(renderUnits),
 	CR_MEMBER(builderCAIs),

Modified: branches/gmltest/rts/System/LogOutput.cpp
===================================================================
--- branches/gmltest/rts/System/LogOutput.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/System/LogOutput.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -1,4 +1,5 @@
 #include &quot;StdAfx.h&quot;
+#include &quot;Rendering/GL/myGL.h&quot;
 
 #include &quot;LogOutput.h&quot;
 
@@ -40,17 +41,23 @@
 
 void CLogOutput::End()
 {
+	GML_STDMUTEX_LOCK(log);
+
 	delete filelog;
 	filelog = 0;
 }
 
 void CLogOutput::SetMirrorToStdout(bool value)
 {
+	GML_STDMUTEX_LOCK(log);
+
 	stdoutDebug = value;
 }
 
 void CLogOutput::Output(int zone, const char *str)
 {
+	GML_STDMUTEX_LOCK(log);
+
 	if (!initialized) {
 		filelog = new std::ofstream(&quot;infolog.txt&quot;);
 		initialized = true;
@@ -91,22 +98,30 @@
 
 void CLogOutput::SetLastMsgPos(const float3&amp; pos)
 {
+	GML_STDMUTEX_LOCK(log);
+
 	for(std::vector&lt;ILogSubscriber*&gt;::iterator lsi=subscribers.begin();lsi!=subscribers.end();++lsi)
 		(*lsi)-&gt;SetLastMsgPos(pos);
 }
 
 void CLogOutput::AddSubscriber(ILogSubscriber* ls)
 {
+	GML_STDMUTEX_LOCK(log);
+
 	subscribers.push_back(ls);
 }
 
 void CLogOutput::RemoveAllSubscribers()
 {
+	GML_STDMUTEX_LOCK(log);
+
 	subscribers.clear();
 }
 
 void CLogOutput::RemoveSubscriber(ILogSubscriber *ls)
 {
+	GML_STDMUTEX_LOCK(log);
+
 	subscribers.erase(std::find(subscribers.begin(),subscribers.end(),ls));
 }
 

Modified: branches/gmltest/rts/System/SpringApp.cpp
===================================================================
--- branches/gmltest/rts/System/SpringApp.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/System/SpringApp.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -1062,14 +1062,21 @@
 					}
 					break;
 				}
-				case SDL_MOUSEMOTION:
+				case SDL_MOUSEMOTION: {
+					mouseInput-&gt;HandleSDLMouseEvent (event);
+					break;
+				}
 				case SDL_MOUSEBUTTONDOWN:
 				case SDL_MOUSEBUTTONUP:
 				case SDL_SYSWMEVENT: {
+//					GML_STDMUTEX_LOCK(sim);
+
 					mouseInput-&gt;HandleSDLMouseEvent (event);
 					break;
 				}
 				case SDL_KEYDOWN: {
+//					GML_STDMUTEX_LOCK(sim);
+
 					int i = event.key.keysym.sym;
 					currentUnicode = event.key.keysym.unicode;
 
@@ -1118,6 +1125,8 @@
 					break;
 				}
 				case SDL_KEYUP: {
+//					GML_STDMUTEX_LOCK(sim);
+
 					int i = event.key.keysym.sym;
 					currentUnicode = event.key.keysym.unicode;
 

Modified: branches/gmltest/rts/lib/gml/gml.cpp
===================================================================
--- branches/gmltest/rts/lib/gml/gml.cpp	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/lib/gml/gml.cpp	2008-11-01 19:49:42 UTC (rev 6951)
@@ -205,6 +205,8 @@
 boost::mutex rendermutex;
 boost::mutex simmutex;
 boost::mutex netmutex;
+boost::mutex histmutex;
+boost::mutex logmutex;
 
 #include &lt;boost/thread/recursive_mutex.hpp&gt;
 boost::recursive_mutex unitmutex;

Modified: branches/gmltest/rts/lib/gml/gml.h
===================================================================
--- branches/gmltest/rts/lib/gml/gml.h	2008-11-01 17:42:47 UTC (rev 6950)
+++ branches/gmltest/rts/lib/gml/gml.h	2008-11-01 19:49:42 UTC (rev 6951)
@@ -166,6 +166,8 @@
 extern boost::mutex rendermutex;
 extern boost::mutex simmutex;
 extern boost::mutex netmutex;
+extern boost::mutex histmutex;
+extern boost::mutex logmutex;
 
 #include &lt;boost/thread/recursive_mutex.hpp&gt;
 extern boost::recursive_mutex unitmutex;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001719.html">[Taspring-linux-commit] r6950 - trunk/rts/Game
</A></li>
	<LI>Next message: <A HREF="001721.html">[Taspring-linux-commit] r6952 - in Lobby/TASClient: .	Python/scripts Python/scripts/layoutProfiles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1720">[ date ]</a>
              <a href="thread.html#1720">[ thread ]</a>
              <a href="subject.html#1720">[ subject ]</a>
              <a href="author.html#1720">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
