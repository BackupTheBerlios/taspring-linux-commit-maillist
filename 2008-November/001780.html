<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r7011 - trunk/tools/unitsync
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7011%20-%20trunk/tools/unitsync&In-Reply-To=%3C20081110193954.04F834768%40progate.clan-sy.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001779.html">
   <LINK REL="Next"  HREF="001781.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r7011 - trunk/tools/unitsync</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7011%20-%20trunk/tools/unitsync&In-Reply-To=%3C20081110193954.04F834768%40progate.clan-sy.com%3E"
       TITLE="[Taspring-linux-commit] r7011 - trunk/tools/unitsync">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Mon Nov 10 20:39:53 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001779.html">[Taspring-linux-commit] r7010 - in trunk/rts: Game Rendering/GL
</A></li>
        <LI>Next message: <A HREF="001781.html">[Taspring-linux-commit] r7012 - trunk/tools/unitsync
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1780">[ date ]</a>
              <a href="thread.html#1780">[ thread ]</a>
              <a href="subject.html#1780">[ subject ]</a>
              <a href="author.html#1780">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: tvo
Date: 2008-11-10 20:39:53 +0100 (Mon, 10 Nov 2008)
New Revision: 7011

Added:
   trunk/tools/unitsync/Doxyfile
Modified:
   trunk/tools/unitsync/unitsync.cpp
   trunk/tools/unitsync/unitsync.h
Log:
* Added lots of doxygen comments + Doxyfile to create reasonable apidox.
* Added missing return keyword in ReadFileVFS
* ReadArchiveFile returns -1 on error now, instead of 0,
  this allows one to differentiate between EOF and error.



Added: trunk/tools/unitsync/Doxyfile
===================================================================
--- trunk/tools/unitsync/Doxyfile	                        (rev 0)
+++ trunk/tools/unitsync/Doxyfile	2008-11-10 19:39:53 UTC (rev 7011)
@@ -0,0 +1,241 @@
+# Doxyfile 1.5.5
+
+#---------------------------------------------------------------------------
+# Project related configuration options
+#---------------------------------------------------------------------------
+DOXYFILE_ENCODING      = UTF-8
+PROJECT_NAME           = Unitsync
+PROJECT_NUMBER         = 
+OUTPUT_DIRECTORY       = doc
+CREATE_SUBDIRS         = NO
+OUTPUT_LANGUAGE        = English
+BRIEF_MEMBER_DESC      = YES
+REPEAT_BRIEF           = NO
+ABBREVIATE_BRIEF       = 
+ALWAYS_DETAILED_SEC    = NO
+INLINE_INHERITED_MEMB  = NO
+FULL_PATH_NAMES        = NO
+STRIP_FROM_PATH        = 
+STRIP_FROM_INC_PATH    = 
+SHORT_NAMES            = NO
+JAVADOC_AUTOBRIEF      = NO
+QT_AUTOBRIEF           = NO
+MULTILINE_CPP_IS_BRIEF = NO
+DETAILS_AT_TOP         = NO
+INHERIT_DOCS           = YES
+SEPARATE_MEMBER_PAGES  = NO
+TAB_SIZE               = 4
+ALIASES                = 
+OPTIMIZE_OUTPUT_FOR_C  = NO
+OPTIMIZE_OUTPUT_JAVA   = NO
+OPTIMIZE_FOR_FORTRAN   = NO
+OPTIMIZE_OUTPUT_VHDL   = NO
+BUILTIN_STL_SUPPORT    = YES
+CPP_CLI_SUPPORT        = NO
+SIP_SUPPORT            = NO
+DISTRIBUTE_GROUP_DOC   = NO
+SUBGROUPING            = YES
+TYPEDEF_HIDES_STRUCT   = NO
+#---------------------------------------------------------------------------
+# Build related configuration options
+#---------------------------------------------------------------------------
+EXTRACT_ALL            = NO
+EXTRACT_PRIVATE        = NO
+EXTRACT_STATIC         = NO
+EXTRACT_LOCAL_CLASSES  = NO
+EXTRACT_LOCAL_METHODS  = NO
+EXTRACT_ANON_NSPACES   = NO
+HIDE_UNDOC_MEMBERS     = YES
+HIDE_UNDOC_CLASSES     = YES
+HIDE_FRIEND_COMPOUNDS  = NO
+HIDE_IN_BODY_DOCS      = NO
+INTERNAL_DOCS          = NO
+CASE_SENSE_NAMES       = YES
+HIDE_SCOPE_NAMES       = NO
+SHOW_INCLUDE_FILES     = YES
+INLINE_INFO            = YES
+SORT_MEMBER_DOCS       = YES
+SORT_BRIEF_DOCS        = NO
+SORT_GROUP_NAMES       = NO
+SORT_BY_SCOPE_NAME     = NO
+GENERATE_TODOLIST      = YES
+GENERATE_TESTLIST      = YES
+GENERATE_BUGLIST       = YES
+GENERATE_DEPRECATEDLIST= YES
+ENABLED_SECTIONS       = 
+MAX_INITIALIZER_LINES  = 30
+SHOW_USED_FILES        = YES
+SHOW_DIRECTORIES       = YES
+FILE_VERSION_FILTER    = 
+#---------------------------------------------------------------------------
+# configuration options related to warning and progress messages
+#---------------------------------------------------------------------------
+QUIET                  = NO
+WARNINGS               = YES
+WARN_IF_UNDOCUMENTED   = NO
+WARN_IF_DOC_ERROR      = YES
+WARN_NO_PARAMDOC       = NO
+WARN_FORMAT            = &quot;$file:$line: $text  &quot;
+WARN_LOGFILE           = 
+#---------------------------------------------------------------------------
+# configuration options related to the input files
+#---------------------------------------------------------------------------
+INPUT                  = unitsync.cpp \
+                         unitsync.h
+INPUT_ENCODING         = UTF-8
+FILE_PATTERNS          = 
+RECURSIVE              = NO
+EXCLUDE                = 
+EXCLUDE_SYMLINKS       = NO
+EXCLUDE_PATTERNS       = 
+EXCLUDE_SYMBOLS        = 
+EXAMPLE_PATH           = 
+EXAMPLE_PATTERNS       = 
+EXAMPLE_RECURSIVE      = NO
+IMAGE_PATH             = 
+INPUT_FILTER           = 
+FILTER_PATTERNS        = 
+FILTER_SOURCE_FILES    = NO
+#---------------------------------------------------------------------------
+# configuration options related to source browsing
+#---------------------------------------------------------------------------
+SOURCE_BROWSER         = NO
+INLINE_SOURCES         = NO
+STRIP_CODE_COMMENTS    = YES
+REFERENCED_BY_RELATION = YES
+REFERENCES_RELATION    = YES
+REFERENCES_LINK_SOURCE = YES
+USE_HTAGS              = NO
+VERBATIM_HEADERS       = NO
+#---------------------------------------------------------------------------
+# configuration options related to the alphabetical class index
+#---------------------------------------------------------------------------
+ALPHABETICAL_INDEX     = NO
+COLS_IN_ALPHA_INDEX    = 5
+IGNORE_PREFIX          = 
+#---------------------------------------------------------------------------
+# configuration options related to the HTML output
+#---------------------------------------------------------------------------
+GENERATE_HTML          = YES
+HTML_OUTPUT            = html
+HTML_FILE_EXTENSION    = .html
+HTML_HEADER            = 
+HTML_FOOTER            = 
+HTML_STYLESHEET        = 
+HTML_ALIGN_MEMBERS     = YES
+GENERATE_HTMLHELP      = NO
+GENERATE_DOCSET        = NO
+DOCSET_FEEDNAME        = &quot;Doxygen generated docs&quot;
+DOCSET_BUNDLE_ID       = org.doxygen.Project
+HTML_DYNAMIC_SECTIONS  = NO
+CHM_FILE               = 
+HHC_LOCATION           = 
+GENERATE_CHI           = NO
+BINARY_TOC             = NO
+TOC_EXPAND             = NO
+DISABLE_INDEX          = NO
+ENUM_VALUES_PER_LINE   = 4
+GENERATE_TREEVIEW      = YES
+TREEVIEW_WIDTH         = 250
+#---------------------------------------------------------------------------
+# configuration options related to the LaTeX output
+#---------------------------------------------------------------------------
+GENERATE_LATEX         = NO
+LATEX_OUTPUT           = latex
+LATEX_CMD_NAME         = latex
+MAKEINDEX_CMD_NAME     = makeindex
+COMPACT_LATEX          = NO
+PAPER_TYPE             = a4wide
+EXTRA_PACKAGES         = 
+LATEX_HEADER           = 
+PDF_HYPERLINKS         = NO
+USE_PDFLATEX           = NO
+LATEX_BATCHMODE        = NO
+LATEX_HIDE_INDICES     = NO
+#---------------------------------------------------------------------------
+# configuration options related to the RTF output
+#---------------------------------------------------------------------------
+GENERATE_RTF           = NO
+RTF_OUTPUT             = rtf
+COMPACT_RTF            = NO
+RTF_HYPERLINKS         = NO
+RTF_STYLESHEET_FILE    = 
+RTF_EXTENSIONS_FILE    = 
+#---------------------------------------------------------------------------
+# configuration options related to the man page output
+#---------------------------------------------------------------------------
+GENERATE_MAN           = NO
+MAN_OUTPUT             = man
+MAN_EXTENSION          = .3
+MAN_LINKS              = NO
+#---------------------------------------------------------------------------
+# configuration options related to the XML output
+#---------------------------------------------------------------------------
+GENERATE_XML           = NO
+XML_OUTPUT             = xml
+XML_SCHEMA             = 
+XML_DTD                = 
+XML_PROGRAMLISTING     = YES
+#---------------------------------------------------------------------------
+# configuration options for the AutoGen Definitions output
+#---------------------------------------------------------------------------
+GENERATE_AUTOGEN_DEF   = NO
+#---------------------------------------------------------------------------
+# configuration options related to the Perl module output
+#---------------------------------------------------------------------------
+GENERATE_PERLMOD       = NO
+PERLMOD_LATEX          = NO
+PERLMOD_PRETTY         = YES
+PERLMOD_MAKEVAR_PREFIX = 
+#---------------------------------------------------------------------------
+# Configuration options related to the preprocessor   
+#---------------------------------------------------------------------------
+ENABLE_PREPROCESSING   = YES
+MACRO_EXPANSION        = YES
+EXPAND_ONLY_PREDEF     = YES
+SEARCH_INCLUDES        = YES
+INCLUDE_PATH           = 
+INCLUDE_FILE_PATTERNS  = 
+PREDEFINED             = DLL_EXPORT= \
+                         __stdcall=
+EXPAND_AS_DEFINED      = 
+SKIP_FUNCTION_MACROS   = YES
+#---------------------------------------------------------------------------
+# Configuration::additions related to external references   
+#---------------------------------------------------------------------------
+TAGFILES               = 
+GENERATE_TAGFILE       = 
+ALLEXTERNALS           = NO
+EXTERNAL_GROUPS        = YES
+PERL_PATH              = /usr/bin/perl
+#---------------------------------------------------------------------------
+# Configuration options related to the dot tool   
+#---------------------------------------------------------------------------
+CLASS_DIAGRAMS         = YES
+MSCGEN_PATH            = 
+HIDE_UNDOC_RELATIONS   = YES
+HAVE_DOT               = NO
+CLASS_GRAPH            = YES
+COLLABORATION_GRAPH    = YES
+GROUP_GRAPHS           = YES
+UML_LOOK               = NO
+TEMPLATE_RELATIONS     = NO
+INCLUDE_GRAPH          = YES
+INCLUDED_BY_GRAPH      = YES
+CALL_GRAPH             = YES
+CALLER_GRAPH           = YES
+GRAPHICAL_HIERARCHY    = YES
+DIRECTORY_GRAPH        = YES
+DOT_IMAGE_FORMAT       = png
+DOT_PATH               = 
+DOTFILE_DIRS           = 
+DOT_GRAPH_MAX_NODES    = 50
+MAX_DOT_GRAPH_DEPTH    = 0
+DOT_TRANSPARENT        = NO
+DOT_MULTI_TARGETS      = YES
+GENERATE_LEGEND        = YES
+DOT_CLEANUP            = YES
+#---------------------------------------------------------------------------
+# Configuration::additions related to the search engine   
+#---------------------------------------------------------------------------
+SEARCHENGINE           = NO

Modified: trunk/tools/unitsync/unitsync.cpp
===================================================================
--- trunk/tools/unitsync/unitsync.cpp	2008-11-10 13:52:11 UTC (rev 7010)
+++ trunk/tools/unitsync/unitsync.cpp	2008-11-10 19:39:53 UTC (rev 7011)
@@ -166,8 +166,12 @@
 //////////////////////////
 //////////////////////////
 
+/** @addtogroup unitsync_api
+	@{ */
+
 /**
- * @brief returns next error in queue of errors and removes this error from queue
+ * @brief Retrieve next error in queue of errors and removes this error from queue
+ * @return An error message, or NULL if there are no more errors in the queue
  *
  * Use this method to get a (short) description of errors that occurred in any
  * other unitsync methods. Call this in a loop until it returns NULL to get all
@@ -177,9 +181,11 @@
  * them, not even whether they have terminating newline or not.
  *
  * Example:
+ *		@code
  *		const char* err;
  *		while ((err = GetNextError()) != NULL)
  *			printf(&quot;unitsync error: %s\n&quot;, err);
+ *		@endcode
  */
 DLL_EXPORT const char* __stdcall GetNextError()
 {
@@ -202,7 +208,8 @@
 
 
 /**
- * @brief returns the version fo spring this was compiled with
+ * @brief Retrieve the version of Spring this unitsync was compiled with
+ * @return The Spring/unitsync version string
  *
  * Returns a const char* string specifying the version of spring used to build this library with.
  * It was added to aid in lobby creation, where checks for updates to spring occur.
@@ -215,7 +222,7 @@
 
 /**
  * @brief Creates a messagebox with said message
- * @param p_szMessage const char* string holding the message
+ * @param p_szMessage string holding the message
  *
  * Creates a messagebox with the title &quot;Message from DLL&quot;, an OK button, and the specified message
  */
@@ -251,7 +258,7 @@
 
 
 /**
- * @brief uninitialize the unitsync library
+ * @brief Uninitialize the unitsync library
  */
 DLL_EXPORT void __stdcall UnInit()
 {
@@ -263,13 +270,17 @@
 
 
 /**
- * @brief initialize the unitsync library
+ * @brief Initialize the unitsync library
+ * @return Zero on error; non-zero on success
  *
  * Call this function before calling any other function in unitsync.
  * In case unitsync was already initialized, it is uninitialized and then
  * reinitialized.
  *
- * @return zero on failure, non-zero on success
+ * Calling this function is currently the only way to clear the VFS of the
+ * files which are mapped into it.  In other words, after using AddArchive() or
+ * AddAllArchives() you have to call Init when you want to remove the archives
+ * from the VFS and start with a clean state.
  */
 DLL_EXPORT int __stdcall Init(bool isServer, int id)
 {
@@ -302,7 +313,10 @@
 
 
 /**
- * @brief get the main, writable, data directory that's used by unitsync and Spring
+ * @brief Get the main data directory that's used by unitsync and Spring
+ * @return NULL on error; the data directory path on success
+ *
+ * This is the data directory which is used to write logs, screenshots, demos, etc.
  */
 DLL_EXPORT const char* __stdcall GetWritableDataDirectory()
 {
@@ -318,13 +332,17 @@
 
 
 /**
- * @brief process another unit and return how many are left to process
- * @return int The number of unprocessed units to be handled
+ * @brief Process another unit and return how many are left to process
+ * @return The number of unprocessed units to be handled
  *
- * Call this function repeatedly until it returns 0 before calling any other function related to units.
+ * Call this function repeatedly until it returns 0 before calling any other
+ * function related to units.
  *
  * Because of risk for infinite loops, this function can not return any error code.
  * It is advised to poll GetNextError() after calling this function.
+ *
+ * Before any units are available, you'll first need to map a mod's archives
+ * into the VFS using AddArchive or AddAllArchives.
  */
 DLL_EXPORT int __stdcall ProcessUnits()
 {
@@ -338,7 +356,8 @@
 
 
 /**
- * @brief identical to ProcessUnits, neither generates checksum anymore
+ * @brief Identical to ProcessUnits(), neither generates checksum anymore
+ * @see ProcessUnits
  */
 DLL_EXPORT int __stdcall ProcessUnitsNoChecksum()
 {
@@ -347,16 +366,18 @@
 
 
 /**
- * @brief returns the number of units
- * @return int number of units processed and available, 0 on error
+ * @brief Get the number of units
+ * @return Zero on error; the number of units available on success
  *
- * Will return the number of units. Remember to call processUnits() beforehand until it returns 0.
- * As ProcessUnits is called the number of processed units goes up, and so will the value returned
- * by this function.
+ * Will return the number of units. Remember to call ProcessUnits() beforehand
+ * until it returns 0.  As ProcessUnits() is called the number of processed
+ * units goes up, and so will the value returned by this function.
  *
  * Example:
- *		while (ProcessUnits()) {}
+ *		@code
+ *		while (ProcessUnits() != 0) {}
  *		int unit_number = GetUnitCount();
+ *		@endcode
  */
 DLL_EXPORT int __stdcall GetUnitCount()
 {
@@ -370,12 +391,12 @@
 
 
 /**
- * @brief returns the units internal mod name
- * @param int the units id number
- * @return const char* The units internal modname or NULL on error.
+ * @brief Get the units internal mod name
+ * @param unit The units id number
+ * @return The units internal modname or NULL on error
  *
- * This function returns the units internal mod name. For example it would return armck and not
- * Arm Construction kbot.
+ * This function returns the units internal mod name. For example it would
+ * return 'armck' and not 'Arm Construction kbot'.
  */
 DLL_EXPORT const char * __stdcall GetUnitName(int unit)
 {
@@ -390,12 +411,12 @@
 
 
 /**
- * @brief returns The units human readable name
- * @param int The units id number
- * @return const char* The Units human readable name or NULL on error.
+ * @brief Get the units human readable name
+ * @param unit The units id number
+ * @return The units human readable name or NULL on error
  *
- * This function returns the units human name. For example it would return Arm Construction kbot
- * and not armck.
+ * This function returns the units human name. For example it would return
+ * 'Arm Construction kbot' and not 'armck'.
  */
 DLL_EXPORT const char * __stdcall GetFullUnitName(int unit)
 {
@@ -412,10 +433,10 @@
 //////////////////////////
 
 /**
- * @brief adds an archive to the VFS (Virtual File System)
+ * @brief Adds an archive to the VFS (Virtual File System)
  *
  * After this, the contents of the archive are available to other unitsync functions,
- * for example: OpenFileVFS, ReadFileVFS, FileSizeVFS, etc.
+ * for example: ProcessUnits(), OpenFileVFS(), ReadFileVFS(), FileSizeVFS(), etc.
  */
 DLL_EXPORT void __stdcall AddArchive(const char* name)
 {
@@ -431,10 +452,8 @@
 
 
 /**
- * @brief adds an achive and all it's dependencies to the VFS
- *
- * After this, the contents of the archive are available to other unitsync functions,
- * for example: OpenFileVFS, ReadFileVFS, FileSizeVFS, etc.
+ * @brief Adds an achive and all it's dependencies to the VFS
+ * @see AddArchive
  */
 DLL_EXPORT void __stdcall AddAllArchives(const char* root)
 {
@@ -453,7 +472,8 @@
 
 
 /**
- * @brief gets checksum of an archive
+ * @brief Get checksum of an archive
+ * @return Zero on error; the checksum on success
  *
  * This checksum depends only on the contents from the archive itself, and not
  * on the contents from dependencies of this archive (if any).
@@ -473,7 +493,8 @@
 
 
 /**
- * @brief gets the real path to the archive
+ * @brief Gets the real path to the archive
+ * @return NULL on error; a path to the archive on success
  */
 DLL_EXPORT const char* __stdcall GetArchivePath(const char* arname)
 {
@@ -494,9 +515,22 @@
 
 
 /**
- * @brief gets the number of maps available
+ * @brief Get the number of maps available
+ * @return Zero on error; the number of maps available on success
  *
  * Call this before any of the map functions which take a map index as parameter.
+ * This function actually performs a relatively costly enumeration of all maps,
+ * so you should resist from calling it repeatedly in a loop.  Rather use:
+ *		@code
+ *		int map_count = GetMapCount();
+ *		for (int index = 0; index &lt; map_count; ++index) {
+ *			printf(&quot;map name: %s\n&quot;, GetMapName(index));
+ *		}
+ *		@endcode
+ * Then:
+ *		@code
+ *		for (int index = 0; index &lt; GetMapCount(); ++index) { ... }
+ *		@endcode
  */
 DLL_EXPORT int __stdcall GetMapCount()
 {
@@ -525,7 +559,8 @@
 
 
 /**
- * @brief get the name of a map, e.g. &quot;SmallDivide.smf&quot;
+ * @brief Get the name of a map
+ * @return NULL on error; the name of the map (e.g. &quot;SmallDivide.smf&quot;) on success
  */
 DLL_EXPORT const char* __stdcall GetMapName(int index)
 {
@@ -649,11 +684,11 @@
 
 
 /**
- * @brief get map info
+ * @brief Retrieve map info
  * @param name name of the map, e.g. &quot;SmallDivide.smf&quot;
  * @param outInfo pointer to structure which is filled with map info
  * @param version this determines which fields of the MapInfo structure are filled
- * @return zero on failure, non-zero on success
+ * @return Zero on error; non-zero on success
  *
  * If version &gt;= 1, then the author field is filled.
  */
@@ -668,10 +703,11 @@
 
 
 /**
- * @brief get map info, equivalent to GetMapInfoEx(name, outInfo, 0)
+ * @brief Retrieve map info, equivalent to GetMapInfoEx(name, outInfo, 0)
  * @param name name of the map, e.g. &quot;SmallDivide.smf&quot;
  * @param outInfo pointer to structure which is filled with map info
- * @return zero on failure, non-zero on success
+ * @return Zero on error; non-zero on success
+ * @see GetMapInfoEx
  */
 DLL_EXPORT int __stdcall GetMapInfo(const char* name, MapInfo* outInfo)
 {
@@ -685,6 +721,14 @@
 
 static vector&lt;string&gt; mapArchives;
 
+
+/**
+ * @brief Retrieves the number of archives a map requires
+ * @param mapName name of the map, e.g. &quot;SmallDivide.smf&quot;
+ * @return Zero on error; the number of archives on success
+ *
+ * Must be called before GetMapArchiveName()
+ */
 DLL_EXPORT int __stdcall GetMapArchiveCount(const char* mapName)
 {
 	try {
@@ -698,6 +742,12 @@
 	return 0;
 }
 
+
+/**
+ * @brief Retrieves an archive a map requires
+ * @param index the index of the archive
+ * @return NULL on error; the name of the archive on success
+ */
 DLL_EXPORT const char* __stdcall GetMapArchiveName(int index)
 {
 	try {
@@ -710,6 +760,17 @@
 	return NULL;
 }
 
+
+/**
+ * @brief Get map checksum given a map index
+ * @param index the index of the map
+ * @return Zero on error; the checksum on success
+ *
+ * This checksum depends on Spring internals, and as such should not be expected
+ * to remain stable between releases.
+ *
+ * (It is ment to check sync between clients in lobby, for example.)
+ */
 DLL_EXPORT unsigned int __stdcall GetMapChecksum(int index)
 {
 	try {
@@ -722,6 +783,13 @@
 	return 0;
 }
 
+
+/**
+ * @brief Get map checksum given a map name
+ * @param mapName name of the map, e.g. &quot;SmallDivide.smf&quot;
+ * @return Zero on error; the checksum on success
+ * @see GetMapChecksum
+ */
 DLL_EXPORT unsigned int __stdcall GetMapChecksumFromName(const char* mapName)
 {
 	try {
@@ -733,6 +801,7 @@
 	return 0;
 }
 
+
 #define RM	0x0000F800
 #define GM  0x000007E0
 #define BM  0x0000001F
@@ -876,12 +945,10 @@
  * 4x4 image.
  * @return A pointer to a static memory area containing the minimap as a 16 bit
  * packed RGB-565 (MSB to LSB: 5 bits red, 6 bits green, 5 bits blue) linear
- * bitmap.
+ * bitmap on success; NULL on error.
  *
  * An example usage would be GetMinimap(&quot;SmallDivide.smf&quot;, 2).
  * This would return a 16 bit packed RGB-565 256x256 (= 1024/2^2) bitmap.
- *
- * Be sure you've made a call to Init prior to using this.
  */
 DLL_EXPORT void* __stdcall GetMinimap(const char* filename, int miplevel)
 {
@@ -918,7 +985,7 @@
  * @param name     Of which infomap to retrieve the dimensions.
  * @param width    This is set to the width of the infomap, or 0 on error.
  * @param height   This is set to the height of the infomap, or 0 on error.
- * @return 1 when the infomap was found with a nonzero size, 0 on error.
+ * @return Non-zero when the infomap was found with a non-zero size; zero on error.
  * @see GetInfoMap
  */
 DLL_EXPORT int __stdcall GetInfoMapSize(const char* filename, const char* name, int* width, int* height)
@@ -954,9 +1021,9 @@
  * @param name     Which infomap to extract from the file.
  * @param data     Pointer to memory location with enough room to hold the infomap data.
  * @param typeHint One of bm_grayscale_8 (or 1) and bm_grayscale_16 (or 2).
- * @return 1 if the infomap was succesfully extracted (and optionally converted),
- * or 0 on error (map wasn't found, infomap wasn't found, or typeHint could not
- * be honoured.)
+ * @return Non-zero if the infomap was succesfully extracted (and optionally
+ * converted), or zero on error (map wasn't found, infomap wasn't found, or
+ * typeHint could not be honoured.)
  *
  * This function extracts an infomap from a map. This can currently be one of:
  * &quot;height&quot;, &quot;metal&quot;, &quot;grass&quot;, &quot;type&quot;. The heightmap is natively in 16 bits per
@@ -1017,11 +1084,9 @@
 
 
 /**
- * @brief Retrieves the name of this mod
- * @return int The number of mods
- *
- * Returns the name of the mod usually found in modinfo.tdf.
- * Be sure you've made calls to Init and GetPrimaryModCount prior to using this.
+ * @brief Retrieves the number of mods available
+ * @return int Zero on error; The number of mods available on success
+ * @see GetMapCount
  */
 DLL_EXPORT int __stdcall GetPrimaryModCount()
 {
@@ -1038,11 +1103,11 @@
 
 /**
  * @brief Retrieves the name of this mod
- * @param index in The mods index/id
- * @return const char* The mods name
+ * @param index The mods index/id
+ * @return NULL on error; The mods name on success
  *
  * Returns the name of the mod usually found in modinfo.tdf.
- * Be sure you've made calls to Init and GetPrimaryModCount prior to using this.
+ * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
 DLL_EXPORT const char* __stdcall GetPrimaryModName(int index)
 {
@@ -1060,11 +1125,11 @@
 
 /**
  * @brief Retrieves the shortened name of this mod
- * @param index in The mods index/id
- * @return const char* The mods abbrieviated name
+ * @param index The mods index/id
+ * @return NULL on error; The mods abbrieviated name on success
  *
  * Returns the shortened name of the mod usually found in modinfo.tdf.
- * Be sure you've made calls to Init and GetPrimaryModCount prior to using this.
+ * Be sure you've made a call GetPrimaryModCount() prior to using this.
  */
 DLL_EXPORT const char* __stdcall GetPrimaryModShortName(int index)
 {
@@ -1082,11 +1147,11 @@
 
 /**
  * @brief Retrieves the version string of this mod
- * @param index in The mods index/id
- * @return const char* The mods version string
+ * @param index The mods index/id
+ * @return NULL on error; The mods version string on success
  *
  * Returns value of the mutator tag for the specified mod usually found in modinfo.tdf.
- * Be sure you've made calls to Init and GetPrimaryModCount prior to using this.
+ * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
 DLL_EXPORT const char* __stdcall GetPrimaryModVersion(int index)
 {
@@ -1104,11 +1169,11 @@
 
 /**
  * @brief Retrieves the mutator name of this mod
- * @param index in The mods index/id
- * @return const char* The mods mutator name
+ * @param index The mods index/id
+ * @return NULL on error; The mods mutator name on success
  *
  * Returns value of the mutator tag for the specified mod usually found in modinfo.tdf.
- * Be sure you've made calls to Init and GetPrimaryModCount prior to using this.
+ * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
 DLL_EXPORT const char* __stdcall GetPrimaryModMutator(int index)
 {
@@ -1126,11 +1191,11 @@
 
 /**
  * @brief Retrieves the game name of this mod
- * @param index in The mods index/id
- * @return const char* The mods game
+ * @param index The mods index/id
+ * @return NULL on error; The mods game name on success
  *
  * Returns the name of the game this mod belongs to usually found in modinfo.tdf.
- * Be sure you've made calls to Init and GetPrimaryModCount prior to using this.
+ * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
 DLL_EXPORT const char* __stdcall GetPrimaryModGame(int index)
 {
@@ -1148,11 +1213,11 @@
 
 /**
  * @brief Retrieves the short game name of this mod
- * @param index in The mods index/id
- * @return const char* The mods abbrieviated game name
+ * @param index The mods index/id
+ * @return NULL on error; The mods abbrieviated game name on success
  *
  * Returns the abbrieviated name of the game this mod belongs to usually found in modinfo.tdf.
- * Be sure you've made calls to Init and GetPrimaryModCount prior to using this.
+ * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
 DLL_EXPORT const char* __stdcall GetPrimaryModShortGame(int index)
 {
@@ -1170,11 +1235,11 @@
 
 /**
  * @brief Retrieves the description of this mod
- * @param index in The mods index/id
- * @return const char* The mods description
+ * @param index The mods index/id
+ * @return NULL on error; The mods description on success
  *
  * Returns a description for the specified mod usually found in modinfo.tdf.
- * Be sure you've made calls to Init and GetPrimaryModCount prior to using this.
+ * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
 DLL_EXPORT const char* __stdcall GetPrimaryModDescription(int index)
 {
@@ -1190,6 +1255,14 @@
 }
 
 
+/**
+ * @brief Retrieves the mod's first/primary archive
+ * @param index The mods index/id
+ * @return NULL on error; The mods primary archive on success
+ *
+ * Returns the name of the primary archive of the mod.
+ * Be sure you've made a call to GetPrimaryModCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetPrimaryModArchive(int index)
 {
 	try {
@@ -1207,13 +1280,19 @@
 
 /**
  * @brief Retrieves the number of archives a mod requires
- * @param index int The index of the mod
- * @return the number of archives this mod depends on.
+ * @param index The index of the mod
+ * @return Zero on error; the number of archives this mod depends on otherwise
  *
  * This is used to get the entire list of archives that a mod requires.
  * Call GetPrimaryModArchiveCount() with selected mod first to get number of
  * archives, and then use GetPrimaryModArchiveList() for 0 to count-1 to get the
- * name of each archive.
+ * name of each archive.  In code:
+ *		@code
+ *		int count = GetPrimaryModArchiveCount(mod_index);
+ *		for (int arnr = 0; arnr &lt; count; ++arnr) {
+ *			printf(&quot;primary mod archive: %s\n&quot;, GetPrimaryModArchiveList(arnr));
+ *		}
+ *		@endcode
  */
 DLL_EXPORT int __stdcall GetPrimaryModArchiveCount(int index)
 {
@@ -1228,11 +1307,12 @@
 	return 0;
 }
 
+
 /**
  * @brief Retrieves the name of the current mod's archive.
- * @param arnr The mod's archive index/id.
- * @return the name of the archive
- * @see GetPrimaryModArchiveCount()
+ * @param arnr The archive's index/id.
+ * @return NULL on error; the name of the archive on success
+ * @see GetPrimaryModArchiveCount
  */
 DLL_EXPORT const char* __stdcall GetPrimaryModArchiveList(int arnr)
 {
@@ -1247,6 +1327,12 @@
 	return NULL;
 }
 
+
+/**
+ * @brief The reverse of GetPrimaryModName()
+ * @param name The name of the mod
+ * @return -1 if the mod can not be found; the index of the mod otherwise
+ */
 DLL_EXPORT int __stdcall GetPrimaryModIndex(const char* name)
 {
 	try {
@@ -1264,6 +1350,13 @@
 	return -1;
 }
 
+
+/**
+ * @brief Get checksum of mod
+ * @param index The mods index/id
+ * @return Zero on error; the checksum on success.
+ * @see GetMapChecksum
+ */
 DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksum(int index)
 {
 	try {
@@ -1276,6 +1369,13 @@
 	return 0;
 }
 
+
+/**
+ * @brief Get checksum of mod given the mod's name
+ * @param name The name of the mod
+ * @return Zero on error; the checksum on success.
+ * @see GetMapChecksum
+ */
 DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksumFromName(const char* name)
 {
 	try {
@@ -1291,6 +1391,14 @@
 //////////////////////////
 //////////////////////////
 
+/**
+ * @brief Retrieve the number of available sides
+ * @return Zero on error; the number of sides on success
+ *
+ * This function parses the mod's side data, and returns the number of sides
+ * available. Be sure to map the mod into the VFS using AddArchive() or
+ * AddAllArchives() prior to using this function.
+ */
 DLL_EXPORT int __stdcall GetSideCount()
 {
 	try {
@@ -1306,6 +1414,12 @@
 }
 
 
+/**
+ * @brief Retrieve a side's name
+ * @return NULL on error; the side's name on success
+ *
+ * Be sure you've made a call to GetSideCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetSideName(int side)
 {
 	try {
@@ -1320,6 +1434,12 @@
 }
 
 
+/**
+ * @brief Retrieve a side's default starting unit
+ * @return NULL on error; the side's starting unit name on success
+ *
+ * Be sure you've made a call to GetSideCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetSideStartUnit(int side)
 {
 	try {
@@ -1385,6 +1505,13 @@
 }
 
 
+/**
+ * @brief Retrieve the number of LUA AIs available
+ * @return Zero on error; the number of LUA AIs otherwise
+ *
+ * Usually LUA AIs are shipped inside a mod, so be sure to map the mod into
+ * the VFS using AddArchive() or AddAllArchives() prior to using this function.
+ */
 DLL_EXPORT int __stdcall GetLuaAICount()
 {
 	try {
@@ -1398,6 +1525,12 @@
 }
 
 
+/**
+ * @brief Retrieve the name of a LUA AI
+ * @return NULL on error; the name of the LUA AI on success
+ *
+ * Be sure you've made a call to GetLuaAICount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetLuaAIName(int aiIndex)
 {
 	try {
@@ -1411,6 +1544,12 @@
 }
 
 
+/**
+ * @brief Retrieve the description of a LUA AI
+ * @return NULL on error; the description of the LUA AI on success
+ *
+ * Be sure you've made a call to GetLuaAICount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetLuaAIDesc(int aiIndex)
 {
 	try {
@@ -1632,6 +1771,11 @@
 }
 
 
+/**
+ * @brief Retrieve the number of map options available
+ * @param name the name of the map
+ * @return Zero on error; the number of map options available on success
+ */
 DLL_EXPORT int __stdcall GetMapOptionCount(const char* name)
 {
 	try {
@@ -1658,6 +1802,13 @@
 }
 
 
+/**
+ * @brief Retrieve the number of mod options available
+ * @return Zero on error; the number of mod options available on success
+ *
+ * Be sure to map the mod into the VFS using AddArchive() or AddAllArchives()
+ * prior to using this function.
+ */
 DLL_EXPORT int __stdcall GetModOptionCount()
 {
 	try {
@@ -1686,6 +1837,16 @@
 
 // Common Parameters
 
+/**
+ * @brief Retrieve an option's key
+ * @param optIndex option index/id
+ * @return NULL on error; the option's key on success
+ *
+ * The key of an option is the name it should be given in the start script's
+ * MODOPTIONS or MAPOPTIONS section.
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetOptionKey(int optIndex)
 {
 	try {
@@ -1697,6 +1858,14 @@
 }
 
 
+/**
+ * @brief Retrieve an option's name
+ * @param optIndex option index/id
+ * @return NULL on error; the option's user visible name on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetOptionName(int optIndex)
 {
 	try {
@@ -1707,6 +1876,15 @@
 	return NULL;
 }
 
+
+/**
+ * @brief Retrieve an option's section
+ * @param optIndex option index/id
+ * @return NULL on error; the option's section name on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetOptionSection(int optIndex)
 {
 	try {
@@ -1717,6 +1895,17 @@
 	return NULL;
 }
 
+
+/**
+ * @brief Retrieve an option's style
+ * @param optIndex option index/id
+ * @return NULL on error; the option's style on success
+ *
+ * The format of an option style string is currently undecided.
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetOptionStyle(int optIndex)
 {
 	try {
@@ -1727,6 +1916,15 @@
 	return NULL;
 }
 
+
+/**
+ * @brief Retrieve an option's description
+ * @param optIndex option index/id
+ * @return NULL on error; the option's description on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetOptionDesc(int optIndex)
 {
 	try {
@@ -1738,6 +1936,14 @@
 }
 
 
+/**
+ * @brief Retrieve an option's type
+ * @param optIndex option index/id
+ * @return opt_error on error; the option's type on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT int __stdcall GetOptionType(int optIndex)
 {
 	try {
@@ -1751,6 +1957,14 @@
 
 // Bool Options
 
+/**
+ * @brief Retrieve an opt_bool option's default value
+ * @param optIndex option index/id
+ * @return Zero on error; the option's default value (0 or 1) on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT int __stdcall GetOptionBoolDef(int optIndex)
 {
 	try {
@@ -1764,6 +1978,14 @@
 
 // Number Options
 
+/**
+ * @brief Retrieve an opt_number option's default value
+ * @param optIndex option index/id
+ * @return Zero on error; the option's default value on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT float __stdcall GetOptionNumberDef(int optIndex)
 {
 	try {
@@ -1775,6 +1997,14 @@
 }
 
 
+/**
+ * @brief Retrieve an opt_number option's minimum value
+ * @param optIndex option index/id
+ * @return -1.0e30 on error; the option's minimum value on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT float __stdcall GetOptionNumberMin(int optIndex)
 {
 	try {
@@ -1786,6 +2016,14 @@
 }
 
 
+/**
+ * @brief Retrieve an opt_number option's maximum value
+ * @param optIndex option index/id
+ * @return +1.0e30 on error; the option's maximum value on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT float __stdcall GetOptionNumberMax(int optIndex)
 {
 	try {
@@ -1797,6 +2035,14 @@
 }
 
 
+/**
+ * @brief Retrieve an opt_number option's step value
+ * @param optIndex option index/id
+ * @return Zero on error; the option's step value on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT float __stdcall GetOptionNumberStep(int optIndex)
 {
 	try {
@@ -1810,6 +2056,14 @@
 
 // String Options
 
+/**
+ * @brief Retrieve an opt_string option's default value
+ * @param optIndex option index/id
+ * @return NULL on error; the option's default value on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetOptionStringDef(int optIndex)
 {
 	try {
@@ -1821,6 +2075,14 @@
 }
 
 
+/**
+ * @brief Retrieve an opt_string option's maximum length
+ * @param optIndex option index/id
+ * @return Zero on error; the option's maximum length on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT int __stdcall GetOptionStringMaxLen(int optIndex)
 {
 	try {
@@ -1834,6 +2096,14 @@
 
 // List Options
 
+/**
+ * @brief Retrieve an opt_list option's number of available items
+ * @param optIndex option index/id
+ * @return Zero on error; the option's number of available items on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT int __stdcall GetOptionListCount(int optIndex)
 {
 	try {
@@ -1845,6 +2115,14 @@
 }
 
 
+/**
+ * @brief Retrieve an opt_list option's default value
+ * @param optIndex option index/id
+ * @return NULL on error; the option's default value (list item key) on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetOptionListDef(int optIndex)
 {
 	try {
@@ -1856,6 +2134,15 @@
 }
 
 
+/**
+ * @brief Retrieve an opt_list option item's key
+ * @param optIndex option index/id
+ * @param itemIndex list item index/id
+ * @return NULL on error; the option item's key (list item key) on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetOptionListItemKey(int optIndex, int itemIndex)
 {
 	try {
@@ -1869,6 +2156,15 @@
 }
 
 
+/**
+ * @brief Retrieve an opt_list option item's name
+ * @param optIndex option index/id
+ * @param itemIndex list item index/id
+ * @return NULL on error; the option item's name on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetOptionListItemName(int optIndex, int itemIndex)
 {
 	try {
@@ -1882,6 +2178,15 @@
 }
 
 
+/**
+ * @brief Retrieve an opt_list option item's description
+ * @param optIndex option index/id
+ * @param itemIndex list item index/id
+ * @return NULL on error; the option item's description on success
+ *
+ * Be sure you've made a call to either GetMapOptionCount()
+ * or GetModOptionCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetOptionListItemDesc(int optIndex, int itemIndex)
 {
 	try {
@@ -1977,8 +2282,14 @@
 }
 
 
-// A return value of 0 means that any map can be selected
-// Map names should be complete  (including the .smf or .sm3 extension)
+/**
+ * @brief Retrieve the number of valid maps for the current mod
+ * @return 0 on error; the number of valid maps on success
+ *
+ * A return value of 0 means that any map can be selected.
+ * Be sure to map the mod into the VFS using AddArchive() or AddAllArchives()
+ * prior to using this function.
+ */
 DLL_EXPORT int __stdcall GetModValidMapCount()
 {
 	try {
@@ -2014,6 +2325,13 @@
 }
 
 
+/**
+ * @brief Retrieve the name of a map valid for the current mod
+ * @return NULL on error; the name of the map on success
+ *
+ * Map names should be complete  (including the .smf or .sm3 extension.)
+ * Be sure you've made a call to GetModValidMapCount() prior to using this.
+ */
 DLL_EXPORT const char* __stdcall GetModValidMap(int index)
 {
 	try {
@@ -2029,8 +2347,6 @@
 //////////////////////////
 //////////////////////////
 
-// Map the wanted archives into the VFS with AddArchive before using these functions
-
 static map&lt;int, CFileHandler*&gt; openFiles;
 static int nextFile = 0;
 static vector&lt;string&gt; curFindFiles;
@@ -2043,6 +2359,18 @@
 		throw content_error(&quot;Unregistered handle. Pass a handle returned by OpenFileVFS.&quot;);
 }
 
+
+/**
+ * @brief Open a file from the VFS
+ * @param name the name of the file
+ * @return Zero on error; a non-zero file handle on success.
+ *
+ * The returned file handle is needed for subsequent calls to CloseFileVFS(),
+ * ReadFileVFS() and FileSizeVFS().
+ *
+ * Map the wanted archives into the VFS with AddArchive() or AddAllArchives()
+ * before using this function.
+ */
 DLL_EXPORT int __stdcall OpenFileVFS(const char* name)
 {
 	try {
@@ -2066,6 +2394,11 @@
 	return 0;
 }
 
+
+/**
+ * @brief Close a file in the VFS
+ * @param handle the file handle as returned by OpenFileVFS()
+ */
 DLL_EXPORT void __stdcall CloseFileVFS(int handle)
 {
 	try {
@@ -2078,7 +2411,15 @@
 	UNITSYNC_CATCH_BLOCKS;
 }
 
-DLL_EXPORT void __stdcall ReadFileVFS(int handle, void* buf, int length)
+/**
+ * @brief Read some data from a file in the VFS
+ * @param handle the file handle as returned by OpenFileVFS()
+ * @param buf output buffer, must be at least length bytes
+ * @param length how many bytes to read from the file
+ * @return -1 on error; the number of bytes read on success
+ * (if this is less than length you reached the end of the file.)
+ */
+DLL_EXPORT int __stdcall ReadFileVFS(int handle, void* buf, int length)
 {
 	try {
 		CheckFileHandle(handle);
@@ -2087,11 +2428,18 @@
 
 		logOutput.Print(LOG_UNITSYNC, &quot;readfilevfs: %d\n&quot;, handle);
 		CFileHandler* fh = openFiles[handle];
-		fh-&gt;Read(buf, length);
+		return fh-&gt;Read(buf, length);
 	}
 	UNITSYNC_CATCH_BLOCKS;
+	return -1;
 }
 
+
+/**
+ * @brief Retrieve size of a file in the VFS
+ * @param handle the file handle as returned by OpenFileVFS()
+ * @return -1 on error; the size of the file on success
+ */
 DLL_EXPORT int __stdcall FileSizeVFS(int handle)
 {
 	try {
@@ -2185,6 +2533,7 @@
 static map&lt;int, CArchiveBase*&gt; openArchives;
 static int nextArchive = 0;
 
+
 static void CheckArchiveHandle(int handle)
 {
 	CheckInit();
@@ -2193,7 +2542,13 @@
 		throw content_error(&quot;Unregistered handle. Pass a handle returned by OpenArchive.&quot;);
 }
 
-// returns 0 on error, a handle otherwise
+
+/**
+ * @brief Open an archive
+ * @param name the name of the archive (*.sdz, *.sd7, ...)
+ * @return Zero on error; a non-zero archive handle on success.
+ * @sa OpenArchiveType
+ */
 DLL_EXPORT int __stdcall OpenArchive(const char* name)
 {
 	try {
@@ -2214,7 +2569,20 @@
 	return 0;
 }
 
-// returns 0 on error, a handle otherwise
+
+/**
+ * @brief Open an archive
+ * @param name the name of the archive (*.sd7, *.sdz, *.sdd, *.ccx, *.hpi, *.ufo, *.gp3, *.gp4, *.swx)
+ * @param type the type of the archive (sd7, 7z, sdz, zip, sdd, dir, ccx, hpi, ufo, gp3, gp4, swx)
+ * @return Zero on error; a non-zero archive handle on success.
+ * @sa OpenArchive
+ *
+ * The list of supported types and recognized extensions may change at any time.
+ * (But this list will always be the same as the file types recognized by the engine.)
+ *
+ * This function is pointless, because OpenArchive() does the same and automatically
+ * detects the file type based on it's extension.  Who added it anyway?
+ */
 DLL_EXPORT int __stdcall OpenArchiveType(const char* name, const char* type)
 {
 	try {
@@ -2236,6 +2604,11 @@
 	return 0;
 }
 
+
+/**
+ * @brief Close an archive in the VFS
+ * @param archive the archive handle as returned by OpenArchive()
+ */
 DLL_EXPORT void __stdcall CloseArchive(int archive)
 {
 	try {
@@ -2247,6 +2620,7 @@
 	UNITSYNC_CATCH_BLOCKS;
 }
 
+
 DLL_EXPORT int __stdcall FindFilesArchive(int archive, int cur, char* nameBuf, int* size)
 {
 	try {
@@ -2270,6 +2644,16 @@
 	return 0;
 }
 
+
+/**
+ * @brief Open an archive member
+ * @param archive the archive handle as returned by OpenArchive()
+ * @param name the name of the file
+ * @return Zero on error; a non-zero file handle on success.
+ *
+ * The returned file handle is needed for subsequent calls to ReadArchiveFile(),
+ * CloseArchiveFile() and SizeArchiveFile().
+ */
 DLL_EXPORT int __stdcall OpenArchiveFile(int archive, const char* name)
 {
 	try {
@@ -2283,6 +2667,16 @@
 	return 0;
 }
 
+
+/**
+ * @brief Read some data from an archive member
+ * @param archive the archive handle as returned by OpenArchive()
+ * @param handle the file handle as returned by OpenArchiveFile()
+ * @param buffer output buffer, must be at least numBytes bytes
+ * @param numBytes how many bytes to read from the file
+ * @return -1 on error; the number of bytes read on success
+ * (if this is less than numBytes you reached the end of the file.)
+ */
 DLL_EXPORT int __stdcall ReadArchiveFile(int archive, int handle, void* buffer, int numBytes)
 {
 	try {
@@ -2294,9 +2688,15 @@
 		return a-&gt;ReadFile(handle, buffer, numBytes);
 	}
 	UNITSYNC_CATCH_BLOCKS;
-	return 0;
+	return -1;
 }
 
+
+/**
+ * @brief Close an archive member
+ * @param archive the archive handle as returned by OpenArchive()
+ * @param handle the file handle as returned by OpenArchiveFile()
+ */
 DLL_EXPORT void __stdcall CloseArchiveFile(int archive, int handle)
 {
 	try {
@@ -2308,6 +2708,13 @@
 	UNITSYNC_CATCH_BLOCKS;
 }
 
+
+/**
+ * @brief Retrieve size of an archive member
+ * @param archive the archive handle as returned by OpenArchive()
+ * @param handle the file handle as returned by OpenArchiveFile()
+ * @return -1 on error; the size of the file on success
+ */
 DLL_EXPORT int __stdcall SizeArchiveFile(int archive, int handle)
 {
 	try {
@@ -2331,7 +2738,7 @@
 	//static char strBuf[STRBUF_SIZE];
 
 	if (str.length() + 1 &gt; STRBUF_SIZE) {
-		sprintf(strBuf, &quot;Increase STRBUF_SIZE (needs %ld bytes)&quot;, str.length() + 1);
+		sprintf(strBuf, &quot;Increase STRBUF_SIZE (needs %d bytes)&quot;, str.length() + 1);
 	}
 	else {
 		strcpy(strBuf, str.c_str());
@@ -2433,6 +2840,8 @@
 	UNITSYNC_CATCH_BLOCKS;
 }
 
+/** @} */
+
 //////////////////////////
 //////////////////////////
 

Modified: trunk/tools/unitsync/unitsync.h
===================================================================
--- trunk/tools/unitsync/unitsync.h	2008-11-10 13:52:11 UTC (rev 7010)
+++ trunk/tools/unitsync/unitsync.h	2008-11-10 19:39:53 UTC (rev 7011)
@@ -6,50 +6,73 @@
 #define STRBUF_SIZE 100000
 
 
+/**
+ * @addtogroup unitsync_api Unitsync API
+ * @{
+*/
+
+/**
+ * @brief 2d vector storing a map defined starting position
+ * @sa MapInfo
+ */
 struct StartPos
 {
-	int x;
-	int z;
+	int x; ///&lt; X component
+	int z; ///&lt; Z component
 };
 
 
+/**
+ * @brief Metadata of a map
+ * @sa GetMapInfo GetMapInfoEx
+ */
 struct MapInfo
 {
-	char* description; // max 255 chars
-	int tidalStrength;
-	int gravity;
-	float maxMetal;
-	int extractorRadius;
-	int minWind;
-	int maxWind;
+	char* description;   ///&lt; Description (max 255 chars)
+	int tidalStrength;   ///&lt; Tidal strength
+	int gravity;         ///&lt; Gravity
+	float maxMetal;      ///&lt; Metal scale factor
+	int extractorRadius; ///&lt; Extractor radius (of metal extractors)
+	int minWind;         ///&lt; Minimum wind speed
+	int maxWind;         ///&lt; Maximum wind speed
 
 	// 0.61b1+
-	int width;
-	int height;
-	int posCount;
-	StartPos positions[16];		// I'd rather not allocate memory, this should be enough
+	int width;              ///&lt; Width of the map
+	int height;             ///&lt; Height of the map
+	int posCount;           ///&lt; Number of defined start positions
+	StartPos positions[16]; ///&lt; Start positions defined by the map (max 16)
 
 	// VERSION&gt;=1
-	char* author; // max 200 chars
+	char* author;   ///&lt; Creator of the map (max 200 chars)
 };
 
 
+/**
+ * @brief Available mod/map option types
+ * @sa GetOptionType
+ */
 enum OptionType {
-	opt_error   = 0,
-	opt_bool    = 1,
-	opt_list    = 2,
-	opt_number  = 3,
-	opt_string  = 4,
-	opt_section = 5
+	opt_error   = 0, ///&lt; error
+	opt_bool    = 1, ///&lt; boolean option
+	opt_list    = 2, ///&lt; list option (e.g. combobox)
+	opt_number  = 3, ///&lt; numeric option (e.g. spinner / slider)
+	opt_string  = 4, ///&lt; string option (e.g. textbox)
+	opt_section = 5  ///&lt; option section (e.g. groupbox)
 };
 
 
+/**
+ * @brief Available bitmap typeHints
+ * @sa GetInfoMap
+ */
 enum BitmapType {
-	bm_grayscale_8 = 1,
-	bm_grayscale_16 = 2
+	bm_grayscale_8  = 1, ///&lt; 8 bits per pixel grayscale bitmap
+	bm_grayscale_16 = 2  ///&lt; 16 bits per pixel grayscale bitmap
 };
 
+/** @} */
 
+
 const char *GetStr(std::string str);
 
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001779.html">[Taspring-linux-commit] r7010 - in trunk/rts: Game Rendering/GL
</A></li>
	<LI>Next message: <A HREF="001781.html">[Taspring-linux-commit] r7012 - trunk/tools/unitsync
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1780">[ date ]</a>
              <a href="thread.html#1780">[ thread ]</a>
              <a href="subject.html#1780">[ subject ]</a>
              <a href="author.html#1780">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
