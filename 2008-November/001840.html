<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r7071 - in trunk: AI/Global/AAI	AI/Global/CSAI/ABICompatibilityLayer	AI/Global/CSAI/CSAILoader AI/Global/CSAI/MonoLoader	AI/Global/JCAI AI/Global/KAI-0.2 AI/Global/KAIK-0.13	AI/Global/NTai/AI/NTai/Core	AI/Global/NTai/AI/ntai-xcode/build/ntai-xcode.build/ntai-xcode.pbxindex/strings.pbxstrings	AI/Global/RAI AI/Global/TestGlobalAI AI/Group/CentralBuildAI	AI/Group/EconomyAI AI/Group/MetalMakerAI	AI/Group/MexUpgraderAI AI/Group/RadarAI AI/Group/ReportIdleAI	AI/Group/SimpleFormationAI rts/ExternalAI rts/System	tools/unitsync tools/unitsync_cacher
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7071%20-%20in%20trunk%3A%20AI/Global/AAI%0A%09AI/Global/CSAI/ABICompatibilityLayer%0A%09AI/Global/CSAI/CSAILoader%20AI/Global/CSAI/MonoLoader%0A%09AI/Global/JCAI%20AI/Global/KAI-0.2%20AI/Global/KAIK-0.13%0A%09AI/Global/NTai/AI/NTai/Core%0A%09AI/Global/NTai/AI/ntai-xcode/build/ntai-xcode.build/ntai-xcode.pbxindex/strings.pbxstrings%0A%09AI/Global/RAI%20AI/Global/TestGlobalAI%20AI/Group/CentralBuildAI%0A%09AI/Group/EconomyAI%20AI/Group/MetalMakerAI%0A%09AI/Group/MexUpgraderAI%20AI/Group/RadarAI%20AI/Group/ReportIdleAI%0A%09AI/Group/SimpleFormationAI%20rts/ExternalAI%20rts/System%0A%09tools/unitsync%20tools/unitsync_cacher&In-Reply-To=%3C20081119154859.E4830476B%40progate.clan-sy.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001839.html">
   <LINK REL="Next"  HREF="001841.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r7071 - in trunk: AI/Global/AAI	AI/Global/CSAI/ABICompatibilityLayer	AI/Global/CSAI/CSAILoader AI/Global/CSAI/MonoLoader	AI/Global/JCAI AI/Global/KAI-0.2 AI/Global/KAIK-0.13	AI/Global/NTai/AI/NTai/Core	AI/Global/NTai/AI/ntai-xcode/build/ntai-xcode.build/ntai-xcode.pbxindex/strings.pbxstrings	AI/Global/RAI AI/Global/TestGlobalAI AI/Group/CentralBuildAI	AI/Group/EconomyAI AI/Group/MetalMakerAI	AI/Group/MexUpgraderAI AI/Group/RadarAI AI/Group/ReportIdleAI	AI/Group/SimpleFormationAI rts/ExternalAI rts/System	tools/unitsync tools/unitsync_cacher</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7071%20-%20in%20trunk%3A%20AI/Global/AAI%0A%09AI/Global/CSAI/ABICompatibilityLayer%0A%09AI/Global/CSAI/CSAILoader%20AI/Global/CSAI/MonoLoader%0A%09AI/Global/JCAI%20AI/Global/KAI-0.2%20AI/Global/KAIK-0.13%0A%09AI/Global/NTai/AI/NTai/Core%0A%09AI/Global/NTai/AI/ntai-xcode/build/ntai-xcode.build/ntai-xcode.pbxindex/strings.pbxstrings%0A%09AI/Global/RAI%20AI/Global/TestGlobalAI%20AI/Group/CentralBuildAI%0A%09AI/Group/EconomyAI%20AI/Group/MetalMakerAI%0A%09AI/Group/MexUpgraderAI%20AI/Group/RadarAI%20AI/Group/ReportIdleAI%0A%09AI/Group/SimpleFormationAI%20rts/ExternalAI%20rts/System%0A%09tools/unitsync%20tools/unitsync_cacher&In-Reply-To=%3C20081119154859.E4830476B%40progate.clan-sy.com%3E"
       TITLE="[Taspring-linux-commit] r7071 - in trunk: AI/Global/AAI	AI/Global/CSAI/ABICompatibilityLayer	AI/Global/CSAI/CSAILoader AI/Global/CSAI/MonoLoader	AI/Global/JCAI AI/Global/KAI-0.2 AI/Global/KAIK-0.13	AI/Global/NTai/AI/NTai/Core	AI/Global/NTai/AI/ntai-xcode/build/ntai-xcode.build/ntai-xcode.pbxindex/strings.pbxstrings	AI/Global/RAI AI/Global/TestGlobalAI AI/Group/CentralBuildAI	AI/Group/EconomyAI AI/Group/MetalMakerAI	AI/Group/MexUpgraderAI AI/Group/RadarAI AI/Group/ReportIdleAI	AI/Group/SimpleFormationAI rts/ExternalAI rts/System	tools/unitsync tools/unitsync_cacher">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Wed Nov 19 16:48:59 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001839.html">[Taspring-linux-commit] r7070 - in trunk:	AI/Global/NTai/AI/NTai/Units tools/unitsync
</A></li>
        <LI>Next message: <A HREF="001841.html">[Taspring-linux-commit] r7072 - trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1840">[ date ]</a>
              <a href="thread.html#1840">[ thread ]</a>
              <a href="subject.html#1840">[ subject ]</a>
              <a href="author.html#1840">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: hoijui
Date: 2008-11-19 16:48:58 +0100 (Wed, 19 Nov 2008)
New Revision: 7071

Added:
   trunk/rts/System/exportdefines.h
Modified:
   trunk/AI/Global/AAI/Interface.cpp
   trunk/AI/Global/CSAI/ABICompatibilityLayer/AbicAICallback.cpp
   trunk/AI/Global/CSAI/ABICompatibilityLayer/AbicAICallback.h
   trunk/AI/Global/CSAI/ABICompatibilityLayer/dllbuild.h
   trunk/AI/Global/CSAI/ABICompatibilityLayer/myai.cpp
   trunk/AI/Global/CSAI/ABICompatibilityLayer/myaimingw.cpp
   trunk/AI/Global/CSAI/CSAILoader/CSAILoader.cpp
   trunk/AI/Global/CSAI/MonoLoader/CSAILoaderMono.cpp
   trunk/AI/Global/JCAI/Interface.cpp
   trunk/AI/Global/KAI-0.2/TestAI.cpp
   trunk/AI/Global/KAIK-0.13/AIExports.cpp
   trunk/AI/Global/NTai/AI/NTai/Core/Interface.cpp
   trunk/AI/Global/NTai/AI/ntai-xcode/build/ntai-xcode.build/ntai-xcode.pbxindex/strings.pbxstrings/strings
   trunk/AI/Global/RAI/DLLExportRAI.cpp
   trunk/AI/Global/TestGlobalAI/TestAI.cpp
   trunk/AI/Group/CentralBuildAI/TestAI.cpp
   trunk/AI/Group/EconomyAI/TestAI.cpp
   trunk/AI/Group/MetalMakerAI/TestAI.cpp
   trunk/AI/Group/MexUpgraderAI/TestAI.cpp
   trunk/AI/Group/RadarAI/TestAI.cpp
   trunk/AI/Group/ReportIdleAI/TestAI.cpp
   trunk/AI/Group/SimpleFormationAI/TestAI.cpp
   trunk/rts/ExternalAI/aibase.h
   trunk/tools/unitsync/Doxyfile
   trunk/tools/unitsync/LuaParserAPI.cpp
   trunk/tools/unitsync/LuaParserAPI.h
   trunk/tools/unitsync/javabind.cpp
   trunk/tools/unitsync/pybind.cpp
   trunk/tools/unitsync/unitsync.cpp
   trunk/tools/unitsync/unitsync.h
   trunk/tools/unitsync/unitsync_api.h
   trunk/tools/unitsync_cacher/test.cpp
Log:
DLL_EXPORT ... __stdcall -&gt; EXPORT(...),
DLL_EXPORT -&gt; SHRAED_EXPORT,
__stdcall -&gt; CALLING_CONV

Modified: trunk/AI/Global/AAI/Interface.cpp
===================================================================
--- trunk/AI/Global/AAI/Interface.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/AAI/Interface.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -16,35 +16,35 @@
 std::set&lt;IGlobalAI*&gt; ais;
 
 
-DLL_EXPORT int GetGlobalAiVersion()
+SHARED_EXPORT int GetGlobalAiVersion()
 {
 	return GLOBAL_AI_INTERFACE_VERSION;
 }
 
-DLL_EXPORT void GetAiName(char* name)
+SHARED_EXPORT void GetAiName(char* name)
 {
 	strcpy(name, AAI_VERSION);
 }
 
-DLL_EXPORT IGlobalAI* GetNewAI()
+SHARED_EXPORT IGlobalAI* GetNewAI()
 {
 	AAI* ai = new AAI();
 	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(IGlobalAI* i)
+SHARED_EXPORT void ReleaseAI(IGlobalAI* i)
 {
 	ais.erase(i);
 	delete (AAI*)i;
 }
 
-DLL_EXPORT int IsCInterface(void) 
+SHARED_EXPORT int IsCInterface(void) 
 {
 	return 0;
 } 
 
-DLL_EXPORT int IsLoadSupported() 
+SHARED_EXPORT int IsLoadSupported() 
 {
 	return 0;
 }

Modified: trunk/AI/Global/CSAI/ABICompatibilityLayer/AbicAICallback.cpp
===================================================================
--- trunk/AI/Global/CSAI/ABICompatibilityLayer/AbicAICallback.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/CSAI/ABICompatibilityLayer/AbicAICallback.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -1,7 +1,7 @@
 
 #include &quot;StdAfx.h&quot;
 
-//#include &quot;ExternalAI/aibase.h&quot; // for DLL_EXPORT definition
+//#include &quot;ExternalAI/aibase.h&quot; // for SHARED_EXPORT definition
 
 #include &quot;AbicAICallback.h&quot;
 

Modified: trunk/AI/Global/CSAI/ABICompatibilityLayer/AbicAICallback.h
===================================================================
--- trunk/AI/Global/CSAI/ABICompatibilityLayer/AbicAICallback.h	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/CSAI/ABICompatibilityLayer/AbicAICallback.h	2008-11-19 15:48:58 UTC (rev 7071)
@@ -1,5 +1,5 @@
 
-// #include &quot;ExternalAI/aibase.h&quot; // for DLL_EXPORT definition
+// #include &quot;ExternalAI/aibase.h&quot; // for SHARED_EXPORT definition
 
 #include &quot;dllbuild.h&quot;
 

Modified: trunk/AI/Global/CSAI/ABICompatibilityLayer/dllbuild.h
===================================================================
--- trunk/AI/Global/CSAI/ABICompatibilityLayer/dllbuild.h	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/CSAI/ABICompatibilityLayer/dllbuild.h	2008-11-19 15:48:58 UTC (rev 7071)
@@ -1,6 +1,6 @@
 // used to decide what gets imported and what gets exported
 
-#include &quot;ExternalAI/aibase.h&quot; // we need this to define DLL_EXPORT
+#include &quot;ExternalAI/aibase.h&quot; // we need this to define SHARED_EXPORT
 
 // define DLL_IMPORT, which is platform dependent
 // since we only have a C interface, we dont care about destructors, virtual functions and so on
@@ -9,16 +9,16 @@
 	#define DLL_IMPORT extern &quot;C&quot; __declspec(dllimport)
 #elif __GNUC__ &gt;= 4
 	// Support for '-fvisibility=hidden'.
-	#define DLL_EXPORT extern &quot;C&quot; __attribute__ ((visibility(&quot;default&quot;)))
+	#define SHARED_EXPORT extern &quot;C&quot; __attribute__ ((visibility(&quot;default&quot;)))
 #else
 	// Older versions of gcc have everything visible; no need for fancy stuff.
-	#define DLL_EXPORT extern &quot;C&quot;
+	#define SHARED_EXPORT extern &quot;C&quot;
 #endif
 
 // define BUILDING_ABIC when building abic dll:
 #ifdef BUILDING_ABIC
-   #define SPRING_TO_ABIC_API DLL_EXPORT  // export, for spring to call into us
-   #define AICALLBACK_API DLL_EXPORT    // export, for ai.dll to callback into us
+   #define SPRING_TO_ABIC_API SHARED_EXPORT  // export, for spring to call into us
+   #define AICALLBACK_API SHARED_EXPORT    // export, for ai.dll to callback into us
                                                    // no outgoing imports: we link dynamically with ai.dll
 #endif
 

Modified: trunk/AI/Global/CSAI/ABICompatibilityLayer/myai.cpp
===================================================================
--- trunk/AI/Global/CSAI/ABICompatibilityLayer/myai.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/CSAI/ABICompatibilityLayer/myai.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -1,6 +1,6 @@
 #include &lt;stdio.h&gt;
 
-#include &quot;ExternalAI/aibase.h&quot; // we need this to define DLL_EXPORT
+#include &quot;ExternalAI/aibase.h&quot; // we need this to define SHARED_EXPORT
 
 // ***** dont include any spring includes above this, except aibase.h ******
 #include &quot;AbicAICallback.h&quot;
@@ -127,65 +127,65 @@
 // exported dll symbols, wrap our AI class
 
 // returns pointers to our new AI object
-DLL_EXPORT void *InitAI( struct IAICallback *aicallback, int team)
+SHARED_EXPORT void *InitAI( struct IAICallback *aicallback, int team)
 {
     MyAI *ai = new MyAI();
     ai-&gt;InitAI( aicallback, team );
     return ai;
 }
 
-DLL_EXPORT void UnitCreated( void *ai, int unit)									//called when a new unit is created on ai team
+SHARED_EXPORT void UnitCreated( void *ai, int unit)									//called when a new unit is created on ai team
 {
     ( ( MyAI *)ai )-&gt;UnitCreated( unit );
 }
 
-DLL_EXPORT void UnitFinished(void *ai, int unit)							//called when an unit has finished building
+SHARED_EXPORT void UnitFinished(void *ai, int unit)							//called when an unit has finished building
 {
     ( ( MyAI *)ai )-&gt;UnitFinished( unit );
 }
 
-DLL_EXPORT void UnitDestroyed(void *ai, int unit,int attacker)								//called when a unit is destroyed
+SHARED_EXPORT void UnitDestroyed(void *ai, int unit,int attacker)								//called when a unit is destroyed
 {
 }
 
-DLL_EXPORT void EnemyEnterLOS(void *ai, int enemy)
+SHARED_EXPORT void EnemyEnterLOS(void *ai, int enemy)
 {
 }
 
-DLL_EXPORT void EnemyLeaveLOS(void *ai, int enemy)
+SHARED_EXPORT void EnemyLeaveLOS(void *ai, int enemy)
 {
 }
 
-DLL_EXPORT void EnemyEnterRadar(void *ai, int enemy)		
+SHARED_EXPORT void EnemyEnterRadar(void *ai, int enemy)		
 {
 }
 
-DLL_EXPORT void EnemyLeaveRadar(void *ai, int enemy)
+SHARED_EXPORT void EnemyLeaveRadar(void *ai, int enemy)
 {
 }
 
-DLL_EXPORT void EnemyDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)	//called when an enemy inside los or radar is damaged
+SHARED_EXPORT void EnemyDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)	//called when an enemy inside los or radar is damaged
 {
 }
 
-DLL_EXPORT void EnemyDestroyed(void *ai, int enemy,int attacker)							//will be called if an enemy inside los or radar dies (note that leave los etc will not be called then)
+SHARED_EXPORT void EnemyDestroyed(void *ai, int enemy,int attacker)							//will be called if an enemy inside los or radar dies (note that leave los etc will not be called then)
 {
 }
 
-DLL_EXPORT void UnitIdle(void *ai, int unit)										//called when a unit go idle and is not assigned to any group
+SHARED_EXPORT void UnitIdle(void *ai, int unit)										//called when a unit go idle and is not assigned to any group
 {
     ( ( MyAI *)ai )-&gt;UnitIdle( unit );
 }
 
-DLL_EXPORT void GotChatMsg(void *aik, const char* msg,int player)					//called when someone writes a chat msg
+SHARED_EXPORT void GotChatMsg(void *aik, const char* msg,int player)					//called when someone writes a chat msg
 {
 }
 
-DLL_EXPORT void UnitDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)					//called when one of your units are damaged
+SHARED_EXPORT void UnitDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)					//called when one of your units are damaged
 {
 }
 
-DLL_EXPORT void UnitMoveFailed(void *ai, int unit)
+SHARED_EXPORT void UnitMoveFailed(void *ai, int unit)
 {
     ( ( MyAI *)ai )-&gt;UnitMoveFailed( unit );
 }
@@ -193,7 +193,7 @@
 //int HandleEvent (int msg,const void *data); // todo
 
 //called every frame
-DLL_EXPORT void Update(void *ai )
+SHARED_EXPORT void Update(void *ai )
 {
 }
     

Modified: trunk/AI/Global/CSAI/ABICompatibilityLayer/myaimingw.cpp
===================================================================
--- trunk/AI/Global/CSAI/ABICompatibilityLayer/myaimingw.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/CSAI/ABICompatibilityLayer/myaimingw.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -1,6 +1,6 @@
 #include &lt;stdio.h&gt;
 
-#include &quot;ExternalAI/aibase.h&quot; // we need this to define DLL_EXPORT
+#include &quot;ExternalAI/aibase.h&quot; // we need this to define SHARED_EXPORT
 
 // ***** dont include any spring includes above this, except aibase.h ******
 #include &quot;AbicAICallback.h&quot;
@@ -127,65 +127,65 @@
 // exported dll symbols, wrap our AI class
 
 // returns pointers to our new AI object
-DLL_EXPORT void *InitAI( struct IAICallback *aicallback, int team)
+SHARED_EXPORT void *InitAI( struct IAICallback *aicallback, int team)
 {
     MyAI *ai = new MyAI();
     ai-&gt;InitAI( aicallback, team );
     return ai;
 }
 
-DLL_EXPORT void UnitCreated( void *ai, int unit)									//called when a new unit is created on ai team
+SHARED_EXPORT void UnitCreated( void *ai, int unit)									//called when a new unit is created on ai team
 {
     ( ( MyAI *)ai )-&gt;UnitCreated( unit );
 }
 
-DLL_EXPORT void UnitFinished(void *ai, int unit)							//called when an unit has finished building
+SHARED_EXPORT void UnitFinished(void *ai, int unit)							//called when an unit has finished building
 {
     ( ( MyAI *)ai )-&gt;UnitFinished( unit );
 }
 
-DLL_EXPORT void UnitDestroyed(void *ai, int unit,int attacker)								//called when a unit is destroyed
+SHARED_EXPORT void UnitDestroyed(void *ai, int unit,int attacker)								//called when a unit is destroyed
 {
 }
 
-DLL_EXPORT void EnemyEnterLOS(void *ai, int enemy)
+SHARED_EXPORT void EnemyEnterLOS(void *ai, int enemy)
 {
 }
 
-DLL_EXPORT void EnemyLeaveLOS(void *ai, int enemy)
+SHARED_EXPORT void EnemyLeaveLOS(void *ai, int enemy)
 {
 }
 
-DLL_EXPORT void EnemyEnterRadar(void *ai, int enemy)		
+SHARED_EXPORT void EnemyEnterRadar(void *ai, int enemy)		
 {
 }
 
-DLL_EXPORT void EnemyLeaveRadar(void *ai, int enemy)
+SHARED_EXPORT void EnemyLeaveRadar(void *ai, int enemy)
 {
 }
 
-DLL_EXPORT void EnemyDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)	//called when an enemy inside los or radar is damaged
+SHARED_EXPORT void EnemyDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)	//called when an enemy inside los or radar is damaged
 {
 }
 
-DLL_EXPORT void EnemyDestroyed(void *ai, int enemy,int attacker)							//will be called if an enemy inside los or radar dies (note that leave los etc will not be called then)
+SHARED_EXPORT void EnemyDestroyed(void *ai, int enemy,int attacker)							//will be called if an enemy inside los or radar dies (note that leave los etc will not be called then)
 {
 }
 
-DLL_EXPORT void UnitIdle(void *ai, int unit)										//called when a unit go idle and is not assigned to any group
+SHARED_EXPORT void UnitIdle(void *ai, int unit)										//called when a unit go idle and is not assigned to any group
 {
     ( ( MyAI *)ai )-&gt;UnitIdle( unit );
 }
 
-DLL_EXPORT void GotChatMsg(void *aik, const char* msg,int player)					//called when someone writes a chat msg
+SHARED_EXPORT void GotChatMsg(void *aik, const char* msg,int player)					//called when someone writes a chat msg
 {
 }
 
-DLL_EXPORT void UnitDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)					//called when one of your units are damaged
+SHARED_EXPORT void UnitDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)					//called when one of your units are damaged
 {
 }
 
-DLL_EXPORT void UnitMoveFailed(void *ai, int unit)
+SHARED_EXPORT void UnitMoveFailed(void *ai, int unit)
 {
     ( ( MyAI *)ai )-&gt;UnitMoveFailed( unit );
 }
@@ -193,7 +193,7 @@
 //int HandleEvent (int msg,const void *data); // todo
 
 //called every frame
-DLL_EXPORT void Update(void *ai )
+SHARED_EXPORT void Update(void *ai )
 {
 }
     

Modified: trunk/AI/Global/CSAI/CSAILoader/CSAILoader.cpp
===================================================================
--- trunk/AI/Global/CSAI/CSAILoader/CSAILoader.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/CSAI/CSAILoader/CSAILoader.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -9,22 +9,22 @@
 /////////////////////////////////////////////////////////////////////////////
 
 // declare that we present a C interface.  Spring checks for this.
-DLL_EXPORT bool IsCInterface()
+SHARED_EXPORT bool IsCInterface()
 {
     return true;
 }
 
-DLL_EXPORT int GetGlobalAiVersion()
+SHARED_EXPORT int GetGlobalAiVersion()
 {
 	return GLOBALAI_C_INTERFACE_VERSION;
 }
 
-DLL_EXPORT void GetAiName(char* name)
+SHARED_EXPORT void GetAiName(char* name)
 {
 	strcpy(name, CSAIProxy::GetAiName() );
 }
 
-DLL_EXPORT void *InitAI( struct IAICallback *aicallback, int team)
+SHARED_EXPORT void *InitAI( struct IAICallback *aicallback, int team)
 {
     CSAIProxy *ai = new CSAIProxy();
     AbicAICallbackWrapper *aicallbackwrapper = new AbicAICallbackWrapper( aicallback );
@@ -32,67 +32,67 @@
     return ai;
 }
 
-DLL_EXPORT void UnitCreated( void *ai, int unit)									//called when a new unit is created on ai team
+SHARED_EXPORT void UnitCreated( void *ai, int unit)									//called when a new unit is created on ai team
 {
     ( ( CSAIProxy *)ai )-&gt;UnitCreated( unit );
 }
 
-DLL_EXPORT void UnitFinished(void *ai, int unit)							//called when an unit has finished building
+SHARED_EXPORT void UnitFinished(void *ai, int unit)							//called when an unit has finished building
 {
     ( ( CSAIProxy *)ai )-&gt;UnitFinished( unit );
 }
 
-DLL_EXPORT void UnitDestroyed(void *ai, int unit,int attacker)								//called when a unit is destroyed
+SHARED_EXPORT void UnitDestroyed(void *ai, int unit,int attacker)								//called when a unit is destroyed
 {
     ( ( CSAIProxy *)ai )-&gt;UnitDestroyed( unit, attacker );
 }
 
-DLL_EXPORT void EnemyEnterLOS(void *ai, int enemy)
+SHARED_EXPORT void EnemyEnterLOS(void *ai, int enemy)
 {
     ( ( CSAIProxy *)ai )-&gt;EnemyEnterLOS( enemy );
 }
 
-DLL_EXPORT void EnemyLeaveLOS(void *ai, int enemy)
+SHARED_EXPORT void EnemyLeaveLOS(void *ai, int enemy)
 {
     ( ( CSAIProxy *)ai )-&gt;EnemyLeaveLOS( enemy );
 }
 
-DLL_EXPORT void EnemyEnterRadar(void *ai, int enemy)		
+SHARED_EXPORT void EnemyEnterRadar(void *ai, int enemy)		
 {
     ( ( CSAIProxy *)ai )-&gt;EnemyEnterRadar( enemy );
 }
 
-DLL_EXPORT void EnemyLeaveRadar(void *ai, int enemy)
+SHARED_EXPORT void EnemyLeaveRadar(void *ai, int enemy)
 {
     ( ( CSAIProxy *)ai )-&gt;EnemyLeaveRadar( enemy );
 }
 
-DLL_EXPORT void EnemyDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)	//called when an enemy inside los or radar is damaged
+SHARED_EXPORT void EnemyDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)	//called when an enemy inside los or radar is damaged
 {
     ( ( CSAIProxy *)ai )-&gt;EnemyDamaged( damaged, attacker ,damage, float3( dirx, diry, dirz ) );
 }
 
-DLL_EXPORT void EnemyDestroyed(void *ai, int enemy,int attacker)							//will be called if an enemy inside los or radar dies (note that leave los etc will not be called then)
+SHARED_EXPORT void EnemyDestroyed(void *ai, int enemy,int attacker)							//will be called if an enemy inside los or radar dies (note that leave los etc will not be called then)
 {
     ( ( CSAIProxy *)ai )-&gt;EnemyDestroyed( enemy, attacker );
 }
 
-DLL_EXPORT void UnitIdle(void *ai, int unit)										//called when a unit go idle and is not assigned to any group
+SHARED_EXPORT void UnitIdle(void *ai, int unit)										//called when a unit go idle and is not assigned to any group
 {
     ( ( CSAIProxy *)ai )-&gt;UnitIdle( unit );
 }
 
-DLL_EXPORT void GotChatMsg(void *ai, const char* msg,int player)					//called when someone writes a chat msg
+SHARED_EXPORT void GotChatMsg(void *ai, const char* msg,int player)					//called when someone writes a chat msg
 {
     ( ( CSAIProxy *)ai )-&gt;GotChatMsg( msg, player );
 }
 
-DLL_EXPORT void UnitDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)					//called when one of your units are damaged
+SHARED_EXPORT void UnitDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)					//called when one of your units are damaged
 {
     ( ( CSAIProxy *)ai )-&gt;UnitDamaged( damaged, attacker, damage, float3(dirx, diry, dirz ) );
 }
 
-DLL_EXPORT void UnitMoveFailed(void *ai, int unit)
+SHARED_EXPORT void UnitMoveFailed(void *ai, int unit)
 {
     ( ( CSAIProxy *)ai )-&gt;UnitMoveFailed( unit );
 }
@@ -102,23 +102,23 @@
 //int HandleEvent (int msg,const void *data); // todo
 
 //called every frame
-DLL_EXPORT void Update(void *ai )
+SHARED_EXPORT void Update(void *ai )
 {
     ( ( CSAIProxy *)ai )-&gt;Update();
 }
     
 /* Old C++ interface bootstrap:
-DLL_EXPORT int GetGlobalAiVersion()
+SHARED_EXPORT int GetGlobalAiVersion()
 {
 	return GLOBAL_AI_INTERFACE_VERSION;
 }
 
-DLL_EXPORT void GetAiName(char* name)
+SHARED_EXPORT void GetAiName(char* name)
 {
 	strcpy(name,AI_NAME);
 }
 
-DLL_EXPORT IGlobalAI* GetNewAI()
+SHARED_EXPORT IGlobalAI* GetNewAI()
 {
     __crt_dll_initialize();
     
@@ -127,7 +127,7 @@
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(IGlobalAI* i)
+SHARED_EXPORT void ReleaseAI(IGlobalAI* i)
 {
 	delete i;
 	ais.erase(i);

Modified: trunk/AI/Global/CSAI/MonoLoader/CSAILoaderMono.cpp
===================================================================
--- trunk/AI/Global/CSAI/MonoLoader/CSAILoaderMono.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/CSAI/MonoLoader/CSAILoaderMono.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -365,23 +365,23 @@
 }
 
 // declare that we present a C interface.  Spring checks for this.
-DLL_EXPORT bool IsCInterface()
+SHARED_EXPORT bool IsCInterface()
 {
     return true;
 }
 
-DLL_EXPORT int GetGlobalAiVersion()
+SHARED_EXPORT int GetGlobalAiVersion()
 {
 	return GLOBALAI_C_INTERFACE_VERSION;
 }
 
-DLL_EXPORT void GetAiName(char* name)
+SHARED_EXPORT void GetAiName(char* name)
 {
 	strcpy(name, &quot;CSAILoaderMono&quot; );
 }
 
 static int numexec = 0;
-DLL_EXPORT void *InitAI( struct IAICallback *aicallback, int team)
+SHARED_EXPORT void *InitAI( struct IAICallback *aicallback, int team)
 {
     AIProxy *aiproxy = new AIProxy(); // set this variable, so the callbacks go to right place
     thisaiproxy = aiproxy;  // so Set callbacks work ok
@@ -420,63 +420,63 @@
     return aiproxy;
 }
 
-DLL_EXPORT void UnitCreated( void *ai, int unit)									//called when a new unit is created on ai team
+SHARED_EXPORT void UnitCreated( void *ai, int unit)									//called when a new unit is created on ai team
 {
     WriteLine( &quot;UnitCreated &gt;&gt;&gt;&quot; );
     ( (AIProxy *)ai )-&gt;UnitCreated( unit );
     WriteLine( &quot;UnitCreated &lt;&lt;&lt;&quot; );
 }
 
-DLL_EXPORT void UnitFinished(void *ai, int unit)							//called when an unit has finished building
+SHARED_EXPORT void UnitFinished(void *ai, int unit)							//called when an unit has finished building
 {
     WriteLine( &quot;UnitFinished &gt;&gt;&gt;&quot; );
     ( (AIProxy *)ai )-&gt;UnitFinished( unit );
     WriteLine( &quot;UnitFinished &lt;&lt;&lt;&quot; );
 }
 
-DLL_EXPORT void UnitDestroyed(void *ai, int unit,int attacker)								//called when a unit is destroyed
+SHARED_EXPORT void UnitDestroyed(void *ai, int unit,int attacker)								//called when a unit is destroyed
 {
     ( (AIProxy *)ai )-&gt;UnitDestroyed( unit, attacker );
 }
 
-DLL_EXPORT void EnemyEnterLOS(void *ai, int enemy)
+SHARED_EXPORT void EnemyEnterLOS(void *ai, int enemy)
 {
     ( (AIProxy *)ai )-&gt;EnemyEnterLOS( enemy );
 }
 
-DLL_EXPORT void EnemyLeaveLOS(void *ai, int enemy)
+SHARED_EXPORT void EnemyLeaveLOS(void *ai, int enemy)
 {
     ( (AIProxy *)ai )-&gt;EnemyLeaveLOS( enemy );
 }
 
-DLL_EXPORT void EnemyEnterRadar(void *ai, int enemy)		
+SHARED_EXPORT void EnemyEnterRadar(void *ai, int enemy)		
 {
     ( (AIProxy *)ai )-&gt;EnemyEnterRadar(enemy );
 }
 
-DLL_EXPORT void EnemyLeaveRadar(void *ai, int enemy)
+SHARED_EXPORT void EnemyLeaveRadar(void *ai, int enemy)
 {
     ( (AIProxy *)ai )-&gt;EnemyLeaveRadar( enemy );
 }
 
-DLL_EXPORT void EnemyDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)	//called when an enemy inside los or radar is damaged
+SHARED_EXPORT void EnemyDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)	//called when an enemy inside los or radar is damaged
 {
     ( (AIProxy *)ai )-&gt;EnemyDamaged( damaged, attacker, damage, dirx, diry, dirz );
 }
 
-DLL_EXPORT void EnemyDestroyed(void *ai, int enemy,int attacker)							//will be called if an enemy inside los or radar dies (note that leave los etc will not be called then)
+SHARED_EXPORT void EnemyDestroyed(void *ai, int enemy,int attacker)							//will be called if an enemy inside los or radar dies (note that leave los etc will not be called then)
 {
     ( (AIProxy *)ai )-&gt;EnemyDestroyed( enemy, attacker );
 }
 
-DLL_EXPORT void UnitIdle(void *ai, int unit)										//called when a unit go idle and is not assigned to any group
+SHARED_EXPORT void UnitIdle(void *ai, int unit)										//called when a unit go idle and is not assigned to any group
 {
     WriteLine( &quot;UnitIdle &gt;&gt;&gt;&quot; );
     ( (AIProxy *)ai )-&gt;UnitIdle( unit );
     WriteLine( &quot;UnitIdle &lt;&lt;&lt;&quot; );
 }
 
-DLL_EXPORT void GotChatMsg(void *ai, const char* msg,int player)					//called when someone writes a chat msg
+SHARED_EXPORT void GotChatMsg(void *ai, const char* msg,int player)					//called when someone writes a chat msg
 {
     WriteLine( &quot;GotChatMsg &gt;&gt;&gt;&quot; );
     WriteLine( msg );
@@ -484,12 +484,12 @@
     WriteLine( &quot;GotChatMsg &lt;&lt;&lt;&quot; );
 }
 
-DLL_EXPORT void UnitDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)					//called when one of your units are damaged
+SHARED_EXPORT void UnitDamaged(void *ai, int damaged,int attacker,float damage, float dirx, float diry, float dirz)					//called when one of your units are damaged
 {
     ( (AIProxy *)ai )-&gt;UnitDamaged( damaged, attacker, damage, dirx, diry, dirz );
 }
 
-DLL_EXPORT void UnitMoveFailed(void *ai, int unit)
+SHARED_EXPORT void UnitMoveFailed(void *ai, int unit)
 {
     ( (AIProxy *)ai )-&gt;UnitMoveFailed( unit );
 }
@@ -497,7 +497,7 @@
 //int HandleEvent (int msg,const void *data); // todo
 
 //called every frame
-DLL_EXPORT void Update(void *ai )
+SHARED_EXPORT void Update(void *ai )
 {
   //  WriteLine( &quot;Update &gt;&gt;&gt;&quot; );
     ( (AIProxy *)ai )-&gt;Update(  );

Modified: trunk/AI/Global/JCAI/Interface.cpp
===================================================================
--- trunk/AI/Global/JCAI/Interface.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/JCAI/Interface.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -15,24 +15,24 @@
 
 std::set&lt;IGlobalAI*&gt; ais;
 
-DLL_EXPORT int GetGlobalAiVersion()
+SHARED_EXPORT int GetGlobalAiVersion()
 {
 	return GLOBAL_AI_INTERFACE_VERSION;
 }
 
-DLL_EXPORT void GetAiName(char* name)
+SHARED_EXPORT void GetAiName(char* name)
 {
 	strcpy(name,AI_NAME);
 }
 
-DLL_EXPORT IGlobalAI* GetNewAI()
+SHARED_EXPORT IGlobalAI* GetNewAI()
 {
 	MainAI* ai=new MainAI(ais.size());
 	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(IGlobalAI* i)
+SHARED_EXPORT void ReleaseAI(IGlobalAI* i)
 {
 	delete i;
 	ais.erase(i);
@@ -40,3 +40,4 @@
 	if (ais.empty ())
 		MainAI::FreeCommonData ();
 }
+

Modified: trunk/AI/Global/KAI-0.2/TestAI.cpp
===================================================================
--- trunk/AI/Global/KAI-0.2/TestAI.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/KAI-0.2/TestAI.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -3,32 +3,32 @@
 std::set&lt;IGlobalAI*&gt; ais;
 
 
-DLL_EXPORT int GetGlobalAiVersion() {
+SHARED_EXPORT int GetGlobalAiVersion() {
 	return GLOBAL_AI_INTERFACE_VERSION;
 }
 
-DLL_EXPORT void GetAiName(char* name) {
+SHARED_EXPORT void GetAiName(char* name) {
 	strcpy(name, AI_NAME);
 }
 
-DLL_EXPORT IGlobalAI* GetNewAI() {
+SHARED_EXPORT IGlobalAI* GetNewAI() {
 	if (ais.empty()) creg::System::InitializeClasses ();
 	CGlobalAI* ai = new CGlobalAI();
 	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(IGlobalAI* i) {
+SHARED_EXPORT void ReleaseAI(IGlobalAI* i) {
 	ais.erase(i);
 	delete (CGlobalAI*) i;
 	if (ais.empty()) creg::System::FreeClasses ();
 }
 
-DLL_EXPORT int IsCInterface(void) {
+SHARED_EXPORT int IsCInterface(void) {
 	return 0;
 }
 
-DLL_EXPORT bool IsLoadSupported()
+SHARED_EXPORT bool IsLoadSupported()
 {
 	return true;
 }

Modified: trunk/AI/Global/KAIK-0.13/AIExports.cpp
===================================================================
--- trunk/AI/Global/KAIK-0.13/AIExports.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/KAIK-0.13/AIExports.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -3,15 +3,15 @@
 std::set&lt;IGlobalAI*&gt; ais;
 
 
-DLL_EXPORT int GetGlobalAiVersion() {
+SHARED_EXPORT int GetGlobalAiVersion() {
 	return GLOBAL_AI_INTERFACE_VERSION;
 }
 
-DLL_EXPORT void GetAiName(char* name) {
+SHARED_EXPORT void GetAiName(char* name) {
 	strcpy(name, AI_VERSION);
 }
 
-DLL_EXPORT IGlobalAI* GetNewAI() {
+SHARED_EXPORT IGlobalAI* GetNewAI() {
 	if (ais.empty())
 		creg::System::InitializeClasses();
 
@@ -20,7 +20,7 @@
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(IGlobalAI* i) {
+SHARED_EXPORT void ReleaseAI(IGlobalAI* i) {
 	ais.erase(i);
 	delete (CGlobalAI*) i;
 
@@ -28,10 +28,10 @@
 		creg::System::FreeClasses();
 }
 
-DLL_EXPORT int IsCInterface(void) {
+SHARED_EXPORT int IsCInterface(void) {
 	return 0;
 }
 
-DLL_EXPORT int IsLoadSupported() {
+SHARED_EXPORT int IsLoadSupported() {
 	return 1;
 }

Modified: trunk/AI/Global/NTai/AI/NTai/Core/Interface.cpp
===================================================================
--- trunk/AI/Global/NTai/AI/NTai/Core/Interface.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/NTai/AI/NTai/Core/Interface.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -6,18 +6,19 @@
 
 #include &quot;CNTai.h&quot;
 
-DLL_EXPORT int GetGlobalAiVersion(){
+SHARED_EXPORT int GetGlobalAiVersion(){
 	return GLOBAL_AI_INTERFACE_VERSION;
 }
 
-DLL_EXPORT void GetAiName(char* name){
+SHARED_EXPORT void GetAiName(char* name){
 	strcpy(name,ntai::AI_NAME);
 }
 
-DLL_EXPORT IGlobalAI* GetNewAI(){
+SHARED_EXPORT IGlobalAI* GetNewAI(){
 	return new ntai::CNTai();
 }
 
-DLL_EXPORT void ReleaseAI(IGlobalAI* i){
+SHARED_EXPORT void ReleaseAI(IGlobalAI* i){
 	delete i;
 }
+

Modified: trunk/AI/Global/NTai/AI/ntai-xcode/build/ntai-xcode.build/ntai-xcode.pbxindex/strings.pbxstrings/strings
===================================================================
(Binary files differ)

Modified: trunk/AI/Global/RAI/DLLExportRAI.cpp
===================================================================
--- trunk/AI/Global/RAI/DLLExportRAI.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/RAI/DLLExportRAI.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -6,24 +6,24 @@
 
 std::set&lt;IGlobalAI*&gt; ais;
 
-DLL_EXPORT int GetGlobalAiVersion()
+SHARED_EXPORT int GetGlobalAiVersion()
 {
 	return GLOBAL_AI_INTERFACE_VERSION;
 }
 
-DLL_EXPORT void GetAiName(char* name)
+SHARED_EXPORT void GetAiName(char* name)
 {
 	strcpy(name,AI_NAME);
 }
 
-DLL_EXPORT IGlobalAI* GetNewAI()
+SHARED_EXPORT IGlobalAI* GetNewAI()
 {
 	cRAI* ai=new cRAI;
 	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(IGlobalAI* i)
+SHARED_EXPORT void ReleaseAI(IGlobalAI* i)
 {
 	delete (cRAI*)i;
 	ais.erase(i);

Modified: trunk/AI/Global/TestGlobalAI/TestAI.cpp
===================================================================
--- trunk/AI/Global/TestGlobalAI/TestAI.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Global/TestGlobalAI/TestAI.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -7,24 +7,24 @@
 
 std::set&lt;IGlobalAI*&gt; ais;
 
-DLL_EXPORT int GetGlobalAiVersion()
+SHARED_EXPORT int GetGlobalAiVersion()
 {
 	return GLOBAL_AI_INTERFACE_VERSION;
 }
 
-DLL_EXPORT void GetAiName(char* name)
+SHARED_EXPORT void GetAiName(char* name)
 {
 	strcpy(name,AI_NAME);
 }
 
-DLL_EXPORT IGlobalAI* GetNewAI()
+SHARED_EXPORT IGlobalAI* GetNewAI()
 {
 	TestGlobalAI* ai=new TestGlobalAI;
 	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(IGlobalAI* i)
+SHARED_EXPORT void ReleaseAI(IGlobalAI* i)
 {
 	delete i;
 	ais.erase(i);

Modified: trunk/AI/Group/CentralBuildAI/TestAI.cpp
===================================================================
--- trunk/AI/Group/CentralBuildAI/TestAI.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Group/CentralBuildAI/TestAI.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -3,19 +3,19 @@
 #include &quot;Sim/Units/UnitDef.h&quot;
 #include &lt;set&gt;
 
-DLL_EXPORT int GetGroupAiVersion()
+SHARED_EXPORT int GetGroupAiVersion()
 {
 	return AI_INTERFACE_VERSION;
 }
 
 static const char* aiNameList[] = { AI_NAME, NULL } ;
 
-DLL_EXPORT const char** GetAiNameList()
+SHARED_EXPORT const char** GetAiNameList()
 {
 	return aiNameList;
 }
 
-DLL_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
+SHARED_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
 {
 	if(unitDef-&gt;buildSpeed==0) //can only use builder units
 		return false;
@@ -23,14 +23,14 @@
 		return true;
 }
 
-DLL_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
+SHARED_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
 {
 	CGroupAI* ai=new CGroupAI();
 //	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
+SHARED_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
 {
 	delete i;
 //	ais.erase(i);

Modified: trunk/AI/Group/EconomyAI/TestAI.cpp
===================================================================
--- trunk/AI/Group/EconomyAI/TestAI.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Group/EconomyAI/TestAI.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -3,19 +3,19 @@
 #include &quot;ExternalAI/aibase.h&quot;
 #include &quot;Sim/Units/UnitDef.h&quot;
 
-DLL_EXPORT int GetGroupAiVersion()
+SHARED_EXPORT int GetGroupAiVersion()
 {
 	return AI_INTERFACE_VERSION;
 }
 
 static const char* aiNameList[] = { AI_NAME, NULL };
 
-DLL_EXPORT const char** GetAiNameList()
+SHARED_EXPORT const char** GetAiNameList()
 {
 	return aiNameList;
 }
 
-DLL_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
+SHARED_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
 {
 	if(unitDef-&gt;buildSpeed==0)
 		return false;
@@ -23,19 +23,19 @@
 		return true;
 }
 
-DLL_EXPORT bool IsLoadSupported(unsigned aiNumber)
+SHARED_EXPORT bool IsLoadSupported(unsigned aiNumber)
 {
 	return true;
 }
 
-DLL_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
+SHARED_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
 {
 	CGroupAI* ai=new CGroupAI();
 //	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
+SHARED_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
 {
 	delete i;
 //	ais.erase(i);

Modified: trunk/AI/Group/MetalMakerAI/TestAI.cpp
===================================================================
--- trunk/AI/Group/MetalMakerAI/TestAI.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Group/MetalMakerAI/TestAI.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -4,19 +4,19 @@
 #include &quot;Sim/Units/UnitDef.h&quot;
 #include &lt;set&gt;
 
-DLL_EXPORT int GetGroupAiVersion()
+SHARED_EXPORT int GetGroupAiVersion()
 {
 	return AI_INTERFACE_VERSION;
 }
 
 static const char* aiNameList[] = { AI_NAME, NULL };
 
-DLL_EXPORT const char** GetAiNameList()
+SHARED_EXPORT const char** GetAiNameList()
 {
 	return aiNameList;
 }
 
-DLL_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
+SHARED_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
 {
 	if(unitDef-&gt;energyUpkeep&gt;0.0f &amp;&amp; (unitDef-&gt;makesMetal&gt;0.0f || unitDef-&gt;extractsMetal&gt;0.0f))
 		return true;
@@ -24,14 +24,14 @@
 		return false;
 }
 
-DLL_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
+SHARED_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
 {
 	CGroupAI* ai=new CGroupAI();
 //	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
+SHARED_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
 {
 	delete i;
 //	ais.erase(i);

Modified: trunk/AI/Group/MexUpgraderAI/TestAI.cpp
===================================================================
--- trunk/AI/Group/MexUpgraderAI/TestAI.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Group/MexUpgraderAI/TestAI.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -3,24 +3,24 @@
 #include &quot;ExternalAI/aibase.h&quot;
 #include &quot;Sim/Units/UnitDef.h&quot;
 
-DLL_EXPORT int GetGroupAiVersion()
+SHARED_EXPORT int GetGroupAiVersion()
 {
 	return AI_INTERFACE_VERSION;
 }
 
 static const char* aiNameList[] = { AI_NAME, NULL };
 
-DLL_EXPORT const char** GetAiNameList()
+SHARED_EXPORT const char** GetAiNameList()
 {
 	return aiNameList;
 }
 
-DLL_EXPORT bool IsLoadSupported(unsigned aiNumber)
+SHARED_EXPORT bool IsLoadSupported(unsigned aiNumber)
 {
 	return true;
 }
 
-DLL_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
+SHARED_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
 {
 	if(unitDef-&gt;buildSpeed==0 || !unitDef-&gt;canmove)
 		return false;
@@ -28,14 +28,14 @@
 		return true;
 }
 
-DLL_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
+SHARED_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
 {
 	CGroupAI* ai=new CGroupAI();
 //	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
+SHARED_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
 {
 	delete i;
 //	ais.erase(i);

Modified: trunk/AI/Group/RadarAI/TestAI.cpp
===================================================================
--- trunk/AI/Group/RadarAI/TestAI.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Group/RadarAI/TestAI.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -3,19 +3,19 @@
 #include &quot;ExternalAI/aibase.h&quot;
 #include &quot;Sim/Units/UnitDef.h&quot;
 
-DLL_EXPORT int GetGroupAiVersion()
+SHARED_EXPORT int GetGroupAiVersion()
 {
 	return AI_INTERFACE_VERSION;
 }
 
 static const char* aiNameList[] = { AI_NAME, NULL };
 
-DLL_EXPORT const char** GetAiNameList()
+SHARED_EXPORT const char** GetAiNameList()
 {
 	return aiNameList;
 }
 
-DLL_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
+SHARED_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
 {
 	if(unitDef-&gt;radarRadius==0 &amp;&amp; unitDef-&gt;sonarRadius==0)
 		return false;
@@ -23,14 +23,14 @@
 		return true;
 }
 
-DLL_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
+SHARED_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
 {
 	CGroupAI* ai=new CGroupAI();
 //	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
+SHARED_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
 {
 	delete i;
 //	ais.erase(i);

Modified: trunk/AI/Group/ReportIdleAI/TestAI.cpp
===================================================================
--- trunk/AI/Group/ReportIdleAI/TestAI.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Group/ReportIdleAI/TestAI.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -3,19 +3,19 @@
 #include &quot;ExternalAI/aibase.h&quot;
 #include &quot;Sim/Units/UnitDef.h&quot;
 
-DLL_EXPORT int GetGroupAiVersion()
+SHARED_EXPORT int GetGroupAiVersion()
 {
 	return AI_INTERFACE_VERSION;
 }
 
 static const char* aiNameList[] = { AI_NAME, NULL };
 
-DLL_EXPORT const char** GetAiNameList()
+SHARED_EXPORT const char** GetAiNameList()
 {
 	return aiNameList;
 }
 
-DLL_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
+SHARED_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
 {
 	if(unitDef-&gt;buildSpeed==0)
 	{
@@ -27,14 +27,14 @@
 	}
 }
 
-DLL_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
+SHARED_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
 {
 	CGroupAI* ai=new CGroupAI();
 //	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
+SHARED_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
 {
 	delete i;
 //	ais.erase(i);

Modified: trunk/AI/Group/SimpleFormationAI/TestAI.cpp
===================================================================
--- trunk/AI/Group/SimpleFormationAI/TestAI.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/AI/Group/SimpleFormationAI/TestAI.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -4,19 +4,19 @@
 #include &quot;Sim/Units/UnitDef.h&quot;
 #include &lt;set&gt;
 
-DLL_EXPORT int GetGroupAiVersion()
+SHARED_EXPORT int GetGroupAiVersion()
 {
 	return AI_INTERFACE_VERSION;
 }
 
 static const char* aiNameList[] = { AI_NAME, NULL };
 
-DLL_EXPORT const char** GetAiNameList()
+SHARED_EXPORT const char** GetAiNameList()
 {
 	return aiNameList;
 }
 
-DLL_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
+SHARED_EXPORT bool IsUnitSuited(unsigned aiNumber, const UnitDef* unitDef)
 {
 	if(!unitDef-&gt;canmove)
 		return false;
@@ -24,14 +24,14 @@
 		return true;
 }
 
-DLL_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
+SHARED_EXPORT IGroupAI* GetNewAI(unsigned aiNumber)
 {
 	CGroupAI* ai=new CGroupAI();
 //	ais.insert(ai);
 	return ai;
 }
 
-DLL_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
+SHARED_EXPORT void ReleaseAI(unsigned aiNumber, IGroupAI* i)
 {
 	delete i;
 //	ais.erase(i);

Modified: trunk/rts/ExternalAI/aibase.h
===================================================================
--- trunk/rts/ExternalAI/aibase.h	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/rts/ExternalAI/aibase.h	2008-11-19 15:48:58 UTC (rev 7071)
@@ -8,15 +8,12 @@
 
 // Shared library support
 #ifdef _WIN32
-	#define DLL_EXPORT extern &quot;C&quot; __declspec(dllexport)
 	#define SPRING_API
 #elif __GNUC__ &gt;= 4
 	// Support for '-fvisibility=hidden'.
-	#define DLL_EXPORT extern &quot;C&quot; __attribute__ ((visibility(&quot;default&quot;)))
 	#define SPRING_API __attribute__ ((visibility(&quot;default&quot;)))
 #else
 	// Older versions of gcc have everything visible; no need for fancy stuff.
-	#define DLL_EXPORT extern &quot;C&quot;
 	#define SPRING_API
 #endif
 
@@ -38,6 +35,8 @@
 	#define IMPLEMENT_PURE_VIRTUAL(proto) proto{}
 #endif
 
+#include &quot;exportdefines.h&quot;
+
 #include &quot;Sim/Units/CommandAI/Command.h&quot;
 #include &quot;Sim/Units/UnitDef.h&quot;
 #include &quot;Sim/Weapons/WeaponDefHandler.h&quot;

Added: trunk/rts/System/exportdefines.h
===================================================================
--- trunk/rts/System/exportdefines.h	                        (rev 0)
+++ trunk/rts/System/exportdefines.h	2008-11-19 15:48:58 UTC (rev 7071)
@@ -0,0 +1,80 @@
+/*
+	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
+
+	This program is free software; you can redistribute it and/or modify
+	it under the terms of the GNU General Public License as published by
+	the Free Software Foundation; either version 2 of the License, or
+	(at your option) any later version.
+
+	This program is distributed in the hope that it will be useful,
+	but WITHOUT ANY WARRANTY; without even the implied warranty of
+	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+	GNU General Public License for more details.
+
+	You should have received a copy of the GNU General Public License
+	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef _EXPORTDEFINES_H
+#define _EXPORTDEFINES_H
+
+#ifdef __cplusplus
+extern &quot;C&quot; {
+#endif // __cplusplus
+
+#define SPRING_CALLING_CONVENTION stdcall
+#define SPRING_CALLING_CONVENTION_2 __stdcall
+
+// extern declaration that will work across
+// different platforms and compilers
+#ifndef SHARED_EXPORT
+	#ifdef __cplusplus
+		#ifdef _WIN32
+			#define SHARED_EXPORT extern &quot;C&quot; __declspec(dllexport)
+			#define SPRING_API
+		#elif __GNUC__ &gt;= 4
+		 // Support for '-fvisibility=hidden'.
+			#define SHARED_EXPORT extern &quot;C&quot; __attribute__ ((visibility(&quot;default&quot;)))
+			#define SPRING_API __attribute__ ((visibility(&quot;default&quot;)))
+		#else
+		 // Older versions of gcc have everything visible; no need for fancy stuff.
+			#define SHARED_EXPORT extern &quot;C&quot;
+			#define SPRING_API
+		#endif
+	#else // __cplusplus
+	 // we dont have t oexport if we are in C already
+		#define SHARED_EXPORT
+	#endif // __cplusplus
+#endif // SHARED_EXPORT
+
+#ifndef SHARED_EXPORT
+	#define SHARED_EXPORT SHARED_EXPORT
+#endif // SHARED_EXPORT
+
+
+// calling convention declaration that will work across
+// different platforms and compilers
+//#ifdef __GNUC__
+//	#define __stdcall
+//#else
+#ifndef CALLING_CONV
+	#ifdef _WIN32
+		#define CALLING_CONV SPRING_CALLING_CONVENTION_2
+	#elif __GNUC__
+		#define CALLING_CONV __attribute__ ((SPRING_CALLING_CONVENTION))
+	#elif __INTEL_COMPILER
+		#define CALLING_CONV __attribute__ ((SPRING_CALLING_CONVENTION))
+	#else
+		#define CALLING_CONV SPRING_CALLING_CONVENTION_2
+	#endif // _WIN32
+#endif // CALLING_CONV
+
+
+#define EXPORT(type) SHARED_EXPORT type CALLING_CONV
+
+
+#ifdef __cplusplus
+} // extern &quot;C&quot;
+#endif // __cplusplus
+
+#endif // _EXPORTDEFINES_H


Property changes on: trunk/rts/System/exportdefines.h
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/tools/unitsync/Doxyfile
===================================================================
--- trunk/tools/unitsync/Doxyfile	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/tools/unitsync/Doxyfile	2008-11-19 15:48:58 UTC (rev 7071)
@@ -196,8 +196,8 @@
 SEARCH_INCLUDES        = YES
 INCLUDE_PATH           = 
 INCLUDE_FILE_PATTERNS  = 
-PREDEFINED             = DLL_EXPORT= \
-                         __stdcall=
+PREDEFINED             = SHARED_EXPORT= \
+                         CALLING_CONV=
 EXPAND_AS_DEFINED      = 
 SKIP_FUNCTION_MACROS   = YES
 #---------------------------------------------------------------------------

Modified: trunk/tools/unitsync/LuaParserAPI.cpp
===================================================================
--- trunk/tools/unitsync/LuaParserAPI.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/tools/unitsync/LuaParserAPI.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -18,6 +18,7 @@
 #include &quot;System/FileSystem/ArchiveScanner.h&quot;
 #include &quot;System/FileSystem/VFSHandler.h&quot;
 #include &quot;unitsync.h&quot;
+#include &quot;exportdefines.h&quot;
 #include &lt;string&gt;
 #include &lt;vector&gt;
 using std::string;
@@ -41,7 +42,7 @@
 //  Primary calls
 //
 
-DLL_EXPORT void __stdcall lpClose()
+EXPORT(void) lpClose()
 {
 	rootTable = LuaTable();
 	currTable = LuaTable();
@@ -58,7 +59,7 @@
 }
 
 
-DLL_EXPORT int __stdcall lpOpenFile(const char* filename,
+EXPORT(int) lpOpenFile(const char* filename,
                                     const char* fileModes,
                                     const char* accessModes)
 {
@@ -68,7 +69,7 @@
 }
 
 
-DLL_EXPORT int __stdcall lpOpenSource(const char* source,
+EXPORT(int) lpOpenSource(const char* source,
                                       const char* accessModes)
 {
 	lpClose();
@@ -77,7 +78,7 @@
 }
 
 
-DLL_EXPORT int __stdcall lpExecute()
+EXPORT(int) lpExecute()
 {
 	if (!luaParser) {
 		return 0;
@@ -89,7 +90,7 @@
 }
 
 
-DLL_EXPORT const char* __stdcall lpErrorLog()
+EXPORT(const char*) lpErrorLog()
 {
 	if (luaParser) {
 		return GetStr(luaParser-&gt;GetErrorLog());
@@ -103,67 +104,67 @@
 //  Environment additions
 //
 
-DLL_EXPORT void __stdcall lpAddTableInt(int key, int override)
+EXPORT(void) lpAddTableInt(int key, int override)
 {
 	if (luaParser) { luaParser-&gt;GetTable(key, override); }
 }
 
 
-DLL_EXPORT void __stdcall lpAddTableStr(const char* key, int override)
+EXPORT(void) lpAddTableStr(const char* key, int override)
 {
 	if (luaParser) { luaParser-&gt;GetTable(key, override); }
 }
 
 
-DLL_EXPORT void __stdcall lpEndTable()
+EXPORT(void) lpEndTable()
 {
 	if (luaParser) { luaParser-&gt;EndTable(); }
 }
 
 
-DLL_EXPORT void __stdcall lpAddIntKeyIntVal(int key, int val)
+EXPORT(void) lpAddIntKeyIntVal(int key, int val)
 {
 	if (luaParser) { luaParser-&gt;AddInt(key, val); }
 }
 
 
-DLL_EXPORT void __stdcall lpAddStrKeyIntVal(const char* key, int val)
+EXPORT(void) lpAddStrKeyIntVal(const char* key, int val)
 {
 	if (luaParser) { luaParser-&gt;AddInt(key, val); }
 }
 
 
-DLL_EXPORT void __stdcall lpAddIntKeyBoolVal(int key, int val)
+EXPORT(void) lpAddIntKeyBoolVal(int key, int val)
 {
 	if (luaParser) { luaParser-&gt;AddBool(key, val); }
 }
 
 
-DLL_EXPORT void __stdcall lpAddStrKeyBoolVal(const char* key, int val)
+EXPORT(void) lpAddStrKeyBoolVal(const char* key, int val)
 {
 	if (luaParser) { luaParser-&gt;AddBool(key, val); }
 }
 
 
-DLL_EXPORT void __stdcall lpAddIntKeyFloatVal(int key, float val)
+EXPORT(void) lpAddIntKeyFloatVal(int key, float val)
 {
 	if (luaParser) { luaParser-&gt;AddFloat(key, val); }
 }
 
 
-DLL_EXPORT void __stdcall lpAddStrKeyFloatVal(const char* key, float val)
+EXPORT(void) lpAddStrKeyFloatVal(const char* key, float val)
 {
 	if (luaParser) { luaParser-&gt;AddFloat(key, val); }
 }
 
 
-DLL_EXPORT void __stdcall lpAddIntKeyStrVal(int key, const char* val)
+EXPORT(void) lpAddIntKeyStrVal(int key, const char* val)
 {
 	if (luaParser) { luaParser-&gt;AddString(key, val); }
 }
 
 
-DLL_EXPORT void __stdcall lpAddStrKeyStrVal(const char* key, const char* val)
+EXPORT(void) lpAddStrKeyStrVal(const char* key, const char* val)
 {
 	if (luaParser) { luaParser-&gt;AddString(key, val); }
 }
@@ -174,7 +175,7 @@
 //  Table manipulation
 //
 
-DLL_EXPORT int __stdcall lpRootTable()
+EXPORT(int) lpRootTable()
 {
 	currTable = rootTable;
 	luaTables.clear();
@@ -182,7 +183,7 @@
 }
 
 
-DLL_EXPORT int __stdcall lpRootTableExpr(const char* expr)
+EXPORT(int) lpRootTableExpr(const char* expr)
 {
 	currTable = rootTable.SubTableExpr(expr);
 	luaTables.clear();
@@ -190,7 +191,7 @@
 }
 
 
-DLL_EXPORT int __stdcall lpSubTableInt(int key)
+EXPORT(int) lpSubTableInt(int key)
 {
 	luaTables.push_back(currTable);
 	currTable = currTable.SubTable(key);
@@ -198,7 +199,7 @@
 }
 
 
-DLL_EXPORT int __stdcall lpSubTableStr(const char* key)
+EXPORT(int) lpSubTableStr(const char* key)
 {
 	luaTables.push_back(currTable);
 	currTable = currTable.SubTable(key);
@@ -206,7 +207,7 @@
 }
 
 
-DLL_EXPORT int __stdcall lpSubTableExpr(const char* expr)
+EXPORT(int) lpSubTableExpr(const char* expr)
 {
 	luaTables.push_back(currTable);
 	currTable = currTable.SubTableExpr(expr);
@@ -214,7 +215,7 @@
 }
 
 
-DLL_EXPORT void __stdcall lpPopTable()
+EXPORT(void) lpPopTable()
 {
 	if (luaTables.empty()) {
 		currTable = rootTable;
@@ -231,13 +232,13 @@
 //  Key existance
 //
 
-DLL_EXPORT int __stdcall lpGetKeyExistsInt(int key)
+EXPORT(int) lpGetKeyExistsInt(int key)
 {
 	return currTable.KeyExists(key) ? 1 : 0;
 }
 
 
-DLL_EXPORT int __stdcall lpGetKeyExistsStr(const char* key)
+EXPORT(int) lpGetKeyExistsStr(const char* key)
 {
 	return currTable.KeyExists(key) ? 1 : 0;
 }
@@ -248,13 +249,13 @@
 //  Type
 //
 
-DLL_EXPORT int __stdcall lpGetIntKeyType(int key)
+EXPORT(int) lpGetIntKeyType(int key)
 {
 	return currTable.GetType(key);
 }
 
 
-DLL_EXPORT int __stdcall lpGetStrKeyType(const char* key)
+EXPORT(int) lpGetStrKeyType(const char* key)
 {
 	return currTable.GetType(key);
 }
@@ -265,7 +266,7 @@
 // Key lists
 //
 
-DLL_EXPORT int __stdcall lpGetIntKeyListCount()
+EXPORT(int) lpGetIntKeyListCount()
 {
 	if (!currTable.IsValid()) {
 		intKeys.clear();
@@ -277,7 +278,7 @@
 }
 
 
-DLL_EXPORT int __stdcall lpGetIntKeyListEntry(int index)
+EXPORT(int) lpGetIntKeyListEntry(int index)
 {
 	if ((index &lt; 0) || (index &gt;= intKeys.size())) {
 		return 0;
@@ -286,7 +287,7 @@
 }
 
 
-DLL_EXPORT int __stdcall lpGetStrKeyListCount()
+EXPORT(int) lpGetStrKeyListCount()
 {
 	if (!currTable.IsValid()) {
 		strKeys.clear();
@@ -298,7 +299,7 @@
 }
 
 
-DLL_EXPORT const char* __stdcall lpGetStrKeyListEntry(int index)
+EXPORT(const char*) lpGetStrKeyListEntry(int index)
 {
 	if ((index &lt; 0) || (index &gt;= strKeys.size())) {
 		return GetStr(&quot;&quot;);
@@ -312,50 +313,50 @@
 //  Value queries
 //
 
-DLL_EXPORT int __stdcall lpGetIntKeyIntVal(int key, int defVal)
+EXPORT(int) lpGetIntKeyIntVal(int key, int defVal)
 {
 	return currTable.GetInt(key, defVal);
 }
 
 
-DLL_EXPORT int __stdcall lpGetStrKeyIntVal(const char* key, int defVal)
+EXPORT(int) lpGetStrKeyIntVal(const char* key, int defVal)
 {
 	return currTable.GetInt(key, defVal);
 }
 
 
-DLL_EXPORT int __stdcall lpGetIntKeyBoolVal(int key, int defVal)
+EXPORT(int) lpGetIntKeyBoolVal(int key, int defVal)
 {
 	return currTable.GetBool(key, defVal) ? 1 : 0;
 }
 
 
-DLL_EXPORT int __stdcall lpGetStrKeyBoolVal(const char* key, int defVal)
+EXPORT(int) lpGetStrKeyBoolVal(const char* key, int defVal)
 {
 	return currTable.GetBool(key, defVal) ? 1 : 0;
 }
 
 
-DLL_EXPORT float __stdcall lpGetIntKeyFloatVal(int key, float defVal)
+EXPORT(float) lpGetIntKeyFloatVal(int key, float defVal)
 {
 	return currTable.GetFloat(key, defVal);
 }
 
 
-DLL_EXPORT float __stdcall lpGetStrKeyFloatVal(const char* key, float defVal)
+EXPORT(float) lpGetStrKeyFloatVal(const char* key, float defVal)
 {
 	return currTable.GetFloat(key, defVal);
 }
 
 
-DLL_EXPORT const char* __stdcall lpGetIntKeyStrVal(int key,
+EXPORT(const char*) lpGetIntKeyStrVal(int key,
                                                    const char* defVal)
 {
 	return GetStr(currTable.GetString(key, defVal));
 }
 
 
-DLL_EXPORT const char* __stdcall lpGetStrKeyStrVal(const char* key,
+EXPORT(const char*) lpGetStrKeyStrVal(const char* key,
                                                    const char* defVal)
 {
 	return GetStr(currTable.GetString(key, defVal));

Modified: trunk/tools/unitsync/LuaParserAPI.h
===================================================================
--- trunk/tools/unitsync/LuaParserAPI.h	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/tools/unitsync/LuaParserAPI.h	2008-11-19 15:48:58 UTC (rev 7071)
@@ -3,6 +3,6 @@
 
 #include &quot;unitsync.h&quot;
 
-DLL_EXPORT void __stdcall lpClose();
+EXPORT(void) lpClose();
 
 #endif /* LUA_PARSER_API_H */

Modified: trunk/tools/unitsync/javabind.cpp
===================================================================
--- trunk/tools/unitsync/javabind.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/tools/unitsync/javabind.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -9,6 +9,7 @@
 #include &quot;ConfigHandler.h&quot;
 #include &quot;FileSystem/FileSystem.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
+#include &quot;exportdefines.h&quot;
 
 #include &lt;string&gt;
 #include &lt;string.h&gt;
@@ -24,100 +25,100 @@
 #pragma GCC visibility push(default)
 #endif
 
-DLL_EXPORT const char*  __stdcall GetSpringVersion();
-DLL_EXPORT void         __stdcall Message(const char* p_szMessage);
-DLL_EXPORT void         __stdcall UnInit();
-DLL_EXPORT int          __stdcall ProcessUnits(void);
-DLL_EXPORT int          __stdcall ProcessUnitsNoChecksum(void);
-DLL_EXPORT const char*  __stdcall GetCurrentList();
-DLL_EXPORT void         __stdcall AddClient(int id, const char *unitList);
-DLL_EXPORT void         __stdcall RemoveClient(int id);
-DLL_EXPORT const char*  __stdcall GetClientDiff(int id);
-DLL_EXPORT void         __stdcall InstallClientDiff(const char *diff);
-DLL_EXPORT int          __stdcall GetUnitCount();
-DLL_EXPORT const char*  __stdcall GetUnitName(int unit);
-DLL_EXPORT const char*  __stdcall GetFullUnitName(int unit);
-DLL_EXPORT int          __stdcall IsUnitDisabled(int unit);
-DLL_EXPORT int          __stdcall IsUnitDisabledByClient(int unit, int clientId);
-DLL_EXPORT void         __stdcall AddArchive(const char* name);
-DLL_EXPORT void         __stdcall AddAllArchives(const char* root);
-DLL_EXPORT unsigned int __stdcall GetArchiveChecksum(const char* arname);
-DLL_EXPORT int          __stdcall GetMapCount();
-DLL_EXPORT const char*  __stdcall GetMapName(int index);
-DLL_EXPORT int          __stdcall GetMapInfoEx(const char* name, MapInfo* outInfo, int version);
-DLL_EXPORT int          __stdcall GetMapInfo(const char* name, MapInfo* outInfo);
-DLL_EXPORT void*        __stdcall GetMinimap(const char* filename, int miplevel);
-DLL_EXPORT int          __stdcall GetMapArchiveCount(const char* mapName);
-DLL_EXPORT const char*  __stdcall GetMapArchiveName(int index);
-DLL_EXPORT unsigned int __stdcall GetMapChecksumFromName(const char* mapName);
-DLL_EXPORT unsigned int __stdcall GetMapChecksum(int index);
-DLL_EXPORT int          __stdcall GetPrimaryModCount();
-DLL_EXPORT const char*  __stdcall GetPrimaryModName(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModShortName(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModGame(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModShortGame(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModVersion(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModMutator(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModDescription(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModArchive(int index);
-DLL_EXPORT int          __stdcall GetPrimaryModArchiveCount(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModArchiveList(int arnr);
-DLL_EXPORT int          __stdcall GetPrimaryModIndex(const char* name);
-DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksum(int index);
-DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksumFromName(const char* name);
-DLL_EXPORT int          __stdcall GetSideCount();
-DLL_EXPORT const char*  __stdcall GetSideName(int side);
-DLL_EXPORT int          __stdcall OpenFileVFS(const char* name);
-DLL_EXPORT void         __stdcall CloseFileVFS(int handle);
-DLL_EXPORT void         __stdcall ReadFileVFS(int handle, void* buf, int length);
-DLL_EXPORT int          __stdcall FileSizeVFS(int handle);
-DLL_EXPORT int          __stdcall InitFindVFS(const char* pattern);
-DLL_EXPORT int          __stdcall FindFilesVFS(int handle, char* nameBuf, int size);
-DLL_EXPORT int          __stdcall OpenArchive(const char* name);
-DLL_EXPORT void         __stdcall CloseArchive(int archive);
-DLL_EXPORT int          __stdcall FindFilesArchive(int archive, int cur, char* nameBuf, int* size);
-DLL_EXPORT int          __stdcall OpenArchiveFile(int archive, const char* name);
-DLL_EXPORT int          __stdcall ReadArchiveFile(int archive, int handle, void* buffer, int numBytes);
-DLL_EXPORT void         __stdcall CloseArchiveFile(int archive, int handle);
-DLL_EXPORT int          __stdcall SizeArchiveFile(int archive, int handle);
+EXPORT(const char* ) GetSpringVersion();
+EXPORT(void        ) Message(const char* p_szMessage);
+EXPORT(void        ) UnInit();
+EXPORT(int         ) ProcessUnits(void);
+EXPORT(int         ) ProcessUnitsNoChecksum(void);
+EXPORT(const char* ) GetCurrentList();
+EXPORT(void        ) AddClient(int id, const char *unitList);
+EXPORT(void        ) RemoveClient(int id);
+EXPORT(const char* ) GetClientDiff(int id);
+EXPORT(void        ) InstallClientDiff(const char *diff);
+EXPORT(int         ) GetUnitCount();
+EXPORT(const char* ) GetUnitName(int unit);
+EXPORT(const char* ) GetFullUnitName(int unit);
+EXPORT(int         ) IsUnitDisabled(int unit);
+EXPORT(int         ) IsUnitDisabledByClient(int unit, int clientId);
+EXPORT(void        ) AddArchive(const char* name);
+EXPORT(void        ) AddAllArchives(const char* root);
+EXPORT(unsigned int) GetArchiveChecksum(const char* arname);
+EXPORT(int         ) GetMapCount();
+EXPORT(const char* ) GetMapName(int index);
+EXPORT(int         ) GetMapInfoEx(const char* name, MapInfo* outInfo, int version);
+EXPORT(int         ) GetMapInfo(const char* name, MapInfo* outInfo);
+EXPORT(void*       ) GetMinimap(const char* filename, int miplevel);
+EXPORT(int         ) GetMapArchiveCount(const char* mapName);
+EXPORT(const char* ) GetMapArchiveName(int index);
+EXPORT(unsigned int) GetMapChecksumFromName(const char* mapName);
+EXPORT(unsigned int) GetMapChecksum(int index);
+EXPORT(int         ) GetPrimaryModCount();
+EXPORT(const char* ) GetPrimaryModName(int index);
+EXPORT(const char* ) GetPrimaryModShortName(int index);
+EXPORT(const char* ) GetPrimaryModGame(int index);
+EXPORT(const char* ) GetPrimaryModShortGame(int index);
+EXPORT(const char* ) GetPrimaryModVersion(int index);
+EXPORT(const char* ) GetPrimaryModMutator(int index);
+EXPORT(const char* ) GetPrimaryModDescription(int index);
+EXPORT(const char* ) GetPrimaryModArchive(int index);
+EXPORT(int         ) GetPrimaryModArchiveCount(int index);
+EXPORT(const char* ) GetPrimaryModArchiveList(int arnr);
+EXPORT(int         ) GetPrimaryModIndex(const char* name);
+EXPORT(unsigned int) GetPrimaryModChecksum(int index);
+EXPORT(unsigned int) GetPrimaryModChecksumFromName(const char* name);
+EXPORT(int         ) GetSideCount();
+EXPORT(const char* ) GetSideName(int side);
+EXPORT(int         ) OpenFileVFS(const char* name);
+EXPORT(void        ) CloseFileVFS(int handle);
+EXPORT(void        ) ReadFileVFS(int handle, void* buf, int length);
+EXPORT(int         ) FileSizeVFS(int handle);
+EXPORT(int         ) InitFindVFS(const char* pattern);
+EXPORT(int         ) FindFilesVFS(int handle, char* nameBuf, int size);
+EXPORT(int         ) OpenArchive(const char* name);
+EXPORT(void        ) CloseArchive(int archive);
+EXPORT(int         ) FindFilesArchive(int archive, int cur, char* nameBuf, int* size);
+EXPORT(int         ) OpenArchiveFile(int archive, const char* name);
+EXPORT(int         ) ReadArchiveFile(int archive, int handle, void* buffer, int numBytes);
+EXPORT(void        ) CloseArchiveFile(int archive, int handle);
+EXPORT(int         ) SizeArchiveFile(int archive, int handle);
 
 // lua custom lobby settings
-DLL_EXPORT int          __stdcall GetMapOptionCount(const char* name);
-DLL_EXPORT int          __stdcall GetModOptionCount();
+EXPORT(int         ) GetMapOptionCount(const char* name);
+EXPORT(int         ) GetModOptionCount();
 
-DLL_EXPORT const char*  __stdcall GetOptionKey(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionName(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionDesc(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionType(int optIndex);
+EXPORT(const char* ) GetOptionKey(int optIndex);
+EXPORT(const char* ) GetOptionName(int optIndex);
+EXPORT(const char* ) GetOptionDesc(int optIndex);
+EXPORT(int         ) GetOptionType(int optIndex);
 
 // Bool Options
-DLL_EXPORT int          __stdcall GetOptionBoolDef(int optIndex);
+EXPORT(int         ) GetOptionBoolDef(int optIndex);
 
 // Number Options
-DLL_EXPORT float        __stdcall GetOptionNumberDef(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberMin(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberMax(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberStep(int optIndex);
+EXPORT(float       ) GetOptionNumberDef(int optIndex);
+EXPORT(float       ) GetOptionNumberMin(int optIndex);
+EXPORT(float       ) GetOptionNumberMax(int optIndex);
+EXPORT(float       ) GetOptionNumberStep(int optIndex);
 
 // String Options
-DLL_EXPORT const char*  __stdcall GetOptionStringDef(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionStringMaxLen(int optIndex);
+EXPORT(const char* ) GetOptionStringDef(int optIndex);
+EXPORT(int         ) GetOptionStringMaxLen(int optIndex);
 
 // List Options
-DLL_EXPORT int          __stdcall GetOptionListCount(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListDef(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemKey(int optIndex, int itemIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemName(int optIndex, int itemIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemDesc(int optIndex, int itemIndex);
+EXPORT(int         ) GetOptionListCount(int optIndex);
+EXPORT(const char* ) GetOptionListDef(int optIndex);
+EXPORT(const char* ) GetOptionListItemKey(int optIndex, int itemIndex);
+EXPORT(const char* ) GetOptionListItemName(int optIndex, int itemIndex);
+EXPORT(const char* ) GetOptionListItemDesc(int optIndex, int itemIndex);
 
 // Spring settings callback
 
-DLL_EXPORT const char*	__stdcall GetSpringConfigString( const char* name, const char* defvalue );
-DLL_EXPORT int			__stdcall GetSpringConfigInt( const char* name, const int defvalue );
-DLL_EXPORT float		__stdcall GetSpringConfigFloat( const char* name, const float defvalue );
-DLL_EXPORT void			__stdcall SetSpringConfigString( const char* name, const char* value );
-DLL_EXPORT void			__stdcall SetSpringConfigInt( const char* name, const int value );
-DLL_EXPORT void			__stdcall SetSpringConfigFloat( const char* name, const float value );
+EXPORT(const char* ) GetSpringConfigString( const char* name, const char* defvalue );
+EXPORT(int         ) GetSpringConfigInt( const char* name, const int defvalue );
+EXPORT(float       ) GetSpringConfigFloat( const char* name, const float defvalue );
+EXPORT(void        ) SetSpringConfigString( const char* name, const char* value );
+EXPORT(void        ) SetSpringConfigInt( const char* name, const int value );
+EXPORT(void        ) SetSpringConfigFloat( const char* name, const float value );
 
 
 /* DO NOT EDIT THIS FILE - it is machine generated */

Modified: trunk/tools/unitsync/pybind.cpp
===================================================================
--- trunk/tools/unitsync/pybind.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/tools/unitsync/pybind.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -15,59 +15,60 @@
 #include &quot;unitsync.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;FileSystem/FileSystem.h&quot;
+#include &quot;exportdefines.h&quot;
 
 #define NAMEBUF_SIZE 4096
 
 
 
-DLL_EXPORT const char*  __stdcall GetSpringVersion();
-DLL_EXPORT void         __stdcall Message(const char* p_szMessage);
-DLL_EXPORT void         __stdcall UnInit();
-DLL_EXPORT int          __stdcall ProcessUnits(void);
-DLL_EXPORT int          __stdcall ProcessUnitsNoChecksum(void);
-DLL_EXPORT const char*  __stdcall GetCurrentList();
-DLL_EXPORT void         __stdcall AddClient(int id, const char *unitList);
-DLL_EXPORT void         __stdcall RemoveClient(int id);
-DLL_EXPORT const char*  __stdcall GetClientDiff(int id);
-DLL_EXPORT void         __stdcall InstallClientDiff(const char *diff);
-DLL_EXPORT int          __stdcall GetUnitCount();
-DLL_EXPORT const char*  __stdcall GetUnitName(int unit);
-DLL_EXPORT const char*  __stdcall GetFullUnitName(int unit);
-DLL_EXPORT int          __stdcall IsUnitDisabled(int unit);
-DLL_EXPORT int          __stdcall IsUnitDisabledByClient(int unit, int clientId);
-DLL_EXPORT void         __stdcall AddArchive(const char* name);
-DLL_EXPORT void         __stdcall AddAllArchives(const char* root);
-DLL_EXPORT unsigned int __stdcall GetArchiveChecksum(const char* arname);
-DLL_EXPORT int          __stdcall GetMapCount();
-DLL_EXPORT const char*  __stdcall GetMapName(int index);
-DLL_EXPORT int          __stdcall GetMapInfoEx(const char* name, MapInfo* outInfo, int version);
-DLL_EXPORT int          __stdcall GetMapInfo(const char* name, MapInfo* outInfo);
-DLL_EXPORT void*        __stdcall GetMinimap(const char* filename, int miplevel);
-DLL_EXPORT int          __stdcall GetMapArchiveCount(const char* mapName);
-DLL_EXPORT const char*  __stdcall GetMapArchiveName(int index);
-DLL_EXPORT unsigned int __stdcall GetMapChecksum(int index);
-DLL_EXPORT int          __stdcall GetPrimaryModCount();
-DLL_EXPORT const char*  __stdcall GetPrimaryModName(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModArchive(int index);
-DLL_EXPORT int          __stdcall GetPrimaryModArchiveCount(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModArchiveList(int arnr);
-DLL_EXPORT int          __stdcall GetPrimaryModIndex(const char* name);
-DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksum(int index);
-DLL_EXPORT int          __stdcall GetSideCount();
-DLL_EXPORT const char*  __stdcall GetSideName(int side);
-DLL_EXPORT int          __stdcall OpenFileVFS(const char* name);
-DLL_EXPORT void         __stdcall CloseFileVFS(int handle);
-DLL_EXPORT void         __stdcall ReadFileVFS(int handle, void* buf, int length);
-DLL_EXPORT int          __stdcall FileSizeVFS(int handle);
-DLL_EXPORT int          __stdcall InitFindVFS(const char* pattern);
-DLL_EXPORT int          __stdcall FindFilesVFS(int handle, char* nameBuf, int size);
-DLL_EXPORT int          __stdcall OpenArchive(const char* name);
-DLL_EXPORT void         __stdcall CloseArchive(int archive);
-DLL_EXPORT int          __stdcall FindFilesArchive(int archive, int cur, char* nameBuf, int* size);
-DLL_EXPORT int          __stdcall OpenArchiveFile(int archive, const char* name);
-DLL_EXPORT int          __stdcall ReadArchiveFile(int archive, int handle, void* buffer, int numBytes);
-DLL_EXPORT void         __stdcall CloseArchiveFile(int archive, int handle);
-DLL_EXPORT int          __stdcall SizeArchiveFile(int archive, int handle);
+EXPORT(const char* ) GetSpringVersion();
+EXPORT(void        ) Message(const char* p_szMessage);
+EXPORT(void        ) UnInit();
+EXPORT(int         ) ProcessUnits(void);
+EXPORT(int         ) ProcessUnitsNoChecksum(void);
+EXPORT(const char* ) GetCurrentList();
+EXPORT(void        ) AddClient(int id, const char *unitList);
+EXPORT(void        ) RemoveClient(int id);
+EXPORT(const char* ) GetClientDiff(int id);
+EXPORT(void        ) InstallClientDiff(const char *diff);
+EXPORT(int         ) GetUnitCount();
+EXPORT(const char* ) GetUnitName(int unit);
+EXPORT(const char* ) GetFullUnitName(int unit);
+EXPORT(int         ) IsUnitDisabled(int unit);
+EXPORT(int         ) IsUnitDisabledByClient(int unit, int clientId);
+EXPORT(void        ) AddArchive(const char* name);
+EXPORT(void        ) AddAllArchives(const char* root);
+EXPORT(unsigned int) GetArchiveChecksum(const char* arname);
+EXPORT(int         ) GetMapCount();
+EXPORT(const char* ) GetMapName(int index);
+EXPORT(int         ) GetMapInfoEx(const char* name, MapInfo* outInfo, int version);
+EXPORT(int         ) GetMapInfo(const char* name, MapInfo* outInfo);
+EXPORT(void*       ) GetMinimap(const char* filename, int miplevel);
+EXPORT(int         ) GetMapArchiveCount(const char* mapName);
+EXPORT(const char* ) GetMapArchiveName(int index);
+EXPORT(unsigned int) GetMapChecksum(int index);
+EXPORT(int         ) GetPrimaryModCount();
+EXPORT(const char* ) GetPrimaryModName(int index);
+EXPORT(const char* ) GetPrimaryModArchive(int index);
+EXPORT(int         ) GetPrimaryModArchiveCount(int index);
+EXPORT(const char* ) GetPrimaryModArchiveList(int arnr);
+EXPORT(int         ) GetPrimaryModIndex(const char* name);
+EXPORT(unsigned int) GetPrimaryModChecksum(int index);
+EXPORT(int         ) GetSideCount();
+EXPORT(const char* ) GetSideName(int side);
+EXPORT(int         ) OpenFileVFS(const char* name);
+EXPORT(void        ) CloseFileVFS(int handle);
+EXPORT(void        ) ReadFileVFS(int handle, void* buf, int length);
+EXPORT(int         ) FileSizeVFS(int handle);
+EXPORT(int         ) InitFindVFS(const char* pattern);
+EXPORT(int         ) FindFilesVFS(int handle, char* nameBuf, int size);
+EXPORT(int         ) OpenArchive(const char* name);
+EXPORT(void        ) CloseArchive(int archive);
+EXPORT(int         ) FindFilesArchive(int archive, int cur, char* nameBuf, int* size);
+EXPORT(int         ) OpenArchiveFile(int archive, const char* name);
+EXPORT(int         ) ReadArchiveFile(int archive, int handle, void* buffer, int numBytes);
+EXPORT(void        ) CloseArchiveFile(int archive, int handle);
+EXPORT(int         ) SizeArchiveFile(int archive, int handle);
 
 
 
@@ -589,7 +590,7 @@
 }
 
 
-// Note to self: sed &quot;s/([^)]*);/ ),/g;s/[ \t]*DLL_EXPORT[^_]\+__stdcall /PY( /g;&quot;
+// Note to self: sed &quot;s/([^)]*);/ ),/g;s/[ \t]*EXPORT\([^\)]\+\) /PY( /g;&quot;
 // TODO   function documentation (last column)
 static PyMethodDef unitsyncMethods[] = {
 #define PY(name)         { # name , unitsync_ ## name , METH_VARARGS , NULL }
@@ -662,7 +663,7 @@
 #undef PY
 };
 
-// PyMODINIT_FUNC already includes the DLL_EXPORT equivalent
+// PyMODINIT_FUNC already includes the SHARED_EXPORT equivalent
 // and the right calling convention for the host platform.
 #ifdef _MSC_VER
 PyMODINIT_FUNC initunitsync(void)

Modified: trunk/tools/unitsync/unitsync.cpp
===================================================================
--- trunk/tools/unitsync/unitsync.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/tools/unitsync/unitsync.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -23,7 +23,9 @@
 #include &quot;System/Exceptions.h&quot;
 #include &quot;System/LogOutput.h&quot;
 #include &quot;System/Util.h&quot;
+#include &quot;System/exportdefines.h&quot;
 
+
 // unitsync only:
 #include &quot;LuaParserAPI.h&quot;
 #include &quot;Syncer.h&quot;
@@ -43,7 +45,7 @@
 
 
 #ifdef WIN32
-BOOL __stdcall DllMain(HINSTANCE hInst, DWORD dwReason, LPVOID lpReserved)
+BOOL CALLING_CONV DllMain(HINSTANCE hInst, DWORD dwReason, LPVOID lpReserved)
 {
 	return TRUE;
 }
@@ -187,7 +189,7 @@
  *			printf(&quot;unitsync error: %s\n&quot;, err);
  *		@endcode
  */
-DLL_EXPORT const char* __stdcall GetNextError()
+EXPORT(const char*) GetNextError()
 {
 	try {
 		// queue is only 1 element long now for simplicity :-)
@@ -214,7 +216,7 @@
  * Returns a const char* string specifying the version of spring used to build this library with.
  * It was added to aid in lobby creation, where checks for updates to spring occur.
  */
-DLL_EXPORT const char* __stdcall GetSpringVersion()
+EXPORT(const char*) GetSpringVersion()
 {
 	return GetStr(SpringVersion::Get());
 }
@@ -226,7 +228,7 @@
  *
  * Creates a messagebox with the title &quot;Message from DLL&quot;, an OK button, and the specified message
  */
-DLL_EXPORT void __stdcall Message(const char* p_szMessage)
+EXPORT(void) Message(const char* p_szMessage)
 {
 	try {
 		logOutput.Print(LOG_UNITSYNC, &quot;Message from DLL: %s\n&quot;, p_szMessage);
@@ -260,7 +262,7 @@
  *
  * also resets the config handler
  */
-DLL_EXPORT void __stdcall UnInit()
+EXPORT(void) UnInit()
 {
 	try {
 		_UnInit();
@@ -285,7 +287,7 @@
  * 
  * The config handler won't be reset, it will however be initialised if it wasn't before (with SetSpringConfigFile())
  */
-DLL_EXPORT int __stdcall Init(bool isServer, int id)
+EXPORT(int) Init(bool isServer, int id)
 {
 	try {
 		_UnInit();
@@ -323,7 +325,7 @@
  *
  * This is the data directory which is used to write logs, screenshots, demos, etc.
  */
-DLL_EXPORT const char* __stdcall GetWritableDataDirectory()
+EXPORT(const char*) GetWritableDataDirectory()
 {
 	try {
 		CheckInit();
@@ -349,7 +351,7 @@
  * Before any units are available, you'll first need to map a mod's archives
  * into the VFS using AddArchive() or AddAllArchives().
  */
-DLL_EXPORT int __stdcall ProcessUnits()
+EXPORT(int) ProcessUnits()
 {
 	try {
 		logOutput.Print(LOG_UNITSYNC, &quot;syncer: process units\n&quot;);
@@ -364,7 +366,7 @@
  * @brief Identical to ProcessUnits(), neither generates checksum anymore
  * @see ProcessUnits
  */
-DLL_EXPORT int __stdcall ProcessUnitsNoChecksum()
+EXPORT(int) ProcessUnitsNoChecksum()
 {
 	return ProcessUnits();
 }
@@ -384,7 +386,7 @@
  *		int unit_number = GetUnitCount();
  *		@endcode
  */
-DLL_EXPORT int __stdcall GetUnitCount()
+EXPORT(int) GetUnitCount()
 {
 	try {
 		logOutput.Print(LOG_UNITSYNC, &quot;syncer: get unit count\n&quot;);
@@ -403,7 +405,7 @@
  * This function returns the units internal mod name. For example it would
  * return 'armck' and not 'Arm Construction kbot'.
  */
-DLL_EXPORT const char * __stdcall GetUnitName(int unit)
+EXPORT(const char *) GetUnitName(int unit)
 {
 	try {
 		logOutput.Print(LOG_UNITSYNC, &quot;syncer: get unit %d name\n&quot;, unit);
@@ -423,7 +425,7 @@
  * This function returns the units human name. For example it would return
  * 'Arm Construction kbot' and not 'armck'.
  */
-DLL_EXPORT const char * __stdcall GetFullUnitName(int unit)
+EXPORT(const char *) GetFullUnitName(int unit)
 {
 	try {
 		logOutput.Print(LOG_UNITSYNC, &quot;syncer: get full unit %d name\n&quot;, unit);
@@ -443,7 +445,7 @@
  * After this, the contents of the archive are available to other unitsync functions,
  * for example: ProcessUnits(), OpenFileVFS(), ReadFileVFS(), FileSizeVFS(), etc.
  */
-DLL_EXPORT void __stdcall AddArchive(const char* name)
+EXPORT(void) AddArchive(const char* name)
 {
 	try {
 		CheckInit();
@@ -460,7 +462,7 @@
  * @brief Adds an achive and all it's dependencies to the VFS
  * @see AddArchive
  */
-DLL_EXPORT void __stdcall AddAllArchives(const char* root)
+EXPORT(void) AddAllArchives(const char* root)
 {
 	try {
 		CheckInit();
@@ -483,7 +485,7 @@
  * This checksum depends only on the contents from the archive itself, and not
  * on the contents from dependencies of this archive (if any).
  */
-DLL_EXPORT unsigned int __stdcall GetArchiveChecksum(const char* arname)
+EXPORT(unsigned int) GetArchiveChecksum(const char* arname)
 {
 	try {
 		CheckInit();
@@ -501,7 +503,7 @@
  * @brief Gets the real path to the archive
  * @return NULL on error; a path to the archive on success
  */
-DLL_EXPORT const char* __stdcall GetArchivePath(const char* arname)
+EXPORT(const char*) GetArchivePath(const char* arname)
 {
 	try {
 		CheckInit();
@@ -537,7 +539,7 @@
  *		for (int index = 0; index &lt; GetMapCount(); ++index) { ... }
  *		@endcode
  */
-DLL_EXPORT int __stdcall GetMapCount()
+EXPORT(int) GetMapCount()
 {
 	try {
 		CheckInit();
@@ -567,7 +569,7 @@
  * @brief Get the name of a map
  * @return NULL on error; the name of the map (e.g. &quot;SmallDivide.smf&quot;) on success
  */
-DLL_EXPORT const char* __stdcall GetMapName(int index)
+EXPORT(const char*) GetMapName(int index)
 {
 	try {
 		CheckInit();
@@ -697,7 +699,7 @@
  *
  * If version &gt;= 1, then the author field is filled.
  */
-DLL_EXPORT int __stdcall GetMapInfoEx(const char* name, MapInfo* outInfo, int version)
+EXPORT(int) GetMapInfoEx(const char* name, MapInfo* outInfo, int version)
 {
 	try {
 		return _GetMapInfoEx(name, outInfo, version);
@@ -714,7 +716,7 @@
  * @return Zero on error; non-zero on success
  * @see GetMapInfoEx
  */
-DLL_EXPORT int __stdcall GetMapInfo(const char* name, MapInfo* outInfo)
+EXPORT(int) GetMapInfo(const char* name, MapInfo* outInfo)
 {
 	try {
 		return _GetMapInfoEx(name, outInfo, 0);
@@ -734,7 +736,7 @@
  *
  * Must be called before GetMapArchiveName()
  */
-DLL_EXPORT int __stdcall GetMapArchiveCount(const char* mapName)
+EXPORT(int) GetMapArchiveCount(const char* mapName)
 {
 	try {
 		CheckInit();
@@ -753,7 +755,7 @@
  * @param index the index of the archive
  * @return NULL on error; the name of the archive on success
  */
-DLL_EXPORT const char* __stdcall GetMapArchiveName(int index)
+EXPORT(const char*) GetMapArchiveName(int index)
 {
 	try {
 		CheckInit();
@@ -776,7 +778,7 @@
  *
  * (It is ment to check sync between clients in lobby, for example.)
  */
-DLL_EXPORT unsigned int __stdcall GetMapChecksum(int index)
+EXPORT(unsigned int) GetMapChecksum(int index)
 {
 	try {
 		CheckInit();
@@ -795,7 +797,7 @@
  * @return Zero on error; the checksum on success
  * @see GetMapChecksum
  */
-DLL_EXPORT unsigned int __stdcall GetMapChecksumFromName(const char* mapName)
+EXPORT(unsigned int) GetMapChecksumFromName(const char* mapName)
 {
 	try {
 		CheckInit();
@@ -955,7 +957,7 @@
  * An example usage would be GetMinimap(&quot;SmallDivide.smf&quot;, 2).
  * This would return a 16 bit packed RGB-565 256x256 (= 1024/2^2) bitmap.
  */
-DLL_EXPORT void* __stdcall GetMinimap(const char* filename, int miplevel)
+EXPORT(void*) GetMinimap(const char* filename, int miplevel)
 {
 	try {
 		CheckInit();
@@ -993,7 +995,7 @@
  * @return Non-zero when the infomap was found with a non-zero size; zero on error.
  * @see GetInfoMap
  */
-DLL_EXPORT int __stdcall GetInfoMapSize(const char* filename, const char* name, int* width, int* height)
+EXPORT(int) GetInfoMapSize(const char* filename, const char* name, int* width, int* height)
 {
 	try {
 		CheckInit();
@@ -1036,7 +1038,7 @@
  * this function to convert from one format to another. Currently only the
  * conversion from 16 bpp to 8 bpp is implemented.
  */
-DLL_EXPORT int __stdcall GetInfoMap(const char* filename, const char* name, void* data, int typeHint)
+EXPORT(int) GetInfoMap(const char* filename, const char* name, void* data, int typeHint)
 {
 	try {
 		CheckInit();
@@ -1093,7 +1095,7 @@
  * @return int Zero on error; The number of mods available on success
  * @see GetMapCount
  */
-DLL_EXPORT int __stdcall GetPrimaryModCount()
+EXPORT(int) GetPrimaryModCount()
 {
 	try {
 		CheckInit();
@@ -1114,7 +1116,7 @@
  * Returns the name of the mod usually found in modinfo.tdf.
  * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetPrimaryModName(int index)
+EXPORT(const char*) GetPrimaryModName(int index)
 {
 	try {
 		CheckInit();
@@ -1136,7 +1138,7 @@
  * Returns the shortened name of the mod usually found in modinfo.tdf.
  * Be sure you've made a call GetPrimaryModCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetPrimaryModShortName(int index)
+EXPORT(const char*) GetPrimaryModShortName(int index)
 {
 	try {
 		CheckInit();
@@ -1158,7 +1160,7 @@
  * Returns value of the mutator tag for the specified mod usually found in modinfo.tdf.
  * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetPrimaryModVersion(int index)
+EXPORT(const char*) GetPrimaryModVersion(int index)
 {
 	try {
 		CheckInit();
@@ -1180,7 +1182,7 @@
  * Returns value of the mutator tag for the specified mod usually found in modinfo.tdf.
  * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetPrimaryModMutator(int index)
+EXPORT(const char*) GetPrimaryModMutator(int index)
 {
 	try {
 		CheckInit();
@@ -1202,7 +1204,7 @@
  * Returns the name of the game this mod belongs to usually found in modinfo.tdf.
  * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetPrimaryModGame(int index)
+EXPORT(const char*) GetPrimaryModGame(int index)
 {
 	try {
 		CheckInit();
@@ -1224,7 +1226,7 @@
  * Returns the abbrieviated name of the game this mod belongs to usually found in modinfo.tdf.
  * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetPrimaryModShortGame(int index)
+EXPORT(const char*) GetPrimaryModShortGame(int index)
 {
 	try {
 		CheckInit();
@@ -1246,7 +1248,7 @@
  * Returns a description for the specified mod usually found in modinfo.tdf.
  * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetPrimaryModDescription(int index)
+EXPORT(const char*) GetPrimaryModDescription(int index)
 {
 	try {
 		CheckInit();
@@ -1268,7 +1270,7 @@
  * Returns the name of the primary archive of the mod.
  * Be sure you've made a call to GetPrimaryModCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetPrimaryModArchive(int index)
+EXPORT(const char*) GetPrimaryModArchive(int index)
 {
 	try {
 		CheckInit();
@@ -1299,7 +1301,7 @@
  *		}
  *		@endcode
  */
-DLL_EXPORT int __stdcall GetPrimaryModArchiveCount(int index)
+EXPORT(int) GetPrimaryModArchiveCount(int index)
 {
 	try {
 		CheckInit();
@@ -1319,7 +1321,7 @@
  * @return NULL on error; the name of the archive on success
  * @see GetPrimaryModArchiveCount
  */
-DLL_EXPORT const char* __stdcall GetPrimaryModArchiveList(int arnr)
+EXPORT(const char*) GetPrimaryModArchiveList(int arnr)
 {
 	try {
 		CheckInit();
@@ -1338,7 +1340,7 @@
  * @param name The name of the mod
  * @return -1 if the mod can not be found; the index of the mod otherwise
  */
-DLL_EXPORT int __stdcall GetPrimaryModIndex(const char* name)
+EXPORT(int) GetPrimaryModIndex(const char* name)
 {
 	try {
 		CheckInit();
@@ -1362,7 +1364,7 @@
  * @return Zero on error; the checksum on success.
  * @see GetMapChecksum
  */
-DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksum(int index)
+EXPORT(unsigned int) GetPrimaryModChecksum(int index)
 {
 	try {
 		CheckInit();
@@ -1381,7 +1383,7 @@
  * @return Zero on error; the checksum on success.
  * @see GetMapChecksum
  */
-DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksumFromName(const char* name)
+EXPORT(unsigned int) GetPrimaryModChecksumFromName(const char* name)
 {
 	try {
 		CheckInit();
@@ -1404,7 +1406,7 @@
  * available. Be sure to map the mod into the VFS using AddArchive() or
  * AddAllArchives() prior to using this function.
  */
-DLL_EXPORT int __stdcall GetSideCount()
+EXPORT(int) GetSideCount()
 {
 	try {
 		CheckInit();
@@ -1425,7 +1427,7 @@
  *
  * Be sure you've made a call to GetSideCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetSideName(int side)
+EXPORT(const char*) GetSideName(int side)
 {
 	try {
 		CheckInit();
@@ -1445,7 +1447,7 @@
  *
  * Be sure you've made a call to GetSideCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetSideStartUnit(int side)
+EXPORT(const char*) GetSideStartUnit(int side)
 {
 	try {
 		CheckInit();
@@ -1517,7 +1519,7 @@
  * Usually LUA AIs are shipped inside a mod, so be sure to map the mod into
  * the VFS using AddArchive() or AddAllArchives() prior to using this function.
  */
-DLL_EXPORT int __stdcall GetLuaAICount()
+EXPORT(int) GetLuaAICount()
 {
 	try {
 		CheckInit();
@@ -1536,7 +1538,7 @@
  *
  * Be sure you've made a call to GetLuaAICount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetLuaAIName(int aiIndex)
+EXPORT(const char*) GetLuaAIName(int aiIndex)
 {
 	try {
 		CheckInit();
@@ -1555,7 +1557,7 @@
  *
  * Be sure you've made a call to GetLuaAICount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetLuaAIDesc(int aiIndex)
+EXPORT(const char*) GetLuaAIDesc(int aiIndex)
 {
 	try {
 		CheckInit();
@@ -1781,7 +1783,7 @@
  * @param name the name of the map
  * @return Zero on error; the number of map options available on success
  */
-DLL_EXPORT int __stdcall GetMapOptionCount(const char* name)
+EXPORT(int) GetMapOptionCount(const char* name)
 {
 	try {
 		CheckInit();
@@ -1814,7 +1816,7 @@
  * Be sure to map the mod into the VFS using AddArchive() or AddAllArchives()
  * prior to using this function.
  */
-DLL_EXPORT int __stdcall GetModOptionCount()
+EXPORT(int) GetModOptionCount()
 {
 	try {
 		CheckInit();
@@ -1852,7 +1854,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetOptionKey(int optIndex)
+EXPORT(const char*) GetOptionKey(int optIndex)
 {
 	try {
 		CheckOptionIndex(optIndex);
@@ -1871,7 +1873,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetOptionName(int optIndex)
+EXPORT(const char*) GetOptionName(int optIndex)
 {
 	try {
 		CheckOptionIndex(optIndex);
@@ -1890,7 +1892,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetOptionSection(int optIndex)
+EXPORT(const char*) GetOptionSection(int optIndex)
 {
 	try {
 		CheckOptionIndex(optIndex);
@@ -1911,7 +1913,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetOptionStyle(int optIndex)
+EXPORT(const char*) GetOptionStyle(int optIndex)
 {
 	try {
 		CheckOptionIndex(optIndex);
@@ -1930,7 +1932,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetOptionDesc(int optIndex)
+EXPORT(const char*) GetOptionDesc(int optIndex)
 {
 	try {
 		CheckOptionIndex(optIndex);
@@ -1949,7 +1951,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT int __stdcall GetOptionType(int optIndex)
+EXPORT(int) GetOptionType(int optIndex)
 {
 	try {
 		CheckOptionIndex(optIndex);
@@ -1970,7 +1972,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT int __stdcall GetOptionBoolDef(int optIndex)
+EXPORT(int) GetOptionBoolDef(int optIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_bool);
@@ -1991,7 +1993,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT float __stdcall GetOptionNumberDef(int optIndex)
+EXPORT(float) GetOptionNumberDef(int optIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_number);
@@ -2010,7 +2012,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT float __stdcall GetOptionNumberMin(int optIndex)
+EXPORT(float) GetOptionNumberMin(int optIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_number);
@@ -2029,7 +2031,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT float __stdcall GetOptionNumberMax(int optIndex)
+EXPORT(float) GetOptionNumberMax(int optIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_number);
@@ -2048,7 +2050,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT float __stdcall GetOptionNumberStep(int optIndex)
+EXPORT(float) GetOptionNumberStep(int optIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_number);
@@ -2069,7 +2071,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetOptionStringDef(int optIndex)
+EXPORT(const char*) GetOptionStringDef(int optIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_string);
@@ -2088,7 +2090,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT int __stdcall GetOptionStringMaxLen(int optIndex)
+EXPORT(int) GetOptionStringMaxLen(int optIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_string);
@@ -2109,7 +2111,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT int __stdcall GetOptionListCount(int optIndex)
+EXPORT(int) GetOptionListCount(int optIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_list);
@@ -2128,7 +2130,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetOptionListDef(int optIndex)
+EXPORT(const char*) GetOptionListDef(int optIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_list);
@@ -2148,7 +2150,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetOptionListItemKey(int optIndex, int itemIndex)
+EXPORT(const char*) GetOptionListItemKey(int optIndex, int itemIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_list);
@@ -2170,7 +2172,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetOptionListItemName(int optIndex, int itemIndex)
+EXPORT(const char*) GetOptionListItemName(int optIndex, int itemIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_list);
@@ -2192,7 +2194,7 @@
  * Be sure you've made a call to either GetMapOptionCount()
  * or GetModOptionCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetOptionListItemDesc(int optIndex, int itemIndex)
+EXPORT(const char*) GetOptionListItemDesc(int optIndex, int itemIndex)
 {
 	try {
 		CheckOptionType(optIndex, opt_list);
@@ -2295,7 +2297,7 @@
  * Be sure to map the mod into the VFS using AddArchive() or AddAllArchives()
  * prior to using this function.
  */
-DLL_EXPORT int __stdcall GetModValidMapCount()
+EXPORT(int) GetModValidMapCount()
 {
 	try {
 		CheckInit();
@@ -2337,7 +2339,7 @@
  * Map names should be complete  (including the .smf or .sm3 extension.)
  * Be sure you've made a call to GetModValidMapCount() prior to using this.
  */
-DLL_EXPORT const char* __stdcall GetModValidMap(int index)
+EXPORT(const char*) GetModValidMap(int index)
 {
 	try {
 		CheckInit();
@@ -2376,7 +2378,7 @@
  * Map the wanted archives into the VFS with AddArchive() or AddAllArchives()
  * before using this function.
  */
-DLL_EXPORT int __stdcall OpenFileVFS(const char* name)
+EXPORT(int) OpenFileVFS(const char* name)
 {
 	try {
 		CheckInit();
@@ -2404,7 +2406,7 @@
  * @brief Close a file in the VFS
  * @param handle the file handle as returned by OpenFileVFS()
  */
-DLL_EXPORT void __stdcall CloseFileVFS(int handle)
+EXPORT(void) CloseFileVFS(int handle)
 {
 	try {
 		CheckFileHandle(handle);
@@ -2424,7 +2426,7 @@
  * @return -1 on error; the number of bytes read on success
  * (if this is less than length you reached the end of the file.)
  */
-DLL_EXPORT int __stdcall ReadFileVFS(int handle, void* buf, int length)
+EXPORT(int) ReadFileVFS(int handle, void* buf, int length)
 {
 	try {
 		CheckFileHandle(handle);
@@ -2445,7 +2447,7 @@
  * @param handle the file handle as returned by OpenFileVFS()
  * @return -1 on error; the size of the file on success
  */
-DLL_EXPORT int __stdcall FileSizeVFS(int handle)
+EXPORT(int) FileSizeVFS(int handle)
 {
 	try {
 		CheckFileHandle(handle);
@@ -2461,7 +2463,7 @@
 
 // Does not currently support more than one call at a time (a new call to initfind destroys data from previous ones)
 // pass the returned handle to findfiles to get the results
-DLL_EXPORT int __stdcall InitFindVFS(const char* pattern)
+EXPORT(int) InitFindVFS(const char* pattern)
 {
 	try {
 		CheckInit();
@@ -2479,7 +2481,7 @@
 
 // Does not currently support more than one call at a time (a new call to initfind destroys data from previous ones)
 // pass the returned handle to findfiles to get the results
-DLL_EXPORT int __stdcall InitDirListVFS(const char* path, const char* pattern, const char* modes)
+EXPORT(int) InitDirListVFS(const char* path, const char* pattern, const char* modes)
 {
 	try {
 		CheckInit();
@@ -2497,7 +2499,7 @@
 
 // Does not currently support more than one call at a time (a new call to initfind destroys data from previous ones)
 // pass the returned handle to findfiles to get the results
-DLL_EXPORT int __stdcall InitSubDirsVFS(const char* path, const char* pattern, const char* modes)
+EXPORT(int) InitSubDirsVFS(const char* path, const char* pattern, const char* modes)
 {
 	try {
 		CheckInit();
@@ -2514,7 +2516,7 @@
 
 // On first call, pass handle from initfind. pass the return value of this function on subsequent calls
 // until 0 is returned. size should be set to max namebuffer size on call
-DLL_EXPORT int __stdcall FindFilesVFS(int handle, char* nameBuf, int size)
+EXPORT(int) FindFilesVFS(int handle, char* nameBuf, int size)
 {
 	try {
 		CheckInit();
@@ -2554,7 +2556,7 @@
  * @return Zero on error; a non-zero archive handle on success.
  * @sa OpenArchiveType
  */
-DLL_EXPORT int __stdcall OpenArchive(const char* name)
+EXPORT(int) OpenArchive(const char* name)
 {
 	try {
 		CheckInit();
@@ -2588,7 +2590,7 @@
  * This function is pointless, because OpenArchive() does the same and automatically
  * detects the file type based on it's extension.  Who added it anyway?
  */
-DLL_EXPORT int __stdcall OpenArchiveType(const char* name, const char* type)
+EXPORT(int) OpenArchiveType(const char* name, const char* type)
 {
 	try {
 		CheckInit();
@@ -2614,7 +2616,7 @@
  * @brief Close an archive in the VFS
  * @param archive the archive handle as returned by OpenArchive()
  */
-DLL_EXPORT void __stdcall CloseArchive(int archive)
+EXPORT(void) CloseArchive(int archive)
 {
 	try {
 		CheckArchiveHandle(archive);
@@ -2626,7 +2628,7 @@
 }
 
 
-DLL_EXPORT int __stdcall FindFilesArchive(int archive, int cur, char* nameBuf, int* size)
+EXPORT(int) FindFilesArchive(int archive, int cur, char* nameBuf, int* size)
 {
 	try {
 		CheckArchiveHandle(archive);
@@ -2659,7 +2661,7 @@
  * The returned file handle is needed for subsequent calls to ReadArchiveFile(),
  * CloseArchiveFile() and SizeArchiveFile().
  */
-DLL_EXPORT int __stdcall OpenArchiveFile(int archive, const char* name)
+EXPORT(int) OpenArchiveFile(int archive, const char* name)
 {
 	try {
 		CheckArchiveHandle(archive);
@@ -2682,7 +2684,7 @@
  * @return -1 on error; the number of bytes read on success
  * (if this is less than numBytes you reached the end of the file.)
  */
-DLL_EXPORT int __stdcall ReadArchiveFile(int archive, int handle, void* buffer, int numBytes)
+EXPORT(int) ReadArchiveFile(int archive, int handle, void* buffer, int numBytes)
 {
 	try {
 		CheckArchiveHandle(archive);
@@ -2702,7 +2704,7 @@
  * @param archive the archive handle as returned by OpenArchive()
  * @param handle the file handle as returned by OpenArchiveFile()
  */
-DLL_EXPORT void __stdcall CloseArchiveFile(int archive, int handle)
+EXPORT(void) CloseArchiveFile(int archive, int handle)
 {
 	try {
 		CheckArchiveHandle(archive);
@@ -2720,7 +2722,7 @@
  * @param handle the file handle as returned by OpenArchiveFile()
  * @return -1 on error; the size of the file on success
  */
-DLL_EXPORT int __stdcall SizeArchiveFile(int archive, int handle)
+EXPORT(int) SizeArchiveFile(int archive, int handle)
 {
 	try {
 		CheckArchiveHandle(archive);
@@ -2760,12 +2762,12 @@
 //////////////////////////
 //////////////////////////
 
-DLL_EXPORT void __stdcall SetSpringConfigFile(const char* filenameAsAbsolutePath)
+EXPORT(void) SetSpringConfigFile(const char* filenameAsAbsolutePath)
 {
 	ConfigHandler::Instantiate(filenameAsAbsolutePath);
 }
 
-DLL_EXPORT const char*  __stdcall GetSpringConfigFile()
+EXPORT(const char* ) GetSpringConfigFile()
 {
 	return GetStr(configHandler.GetConfigFile());
 }
@@ -2776,7 +2778,7 @@
  * @param defvalue default string value to use if key is not found, may not be NULL
  * @return string value
  */
-DLL_EXPORT const char* __stdcall GetSpringConfigString( const char* name, const char* defvalue )
+EXPORT(const char*) GetSpringConfigString( const char* name, const char* defvalue )
 {
 	try {
 		string res = configHandler.GetString( name, defvalue );
@@ -2792,7 +2794,7 @@
  * @param defvalue default integer value to use if key is not found
  * @return integer value
  */
-DLL_EXPORT int __stdcall GetSpringConfigInt( const char* name, const int defvalue )
+EXPORT(int) GetSpringConfigInt( const char* name, const int defvalue )
 {
 	try {
 		return configHandler.Get( name, defvalue );
@@ -2807,7 +2809,7 @@
  * @param defvalue default float value to use if key is not found
  * @return float value
  */
-DLL_EXPORT float __stdcall GetSpringConfigFloat( const char* name, const float defvalue )
+EXPORT(float) GetSpringConfigFloat( const char* name, const float defvalue )
 {
 	try {
 		return configHandler.Get( name, defvalue );
@@ -2821,7 +2823,7 @@
  * @param name name of key to set
  * @param value string value to set
  */
-DLL_EXPORT void __stdcall SetSpringConfigString(const char* name, const char* value)
+EXPORT(void) SetSpringConfigString(const char* name, const char* value)
 {
 	try {
 		configHandler.SetString( name, value );
@@ -2834,7 +2836,7 @@
  * @param name name of key to set
  * @param value integer value to set
  */
-DLL_EXPORT void __stdcall SetSpringConfigInt(const char* name, const int value)
+EXPORT(void) SetSpringConfigInt(const char* name, const int value)
 {
 	try {
 		configHandler.Set( name, value );
@@ -2847,7 +2849,7 @@
  * @param name name of key to set
  * @param value float value to set
  */
-DLL_EXPORT void __stdcall SetSpringConfigFloat(const char* name, const float value)
+EXPORT(void) SetSpringConfigFloat(const char* name, const float value)
 {
 	try {
 		configHandler.Set( name, value );
@@ -2884,46 +2886,46 @@
 
 
 // deprecated 2008/10
-DLL_EXPORT const char * __stdcall GetCurrentList()
+EXPORT(const char *) GetCurrentList()
 {
 	DEPRECATED;
 	return NULL;
 }
 
 // deprecated 2008/10
-DLL_EXPORT void __stdcall AddClient(int id, const char *unitList)
+EXPORT(void) AddClient(int id, const char *unitList)
 {
 	DEPRECATED;
 }
 
 // deprecated 2008/10
-DLL_EXPORT void __stdcall RemoveClient(int id)
+EXPORT(void) RemoveClient(int id)
 {
 	DEPRECATED;
 }
 
 // deprecated 2008/10
-DLL_EXPORT const char * __stdcall GetClientDiff(int id)
+EXPORT(const char *) GetClientDiff(int id)
 {
 	DEPRECATED;
 	return NULL;
 }
 
 // deprecated 2008/10
-DLL_EXPORT void __stdcall InstallClientDiff(const char *diff)
+EXPORT(void) InstallClientDiff(const char *diff)
 {
 	DEPRECATED;
 }
 
 // deprecated 2008/10
-DLL_EXPORT int __stdcall IsUnitDisabled(int unit)
+EXPORT(int) IsUnitDisabled(int unit)
 {
 	DEPRECATED;
 	return 0;
 }
 
 // deprecated 2008/10
-DLL_EXPORT int __stdcall IsUnitDisabledByClient(int unit, int clientId)
+EXPORT(int) IsUnitDisabledByClient(int unit, int clientId)
 {
 	DEPRECATED;
 	return 0;

Modified: trunk/tools/unitsync/unitsync.h
===================================================================
--- trunk/tools/unitsync/unitsync.h	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/tools/unitsync/unitsync.h	2008-11-19 15:48:58 UTC (rev 7071)
@@ -75,13 +75,5 @@
 
 const char *GetStr(std::string str);
 
-
-#ifdef WIN32
-#  define DLL_EXPORT extern &quot;C&quot; __declspec(dllexport)
-#  include &lt;windows.h&gt;
-#else
-#  define DLL_EXPORT extern &quot;C&quot; __attribute__ ((visibility(&quot;default&quot;)))
-#  define __stdcall
 #endif
 
-#endif

Modified: trunk/tools/unitsync/unitsync_api.h
===================================================================
--- trunk/tools/unitsync/unitsync_api.h	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/tools/unitsync/unitsync_api.h	2008-11-19 15:48:58 UTC (rev 7071)
@@ -6,162 +6,162 @@
 
 // from unitsync.cpp:
 
-DLL_EXPORT const char*  __stdcall GetNextError();
-DLL_EXPORT const char*  __stdcall GetSpringVersion();
+EXPORT(const char* ) GetNextError();
+EXPORT(const char* ) GetSpringVersion();
 
-DLL_EXPORT void         __stdcall Message(const char* p_szMessage);
+EXPORT(void        ) Message(const char* p_szMessage);
 
-DLL_EXPORT int          __stdcall Init(bool isServer, int id);
-DLL_EXPORT void         __stdcall UnInit();
+EXPORT(int         ) Init(bool isServer, int id);
+EXPORT(void        ) UnInit();
 
-DLL_EXPORT const char*  __stdcall GetWritableDataDirectory();
+EXPORT(const char* ) GetWritableDataDirectory();
 
-DLL_EXPORT int          __stdcall ProcessUnits();
-DLL_EXPORT int          __stdcall ProcessUnitsNoChecksum();
+EXPORT(int         ) ProcessUnits();
+EXPORT(int         ) ProcessUnitsNoChecksum();
 
-DLL_EXPORT int          __stdcall GetUnitCount();
-DLL_EXPORT const char*  __stdcall GetUnitName(int unit);
-DLL_EXPORT const char*  __stdcall GetFullUnitName(int unit);
+EXPORT(int         ) GetUnitCount();
+EXPORT(const char* ) GetUnitName(int unit);
+EXPORT(const char* ) GetFullUnitName(int unit);
 
-DLL_EXPORT void         __stdcall AddArchive(const char* name);
-DLL_EXPORT void         __stdcall AddAllArchives(const char* root);
-DLL_EXPORT unsigned int __stdcall GetArchiveChecksum(const char* arname);
-DLL_EXPORT const char*  __stdcall GetArchivePath(const char* arname);
+EXPORT(void        ) AddArchive(const char* name);
+EXPORT(void        ) AddAllArchives(const char* root);
+EXPORT(unsigned int) GetArchiveChecksum(const char* arname);
+EXPORT(const char* ) GetArchivePath(const char* arname);
 
-DLL_EXPORT int          __stdcall GetMapCount();
-DLL_EXPORT const char*  __stdcall GetMapName(int index);
-DLL_EXPORT int          __stdcall GetMapInfoEx(const char* name, MapInfo* outInfo, int version);
-DLL_EXPORT int          __stdcall GetMapInfo(const char* name, MapInfo* outInfo);
-DLL_EXPORT int          __stdcall GetMapArchiveCount(const char* mapName);
-DLL_EXPORT const char*  __stdcall GetMapArchiveName(int index);
-DLL_EXPORT unsigned int __stdcall GetMapChecksum(int index);
-DLL_EXPORT unsigned int __stdcall GetMapChecksumFromName(const char* mapName);
-DLL_EXPORT void*        __stdcall GetMinimap(const char* filename, int miplevel);
-DLL_EXPORT int          __stdcall GetInfoMapSize(const char* filename, const char* name, int* width, int* height);
-DLL_EXPORT int          __stdcall GetInfoMap(const char* filename, const char* name, void* data, int typeHint);
+EXPORT(int         ) GetMapCount();
+EXPORT(const char* ) GetMapName(int index);
+EXPORT(int         ) GetMapInfoEx(const char* name, MapInfo* outInfo, int version);
+EXPORT(int         ) GetMapInfo(const char* name, MapInfo* outInfo);
+EXPORT(int         ) GetMapArchiveCount(const char* mapName);
+EXPORT(const char* ) GetMapArchiveName(int index);
+EXPORT(unsigned int) GetMapChecksum(int index);
+EXPORT(unsigned int) GetMapChecksumFromName(const char* mapName);
+EXPORT(void*       ) GetMinimap(const char* filename, int miplevel);
+EXPORT(int         ) GetInfoMapSize(const char* filename, const char* name, int* width, int* height);
+EXPORT(int         ) GetInfoMap(const char* filename, const char* name, void* data, int typeHint);
 
-DLL_EXPORT int          __stdcall GetPrimaryModCount();
-DLL_EXPORT const char*  __stdcall GetPrimaryModName(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModShortName(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModVersion(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModMutator(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModGame(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModShortGame(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModDescription(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModArchive(int index);
-DLL_EXPORT int          __stdcall GetPrimaryModArchiveCount(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModArchiveList(int arnr);
-DLL_EXPORT int          __stdcall GetPrimaryModIndex(const char* name);
-DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksum(int index);
-DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksumFromName(const char* name);
+EXPORT(int         ) GetPrimaryModCount();
+EXPORT(const char* ) GetPrimaryModName(int index);
+EXPORT(const char* ) GetPrimaryModShortName(int index);
+EXPORT(const char* ) GetPrimaryModVersion(int index);
+EXPORT(const char* ) GetPrimaryModMutator(int index);
+EXPORT(const char* ) GetPrimaryModGame(int index);
+EXPORT(const char* ) GetPrimaryModShortGame(int index);
+EXPORT(const char* ) GetPrimaryModDescription(int index);
+EXPORT(const char* ) GetPrimaryModArchive(int index);
+EXPORT(int         ) GetPrimaryModArchiveCount(int index);
+EXPORT(const char* ) GetPrimaryModArchiveList(int arnr);
+EXPORT(int         ) GetPrimaryModIndex(const char* name);
+EXPORT(unsigned int) GetPrimaryModChecksum(int index);
+EXPORT(unsigned int) GetPrimaryModChecksumFromName(const char* name);
 
-DLL_EXPORT int          __stdcall GetSideCount();
-DLL_EXPORT const char*  __stdcall GetSideName(int side);
-DLL_EXPORT const char*  __stdcall GetSideStartUnit(int side);
+EXPORT(int         ) GetSideCount();
+EXPORT(const char* ) GetSideName(int side);
+EXPORT(const char* ) GetSideStartUnit(int side);
 
-DLL_EXPORT int          __stdcall GetLuaAICount();
-DLL_EXPORT const char*  __stdcall GetLuaAIName(int aiIndex);
-DLL_EXPORT const char*  __stdcall GetLuaAIDesc(int aiIndex);
+EXPORT(int         ) GetLuaAICount();
+EXPORT(const char* ) GetLuaAIName(int aiIndex);
+EXPORT(const char* ) GetLuaAIDesc(int aiIndex);
 
-DLL_EXPORT int          __stdcall GetMapOptionCount(const char* name);
-DLL_EXPORT int          __stdcall GetModOptionCount();
-DLL_EXPORT const char*  __stdcall GetOptionKey(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionName(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionSection(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionStyle(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionDesc(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionType(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionBoolDef(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberDef(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberMin(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberMax(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberStep(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionStringDef(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionStringMaxLen(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionListCount(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListDef(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemKey(int optIndex, int itemIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemName(int optIndex, int itemIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemDesc(int optIndex, int itemIndex);
+EXPORT(int         ) GetMapOptionCount(const char* name);
+EXPORT(int         ) GetModOptionCount();
+EXPORT(const char* ) GetOptionKey(int optIndex);
+EXPORT(const char* ) GetOptionName(int optIndex);
+EXPORT(const char* ) GetOptionSection(int optIndex);
+EXPORT(const char* ) GetOptionStyle(int optIndex);
+EXPORT(const char* ) GetOptionDesc(int optIndex);
+EXPORT(int         ) GetOptionType(int optIndex);
+EXPORT(int         ) GetOptionBoolDef(int optIndex);
+EXPORT(float       ) GetOptionNumberDef(int optIndex);
+EXPORT(float       ) GetOptionNumberMin(int optIndex);
+EXPORT(float       ) GetOptionNumberMax(int optIndex);
+EXPORT(float       ) GetOptionNumberStep(int optIndex);
+EXPORT(const char* ) GetOptionStringDef(int optIndex);
+EXPORT(int         ) GetOptionStringMaxLen(int optIndex);
+EXPORT(int         ) GetOptionListCount(int optIndex);
+EXPORT(const char* ) GetOptionListDef(int optIndex);
+EXPORT(const char* ) GetOptionListItemKey(int optIndex, int itemIndex);
+EXPORT(const char* ) GetOptionListItemName(int optIndex, int itemIndex);
+EXPORT(const char* ) GetOptionListItemDesc(int optIndex, int itemIndex);
 
-DLL_EXPORT int          __stdcall GetModValidMapCount();
-DLL_EXPORT const char*  __stdcall GetModValidMap(int index);
+EXPORT(int         ) GetModValidMapCount();
+EXPORT(const char* ) GetModValidMap(int index);
 
-DLL_EXPORT int          __stdcall OpenFileVFS(const char* name);
-DLL_EXPORT void         __stdcall CloseFileVFS(int handle);
-DLL_EXPORT void         __stdcall ReadFileVFS(int handle, void* buf, int length);
-DLL_EXPORT int          __stdcall FileSizeVFS(int handle);
+EXPORT(int         ) OpenFileVFS(const char* name);
+EXPORT(void        ) CloseFileVFS(int handle);
+EXPORT(void        ) ReadFileVFS(int handle, void* buf, int length);
+EXPORT(int         ) FileSizeVFS(int handle);
 
-DLL_EXPORT int          __stdcall InitFindVFS(const char* pattern);
-DLL_EXPORT int          __stdcall InitDirListVFS(const char* path, const char* pattern, const char* modes);
-DLL_EXPORT int          __stdcall InitSubDirsVFS(const char* path, const char* pattern, const char* modes);
-DLL_EXPORT int          __stdcall FindFilesVFS(int handle, char* nameBuf, int size);
+EXPORT(int         ) InitFindVFS(const char* pattern);
+EXPORT(int         ) InitDirListVFS(const char* path, const char* pattern, const char* modes);
+EXPORT(int         ) InitSubDirsVFS(const char* path, const char* pattern, const char* modes);
+EXPORT(int         ) FindFilesVFS(int handle, char* nameBuf, int size);
 
-DLL_EXPORT int          __stdcall OpenArchive(const char* name);
-DLL_EXPORT int          __stdcall OpenArchiveType(const char* name, const char* type);
-DLL_EXPORT void         __stdcall CloseArchive(int archive);
-DLL_EXPORT int          __stdcall FindFilesArchive(int archive, int cur, char* nameBuf, int* size);
-DLL_EXPORT int          __stdcall OpenArchiveFile(int archive, const char* name);
-DLL_EXPORT int          __stdcall ReadArchiveFile(int archive, int handle, void* buffer, int numBytes);
-DLL_EXPORT void         __stdcall CloseArchiveFile(int archive, int handle);
-DLL_EXPORT int          __stdcall SizeArchiveFile(int archive, int handle);
+EXPORT(int         ) OpenArchive(const char* name);
+EXPORT(int         ) OpenArchiveType(const char* name, const char* type);
+EXPORT(void        ) CloseArchive(int archive);
+EXPORT(int         ) FindFilesArchive(int archive, int cur, char* nameBuf, int* size);
+EXPORT(int         ) OpenArchiveFile(int archive, const char* name);
+EXPORT(int         ) ReadArchiveFile(int archive, int handle, void* buffer, int numBytes);
+EXPORT(void        ) CloseArchiveFile(int archive, int handle);
+EXPORT(int         ) SizeArchiveFile(int archive, int handle);
 
-DLL_EXPORT void         __stdcall SetSpringConfigFile(const char* filenameAsAbsolutePath);
-DLL_EXPORT const char*  __stdcall GetSpringConfigFile();
-DLL_EXPORT const char*  __stdcall GetSpringConfigString(const char* name, const char* defvalue);
-DLL_EXPORT int          __stdcall GetSpringConfigInt(const char* name, const int defvalue);
-DLL_EXPORT float        __stdcall GetSpringConfigFloat( const char* name, const float defvalue );
-DLL_EXPORT void         __stdcall SetSpringConfigString(const char* name, const char* value);
-DLL_EXPORT void         __stdcall SetSpringConfigInt(const char* name, const int value);
-DLL_EXPORT void         __stdcall SetSpringConfigFloat(const char* name, const float value);
+EXPORT(void        ) SetSpringConfigFile(const char* filenameAsAbsolutePath);
+EXPORT(const char* ) GetSpringConfigFile();
+EXPORT(const char* ) GetSpringConfigString(const char* name, const char* defvalue);
+EXPORT(int         ) GetSpringConfigInt(const char* name, const int defvalue);
+EXPORT(float       ) GetSpringConfigFloat( const char* name, const float defvalue );
+EXPORT(void        ) SetSpringConfigString(const char* name, const char* value);
+EXPORT(void        ) SetSpringConfigInt(const char* name, const int value);
+EXPORT(void        ) SetSpringConfigFloat(const char* name, const float value);
 
 
 // from LuaParserAPI.cpp:
 
-DLL_EXPORT void        __stdcall lpClose();
-DLL_EXPORT int         __stdcall lpOpenFile(const char* filename, const char* fileModes, const char* accessModes);
-DLL_EXPORT int         __stdcall lpOpenSource(const char* source, const char* accessModes);
-DLL_EXPORT int         __stdcall lpExecute();
-DLL_EXPORT const char* __stdcall lpErrorLog();
+EXPORT(void       ) lpClose();
+EXPORT(int        ) lpOpenFile(const char* filename, const char* fileModes, const char* accessModes);
+EXPORT(int        ) lpOpenSource(const char* source, const char* accessModes);
+EXPORT(int        ) lpExecute();
+EXPORT(const char*) lpErrorLog();
 
-DLL_EXPORT void        __stdcall lpAddTableInt(int key, int override);
-DLL_EXPORT void        __stdcall lpAddTableStr(const char* key, int override);
-DLL_EXPORT void        __stdcall lpEndTable();
-DLL_EXPORT void        __stdcall lpAddIntKeyIntVal(int key, int val);
-DLL_EXPORT void        __stdcall lpAddStrKeyIntVal(const char* key, int val);
-DLL_EXPORT void        __stdcall lpAddIntKeyBoolVal(int key, int val);
-DLL_EXPORT void        __stdcall lpAddStrKeyBoolVal(const char* key, int val);
-DLL_EXPORT void        __stdcall lpAddIntKeyFloatVal(int key, float val);
-DLL_EXPORT void        __stdcall lpAddStrKeyFloatVal(const char* key, float val);
-DLL_EXPORT void        __stdcall lpAddIntKeyStrVal(int key, const char* val);
-DLL_EXPORT void        __stdcall lpAddStrKeyStrVal(const char* key, const char* val);
+EXPORT(void       ) lpAddTableInt(int key, int override);
+EXPORT(void       ) lpAddTableStr(const char* key, int override);
+EXPORT(void       ) lpEndTable();
+EXPORT(void       ) lpAddIntKeyIntVal(int key, int val);
+EXPORT(void       ) lpAddStrKeyIntVal(const char* key, int val);
+EXPORT(void       ) lpAddIntKeyBoolVal(int key, int val);
+EXPORT(void       ) lpAddStrKeyBoolVal(const char* key, int val);
+EXPORT(void       ) lpAddIntKeyFloatVal(int key, float val);
+EXPORT(void       ) lpAddStrKeyFloatVal(const char* key, float val);
+EXPORT(void       ) lpAddIntKeyStrVal(int key, const char* val);
+EXPORT(void       ) lpAddStrKeyStrVal(const char* key, const char* val);
 
-DLL_EXPORT int         __stdcall lpRootTable();
-DLL_EXPORT int         __stdcall lpRootTableExpr(const char* expr);
-DLL_EXPORT int         __stdcall lpSubTableInt(int key);
-DLL_EXPORT int         __stdcall lpSubTableStr(const char* key);
-DLL_EXPORT int         __stdcall lpSubTableExpr(const char* expr);
-DLL_EXPORT void        __stdcall lpPopTable();
+EXPORT(int        ) lpRootTable();
+EXPORT(int        ) lpRootTableExpr(const char* expr);
+EXPORT(int        ) lpSubTableInt(int key);
+EXPORT(int        ) lpSubTableStr(const char* key);
+EXPORT(int        ) lpSubTableExpr(const char* expr);
+EXPORT(void       ) lpPopTable();
 
-DLL_EXPORT int         __stdcall lpGetKeyExistsInt(int key);
-DLL_EXPORT int         __stdcall lpGetKeyExistsStr(const char* key);
+EXPORT(int        ) lpGetKeyExistsInt(int key);
+EXPORT(int        ) lpGetKeyExistsStr(const char* key);
 
-DLL_EXPORT int         __stdcall lpGetIntKeyType(int key);
-DLL_EXPORT int         __stdcall lpGetStrKeyType(const char* key);
+EXPORT(int        ) lpGetIntKeyType(int key);
+EXPORT(int        ) lpGetStrKeyType(const char* key);
 
-DLL_EXPORT int         __stdcall lpGetIntKeyListCount();
-DLL_EXPORT int         __stdcall lpGetIntKeyListEntry(int index);
-DLL_EXPORT int         __stdcall lpGetStrKeyListCount();
-DLL_EXPORT const char* __stdcall lpGetStrKeyListEntry(int index);
+EXPORT(int        ) lpGetIntKeyListCount();
+EXPORT(int        ) lpGetIntKeyListEntry(int index);
+EXPORT(int        ) lpGetStrKeyListCount();
+EXPORT(const char*) lpGetStrKeyListEntry(int index);
 
-DLL_EXPORT int         __stdcall lpGetIntKeyIntVal(int key, int defVal);
-DLL_EXPORT int         __stdcall lpGetStrKeyIntVal(const char* key, int defVal);
-DLL_EXPORT int         __stdcall lpGetIntKeyBoolVal(int key, int defVal);
-DLL_EXPORT int         __stdcall lpGetStrKeyBoolVal(const char* key, int defVal);
-DLL_EXPORT float       __stdcall lpGetIntKeyFloatVal(int key, float defVal);
-DLL_EXPORT float       __stdcall lpGetStrKeyFloatVal(const char* key, float defVal);
-DLL_EXPORT const char* __stdcall lpGetIntKeyStrVal(int key, const char* defVal);
-DLL_EXPORT const char* __stdcall lpGetStrKeyStrVal(const char* key, const char* defVal);
+EXPORT(int        ) lpGetIntKeyIntVal(int key, int defVal);
+EXPORT(int        ) lpGetStrKeyIntVal(const char* key, int defVal);
+EXPORT(int        ) lpGetIntKeyBoolVal(int key, int defVal);
+EXPORT(int        ) lpGetStrKeyBoolVal(const char* key, int defVal);
+EXPORT(float      ) lpGetIntKeyFloatVal(int key, float defVal);
+EXPORT(float      ) lpGetStrKeyFloatVal(const char* key, float defVal);
+EXPORT(const char*) lpGetIntKeyStrVal(int key, const char* defVal);
+EXPORT(const char*) lpGetStrKeyStrVal(const char* key, const char* defVal);
 
 
 #endif // UNITSYNC_API_H

Modified: trunk/tools/unitsync_cacher/test.cpp
===================================================================
--- trunk/tools/unitsync_cacher/test.cpp	2008-11-19 13:20:18 UTC (rev 7070)
+++ trunk/tools/unitsync_cacher/test.cpp	2008-11-19 15:48:58 UTC (rev 7071)
@@ -45,107 +45,108 @@
 /******************************************************************************/
 /******************************************************************************/
 //
-//  Generated using:  'grep DLL_EXPORT unitsync.cpp'
+//  Generated using:  'grep &quot;EXPORT(&quot; unitsync.cpp'
 // Scratch that, copy pasted from javabind.cpp
 //
 
-DLL_EXPORT const char*  __stdcall GetSpringVersion();
-DLL_EXPORT void         __stdcall Message(const char* p_szMessage);
-DLL_EXPORT int          __stdcall Init(bool isServer, int id);
-DLL_EXPORT void         __stdcall UnInit();
-DLL_EXPORT int          __stdcall ProcessUnits(void);
-DLL_EXPORT int          __stdcall ProcessUnitsNoChecksum(void);
-DLL_EXPORT const char*  __stdcall GetCurrentList();
-DLL_EXPORT void         __stdcall AddClient(int id, const char *unitList);
-DLL_EXPORT void         __stdcall RemoveClient(int id);
-DLL_EXPORT const char*  __stdcall GetClientDiff(int id);
-DLL_EXPORT void         __stdcall InstallClientDiff(const char *diff);
-DLL_EXPORT int          __stdcall GetUnitCount();
-DLL_EXPORT const char*  __stdcall GetUnitName(int unit);
-DLL_EXPORT const char*  __stdcall GetFullUnitName(int unit);
-DLL_EXPORT int          __stdcall IsUnitDisabled(int unit);
-DLL_EXPORT int          __stdcall IsUnitDisabledByClient(int unit, int clientId);
-DLL_EXPORT void         __stdcall AddArchive(const char* name);
-DLL_EXPORT void         __stdcall AddAllArchives(const char* root);
-DLL_EXPORT unsigned int __stdcall GetArchiveChecksum(const char* arname);
-DLL_EXPORT int          __stdcall GetMapCount();
-DLL_EXPORT const char*  __stdcall GetMapName(int index);
-DLL_EXPORT int          __stdcall GetMapInfoEx(const char* name, MapInfo* outInfo, int version);
-DLL_EXPORT int          __stdcall GetMapInfo(const char* name, MapInfo* outInfo);
-DLL_EXPORT void*        __stdcall GetMinimap(const char* filename, int miplevel);
-DLL_EXPORT int          __stdcall GetMapArchiveCount(const char* mapName);
-DLL_EXPORT const char*  __stdcall GetMapArchiveName(int index);
-DLL_EXPORT unsigned int __stdcall GetMapChecksumFromName(const char* mapName);
-DLL_EXPORT unsigned int __stdcall GetMapChecksum(int index);
-DLL_EXPORT int          __stdcall GetPrimaryModCount();
-DLL_EXPORT const char*  __stdcall GetPrimaryModName(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModShortName(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModGame(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModShortGame(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModVersion(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModMutator(int index);
-DLL_EXPORT const char*	__stdcall GetPrimaryModDescription(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModArchive(int index);
-DLL_EXPORT int          __stdcall GetPrimaryModArchiveCount(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModArchiveList(int arnr);
-DLL_EXPORT int          __stdcall GetPrimaryModIndex(const char* name);
-DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksum(int index);
-DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksumFromName(const char* name);
-DLL_EXPORT int          __stdcall GetSideCount();
-DLL_EXPORT const char*  __stdcall GetSideName(int side);
-DLL_EXPORT int          __stdcall OpenFileVFS(const char* name);
-DLL_EXPORT void         __stdcall CloseFileVFS(int handle);
-DLL_EXPORT void         __stdcall ReadFileVFS(int handle, void* buf, int length);
-DLL_EXPORT int          __stdcall FileSizeVFS(int handle);
-DLL_EXPORT int          __stdcall InitFindVFS(const char* pattern);
-DLL_EXPORT int          __stdcall FindFilesVFS(int handle, char* nameBuf, int size);
-DLL_EXPORT int          __stdcall OpenArchive(const char* name);
-DLL_EXPORT void         __stdcall CloseArchive(int archive);
-DLL_EXPORT int          __stdcall FindFilesArchive(int archive, int cur, char* nameBuf, int* size);
-DLL_EXPORT int          __stdcall OpenArchiveFile(int archive, const char* name);
-DLL_EXPORT int          __stdcall ReadArchiveFile(int archive, int handle, void* buffer, int numBytes);
-DLL_EXPORT void         __stdcall CloseArchiveFile(int archive, int handle);
-DLL_EXPORT int          __stdcall SizeArchiveFile(int archive, int handle);
+EXPORT(const char* ) GetSpringVersion();
+EXPORT(void        ) Message(const char* p_szMessage);
+EXPORT(int         ) Init(bool isServer, int id);
+EXPORT(void        ) UnInit();
+EXPORT(int         ) ProcessUnits(void);
+EXPORT(int         ) ProcessUnitsNoChecksum(void);
+EXPORT(const char* ) GetCurrentList();
+EXPORT(void        ) AddClient(int id, const char *unitList);
+EXPORT(void        ) RemoveClient(int id);
+EXPORT(const char* ) GetClientDiff(int id);
+EXPORT(void        ) InstallClientDiff(const char *diff);
+EXPORT(int         ) GetUnitCount();
+EXPORT(const char* ) GetUnitName(int unit);
+EXPORT(const char* ) GetFullUnitName(int unit);
+EXPORT(int         ) IsUnitDisabled(int unit);
+EXPORT(int         ) IsUnitDisabledByClient(int unit, int clientId);
+EXPORT(void        ) AddArchive(const char* name);
+EXPORT(void        ) AddAllArchives(const char* root);
+EXPORT(unsigned int) GetArchiveChecksum(const char* arname);
+EXPORT(int         ) GetMapCount();
+EXPORT(const char* ) GetMapName(int index);
+EXPORT(int         ) GetMapInfoEx(const char* name, MapInfo* outInfo, int version);
+EXPORT(int         ) GetMapInfo(const char* name, MapInfo* outInfo);
+EXPORT(void*       ) GetMinimap(const char* filename, int miplevel);
+EXPORT(int         ) GetMapArchiveCount(const char* mapName);
+EXPORT(const char* ) GetMapArchiveName(int index);
+EXPORT(unsigned int) GetMapChecksumFromName(const char* mapName);
+EXPORT(unsigned int) GetMapChecksum(int index);
+EXPORT(int         ) GetPrimaryModCount();
+EXPORT(const char* ) GetPrimaryModName(int index);
+EXPORT(const char*) GetPrimaryModShortName(int index);
+EXPORT(const char*) GetPrimaryModGame(int index);
+EXPORT(const char*) GetPrimaryModShortGame(int index);
+EXPORT(const char*) GetPrimaryModVersion(int index);
+EXPORT(const char*) GetPrimaryModMutator(int index);
+EXPORT(const char*) GetPrimaryModDescription(int index);
+EXPORT(const char* ) GetPrimaryModArchive(int index);
+EXPORT(int         ) GetPrimaryModArchiveCount(int index);
+EXPORT(const char* ) GetPrimaryModArchiveList(int arnr);
+EXPORT(int         ) GetPrimaryModIndex(const char* name);
+EXPORT(unsigned int) GetPrimaryModChecksum(int index);
+EXPORT(unsigned int) GetPrimaryModChecksumFromName(const char* name);
+EXPORT(int         ) GetSideCount();
+EXPORT(const char* ) GetSideName(int side);
+EXPORT(int         ) OpenFileVFS(const char* name);
+EXPORT(void        ) CloseFileVFS(int handle);
+EXPORT(void        ) ReadFileVFS(int handle, void* buf, int length);
+EXPORT(int         ) FileSizeVFS(int handle);
+EXPORT(int         ) InitFindVFS(const char* pattern);
+EXPORT(int         ) FindFilesVFS(int handle, char* nameBuf, int size);
+EXPORT(int         ) OpenArchive(const char* name);
+EXPORT(void        ) CloseArchive(int archive);
+EXPORT(int         ) FindFilesArchive(int archive, int cur, char* nameBuf, int* size);
+EXPORT(int         ) OpenArchiveFile(int archive, const char* name);
+EXPORT(int         ) ReadArchiveFile(int archive, int handle, void* buffer, int numBytes);
+EXPORT(void        ) CloseArchiveFile(int archive, int handle);
+EXPORT(int         ) SizeArchiveFile(int archive, int handle);
 
 // lua custom lobby settings
-DLL_EXPORT int          __stdcall GetMapOptionCount(const char* name);
-DLL_EXPORT int          __stdcall GetModOptionCount();
+EXPORT(int         ) GetMapOptionCount(const char* name);
+EXPORT(int         ) GetModOptionCount();
 
-DLL_EXPORT const char*  __stdcall GetOptionKey(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionName(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionDesc(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionType(int optIndex);
+EXPORT(const char* ) GetOptionKey(int optIndex);
+EXPORT(const char* ) GetOptionName(int optIndex);
+EXPORT(const char* ) GetOptionDesc(int optIndex);
+EXPORT(int         ) GetOptionType(int optIndex);
 
 // Bool Options
-DLL_EXPORT int          __stdcall GetOptionBoolDef(int optIndex);
+EXPORT(int         ) GetOptionBoolDef(int optIndex);
 
 // Number Options
-DLL_EXPORT float        __stdcall GetOptionNumberDef(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberMin(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberMax(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberStep(int optIndex);
+EXPORT(float       ) GetOptionNumberDef(int optIndex);
+EXPORT(float       ) GetOptionNumberMin(int optIndex);
+EXPORT(float       ) GetOptionNumberMax(int optIndex);
+EXPORT(float       ) GetOptionNumberStep(int optIndex);
 
 // String Options
-DLL_EXPORT const char*  __stdcall GetOptionStringDef(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionStringMaxLen(int optIndex);
+EXPORT(const char* ) GetOptionStringDef(int optIndex);
+EXPORT(int         ) GetOptionStringMaxLen(int optIndex);
 
 // List Options
-DLL_EXPORT int          __stdcall GetOptionListCount(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListDef(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemKey(int optIndex, int itemIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemName(int optIndex, int itemIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemDesc(int optIndex, int itemIndex);
+EXPORT(int         ) GetOptionListCount(int optIndex);
+EXPORT(const char* ) GetOptionListDef(int optIndex);
+EXPORT(const char* ) GetOptionListItemKey(int optIndex, int itemIndex);
+EXPORT(const char* ) GetOptionListItemName(int optIndex, int itemIndex);
+EXPORT(const char* ) GetOptionListItemDesc(int optIndex, int itemIndex);
 
 // Spring settings callback
 
-DLL_EXPORT const char*	__stdcall GetSpringConfigString( const char* name, const char* defvalue );
-DLL_EXPORT int			__stdcall GetSpringConfigInt( const char* name, const int defvalue );
-DLL_EXPORT float		__stdcall GetSpringConfigFloat( const char* name, const float defvalue );
-DLL_EXPORT void			__stdcall SetSpringConfigString( const char* name, const char* value );
-DLL_EXPORT void			__stdcall SetSpringConfigInt( const char* name, const int value );
-DLL_EXPORT void			__stdcall SetSpringConfigFloat( const char* name, const float value );
+EXPORT(void        ) SetSpringConfigFile(const char* filenameAsAbsolutePath);
+EXPORT(const char* ) GetSpringConfigFile();
+EXPORT(const char* ) GetSpringConfigString(const char* name, const char* defvalue);
+EXPORT(int         ) GetSpringConfigInt(const char* name, const int defvalue);
+EXPORT(float       ) GetSpringConfigFloat( const char* name, const float defvalue );
+EXPORT(void        ) SetSpringConfigString(const char* name, const char* value);
+EXPORT(void        ) SetSpringConfigInt(const char* name, const int value);
+EXPORT(void        ) SetSpringConfigFloat(const char* name, const float value);
 
-
 /******************************************************************************/
 /******************************************************************************/
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001839.html">[Taspring-linux-commit] r7070 - in trunk:	AI/Global/NTai/AI/NTai/Units tools/unitsync
</A></li>
	<LI>Next message: <A HREF="001841.html">[Taspring-linux-commit] r7072 - trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1840">[ date ]</a>
              <a href="thread.html#1840">[ thread ]</a>
              <a href="subject.html#1840">[ subject ]</a>
              <a href="author.html#1840">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
