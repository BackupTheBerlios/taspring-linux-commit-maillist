<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r5657 - trunk/Lobby/TASClient
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-April/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r5657%20-%20trunk/Lobby/TASClient&In-Reply-To=%3C20080404133000.18C644696%40progate.clan-sy.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000437.html">
   <LINK REL="Next"  HREF="000439.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r5657 - trunk/Lobby/TASClient</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r5657%20-%20trunk/Lobby/TASClient&In-Reply-To=%3C20080404133000.18C644696%40progate.clan-sy.com%3E"
       TITLE="[Taspring-linux-commit] r5657 - trunk/Lobby/TASClient">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Fri Apr  4 15:29:59 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000437.html">[Taspring-linux-commit] r5656 - trunk/rts/build/vstudio8
</A></li>
        <LI>Next message: <A HREF="000439.html">[Taspring-linux-commit] r5658 - trunk/Lobby/TASClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#438">[ date ]</a>
              <a href="thread.html#438">[ thread ]</a>
              <a href="subject.html#438">[ subject ]</a>
              <a href="author.html#438">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: satirik
Date: 2008-04-04 15:29:58 +0200 (Fri, 04 Apr 2008)
New Revision: 5657

Added:
   trunk/Lobby/TASClient/SevenZip.pas
Modified:
   trunk/Lobby/TASClient/ColorsPreferenceUnit.dfm
   trunk/Lobby/TASClient/ColorsPreferenceUnit.pas
   trunk/Lobby/TASClient/HttpGetUnit.dfm
   trunk/Lobby/TASClient/HttpGetUnit.pas
   trunk/Lobby/TASClient/MainUnit.dfm
   trunk/Lobby/TASClient/MainUnit.pas
   trunk/Lobby/TASClient/OnlineMapsUnit.dfm
   trunk/Lobby/TASClient/TASClient.dof
   trunk/Lobby/TASClient/TASClient.dpr
   trunk/Lobby/TASClient/TASClient.res
Log:
- AVG now show 2 digits even for integer value
- admins text chat is now displayed in orange (you can ofc change it in the options)
- &quot;Error: Battle ladder id not found&quot; when joining non ladder battles bug fixed
- Auto update implemented, if you checked the option it auto download the archive, extract it and relaunch the lobby without any action needed (no more confirmation msgs)

Modified: trunk/Lobby/TASClient/ColorsPreferenceUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/ColorsPreferenceUnit.dfm	2008-04-04 09:18:14 UTC (rev 5656)
+++ trunk/Lobby/TASClient/ColorsPreferenceUnit.dfm	2008-04-04 13:29:58 UTC (rev 5657)
@@ -3,7 +3,7 @@
   Top = 202
   BorderStyle = bsDialog
   Caption = 'Color Preferences'
-  ClientHeight = 372
+  ClientHeight = 395
   ClientWidth = 490
   Color = clBtnFace
   Constraints.MaxHeight = 1000
@@ -22,13 +22,13 @@
     Left = 0
     Top = 0
     Width = 490
-    Height = 372
+    Height = 395
     Caption = 'Colors Preference'
     FixedSize = True
     Options.Maximize = False
     object btOk: TSpTBXButton
       Left = 311
-      Top = 336
+      Top = 360
       Width = 73
       Height = 25
       Caption = 'Ok'
@@ -42,7 +42,7 @@
     end
     object btRest: TSpTBXButton
       Left = 22
-      Top = 336
+      Top = 360
       Width = 88
       Height = 25
       Caption = 'Reset'
@@ -56,7 +56,7 @@
     end
     object btCancel: TSpTBXButton
       Left = 397
-      Top = 336
+      Top = 360
       Width = 70
       Height = 25
       Caption = 'Cancel'
@@ -72,7 +72,7 @@
       Left = 24
       Top = 40
       Width = 193
-      Height = 289
+      Height = 313
       Caption = 'Chat colors'
       Font.Charset = DEFAULT_CHARSET
       Font.Color = clWindowText
@@ -120,7 +120,7 @@
       end
       object SpTBXButton1: TSpTBXButton
         Left = 160
-        Top = 68
+        Top = 92
         Width = 25
         Height = 20
         Caption = '...'
@@ -135,7 +135,7 @@
       end
       object Panel1: TPanel
         Left = 101
-        Top = 68
+        Top = 92
         Width = 57
         Height = 21
         BevelOuter = bvNone
@@ -145,7 +145,7 @@
       end
       object SpTBXLabel3: TSpTBXLabel
         Left = 16
-        Top = 69
+        Top = 93
         Width = 29
         Height = 13
         Caption = 'Data :'
@@ -157,7 +157,7 @@
       end
       object SpTBXLabel4: TSpTBXLabel
         Left = 16
-        Top = 93
+        Top = 117
         Width = 28
         Height = 13
         Caption = 'Error :'
@@ -169,7 +169,7 @@
       end
       object Panel2: TPanel
         Left = 101
-        Top = 91
+        Top = 115
         Width = 57
         Height = 21
         BevelOuter = bvNone
@@ -179,7 +179,7 @@
       end
       object SpTBXButton2: TSpTBXButton
         Left = 160
-        Top = 91
+        Top = 115
         Width = 25
         Height = 20
         Caption = '...'
@@ -194,7 +194,7 @@
       end
       object SpTBXButton3: TSpTBXButton
         Left = 160
-        Top = 115
+        Top = 139
         Width = 25
         Height = 20
         Caption = '...'
@@ -209,7 +209,7 @@
       end
       object Panel3: TPanel
         Left = 101
-        Top = 116
+        Top = 140
         Width = 57
         Height = 21
         BevelOuter = bvNone
@@ -219,7 +219,7 @@
       end
       object SpTBXLabel5: TSpTBXLabel
         Left = 16
-        Top = 116
+        Top = 140
         Width = 24
         Height = 13
         Caption = 'Info :'
@@ -231,7 +231,7 @@
       end
       object SpTBXLabel6: TSpTBXLabel
         Left = 16
-        Top = 141
+        Top = 165
         Width = 53
         Height = 13
         Caption = 'Minor Info :'
@@ -243,7 +243,7 @@
       end
       object Panel4: TPanel
         Left = 101
-        Top = 138
+        Top = 162
         Width = 57
         Height = 21
         BevelOuter = bvNone
@@ -253,7 +253,7 @@
       end
       object SpTBXButton4: TSpTBXButton
         Left = 160
-        Top = 138
+        Top = 162
         Width = 25
         Height = 20
         Caption = '...'
@@ -268,7 +268,7 @@
       end
       object SpTBXButton5: TSpTBXButton
         Left = 160
-        Top = 163
+        Top = 187
         Width = 25
         Height = 20
         Caption = '...'
@@ -283,7 +283,7 @@
       end
       object Panel5: TPanel
         Left = 101
-        Top = 162
+        Top = 186
         Width = 57
         Height = 21
         BevelOuter = bvNone
@@ -293,7 +293,7 @@
       end
       object SpTBXLabel7: TSpTBXLabel
         Left = 16
-        Top = 165
+        Top = 189
         Width = 64
         Height = 13
         Caption = 'Channel join :'
@@ -305,7 +305,7 @@
       end
       object SpTBXLabel8: TSpTBXLabel
         Left = 16
-        Top = 189
+        Top = 213
         Width = 62
         Height = 13
         Caption = 'Channel left :'
@@ -317,7 +317,7 @@
       end
       object Panel6: TPanel
         Left = 101
-        Top = 186
+        Top = 210
         Width = 57
         Height = 21
         BevelOuter = bvNone
@@ -327,7 +327,7 @@
       end
       object SpTBXButton6: TSpTBXButton
         Left = 160
-        Top = 186
+        Top = 210
         Width = 25
         Height = 20
         Caption = '...'
@@ -342,7 +342,7 @@
       end
       object SpTBXLabel9: TSpTBXLabel
         Left = 16
-        Top = 213
+        Top = 237
         Width = 38
         Height = 13
         Caption = 'MOTD :'
@@ -354,7 +354,7 @@
       end
       object SpTBXLabel10: TSpTBXLabel
         Left = 16
-        Top = 238
+        Top = 262
         Width = 36
         Height = 13
         Caption = 'SayEx :'
@@ -366,7 +366,7 @@
       end
       object SpTBXLabel11: TSpTBXLabel
         Left = 16
-        Top = 260
+        Top = 284
         Width = 33
         Height = 13
         Caption = 'Topic :'
@@ -378,7 +378,7 @@
       end
       object Panel7: TPanel
         Left = 101
-        Top = 210
+        Top = 234
         Width = 57
         Height = 21
         BevelOuter = bvNone
@@ -388,7 +388,7 @@
       end
       object SpTBXButton7: TSpTBXButton
         Left = 160
-        Top = 210
+        Top = 234
         Width = 25
         Height = 20
         Caption = '...'
@@ -403,7 +403,7 @@
       end
       object Panel8: TPanel
         Left = 101
-        Top = 234
+        Top = 258
         Width = 57
         Height = 21
         BevelOuter = bvNone
@@ -413,7 +413,7 @@
       end
       object SpTBXButton8: TSpTBXButton
         Left = 160
-        Top = 235
+        Top = 259
         Width = 25
         Height = 20
         Caption = '...'
@@ -428,7 +428,7 @@
       end
       object Panel9: TPanel
         Left = 101
-        Top = 259
+        Top = 283
         Width = 57
         Height = 21
         BevelOuter = bvNone
@@ -438,7 +438,7 @@
       end
       object SpTBXButton9: TSpTBXButton
         Left = 160
-        Top = 259
+        Top = 283
         Width = 25
         Height = 20
         Caption = '...'
@@ -488,12 +488,49 @@
         LinkFont.Style = [fsUnderline]
         ThemeType = thtTBX
       end
+      object SpTBXLabel15: TSpTBXLabel
+        Left = 16
+        Top = 69
+        Width = 55
+        Height = 13
+        Caption = 'Admin text :'
+        LinkFont.Charset = DEFAULT_CHARSET
+        LinkFont.Color = clBlue
+        LinkFont.Height = -11
+        LinkFont.Name = 'MS Sans Serif'
+        LinkFont.Style = [fsUnderline]
+      end
+      object Panel14: TPanel
+        Left = 101
+        Top = 68
+        Width = 57
+        Height = 21
+        BevelOuter = bvNone
+        BorderStyle = bsSingle
+        Color = clBlack
+        TabOrder = 34
+      end
+      object SpTBXButton14: TSpTBXButton
+        Left = 160
+        Top = 68
+        Width = 25
+        Height = 20
+        Caption = '...'
+        TabOrder = 35
+        OnClick = SpTBXButton9Click
+        LinkFont.Charset = DEFAULT_CHARSET
+        LinkFont.Color = clBlue
+        LinkFont.Height = -11
+        LinkFont.Name = 'MS Sans Serif'
+        LinkFont.Style = [fsUnderline]
+        ThemeType = thtTBX
+      end
     end
     object SpTBXGroupBox2: TSpTBXGroupBox
       Left = 224
       Top = 40
       Width = 241
-      Height = 289
+      Height = 313
       Caption = 'Other colors'
       TabOrder = 5
       object SpTBXButton10: TSpTBXButton

Modified: trunk/Lobby/TASClient/ColorsPreferenceUnit.pas
===================================================================
--- trunk/Lobby/TASClient/ColorsPreferenceUnit.pas	2008-04-04 09:18:14 UTC (rev 5656)
+++ trunk/Lobby/TASClient/ColorsPreferenceUnit.pas	2008-04-04 13:29:58 UTC (rev 5657)
@@ -56,6 +56,9 @@
     SpTBXLabel13: TSpTBXLabel;
     Panel13: TPanel;
     SpTBXButton13: TSpTBXButton;
+    SpTBXLabel15: TSpTBXLabel;
+    Panel14: TPanel;
+    SpTBXButton14: TSpTBXButton;
     procedure FormCreate(Sender: TObject);
     procedure SpTBXButton0Click(Sender: TObject);
     procedure SpTBXButton1Click(Sender: TObject);
@@ -107,6 +110,7 @@
   Panel11.Color := Colors.MapModUnavailable;
   Panel12.Color := Colors.BotText;
   Panel13.Color := Colors.MyText;
+  Panel14.Color := Colors.AdminText;
 end;
 
 procedure TColorsPreference.SpTBXButton0Click(Sender: TObject);
@@ -156,7 +160,7 @@
 
 procedure TColorsPreference.SpTBXButton9Click(Sender: TObject);
 begin
-  Panel9.Color := InputColor('Choose a color ...',Panel9.Color);
+  Panel14.Color := InputColor('Choose a color ...',Panel14.Color);
 end;
 
 procedure TColorsPreference.btOkClick(Sender: TObject);
@@ -175,6 +179,7 @@
   Colors.MapModUnavailable := Panel11.Color;
   Colors.BotText := Panel12.Color;
   Colors.MyText := Panel13.Color;
+  Colors.AdminText := Panel14.Color;
 
   ModalResult := mrOk;
 end;
@@ -200,6 +205,7 @@
   Panel11.Color := $00ed00d5;
   Panel12.Color := clGray;
   Panel13.Color := $0092726e;
+  Panel14.Color := $000486d8;
 end;
 
 procedure TColorsPreference.SpTBXButton10Click(Sender: TObject);

Modified: trunk/Lobby/TASClient/HttpGetUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/HttpGetUnit.dfm	2008-04-04 09:18:14 UTC (rev 5656)
+++ trunk/Lobby/TASClient/HttpGetUnit.dfm	2008-04-04 13:29:58 UTC (rev 5657)
@@ -1,11 +1,13 @@
 object HttpGetForm: THttpGetForm
-  Left = 387
-  Top = 319
+  Left = 638
+  Top = 589
   BorderStyle = bsDialog
   Caption = 'File download'
   ClientHeight = 178
   ClientWidth = 281
   Color = clBtnFace
+  Constraints.MaxHeight = 1000
+  Constraints.MaxWidth = 1680
   Font.Charset = DEFAULT_CHARSET
   Font.Color = clWindowText
   Font.Height = -11
@@ -131,7 +133,7 @@
       Font.Name = 'MS Sans Serif'
       Font.Style = [fsBold]
       ParentFont = False
-      CaptionGlow = False
+      CaptionGlow = TBXTitleToolbar&#144;\&#134;&#192;OTSpTBXTitleToolbar&#133;&#192;O&#204;k&#192;OP 	SpTBXItem  &#139;&#192;&#212;&#134;&#192;O            (&#135;&#192;O            &#135;&#192;OT   &#216;x&#192;Op&#192;O
       Smooth = True
     end
   end
@@ -145,12 +147,15 @@
     MultiThreaded = False
     RequestVer = '1.0'
     FollowRelocation = True
+    LocationChangeMaxCount = 5
+    BandwidthLimit = 10000
+    BandwidthSampling = 1000
     Options = []
     OnHeaderData = HttpCli1HeaderData
     OnDocBegin = HttpCli1DocBegin
     OnDocData = HttpCli1DocData
     SocksAuthentication = socksNoAuthentication
     Left = 208
-    Top = 120
+    Top = 136
   end
 end

Modified: trunk/Lobby/TASClient/HttpGetUnit.pas
===================================================================
--- trunk/Lobby/TASClient/HttpGetUnit.pas	2008-04-04 09:18:14 UTC (rev 5656)
+++ trunk/Lobby/TASClient/HttpGetUnit.pas	2008-04-04 13:29:58 UTC (rev 5657)
@@ -5,7 +5,7 @@
 uses
   Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
   Dialogs, HttpProt, StdCtrls, Buttons, ComCtrls, MainUnit, Misc, ShellAPI,
-  SpTBXControls, TBXDkPanels, SpTBXItem;
+  SpTBXControls, TBXDkPanels, SpTBXItem,SevenZip;
 
 type
   THttpGetForm = class(TForm)
@@ -23,6 +23,7 @@
     procedure CreateParams(var Params: TCreateParams); override;
 
     function StartDownload(URL: string): Boolean;
+
     procedure CancelDownload;
     procedure UpdateReceivedStatus;
 
@@ -85,9 +86,23 @@
 end;
 
 function THttpGetForm.StartDownload(URL: string): Boolean;
+var
+  i:integer;
+  paramList: TStringList;
+  appExePath: string;
 begin
   Result := False;
 
+  ReceivedLabel.Visible := True;
+
+  if (DownloadFile.ServerOptions and $4) = 4 then
+  begin
+
+    HttpGetForm.SpTBXTitleBar1.Caption := 'Auto-updating lobby ...';
+  end
+  else
+    HttpGetForm.SpTBXTitleBar1.Caption := 'File download';
+
   if DownloadStatus.Downloading then Exit;
   UpdateReceivedStatus;
   DownloadStatus.Downloading := True;
@@ -145,6 +160,23 @@
       end;
     end
     else
+      if (DownloadFile.ServerOptions and $4) = 4 then
+      begin
+        StatusLabel.Caption := 'Download complete, extracting new files ...';
+        ReceivedLabel.Visible := False;
+        appExePath := Application.ExeName;
+        RenameFile(Application.ExeName,Application.ExeName+'.old');
+        LoadSevenZipDLL;
+        SevenZipExtractArchive(Application.Handle,DownloadFile.FileName,'',false,'',true,'.',false);
+        UnloadSevenZipDLL;
+        DeleteFile(DownloadFile.FileName);
+        paramList := TStringList.Create;
+        for i:=1 to ParamCount do
+          paramList.Add(ParamStr(i));
+        ShellExecute(0,'open',PChar(appExePath),PChar(JoinStringList(paramList,' ')),PChar(ExtractFilePath(appExePath)), SW_SHOWNORMAL);
+        MainForm.Close;
+      end
+      else
       MessageDlg('Download complete!', mtInformation, [mbOK], 0);
   end;
 
@@ -152,6 +184,7 @@
 
 end;
 
+
 procedure THttpGetForm.CancelDownload;
 begin
   HttpCli1.Abort;
@@ -182,7 +215,7 @@
 
 procedure THttpGetForm.OnStartDownloadMessage(var Msg: TMessage); // responds to WM_STARTDOWNLOAD message
 begin
-  HttpGetForm.Show;
+  HttpGetForm.ShowModal;
 end;
 
 procedure THttpGetForm.OnStartDownloadMessage2(var Msg: TMessage); // responds to WM_STARTDOWNLOAD2 message

Modified: trunk/Lobby/TASClient/MainUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/MainUnit.dfm	2008-04-04 09:18:14 UTC (rev 5656)
+++ trunk/Lobby/TASClient/MainUnit.dfm	2008-04-04 13:29:58 UTC (rev 5657)
@@ -1,6 +1,6 @@
 object MainForm: TMainForm
-  Left = 472
-  Top = 240
+  Left = 723
+  Top = 128
   Width = 789
   Height = 548
   Caption = 'TASClient'

Modified: trunk/Lobby/TASClient/MainUnit.pas
===================================================================
--- trunk/Lobby/TASClient/MainUnit.pas	2008-04-04 09:18:14 UTC (rev 5656)
+++ trunk/Lobby/TASClient/MainUnit.pas	2008-04-04 13:29:58 UTC (rev 5657)
@@ -486,6 +486,7 @@
     MapModUnavailable: TColor; // text color of a battle with a mod or map you don't have
     BotText: TColor; // bot text color in battle client list
     MyText: TColor; // my chat text color
+    AdminText: TColor;
   end;
 
   TTeamColors = array[0..9] of TColor;
@@ -508,7 +509,7 @@
 
 const
   VERSION_NUMBER = '0.37'; // Must be float value! (with a period as a decimal seperator)
-  BETA_NUMBER = 266;
+  BETA_NUMBER = 268;
   CHECK_BETA_LOBBY_URL = '<A HREF="http://tasclient.no-ip.org/TASClient.txt">http://tasclient.no-ip.org/TASClient.txt</A>';
   PROGRAM_VERSION = 'TASClient ' + VERSION_NUMBER + ' beta';
   KEEP_ALIVE_INTERVAL = 10000; // in milliseconds. Tells us what should be the maximum &quot;silence&quot; time before we send a ping to the server.
@@ -648,6 +649,8 @@
 
     constructor Create(Name: string; Status: Integer; Country: string; CPU: Integer);
 
+    function GetChatTextColor: TColor;
+
     // following functions extract various values from BattleStatus:
     function GetReadyStatus: Boolean;
     function GetTeamNo: Integer;
@@ -1360,7 +1363,7 @@
     Key: Word; // unique ping packet ID (we use it to identify the packet so we don't mingle it with other ping packets if more were sent at the same time)
   end;
 var
-  Colors: TColors = (Normal:clBlack; Data: clGreen; Error:clRed; Info:clBlue; MinorInfo: clNavy; ChanJoin: clGreen; ChanLeft: clNavy; MOTD: clMaroon; SayEx: clPurple; Topic: clMaroon; ClientAway: $009F9F9F; MapModUnavailable: $00ed00d5;BotText:clGray; MyText: $0092726e );
+  Colors: TColors = (Normal:clBlack; Data: clGreen; Error:clRed; Info:clBlue; MinorInfo: clNavy; ChanJoin: clGreen; ChanLeft: clNavy; MOTD: clMaroon; SayEx: clPurple; Topic: clMaroon; ClientAway: $009F9F9F; MapModUnavailable: $00ed00d5;BotText:clGray; MyText: $0092726e;AdminText: $0486d8 );
   Debug:
   record
     Enabled: Boolean; // show some debugging information
@@ -2196,6 +2199,17 @@
   Self.CupLadderList := TStringList.Create;
 end;
 
+function TClient.GetChatTextColor: TColor;
+begin
+  if Self.Name = MainUnit.Status.Username then
+    Result := Colors.MyText
+  else
+    if Self.GetAccess then
+      Result := Colors.AdminText
+    else
+      Result := Colors.Normal;
+end;
+
 function TClient.isComSharing: Boolean;
 var
   i:integer;
@@ -3056,6 +3070,13 @@
   Left := 10;
   Top := 10;
 
+  try
+    if FileExists(Application.ExeName + '.old') then
+      DeleteFile(Application.ExeName + '.old');
+  except
+    // nothing
+  end;
+
   FilterGroup.Height := 0;
   Filters.TextFilters := TList.Create;
   LoadFiltersFromFile;
@@ -4829,12 +4850,9 @@
         Exit;
       end;
 
-      if sl[2] = Status.Username then
-        cTmp := Colors.MyText
-      else
-        cTmp := Colors.Normal;
+      Client := GetClient(sl[2]);
 
-      AddTextToChatWindow(PageControl1.Pages[i] as TMyTabSheet, '&lt;' + sl[2] + '&gt; ' + MakeSentenceWS(sl, 3), cTmp, Length(sl[2])+2);
+      AddTextToChatWindow(PageControl1.Pages[i] as TMyTabSheet, '&lt;' + Client.Name + '&gt; ' + MakeSentenceWS(sl, 3), Client.GetChatTextColor, Length(sl[2])+2);
     end
     else if sl[0] = 'CHANNELMESSAGE' then
     begin
@@ -4952,12 +4970,9 @@
         Exit;
       end;
 
-      if sl[1] = Status.Username then
-        cTmp := Colors.MyText
-      else
-        cTmp := Colors.Normal;
+      Client := GetClient(sl[1]);
 
-      BattleForm.AddTextToChat('&lt;' + sl[1] + '&gt; ' + MakeSentenceWS(sl, 2), cTmp, Length(sl[1])+2);
+      BattleForm.AddTextToChat('&lt;' + Client.Name + '&gt; ' + MakeSentenceWS(sl, 2), Client.GetChatTextColor, Length(sl[1])+2);
     end
     else if sl[0] = 'SAIDBATTLEEX' then
     begin
@@ -5059,6 +5074,7 @@
 
         BattleState.LadderIndex := -1;
         if Battle.IsLadderBattle then
+        begin
           CheckPasswordThread := TLadderCheckAccountThread.Create(False,Preferences.LadderPassword,true);
           if Battle.GetLadderId = -1 then
             AddMainLog('Error: Battle ladder id not found.', Colors.Error)
@@ -5081,6 +5097,7 @@
               BattleForm.RefreshLadderRanks;
             end;
           end;
+        end;
 
         BattleForm.SortBotList(Preferences.BattleClientSortStyle,Preferences.BattleClientSortDirection,True);
         BattleForm.SortClientList(Preferences.BattleClientSortStyle,Preferences.BattleClientSortDirection,True);
@@ -7050,7 +7067,7 @@
         avgRank := avgRank / Battle.Clients.Count;
         RanksImageList.Draw(Canvas, R.Left, R.Top, Round(avgRank));
         Inc(R.Left, RanksImageList.Width);
-        s := FloatToStr(RoundTo(avgRank+1,-2));
+        s := FloatToStrF(RoundTo(avgRank+1,-2),ffFixed,7,2);
       end;
       7: // players
       begin
@@ -9441,6 +9458,8 @@
   html : string;
   parsedHtml: TStrings;
 begin
+  if FileExists(Application.ExeName + '.old') then
+    DeleteFile(Application.ExeName + '.old');
   with MainForm do
   begin
     parsedHtml := TStringList.Create;
@@ -9469,8 +9488,14 @@
       Misc.ParseDelimited(parsedHtml,html,' ','');
       if StrToInt(parsedHtml[0]) &gt; BETA_NUMBER then
       begin
-        if MessageDlgThread('A new beta version of the lobby is available, do you want to download it ?',mtInformation,[mbYes,mbNo],0) = mrYes then
-          Misc.OpenURLInDefaultBrowser(parsedHtml[1]);
+        //if MessageDlgThread('A new beta version of the lobby is available, do you want to download it ?',mtInformation,[mbYes,mbNo],0) = mrYes then
+        //begin
+          //Misc.OpenURLInDefaultBrowser(parsedHtml[1]);
+            DownloadFile.URL := parsedHtml[1];
+            DownloadFile.FileName := '_AutoUpdateTempFile.7z';
+            DownloadFile.ServerOptions := 4;
+            PostMessage(HttpGetForm.Handle, WM_STARTDOWNLOAD, 0, 0);
+        //end;
       end
       else
         if confirmation then

Modified: trunk/Lobby/TASClient/OnlineMapsUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/OnlineMapsUnit.dfm	2008-04-04 09:18:14 UTC (rev 5656)
+++ trunk/Lobby/TASClient/OnlineMapsUnit.dfm	2008-04-04 13:29:58 UTC (rev 5657)
@@ -1,10 +1,12 @@
 object OnlineMapsForm: TOnlineMapsForm
-  Left = 424
-  Top = 261
+  Left = 527
+  Top = 291
   Width = 676
   Height = 497
   Caption = 'Online map list'
   Color = clBtnFace
+  Constraints.MaxHeight = 1000
+  Constraints.MaxWidth = 1680
   Font.Charset = DEFAULT_CHARSET
   Font.Color = clWindowText
   Font.Height = -11

Added: trunk/Lobby/TASClient/SevenZip.pas
===================================================================
--- trunk/Lobby/TASClient/SevenZip.pas	                        (rev 0)
+++ trunk/Lobby/TASClient/SevenZip.pas	2008-04-04 13:29:58 UTC (rev 5657)
@@ -0,0 +1,730 @@
+// Delphi interface to 7-zip32.dll
+// Written by Dominic Dum&#233;e (<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">dominic at psas.co.za</A>)
+// Purpose: to create and extract files in the 7-zip format (www.7-zip.org)
+
+// 7-zip32.dll written by Akky. Download it here:
+// <A HREF="http://akky.cjb.net/download/7-zip32.html">http://akky.cjb.net/download/7-zip32.html</A>
+
+// NB: I don't understand Japanese (no english docs are available for the dll)
+// so I don't understand the purpose of all of the functions available,
+// such as Set/GetCursorInterval, Cursormode etc...
+
+// If anyone out there can provide more info on all the functions in the dll
+// please let me know... :)
+
+//-----------------------------------------------------------------------------
+// HOW TO USE IT:
+// Your program first needs to call LoadSevenZipDLL before any of the functions
+// will work. Call UnloadSevenZipDLL when your program terminates...
+// Obviously 7-zip32.dll file must be available to program (such as in the
+// app's exe folder).
+
+// Use SevenZipCreateArchive, SevenZipExtractArchive function to easily create
+// and extract 7z files (with optional callback function)
+
+// If you know what you're doing use SevenZipCommand function (works just like
+// command line version of 7-zip). See 7-zip docs for command syntax.
+
+// To get contents of archive file use SevenZipOpenArchive, SevenZipFindFirst,
+// SevenZipFindNext and SevenZipCloseArchive (works like FindFirst, FindNext) 
+
+//-----------------------------------------------------------------------------
+// Revision history:
+// v1.00 17 June 2005 - First release
+// If you find any bugs or add any features please let me know
+
+// v1.01 1 September 2005
+// new feature:
+//  --&gt; Add parameter Password in SevenZipCreateArchive and SevenZipExtractArchive function
+//      by J&#233;ter Rabelo Ferreira (<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">jeter.rabelo at jerasoft.com.br</A>)
+
+// --&gt; Added BaseDirectory parameter to SevenZipCreateArchive for easier handling of
+//     relative paths (note that absolute paths ARE NOT supported by the DLL) [Dominic Dum&#233;e]
+
+unit SevenZip;
+
+interface
+uses windows;
+
+const
+  // codes returned by SevenZipCreateArchive and SevenZipExtractArchive
+  SZ_OK = 0;
+  SZ_ERROR = 1;
+  SZ_CANCELLED = 2;
+  SZ_DLLERROR = 3;
+
+  FNAME_MAX32	= 512;
+  // these get returned as nState in the Callback function
+  ARCEXTRACT_BEGIN = 0;
+  ARCEXTRACT_INPROCESS = 1;
+  ARCEXTRACT_END = 2;
+  ARCEXTRACT_OPEN	= 3;
+  ARCEXTRACT_COPY	= 4;
+
+  // functions (QueryFunctionList)
+  ISARC								            = 0	; (* SevenZip *)
+  ISARC_GET_VERSION					      = 1	; (* SevenZipGetVersion *)
+  ISARC_GET_CURSOR_INTERVAL			  = 2	; (* SevenZipGetCursorInterval *)
+  ISARC_SET_CURSOR_INTERVAL			  = 3	; (* SevenZipSetCursorInterval *)
+  ISARC_GET_BACK_GROUND_MODE			= 4	; (* SevenZipGetBackGroundMode *)
+  ISARC_SET_BACK_GROUND_MODE			= 5	; (* SevenZipSetBackGroundMode *)
+  ISARC_GET_CURSOR_MODE				    = 6	; (* SevenZipGetCursorMode *)
+  ISARC_SET_CURSOR_MODE				    = 7	; (* SevenZipSetCursorMode *)
+  ISARC_GET_RUNNING					      = 8	; (* SevenZipGetRunning *)
+
+  ISARC_CHECK_ARCHIVE					    = 16	; (* SevenZipCheckArchive *)
+  ISARC_CONFIG_DIALOG					    = 17	; (* SevenZipConfigDialog *)
+  ISARC_GET_FILE_COUNT				    = 18	; (* SevenZipGetFileCount *)
+  ISARC_QUERY_FUNCTION_LIST			  = 19	; (* SevenZipQueryFunctionList *)
+  ISARC_HOUT							        = 20	; (* SevenZipHOut *)
+  ISARC_STRUCTOUT						      = 21	; (* SevenZipStructOut *)
+  ISARC_GET_ARC_FILE_INFO				  = 22	; (* SevenZipGetArcFileInfo *)
+
+  ISARC_OPEN_ARCHIVE					    = 23	; (* SevenZipOpenArchive *)
+  ISARC_CLOSE_ARCHIVE					    = 24	; (* SevenZipCloseArchive *)
+  ISARC_FIND_FIRST					      = 25	; (* SevenZipFindFirst *)
+  ISARC_FIND_NEXT						      = 26	; (* SevenZipFindNext *)
+  ISARC_EXTRACT						        = 27	; (* SevenZipExtract *)
+  ISARC_ADD							          = 28	; (* SevenZipAdd *)
+  ISARC_MOVE							        = 29	; (* SevenZipMove *)
+  ISARC_DELETE						        = 30	; (* SevenZipDelete *)
+  ISARC_SETOWNERWINDOW				    = 31	; (* SevenZipSetOwnerWindow *)
+  ISARC_CLEAROWNERWINDOW				  = 32	; (* SevenZipClearOwnerWindow *)
+  ISARC_SETOWNERWINDOWEX				  = 33	; (* SevenZipSetOwnerWindowEx *)
+  ISARC_KILLOWNERWINDOWEX				  = 34	; (* SevenZipKillOwnerWindowEx *)
+
+  ISARC_GET_ARC_FILE_NAME				  = 40	; (* SevenZipGetArcFileName *)
+  ISARC_GET_ARC_FILE_SIZE				  = 41	; (* SevenZipGetArcFileSize *)
+  ISARC_GET_ARC_ORIGINAL_SIZE			= 42	; (* SevenZipArcOriginalSize *)
+  ISARC_GET_ARC_COMPRESSED_SIZE		= 43	; (* SevenZipGetArcCompressedSize *)
+  ISARC_GET_ARC_RATIO					    = 44	; (* SevenZipGetArcRatio *)
+  ISARC_GET_ARC_DATE					    = 45	; (* SevenZipGetArcDate *)
+  ISARC_GET_ARC_TIME					    = 46	; (* SevenZipGetArcTime *)
+  ISARC_GET_ARC_OS_TYPE				    = 47	; (* SevenZipGetArcOSType *)
+  ISARC_GET_ARC_IS_SFX_FILE			  = 48	; (* SevenZipGetArcIsSFXFile *)
+  ISARC_GET_ARC_WRITE_TIME_EX			= 49	; (* SevenZipGetArcWriteTimeEx *)
+  ISARC_GET_ARC_CREATE_TIME_EX		= 50	; (* SevenZipGetArcCreateTimeEx *)
+ 	ISARC_GET_ARC_ACCESS_TIME_EX		= 51	; (* SevenZipGetArcAccessTimeEx *)
+ 	ISARC_GET_ARC_CREATE_TIME_EX2		= 52	; (* SevenZipGetArcCreateTimeEx2 *)
+  ISARC_GET_ARC_WRITE_TIME_EX2		= 53	; (* SevenZipGetArcWriteTimeEx2 *)
+  ISARC_GET_FILE_NAME					    = 57	; (* SevenZipGetFileName *)
+  ISARC_GET_ORIGINAL_SIZE				  = 58	; (* SevenZipGetOriginalSize *)
+  ISARC_GET_COMPRESSED_SIZE			  = 59	; (* SevenZipGetCompressedSize *)
+  ISARC_GET_RATIO						      = 60	; (* SevenZipGetRatio *)
+  ISARC_GET_DATE						      = 61	; (* SevenZipGetDate *)
+  ISARC_GET_TIME						      = 62	; (* SevenZipGetTime *)
+  ISARC_GET_CRC						        = 63	; (* SevenZipGetCRC *)
+  ISARC_GET_ATTRIBUTE					    = 64	; (* SevenZipGetAttribute *)
+  ISARC_GET_OS_TYPE					      = 65	; (* SevenZipGetOSType *)
+  ISARC_GET_METHOD					      = 66	; (* SevenZipGetMethod *)
+  ISARC_GET_WRITE_TIME				    = 67	; (* SevenZipGetWriteTime *)
+  ISARC_GET_CREATE_TIME				    = 68	; (* SevenZipGetCreateTime *)
+  ISARC_GET_ACCESS_TIME				    = 69	; (* SevenZipGetAccessTime *)
+  ISARC_GET_WRITE_TIME_EX				  = 70	; (* SevenZipGetWriteTimeEx *)
+  ISARC_GET_CREATE_TIME_EX			  = 71	; (* SevenZipGetCreateTimeEx *)
+  ISARC_GET_ACCESS_TIME_EX			  = 72	; (* SevenZipGetAccessTimeEx *)
+  ISARC_SET_ENUM_MEMBERS_PROC			= 80 ; (* SevenZipSetEnumMembersProc *)
+  ISARC_CLEAR_ENUM_MEMBERS_PROC		= 81	; (* SevenZipClearEnumMembersProc *)
+  ISARC_GET_ARC_FILE_SIZE_EX			= 82	; (* SevenZipGetArcFileSizeEx *)
+  ISARC_GET_ARC_ORIGINAL_SIZE_EX	=	83	; (* SevenZipArcOriginalSizeEx *)
+  ISARC_GET_ARC_COMPRESSED_SIZE_EX = 84	; (* SevenZipGetArcCompressedSizeEx *)
+  ISARC_GET_ORIGINAL_SIZE_EX			= 85	; (* SevenZipGetOriginalSizeEx *)
+  ISARC_GET_COMPRESSED_SIZE_EX		= 86	; (* SevenZipGetCompressedSizeEx *)
+  ISARC_SETOWNERWINDOWEX64			  = 87	; (* SevenZipSetOwnerWindowEx64 *)
+  ISARC_KILLOWNERWINDOWEX64			  = 88	; (* SevenZipKillOwnerWindowEx64 *)
+  ISARC_SET_ENUM_MEMBERS_PROC64		= 89  ; (* SevenZipSetEnumMembersProc64 *)
+  ISARC_CLEAR_ENUM_MEMBERS_PROC64	= 90	; (* SevenZipClearEnumMembersProc64 *)
+  ISARC_OPEN_ARCHIVE2					    = 91	; (* SevenZipOpenArchive2 *)
+  ISARC_GET_ARC_READ_SIZE				  = 92	; (* SevenZipGetArcReadSize *)
+  ISARC_GET_ARC_READ_SIZE_EX			= 93	; (* SevenZipGetArcReadSizeEx*)
+
+
+// Errors
+  ERROR_START				              = $8000;
+
+// (* WARNING *)
+  ERROR_DISK_SPACE		            = $8005;
+  ERROR_READ_ONLY			            = $8006;
+  ERROR_USER_SKIP			            = $8007;
+  ERROR_UNKNOWN_TYPE		          = $8008;
+  ERROR_METHOD			              = $8009;
+  ERROR_PASSWORD_FILE		          = $800A;
+  ERROR_VERSION			              = $800B;
+  ERROR_FILE_CRC			            = $800C;
+  ERROR_FILE_OPEN			            = $800D;
+  ERROR_MORE_FRESH		            = $800E;
+  ERROR_NOT_EXIST			            = $800F;
+  ERROR_ALREADY_EXIST		          = $8010;
+
+  ERROR_TOO_MANY_FILES	          = $8011;
+
+// (* ERROR *)
+  ERROR_MAKEDIRECTORY		          = $8012;
+  ERROR_CANNOT_WRITE		          = $8013;
+  ERROR_HUFFMAN_CODE		          = $8014;
+  ERROR_COMMENT_HEADER	          = $8015;
+  ERROR_HEADER_CRC		            = $8016;
+  ERROR_HEADER_BROKEN		          = $8017;
+  ERROR_ARC_FILE_OPEN		          = $8018;
+  ERROR_NOT_ARC_FILE		          = $8019;
+  ERROR_CANNOT_READ		            = $801A;
+  ERROR_FILE_STYLE		            = $801B;
+  ERROR_COMMAND_NAME		          = $801C;
+  ERROR_MORE_HEAP_MEMORY	        = $801D;
+  ERROR_ENOUGH_MEMORY		          = $801E;
+  ERROR_ALREADY_RUNNING	          = $801F;
+  ERROR_USER_CANCEL		            = $8020;
+  ERROR_HARC_ISNOT_OPENED	        = $8021;
+  ERROR_NOT_SEARCH_MODE	          = $8022;
+  ERROR_NOT_SUPPORT		            = $8023;
+  ERROR_TIME_STAMP		            = $8024;
+  ERROR_TMP_OPEN			            = $8025;
+  ERROR_LONG_FILE_NAME	          = $8026;
+  ERROR_ARC_READ_ONLY		          = $8027;
+  ERROR_SAME_NAME_FILE	          = $8028;
+  ERROR_NOT_FIND_ARC_FILE         = $8029;
+  ERROR_RESPONSE_READ		          = $802A;
+  ERROR_NOT_FILENAME		          = $802B;
+  ERROR_TMP_COPY			            = $802C;
+  ERROR_EOF				                = $802D;
+  ERROR_ADD_TO_LARC		            = $802E;
+  ERROR_TMP_BACK_SPACE	          = $802F;
+  ERROR_SHARING			              = $8030;
+  ERROR_NOT_FIND_FILE		          = $8031;
+  ERROR_LOG_FILE			            = $8032;
+ 	ERROR_NO_DEVICE			            = $8033;
+  ERROR_GET_ATTRIBUTES	          = $8034;
+  ERROR_SET_ATTRIBUTES	          = $8035;
+  ERROR_GET_INFORMATION	          = $8036;
+  ERROR_GET_POINT			            = $8037;
+  ERROR_SET_POINT			            = $8038;
+  ERROR_CONVERT_TIME		          = $8039;
+  ERROR_GET_TIME			            = $803a;
+  ERROR_SET_TIME			            = $803b;
+  ERROR_CLOSE_FILE		            = $803c;
+  ERROR_HEAP_MEMORY		            = $803d;
+  ERROR_HANDLE			              = $803e;
+  ERROR_TIME_STAMP_RANGE	        = $803f;
+  ERROR_MAKE_ARCHIVE		          = $8040;
+  ERROR_NOT_CONFIRM_NAME	        = $8041;
+  ERROR_UNEXPECTED_EOF	          = $8042;
+  ERROR_INVALID_END_MARK	        = $8043;
+  ERROR_INVOLVED_LZH		          = $8044;
+  ERROR_NO_END_MARK		            = $8045;
+  ERROR_HDR_INVALID_SIZE	        = $8046;
+  ERROR_UNKNOWN_LEVEL		          = $8047;
+  ERROR_BROKEN_DATA		            = $8048;
+
+  FA_RDONLY		 = $01;
+  FA_HIDDEN		 = $02;
+  FA_SYSTEM		 = $04;
+  FA_LABEL		 = $08;
+  FA_DIREC		 = $10;
+  FA_ARCH 		 = $20;
+  FA_ENCRYPTED = $40;
+
+  ERROR_7ZIP_START                    = $8100;
+
+  ERROR_WARNING		                    = $8101;
+  ERROR_FATAL			                    = $8102;
+  ERROR_DURING_DECOMPRESSION          = $8103;
+  ERROR_DIR_FILE_WITH_64BIT_SIZE      = $8104;
+  ERROR_FILE_CHANGED_DURING_OPERATION	= $8105;
+
+  ARCHIVETYPE_ZIP	= 1;
+  ARCHIVETYPE_7Z	=	2;
+
+
+type
+
+  HARC = integer;
+
+  TSevenZipEXTRACTINGINFO = record
+    dwFileSize          : DWORD;
+    dwWriteSize         : DWORD;
+    szSourceFileName    : array[ 0..FNAME_MAX32 ] of char;
+    dummy1              : array[ 0..2 ] of char;
+    szDestFileName      : array[ 0..FNAME_MAX32 ] of char;
+    dummy               : array[ 0..2 ] of char;
+  end;
+
+  TSevenZipEXTRACTINGINFOEX = record
+    exinfo           : TSevenZipEXTRACTINGINFO;
+    dwCompressedSize : DWORD;
+    dwCRC            : DWORD;
+    uOSType          : UINT;
+    wRatio           : WORD;
+    wDate            : WORD;
+    wTime            : WORD;
+    szAttribute      : array[ 0..7 ] of char;
+    szMode           : array[ 0..7 ] of char;
+  end;
+
+  TSevenZipINDIVIDUALINFO = record
+    dwOriginalSize   : DWORD;
+	  dwCompressedSize : DWORD;
+	  dwCRC            : DWORD;
+    uFlag            : UINT;
+		uOSType          : UINT;
+    wRatio           : WORD;
+    wDate            : WORD;
+    wTime            : WORD;
+    szFilename       : array[ 0..FNAME_MAX32 ] of char;
+    dummy1           : array[ 0..2 ] of char;
+    szAttribute      : array[ 0..7 ] of char;
+    szMode           : array[ 0..7 ] of char;
+  end;
+
+  TSevenZipCommand                = function (const hWnd: HWND; szCmdLine: PChar; szOutput: PChar; dwSize: DWORD): Integer; stdcall;
+	TSevenZipGetVersion             = function : WORD; stdcall;
+  TSevenZipGetCursorMode          = function : BOOL; stdcall;
+  TSevenZipSetCursorMode          = function( CursorMode : BOOL ) : BOOL; stdcall;
+  TSevenZipGetCursorInterval      = function : WORD; stdcall;
+  TSevenZipSetCursorInterval      = function( CursorInterval : WORD ) : WORD; stdcall; // millisecs
+  TSevenZipGetBackgroundMode      = function : BOOL; stdcall;
+  TSevenZipSetBackgroundMode      = function( BackgroundMode : BOOL ) : BOOL; stdcall;
+	TSevenZipGetRunning             = function : BOOL; stdcall;
+
+  TSevenZipConfigDialog           = function( hwnd : HWND; szOptionBuffer : PChar; iMode : integer ) : BOOL; stdcall;
+  TSevenZipCheckArchive           = function( szFilename : PChar; iMode : integer ) : BOOL; stdcall;
+  TSevenZipGetFileCount           = function( szArcFile : PChar ) : integer; stdcall;
+  TSevenZipQueryFunctionList      = function( iFunction : integer ) : BOOL; stdcall;
+
+	TSevenZipOpenArchive            = function( hwnd : HWND; szFileName : PChar; dwMode : DWORD ) : HARC; stdcall;
+	TSevenZipCloseArchive           = function( harc : HARC ) : integer; stdcall;
+	TSevenZipFindFirst              = function( harc : HARC; szFilename : PChar; var lpSubInfo : TSevenZipINDIVIDUALINFO ) : integer; stdcall;
+	TSevenZipFindNext               = function( harc : HARC; var lpSubInfo : TSevenZipINDIVIDUALINFO ) : integer; stdcall;
+	TSevenZipGetArcFileName         = function( harc : HARC; lpBuffer : pchar; nSize : integer ) : integer; stdcall;
+	TSevenZipGetArcFileSize         = function( harc : HARC ) : DWORD; stdcall;
+	TSevenZipGetArcOriginalSize     = function( harc : HARC ) : DWORD; stdcall;
+	TSevenZipGetArcCompressedSize   = function( harc : HARC ) : DWORD; stdcall;
+	TSevenZipGetArcRatio            = function( harc : HARC ) : WORD; stdcall;
+	TSevenZipGetArcDate             = function( harc : HARC ) : WORD; stdcall;
+	TSevenZipGetArcTime             = function( harc : HARC ) : WORD; stdcall;
+	TSevenZipGetArcOSType           = function( harc : HARC ) : UINT; stdcall;
+	TSevenZipIsSFXFile              = function( harc : HARC ) : integer; stdcall;
+	TSevenZipGetFileName            = function( harc : HARC ; lpBuffer : PChar; nsize : integer) : integer; stdcall;
+	TSevenZipGetOriginalSize        = function( harc : HARC ) : DWORD; stdcall;
+	TSevenZipGetCompressedSize      = function( harc : HARC ) : DWORD; stdcall;
+	TSevenZipGetRatio               = function( harc : HARC ) : WORD; stdcall;
+	TSevenZipGetDate                = function( harc : HARC ) : WORD; stdcall;
+	TSevenZipGetTime                = function( harc : HARC ) : WORD; stdcall;
+	TSevenZipGetCRC                 = function( harc : HARC ) : DWORD; stdcall;
+	TSevenZipGetAttribute           = function( harc : HARC ) : integer; stdcall;
+	TSevenZipGetOSType              = function( harc : HARC ) : UINT; stdcall;
+	TSevenZipGetMethod              = function( harc : HARC ; lpBuffer : PChar; nsize : integer) : integer; stdcall;
+	TSevenZipGetWriteTime           = function( harc : HARC ) : DWORD; stdcall;
+	TSevenZipGetWriteTimeEx         = function( harc : HARC; var lpftLastWriteTime : FILETIME ) : BOOL; stdcall;
+	TSevenZipGetArcCreateTimeEx     = function( harc : HARC; var lpftCreationTime : FILETIME ) : BOOL; stdcall;
+	TSevenZipGetArcAccessTimeEx     = function( harc : HARC; var lpftLastAccessTime : FILETIME ) : BOOL; stdcall;
+	TSevenZipGetArcWriteTimeEx      = function( harc : HARC; var lpftLastWriteTime : FILETIME ) : BOOL; stdcall;
+	TSevenZipGetArcFileSizeEx       = function( harc : HARC; var lpllSize : TLargeInteger ) : BOOL; stdcall;
+	TSevenZipGetArcOriginalSizeEx   = function( harc : HARC; var lpllSize : TLargeInteger ) : BOOL; stdcall;
+	TSevenZipGetArcCompressedSizeEx = function( harc : HARC; var lpllSize : TLargeInteger ) : BOOL; stdcall;
+	TSevenZipGetOriginalSizeEx      = function( harc : HARC; var lpllSize : TLargeInteger  ) : BOOL; stdcall;
+	TSevenZipGetCompressedSizeEx    = function( harc : HARC; var lpllSize : TLargeInteger ) : BOOL; stdcall;
+
+  // Callback func should return FALSE to cancel the archiving process, else TRUE
+  TSevenZipCallbackProc           = function( hWnd : HWND; uMsg, nState : UINT; var ExInfo : TSevenZipEXTRACTINGINFOEX ) : BOOL of object;stdcall;
+
+  TSevenZipSetOwnerWindow         = function( hwnd : HWND ) : BOOL; stdcall;
+	TSevenZipClearOwnerWindow       = function : BOOL; stdcall;
+  TSevenZipSetOwnerWindowEx       = function( hwnd : HWND; CallbackProc : TSevenZipCallbackProc ) : BOOL; stdcall;
+	TSevenZipKillOwnerWindowEx      = function( hwnd : HWND ) : BOOL; stdcall;
+
+	TSevenZipGetSubVersion          = function : WORD; stdcall;
+	TSevenZipGetArchiveType         = function( szFileName : pchar ) : integer; stdcall;
+	TSevenZipSetUnicodeMode         = function( bUnicode : BOOL ) : BOOL; stdcall;
+
+function LoadSevenZipDLL : Boolean;
+function UnloadSevenZipDLL : Boolean;
+
+// NB: add '-hide' to command line switches if you want the CallBack function to be called
+// (set up via SevenZipSetOwnerWindowEx).
+// otherwise the DLL uses it's own internal progress dialog
+function SevenZipCommand( hWnd : HWND;                     // parent window
+                          CommandLine : string;            // 7zip command line (see 7zip docs)
+                          var CommandOutput : string;      // returns 7zip output
+                          MaxCommandOutputLen : integer = 32768 ) : integer;
+
+// simplified func to create archive
+function SevenZipCreateArchive( hWnd : HWND; // parent window handle
+                                ArchiveFilename : string;
+                                BaseDirectory : string; // all filenames in FileList must be relative to this directory (absolute paths e.g. &quot;c:\temp\test.txt&quot; not allowed, but &quot;temp\test.txt&quot; allowed)
+                                FileList : string; // comma separated files to be added to archive (wildcards ok)
+                                CompressionLevel : integer;   // 0 = none, 9=max
+                                CreateSolidArchive : Boolean; // solid = better compression for multiple files
+                                RecurseFolders : Boolean;     // recurse folders?
+                                Password: String; // '' Nothing happens
+                                ShowProgress   : Boolean;     // if true uses dll's internal progress indicator (callback func ignored)
+                                Callback       : TSevenZipCallbackProc = nil ) // optional callback (ShowProgress must be false)
+                                : integer;
+
+// simplified func to extract archive
+function SevenZipExtractArchive( hWnd : HWND; // parent window handle
+                                 ArchiveFilename : string;
+                                 FileList : string; // comma separated files to be extracted (wildcards ok)
+                                 RecurseFolders : Boolean;
+                                 Password: String; // '' Nothing happens
+                                 ExtractFullPaths : Boolean;
+                                 ExtractBaseDir : string;
+                                 ShowProgress   : Boolean;     // if true uses dll's internal progress indicator (callback func ignored)
+                                 Callback       : TSevenZipCallbackProc = nil ) // optional callback (ShowProgress must be false)
+                                 : integer; // 0 = success
+
+
+var
+  _SevenZipCommand              : TSevenZipCommand              = nil;
+  SevenZipGetVersion            : TSevenZipGetVersion           = nil;
+  SevenZipGetCursorMode         : TSevenZipGetCursorMode        = nil;
+  SevenZipSetCursorMode         : TSevenZipSetCursorMode        = nil;
+  SevenZipGetCursorInterval     : TSevenZipGetCursorInterval    = nil;
+  SevenZipSetCursorInterval     : TSevenZipSetCursorInterval    = nil;
+  SevenZipGetBackgroundMode     : TSevenZipGetBackgroundMode    = nil;
+  SevenZipSetBackgroundMode     : TSevenZipSetBackgroundMode    = nil;
+  SevenZipGetRunning            : TSevenZipGetRunning           = nil;
+
+  SevenZipConfigDialog          : TSevenZipConfigDialog         = nil;
+  SevenZipCheckArchive          : TSevenZipCheckArchive         = nil;
+  SevenZipGetFileCount          : TSevenZipGetFileCount         = nil;
+  SevenZipQueryFunctionList     : TSevenZipQueryFunctionList    = nil;
+
+  SevenZipOpenArchive           : TSevenZipOpenArchive          = nil;
+  SevenZipCloseArchive          : TSevenZipCloseArchive         = nil;
+  SevenZipFindFirst             : TSevenZipFindFirst            = nil;
+  SevenZipFindNext              : TSevenZipFindNext             = nil;
+  SevenZipGetArcFileName        : TSevenZipGetArcFileName       = nil;
+  SevenZipGetArcFileSize        : TSevenZipGetArcFileSize       = nil;
+  SevenZipGetArcOriginalSize    : TSevenZipGetArcOriginalSize   = nil;
+  SevenZipGetArcCompressedSize  : TSevenZipGetArcCompressedSize = nil;
+  SevenZipGetArcRatio           : TSevenZipGetArcRatio          = nil;
+  SevenZipGetArcDate            : TSevenZipGetArcDate           = nil;
+  SevenZipGetArcTime            : TSevenZipGetArcTime           = nil;
+  SevenZipGetArcOSType          : TSevenZipGetArcOSType         = nil;
+  SevenZipIsSFXFile             : TSevenZipIsSFXFile            = nil;
+  SevenZipGetFileName           : TSevenZipGetFileName          = nil;
+  SevenZipGetOriginalSize       : TSevenZipGetOriginalSize      = nil;
+  SevenZipGetCompressedSize     : TSevenZipGetCompressedSize    = nil;
+  SevenZipGetRatio              : TSevenZipGetRatio             = nil;
+  SevenZipGetDate               : TSevenZipGetDate              = nil;   
+  SevenZipGetTime               : TSevenZipGetTime              = nil;   
+  SevenZipGetCRC                : TSevenZipGetCRC               = nil;
+  SevenZipGetAttribute          : TSevenZipGetAttribute         = nil;   
+  SevenZipGetOSType             : TSevenZipGetOSType            = nil;   
+  SevenZipGetMethod             : TSevenZipGetMethod            = nil;   
+  SevenZipGetWriteTime          : TSevenZipGetWriteTime         = nil;
+  SevenZipGetWriteTimeEx        : TSevenZipGetWriteTimeEx       = nil;
+  SevenZipGetArcCreateTimeEx    : TSevenZipGetArcCreateTimeEx   = nil;   
+  SevenZipGetArcAccessTimeEx    : TSevenZipGetArcAccessTimeEx   = nil;   
+  SevenZipGetArcWriteTimeEx     : TSevenZipGetArcWriteTimeEx    = nil;   
+  SevenZipGetArcFileSizeEx      : TSevenZipGetArcFileSizeEx     = nil;   
+  SevenZipGetArcOriginalSizeEx  : TSevenZipGetArcOriginalSizeEx = nil;   
+  SevenZipGetArcCompressedSizeEx: TSevenZipGetArcCompressedSizeEx= nil;
+  SevenZipGetOriginalSizeEx     : TSevenZipGetOriginalSizeEx    = nil; 
+  SevenZipGetCompressedSizeEx   : TSevenZipGetCompressedSizeEx  = nil;
+
+  SevenZipSetOwnerWindow        : TSevenZipSetOwnerWindow       = nil; 
+  SevenZipClearOwnerWindow      : TSevenZipClearOwnerWindow     = nil; 
+  SevenZipSetOwnerWindowEx      : TSevenZipSetOwnerWindowEx     = nil; 
+  SevenZipKillOwnerWindowEx     : TSevenZipKillOwnerWindowEx    = nil; 
+
+  SevenZipGetSubVersion         : TSevenZipGetSubVersion        = nil; 
+  SevenZipGetArchiveType        : TSevenZipGetArchiveType       = nil;
+  SevenZipSetUnicodeMode        : TSevenZipSetUnicodeMode       = nil;
+
+implementation
+uses classes, sysutils, dialogs;
+
+var
+  _SevenZipDLLHandle : THandle = 0;
+
+function LoadSevenZipDLL : Boolean;
+
+begin
+  Result := FALSE;
+
+  if _SevenZipDLLHandle &lt;&gt; 0 then
+    exit;
+
+  _SevenZipDLLHandle := LoadLibrary( '7-zip32.dll' );
+  if _SevenZipDLLHandle &gt; 0 then
+  begin
+    _SevenZipCommand             := GetProcAddress( _SevenZipDLLHandle, 'SevenZip' );
+
+    SevenZipGetVersion           := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetVersion' );
+    SevenZipGetCursorMode        := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetCursorMode' );
+    SevenZipSetCursorMode        := GetProcAddress( _SevenZipDLLHandle, 'SevenZipSetCursorMode' );
+    SevenZipGetCursorInterval    := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetCursorInterval' );
+    SevenZipSetCursorInterval    := GetProcAddress( _SevenZipDLLHandle, 'SevenZipSetCursorInterval' );
+    SevenZipGetBackgroundMode    := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetBackgroundMode' );
+    SevenZipSetBackgroundMode    := GetProcAddress( _SevenZipDLLHandle, 'SevenZipSetBackgroundMode' );
+    SevenZipGetRunning           := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetRunning' );
+
+    SevenZipConfigDialog         := GetProcAddress( _SevenZipDLLHandle, 'SevenZipConfigDialog' );
+    SevenZipCheckArchive         := GetProcAddress( _SevenZipDLLHandle, 'SevenZipCheckArchive' );
+    SevenZipGetFileCount         := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetFileCount' );
+    SevenZipQueryFunctionList    := GetProcAddress( _SevenZipDLLHandle, 'SevenZipQueryFunctionList' );
+
+    SevenZipOpenArchive          := GetProcAddress( _SevenZipDLLHandle, 'SevenZipOpenArchive' );
+    SevenZipCloseArchive         := GetProcAddress( _SevenZipDLLHandle, 'SevenZipCloseArchive' );
+    SevenZipFindFirst            := GetProcAddress( _SevenZipDLLHandle, 'SevenZipFindFirst' );
+    SevenZipFindNext             := GetProcAddress( _SevenZipDLLHandle, 'SevenZipFindNext' );
+    SevenZipGetArcFileName       := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcFileName' );      
+    SevenZipGetArcFileSize       := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcFileSize' );      
+    SevenZipGetArcOriginalSize   := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcOriginalSize' );  
+    SevenZipGetArcCompressedSize := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcCompressedSize' );
+    SevenZipGetArcRatio          := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcRatio' );         
+    SevenZipGetArcDate           := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcDate' );          
+    SevenZipGetArcTime           := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcTime' );          
+    SevenZipGetArcOSType         := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcOSType' );        
+    SevenZipIsSFXFile            := GetProcAddress( _SevenZipDLLHandle, 'SevenZipIsSFXFile' );           
+    SevenZipGetFileName          := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetFileName' );         
+    SevenZipGetOriginalSize      := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetOriginalSize' );     
+    SevenZipGetCompressedSize    := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetCompressedSize' );
+    SevenZipGetRatio             := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetRatio' );            
+    SevenZipGetDate              := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetDate' );             
+    SevenZipGetTime              := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetTime' );             
+    SevenZipGetCRC               := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetCRC' );              
+    SevenZipGetAttribute         := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetAttribute' );         
+    SevenZipGetOSType            := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetOSType' );            
+    SevenZipGetMethod            := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetMethod' );            
+    SevenZipGetWriteTime         := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetWriteTime' );         
+    SevenZipGetWriteTimeEx       := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetWriteTimeEx' );       
+    SevenZipGetArcCreateTimeEx   := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcCreateTimeEx' );   
+    SevenZipGetArcAccessTimeEx   := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcAccessTimeEx' );   
+    SevenZipGetArcWriteTimeEx    := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcWriteTimeEx' );
+    SevenZipGetArcFileSizeEx     := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcFileSizeEx' );
+    SevenZipGetArcOriginalSizeEx := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcOriginalSizeEx' ); 
+    SevenZipGetArcCompressedSizeEx := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArcCompressedSizeEx' );
+    SevenZipGetOriginalSizeEx    := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetOriginalSizeEx' );
+    SevenZipGetCompressedSizeEx  := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetCompressedSizeEx' );
+
+    SevenZipSetOwnerWindow       := GetProcAddress( _SevenZipDLLHandle, 'SevenZipSetOwnerWindow' );
+    SevenZipClearOwnerWindow     := GetProcAddress( _SevenZipDLLHandle, 'SevenZipClearOwnerWindow' );
+    SevenZipSetOwnerWindowEx     := GetProcAddress( _SevenZipDLLHandle, 'SevenZipSetOwnerWindowEx' );
+    SevenZipKillOwnerWindowEx    := GetProcAddress( _SevenZipDLLHandle, 'SevenZipKillOwnerWindowEx' );
+
+    SevenZipGetSubVersion        := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetSubVersion' );
+    SevenZipGetArchiveType       := GetProcAddress( _SevenZipDLLHandle, 'SevenZipGetArchiveType' );
+    SevenZipSetUnicodeMode       := GetProcAddress( _SevenZipDLLHandle, 'SevenZipSetUnicodeMode' );
+
+    Result := TRUE;
+  end;
+
+end;
+
+function UnloadSevenZipDLL : Boolean;
+
+begin
+  Result := FALSE;
+
+  if _SevenZipDLLHandle &lt;&gt; 0 then
+  begin
+    FreeLibrary( _SevenZipDLLHandle );
+    _SevenZipDLLHandle := 0;
+    Result := TRUE;
+  end;
+end;
+
+function SevenZipCommand( hWnd : HWND;
+                          CommandLine : string;
+                          var CommandOutput : string;
+                          MaxCommandOutputLen : integer = 32768 ) : integer;
+
+begin
+  SetLength( CommandOutput, MaxCommandOutputLen );
+  Result := _SevenZipCommand( hWnd, PChar( CommandLine), PChar( CommandOutput ), MaxCommandOutputLen - 1 );
+  CommandOutput := string( PChar( CommandOutput ) );
+end;
+
+function RemoveQuotes( s : string ) : string;
+
+begin
+  if ( Copy( s, 1, 1 ) = '&quot;' ) and ( Copy( s, Length( s ), 1 ) = '&quot;' ) then
+    Result := Copy( s, 2, Length( s ) - 2 )
+  else
+    Result := s;
+end;
+
+function SevenZipCreateArchive( hWnd : HWND; // parent window handle
+                                ArchiveFilename : string;
+                                BaseDirectory : string; // all filenames in FileList must be relative to this directory (absolute paths e.g. &quot;c:\temp\test.txt&quot; not allowed, but &quot;temp\test.txt&quot; allowed)
+                                FileList : string; // comma separated files to be added to archive (wildcards ok) - all relative to BaseDirectory
+                                CompressionLevel : integer;   // 0 = none, 9=max
+                                CreateSolidArchive : Boolean; // solid = better compression for multiple files
+                                RecurseFolders : Boolean;     // recurse folders?
+                                Password: String; // '' Nothing happens
+                                ShowProgress   : Boolean;     // if true uses dll's internal progress indicator (callback func ignored)
+                                Callback       : TSevenZipCallbackProc = nil ) // optional callback (ShowProgress must be false)
+                                : integer; // 0 = success
+
+var
+  flist : TStringList;
+  S7ResultOutput : string;
+  s7cmd : string;
+  i : integer;
+  cwd : string;
+
+begin
+  //
+  cwd := GetCurrentDir;
+
+  // change to base dir so relative paths work correctly
+  if not SetCurrentDir( BaseDirectory ) then
+  begin
+    Result := SZ_ERROR;
+    exit;
+  end;
+
+  flist := TStringList.Create;
+  flist.CommaText := FileList;
+
+  if @Callback &lt;&gt; nil then
+    ShowProgress := FALSE;
+
+  try
+    s7cmd := 'a &quot;' + ArchiveFilename + '&quot; &quot;' + RemoveQuotes( flist[ 0 ] ) + '&quot;';
+
+    for i := 1 to flist.count - 1 do
+    begin
+      s7cmd := s7cmd + ' -i';
+      if RecurseFolders then
+        s7cmd := s7cmd + 'r';
+
+      s7cmd := s7cmd + '!&quot;' + RemoveQuotes( flist[ i ] ) + '&quot;';
+    end;
+
+    s7cmd := s7cmd + ' -mx' + IntToStr( CompressionLevel );
+    if RecurseFolders then
+      s7Cmd := s7cmd + ' -r';
+
+    if Password &lt;&gt; '' then
+      s7Cmd := s7Cmd + ' -p' + Password;
+
+    if CreateSolidArchive then
+      s7cmd := s7cmd + ' -ms=on'
+    else
+      s7cmd := s7cmd + ' -ms=off';
+
+    if not ShowProgress then
+      s7cmd := s7cmd + ' -hide';
+
+    try
+      SevenZipSetOwnerWindowEx( hwnd, Callback );
+
+      SevenZipCommand( hWnd, s7cmd, s7ResultOutput );
+
+      SevenZipSetOwnerWindowEx( hwnd, nil );
+
+      S7ResultOutput := string(PChar(S7ResultOutput));
+
+      if Pos( 'operation aborted', Lowercase( S7ResultOutput ) ) &gt; 0 then
+        Result := SZ_CANCELLED
+      else
+      if Pos('error:', LowerCase(S7ResultOutput)) &gt; 0 then
+        Result := SZ_ERROR
+      else
+        Result := SZ_OK;
+    except
+      on e : exception do
+      begin
+        Result := SZ_DLLERROR;
+      end;
+    end;
+
+  finally
+    flist.Free;
+    SetCurrentDir( cwd ); // back to where we were
+  end;
+end;
+
+function SevenZipExtractArchive( hWnd : HWND; // parent window handle
+                                ArchiveFilename : string;
+                                FileList : string; // comma separated files to be extracted (wildcards ok)
+                                RecurseFolders : Boolean;
+                                Password: String; // '' Nothing happens
+                                ExtractFullPaths : Boolean;
+                                ExtractBaseDir : string;
+                                ShowProgress   : Boolean;     // if true uses dll's internal progress indicator (callback func ignored)
+                                Callback       : TSevenZipCallbackProc = nil ) // optional callback (ShowProgress must be false)
+                                : integer; // 0 = success
+
+var
+  flist : TStringList;
+  S7ResultOutput : string;
+  s7cmd : string;
+  i : integer;
+
+begin
+  //
+  flist := TStringList.Create;
+
+  if @Callback &lt;&gt; nil then
+    ShowProgress := FALSE;
+
+  if FileList = '' then
+    FileList := '*.*';
+
+  flist.CommaText := FileList;
+
+  try
+    if ExtractFullPaths then
+      s7cmd := 'x'
+    else
+      s7cmd := 'e';
+
+    s7cmd := s7cmd + ' &quot;' + ArchiveFilename + '&quot; -o&quot;' + ExtractBaseDir + '&quot;';
+
+    s7cmd := s7cmd + ' &quot;' + flist[ 0 ] + '&quot;';
+
+
+    for i := 1 to flist.count - 1 do
+    begin
+      s7cmd := s7cmd + ' -i';
+      if RecurseFolders then
+        s7cmd := s7cmd + 'r';
+
+      s7cmd := s7cmd + '!&quot;' + RemoveQuotes( flist[ i ] ) + '&quot;';
+    end;
+
+    if RecurseFolders then
+      s7cmd := s7cmd + ' -r';
+
+    if Password &lt;&gt; '' then
+      s7Cmd := s7Cmd + ' -p' + Password;  
+
+    if not ShowProgress then
+      s7cmd := s7cmd + ' -hide';
+
+    s7cmd := s7cmd + ' -y'; // yes on all queries (will overwrite)
+
+    try
+      SevenZipSetOwnerWindowEx( hwnd, Callback );
+
+      SevenZipCommand( hWnd, s7cmd, s7ResultOutput );
+
+      SevenZipSetOwnerWindowEx( hwnd, nil );
+
+      S7ResultOutput := string(PChar(S7ResultOutput));
+
+      if Pos( 'operation aborted', Lowercase( S7ResultOutput ) ) &gt; 0 then
+        Result := SZ_CANCELLED
+      else
+      if Pos('error:', LowerCase(S7ResultOutput)) &gt; 0 then
+        Result := SZ_ERROR
+      else
+        Result := SZ_OK;
+    except
+      on e : exception do
+      begin
+        Result := SZ_DLLERROR;
+      end;
+    end;
+
+  finally
+    flist.Free;
+  end;
+end;
+
+
+end.

Modified: trunk/Lobby/TASClient/TASClient.dof
===================================================================
--- trunk/Lobby/TASClient/TASClient.dof	2008-04-04 09:18:14 UTC (rev 5656)
+++ trunk/Lobby/TASClient/TASClient.dof	2008-04-04 13:29:58 UTC (rev 5657)
@@ -115,7 +115,7 @@
 MajorVer=0
 MinorVer=3
 Release=0
-Build=266
+Build=268
 Debug=0
 PreRelease=0
 Special=0
@@ -126,7 +126,7 @@
 [Version Info Keys]
 CompanyName=
 FileDescription=TA Spring lobby client
-FileVersion=0.3.0.266
+FileVersion=0.3.0.268
 InternalName=
 LegalCopyright=
 LegalTrademarks=

Modified: trunk/Lobby/TASClient/TASClient.dpr
===================================================================
--- trunk/Lobby/TASClient/TASClient.dpr	2008-04-04 09:18:14 UTC (rev 5656)
+++ trunk/Lobby/TASClient/TASClient.dpr	2008-04-04 13:29:58 UTC (rev 5657)
@@ -97,7 +97,8 @@
   AwayMessageFormUnit in 'AwayMessageFormUnit.pas' {AwayMessageForm},
   ColorsPreferenceUnit in 'ColorsPreferenceUnit.pas' {ColorsPreference},
   Math,
-  Classes;
+  Classes,
+  SevenZip in 'SevenZip.pas';
 
 var
   i: Integer;

Modified: trunk/Lobby/TASClient/TASClient.res
===================================================================
(Binary files differ)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000437.html">[Taspring-linux-commit] r5656 - trunk/rts/build/vstudio8
</A></li>
	<LI>Next message: <A HREF="000439.html">[Taspring-linux-commit] r5658 - trunk/Lobby/TASClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#438">[ date ]</a>
              <a href="thread.html#438">[ thread ]</a>
              <a href="subject.html#438">[ subject ]</a>
              <a href="author.html#438">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
