<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r7115 - in branches/caiinterface:	AI/Interfaces AI/Interfaces/C AI/Skirmish	AI/Wrappers/LegacyCpp rts/ExternalAI rts/ExternalAI/Interface	rts/Game rts/Game/StartScripts rts/Sim/Misc rts/System/Script	rts/build/cmake tools/unitsync
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-December/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7115%20-%20in%20branches/caiinterface%3A%0A%09AI/Interfaces%20AI/Interfaces/C%20AI/Skirmish%0A%09AI/Wrappers/LegacyCpp%20rts/ExternalAI%20rts/ExternalAI/Interface%0A%09rts/Game%20rts/Game/StartScripts%20rts/Sim/Misc%20rts/System/Script%0A%09rts/build/cmake%20tools/unitsync&In-Reply-To=%3C20081204110228.35239477A%40progate.clan-sy.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001883.html">
   <LINK REL="Next"  HREF="001885.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r7115 - in branches/caiinterface:	AI/Interfaces AI/Interfaces/C AI/Skirmish	AI/Wrappers/LegacyCpp rts/ExternalAI rts/ExternalAI/Interface	rts/Game rts/Game/StartScripts rts/Sim/Misc rts/System/Script	rts/build/cmake tools/unitsync</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7115%20-%20in%20branches/caiinterface%3A%0A%09AI/Interfaces%20AI/Interfaces/C%20AI/Skirmish%0A%09AI/Wrappers/LegacyCpp%20rts/ExternalAI%20rts/ExternalAI/Interface%0A%09rts/Game%20rts/Game/StartScripts%20rts/Sim/Misc%20rts/System/Script%0A%09rts/build/cmake%20tools/unitsync&In-Reply-To=%3C20081204110228.35239477A%40progate.clan-sy.com%3E"
       TITLE="[Taspring-linux-commit] r7115 - in branches/caiinterface:	AI/Interfaces AI/Interfaces/C AI/Skirmish	AI/Wrappers/LegacyCpp rts/ExternalAI rts/ExternalAI/Interface	rts/Game rts/Game/StartScripts rts/Sim/Misc rts/System/Script	rts/build/cmake tools/unitsync">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Thu Dec  4 12:02:28 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001883.html">[Taspring-linux-commit] r7114 - trunk/rts/System/Net
</A></li>
        <LI>Next message: <A HREF="001885.html">[Taspring-linux-commit] r7116 - in Lobby/TASClient: . Interface
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1884">[ date ]</a>
              <a href="thread.html#1884">[ thread ]</a>
              <a href="subject.html#1884">[ subject ]</a>
              <a href="author.html#1884">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: hoijui
Date: 2008-12-04 12:02:27 +0100 (Thu, 04 Dec 2008)
New Revision: 7115

Added:
   branches/caiinterface/rts/ExternalAI/AIInterfaceKey.cpp
   branches/caiinterface/rts/ExternalAI/AIInterfaceKey.h
   branches/caiinterface/rts/ExternalAI/Interface/SSkirmishAISpecifier.cpp
   branches/caiinterface/rts/ExternalAI/Interface/SSkirmishAISpecifier.h
   branches/caiinterface/rts/ExternalAI/SkirmishAIKey.cpp
   branches/caiinterface/rts/ExternalAI/SkirmishAIKey.h
   branches/caiinterface/rts/build/cmake/FindJAVA.cmake
Modified:
   branches/caiinterface/AI/Interfaces/C/Interface.cpp
   branches/caiinterface/AI/Interfaces/C/Interface.h
   branches/caiinterface/AI/Interfaces/C/InterfaceExport.h
   branches/caiinterface/AI/Interfaces/CMakeLists.txt
   branches/caiinterface/AI/Skirmish/CMakeLists.txt
   branches/caiinterface/AI/Wrappers/LegacyCpp/AIAICallback.cpp
   branches/caiinterface/rts/ExternalAI/AIInterfaceLibrary.cpp
   branches/caiinterface/rts/ExternalAI/AIInterfaceLibrary.h
   branches/caiinterface/rts/ExternalAI/AIInterfaceLibraryInfo.cpp
   branches/caiinterface/rts/ExternalAI/AIInterfaceLibraryInfo.h
   branches/caiinterface/rts/ExternalAI/AILibraryManager.cpp
   branches/caiinterface/rts/ExternalAI/AILibraryManager.h
   branches/caiinterface/rts/ExternalAI/EngineOutHandler.cpp
   branches/caiinterface/rts/ExternalAI/EngineOutHandler.h
   branches/caiinterface/rts/ExternalAI/GroupAI.h
   branches/caiinterface/rts/ExternalAI/GroupAILibrary.cpp
   branches/caiinterface/rts/ExternalAI/GroupAILibrary.h
   branches/caiinterface/rts/ExternalAI/IAIInterfaceLibrary.h
   branches/caiinterface/rts/ExternalAI/IAILibraryManager.cpp
   branches/caiinterface/rts/ExternalAI/IAILibraryManager.h
   branches/caiinterface/rts/ExternalAI/ISkirmishAILibrary.h
   branches/caiinterface/rts/ExternalAI/Interface/AISCommands.h
   branches/caiinterface/rts/ExternalAI/Interface/SAICallback.h
   branches/caiinterface/rts/ExternalAI/Interface/SAIInterfaceLibrary.cpp
   branches/caiinterface/rts/ExternalAI/Interface/SAIInterfaceLibrary.h
   branches/caiinterface/rts/ExternalAI/Interface/SInfo.cpp
   branches/caiinterface/rts/ExternalAI/Interface/SSAILibrary.cpp
   branches/caiinterface/rts/ExternalAI/Interface/SSAILibrary.h
   branches/caiinterface/rts/ExternalAI/SAICallback.cpp
   branches/caiinterface/rts/ExternalAI/SStaticGlobalData.cpp
   branches/caiinterface/rts/ExternalAI/SkirmishAI.cpp
   branches/caiinterface/rts/ExternalAI/SkirmishAI.h
   branches/caiinterface/rts/ExternalAI/SkirmishAILibrary.cpp
   branches/caiinterface/rts/ExternalAI/SkirmishAILibrary.h
   branches/caiinterface/rts/ExternalAI/SkirmishAILibraryInfo.cpp
   branches/caiinterface/rts/ExternalAI/SkirmishAILibraryInfo.h
   branches/caiinterface/rts/ExternalAI/SkirmishAIWrapper.cpp
   branches/caiinterface/rts/ExternalAI/SkirmishAIWrapper.h
   branches/caiinterface/rts/Game/GameServer.cpp
   branches/caiinterface/rts/Game/Player.cpp
   branches/caiinterface/rts/Game/StartScripts/CommanderScript.cpp
   branches/caiinterface/rts/Game/StartScripts/SkirmishAITestScript.cpp
   branches/caiinterface/rts/Game/StartScripts/SkirmishAITestScript.h
   branches/caiinterface/rts/Sim/Misc/Resource.cpp
   branches/caiinterface/rts/Sim/Misc/Resource.h
   branches/caiinterface/rts/Sim/Misc/ResourceHandler.cpp
   branches/caiinterface/rts/Sim/Misc/ResourceHandler.h
   branches/caiinterface/rts/Sim/Misc/Team.cpp
   branches/caiinterface/rts/Sim/Misc/Team.h
   branches/caiinterface/rts/Sim/Misc/TeamHandler.cpp
   branches/caiinterface/rts/System/Script/LuaFunctions.cpp
   branches/caiinterface/rts/System/Script/LuaFunctions.h
   branches/caiinterface/tools/unitsync/unitsync.cpp
   branches/caiinterface/tools/unitsync/unitsync_api.h
Log:
* replaced the C SSAISpecifier with the C++ SkirmishAIKey (as it is now not used in the interface anymore)
* for convienience when building AI interfaces: added SSkirmishAISpecifier, which can be used instead of SSAISpecifier in interfaces (for uniquely identifying skirmish AIs), this struct is not used engine internally
* fixed SkirmishAITestScript
* refined CMake Java AI interface and Skirmish AI building a bit
* some callback bug-fixes

Modified: branches/caiinterface/AI/Interfaces/C/Interface.cpp
===================================================================
--- branches/caiinterface/AI/Interfaces/C/Interface.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/AI/Interfaces/C/Interface.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -21,6 +21,7 @@
 
 #include &quot;ExternalAI/Interface/aidefines.h&quot;
 #include &quot;ExternalAI/Interface/SAIInterfaceLibrary.h&quot;
+#include &quot;ExternalAI/Interface/SSAILibrary.h&quot;
 #include &quot;ExternalAI/Interface/SStaticGlobalData.h&quot;
 
 #include &quot;System/Platform/SharedLib.h&quot;
@@ -121,15 +122,15 @@
 	return LOS_Working;
 }
 
-SSAISpecifier extractSSAISpecifier(
+SSkirmishAISpecifier CInterface::ExtractSpecifier(
 		const std::map&lt;std::string, std::string&gt;&amp; infoMap) {
 
 	const char* sn = infoMap.find(SKIRMISH_AI_PROPERTY_SHORT_NAME)-&gt;second.c_str();
 	const char* v = infoMap.find(SKIRMISH_AI_PROPERTY_VERSION)-&gt;second.c_str();
 
-	SSAISpecifier specifier = {sn, v};
+	SSkirmishAISpecifier spec = {sn, v};
 
-	return specifier;
+	return spec;
 }
 //SGAISpecifier extractSGAISpecifier(
 //		const std::map&lt;std::string, InfoItem&gt;&amp; infoMap) {
@@ -147,18 +148,18 @@
 
 	SSAILibrary* ai;
 
-	SSAISpecifier sAISpecifier = extractSSAISpecifier(infoMap);
+	SSkirmishAISpecifier spec = ExtractSpecifier(infoMap);
 
-	mySkirmishAISpecifiers.push_back(sAISpecifier);
-	mySkirmishAIInfos[sAISpecifier] = infoMap;
+	mySkirmishAISpecifiers.insert(spec);
+	mySkirmishAIInfos[spec] = infoMap;
 
 	T_skirmishAIs::iterator skirmishAI;
-	skirmishAI = myLoadedSkirmishAIs.find(sAISpecifier);
+	skirmishAI = myLoadedSkirmishAIs.find(spec);
 	if (skirmishAI == myLoadedSkirmishAIs.end()) {
 		ai = new SSAILibrary;
-		SharedLib* lib = Load(&amp;sAISpecifier, ai);
-		myLoadedSkirmishAIs[sAISpecifier] = ai;
-		myLoadedSkirmishAILibs[sAISpecifier] = lib;
+		SharedLib* lib = Load(spec, ai);
+		myLoadedSkirmishAIs[spec] = ai;
+		myLoadedSkirmishAILibs[spec] = lib;
 	} else {
 		ai = skirmishAI-&gt;second;
 	}
@@ -168,12 +169,12 @@
 int CInterface::UnloadSkirmishAILibrary(
 		const std::map&lt;std::string, std::string&gt;&amp; infoMap) {
 
-	SSAISpecifier sAISpecifier = extractSSAISpecifier(infoMap);
+	SSkirmishAISpecifier spec = ExtractSpecifier(infoMap);
 
 	T_skirmishAIs::iterator skirmishAI =
-			myLoadedSkirmishAIs.find(sAISpecifier);
+			myLoadedSkirmishAIs.find(spec);
 	T_skirmishAILibs::iterator skirmishAILib =
-			myLoadedSkirmishAILibs.find(sAISpecifier);
+			myLoadedSkirmishAILibs.find(spec);
 	if (skirmishAI == myLoadedSkirmishAIs.end()) {
 		// to unload AI is not loaded -&gt; no problem, do nothing
 	} else {
@@ -248,9 +249,8 @@
 
 // private functions following
 
-SharedLib* CInterface::Load(const SSAISpecifier* const sAISpecifier,
-		SSAILibrary* skirmishAILibrary) {
-	return LoadSkirmishAILib(FindLibFile(*sAISpecifier), skirmishAILibrary);
+SharedLib* CInterface::Load(const SSkirmishAISpecifier&amp; spec, SSAILibrary* skirmishAILibrary) {
+	return LoadSkirmishAILib(FindLibFile(spec), skirmishAILibrary);
 }
 SharedLib* CInterface::LoadSkirmishAILib(const std::string&amp; libFilePath,
 		SSAILibrary* skirmishAILibrary) {
@@ -414,29 +414,29 @@
 }
 
 
-std::string CInterface::FindLibFile(const SSAISpecifier&amp; sAISpecifier) {
+std::string CInterface::FindLibFile(const SSkirmishAISpecifier&amp; spec) {
 
 	// fetch the data-dir and file-name from the info about the AI to load,
 	// which was supplied to us by the engine
 	T_skirmishAIInfos::const_iterator info =
-			mySkirmishAIInfos.find(sAISpecifier);
+			mySkirmishAIInfos.find(spec);
 	if (info == mySkirmishAIInfos.end()) {
 		reportError(std::string(&quot;Missing Skirmish-AI info for &quot;)
-				+ sAISpecifier.shortName + &quot; &quot; + sAISpecifier.version);
+				+ spec.shortName + &quot; &quot; + spec.version);
 	}
 
 	std::map&lt;std::string, std::string&gt;::const_iterator prop =
 			info-&gt;second.find(SKIRMISH_AI_PROPERTY_DATA_DIR);
 	if (prop == info-&gt;second.end()) {
 		reportError(std::string(&quot;Missing Skirmish-AI data dir for &quot;)
-				+ sAISpecifier.shortName + &quot; &quot; + sAISpecifier.version);
+				+ spec.shortName + &quot; &quot; + spec.version);
 	}
 	const std::string&amp; dataDir(prop-&gt;second);
 
 	prop = info-&gt;second.find(SKIRMISH_AI_PROPERTY_FILE_NAME);
 	if (prop == info-&gt;second.end()) {
 		reportError(std::string(&quot;Missing Skirmish-AI file name for &quot;)
-				+ sAISpecifier.shortName + &quot; &quot; + sAISpecifier.version);
+				+ spec.shortName + &quot; &quot; + spec.version);
 	}
 	const std::string&amp; fileName(prop-&gt;second);
 

Modified: branches/caiinterface/AI/Interfaces/C/Interface.h
===================================================================
--- branches/caiinterface/AI/Interfaces/C/Interface.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/AI/Interfaces/C/Interface.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -19,15 +19,19 @@
 #define _INTERFACE_H
 
 #include &quot;ExternalAI/Interface/SSAILibrary.h&quot;
+#include &quot;ExternalAI/Interface/SSkirmishAISpecifier.h&quot;
 //#include &quot;ExternalAI/Interface/SGAILibrary.h&quot;
 
 #include &lt;map&gt;
+#include &lt;set&gt;
 #include &lt;vector&gt;
 #include &lt;string&gt;
 
 enum LevelOfSupport;
 class SharedLib;
 struct SStaticGlobalData;
+//struct SSkirmishAISpecifier;
+//struct SSkirmishAISpecifier_Comparator;
 
 class CInterface {
 public:
@@ -54,8 +58,10 @@
 //	int UnloadAllGroupAILibraries();
 
 private:
+	static SSkirmishAISpecifier ExtractSpecifier(
+		const std::map&lt;std::string, std::string&gt;&amp; infoMap);
 	// these functions actually load and unload the libraries
-	SharedLib* Load(const SSAISpecifier* const sAISpecifier, SSAILibrary* ai);
+	SharedLib* Load(const SSkirmishAISpecifier&amp; aiKeyHash, SSAILibrary* ai);
 	SharedLib* LoadSkirmishAILib(const std::string&amp; libFilePath,
 			SSAILibrary* ai);
 
@@ -65,7 +71,7 @@
 	static void reportInterfaceFunctionError(const std::string&amp; libFileName,
 			const std::string&amp; functionName);
 	static void reportError(const std::string&amp; msg);
-	std::string FindLibFile(const SSAISpecifier&amp; sAISpecifier);
+	std::string FindLibFile(const SSkirmishAISpecifier&amp; sAISpecifier);
 //	std::string FindLibFile(const SGAISpecifier&amp; gAISpecifier);
 	/**
 	 * Searches for a file in all data-dirs.
@@ -121,12 +127,16 @@
 	//std::string groupAIsLibDir;
 //	std::vector&lt;InfoItem&gt; myInfo;
 
-	std::vector&lt;SSAISpecifier&gt; mySkirmishAISpecifiers;
-	typedef std::map&lt;SSAISpecifier, std::map&lt;std::string, std::string&gt;,SSAISpecifier_Comparator&gt; T_skirmishAIInfos;
+//	std::vector&lt;SSAISpecifier&gt; mySkirmishAISpecifiers;
+//	typedef std::map&lt;SSAISpecifier, std::map&lt;std::string, std::string&gt;,SSAISpecifier_Comparator&gt; T_skirmishAIInfos;
+//	typedef std::map&lt;SSAISpecifier, SSAILibrary*, SSAISpecifier_Comparator&gt; T_skirmishAIs;
+//	typedef std::map&lt;SSAISpecifier, SharedLib*, SSAISpecifier_Comparator&gt; T_skirmishAILibs;
+	std::set&lt;SSkirmishAISpecifier, SSkirmishAISpecifier_Comparator&gt; mySkirmishAISpecifiers;
+	typedef std::map&lt;const SSkirmishAISpecifier, std::map&lt;std::string, std::string&gt;, SSkirmishAISpecifier_Comparator&gt; T_skirmishAIInfos;
+	typedef std::map&lt;const SSkirmishAISpecifier, SSAILibrary*, SSkirmishAISpecifier_Comparator&gt; T_skirmishAIs;
+	typedef std::map&lt;const SSkirmishAISpecifier, SharedLib*, SSkirmishAISpecifier_Comparator&gt; T_skirmishAILibs;
 	T_skirmishAIInfos mySkirmishAIInfos;
-	typedef std::map&lt;SSAISpecifier, SSAILibrary*, SSAISpecifier_Comparator&gt; T_skirmishAIs;
 	T_skirmishAIs myLoadedSkirmishAIs;
-	typedef std::map&lt;SSAISpecifier, SharedLib*, SSAISpecifier_Comparator&gt; T_skirmishAILibs;
 	T_skirmishAILibs myLoadedSkirmishAILibs;
 
 //	std::vector&lt;SGAISpecifier&gt; myGroupAISpecifiers;
@@ -138,4 +148,4 @@
 //	T_groupAILibs myLoadedGroupAILibs;
 };
 
-#endif	// _INTERFACE_H
+#endif // _INTERFACE_H

Modified: branches/caiinterface/AI/Interfaces/C/InterfaceExport.h
===================================================================
--- branches/caiinterface/AI/Interfaces/C/InterfaceExport.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/AI/Interfaces/C/InterfaceExport.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -36,7 +36,7 @@
 
 #include &quot;ExternalAI/Interface/ELevelOfSupport.h&quot;
 //struct InfoItem;
-struct SSAISpecifier;
+//struct SSAISpecifier;
 struct SSAILibrary;
 //struct SGAISpecifier;
 //struct SGAILibrary;

Modified: branches/caiinterface/AI/Interfaces/CMakeLists.txt
===================================================================
--- branches/caiinterface/AI/Interfaces/CMakeLists.txt	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/AI/Interfaces/CMakeLists.txt	2008-12-04 11:02:27 UTC (rev 7115)
@@ -36,12 +36,14 @@
 
 
 # Java AI Interface
-FIND_PACKAGE(JAVA) # Note: this is not the CMake builtin FindJava
-message(STATUS &quot;Interface JAVA_FOUND: ${JAVA_FOUND}&quot;)
-message(STATUS &quot;Interface JAVA_NOT_FOUND: ${JAVA_NOT_FOUND}&quot;)
-message(STATUS &quot;JAVA_RUNTIME ${JAVA_RUNTIME}&quot;)
-message(STATUS &quot;JAVA_COMPILE ${JAVA_COMPILE}&quot;)
-message(STATUS &quot;JAVA_ARCHIVE ${JAVA_ARCHIVE}&quot;)
+if (NOT JAVA_FOUND)
+	FIND_PACKAGE(JAVA) # Note: this is not the CMake builtin FindJava
+endif (NOT JAVA_FOUND)
+#message(STATUS &quot;Interface JAVA_FOUND: ${JAVA_FOUND}&quot;)
+#message(STATUS &quot;Interface JAVA_NOT_FOUND: ${JAVA_NOT_FOUND}&quot;)
+#message(STATUS &quot;JAVA_RUNTIME ${JAVA_RUNTIME}&quot;)
+#message(STATUS &quot;JAVA_COMPILE ${JAVA_COMPILE}&quot;)
+#message(STATUS &quot;JAVA_ARCHIVE ${JAVA_ARCHIVE}&quot;)
 IF (MINGW)
 	set (JAVA_JVM_LIBRARY jvm)
 	set (JNI_FOUND TRUE)

Modified: branches/caiinterface/AI/Skirmish/CMakeLists.txt
===================================================================
--- branches/caiinterface/AI/Skirmish/CMakeLists.txt	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/AI/Skirmish/CMakeLists.txt	2008-12-04 11:02:27 UTC (rev 7115)
@@ -166,7 +166,9 @@
 
 
 ## Null Java AI
-FIND_PACKAGE(JAVA) # Note: this is not the CMake builtin FindJava
+if (NOT JAVA_FOUND)
+	FIND_PACKAGE(JAVA) # Note: this is not the CMake builtin FindJava
+endif (NOT JAVA_FOUND)
 set(NullJavaAI_SRC &quot;${SKIRMISH_SRC}/NullJavaAI&quot;)
 if (JAVA_FOUND AND EXISTS ${NullJavaAI_SRC})
 	set(NullJavaAI_VERS &quot;UNKNOWN_VERSION&quot;)
@@ -184,10 +186,16 @@
 	file(REMOVE_RECURSE &quot;${NullJavaAI_SRC}/build&quot;)
 	file(MAKE_DIRECTORY &quot;${NullJavaAI_SRC}/build&quot;)
 	file(GLOB_RECURSE NullJavaAI_JAVA_SOURCES RELATIVE &quot;${NullJavaAI_SRC}&quot; FOLLOW_SYMLINKS &quot;${NullJavaAI_SRC}*.java&quot;)
+	#string(REPLACE &quot;;&quot; &quot; &quot; tmpVar &quot;${NullJavaAI_JAVA_SOURCES}&quot;)
+	set(srcListFile &quot;${NullJavaAI_SRC}/build/srcList.txt&quot;)
+	foreach(srcFile ${NullJavaAI_JAVA_SOURCES})
+		file(APPEND ${srcListFile} &quot;${srcFile}\n&quot;)
+	endforeach(srcFile)
+	#set(NullJavaAI_JAVA_SOURCES &quot;${tmpVar}&quot;)
 	#add_custom_command(OUTPUT &quot;${NullJavaAI_DATA_DIR}/ai.jar&quot;
 	#add_custom_command(TARGET ${NullJavaAI_TARGET}
 	add_custom_target(${NullJavaAI_TARGET} ALL
-		COMMAND &quot;${JAVA_COMPILE}&quot; &quot;-cp&quot; &quot;\&quot;${NullJavaAI_CLASSPATH}\&quot;&quot; &quot;-d&quot; &quot;${NullJavaAI_SRC}/build&quot; &quot;${NullJavaAI_JAVA_SOURCES}&quot;
+		COMMAND &quot;${JAVA_COMPILE}&quot; &quot;-cp&quot; &quot;\&quot;${NullJavaAI_CLASSPATH}\&quot;&quot; &quot;-d&quot; &quot;${NullJavaAI_SRC}/build&quot; &quot;@${srcListFile}&quot;
 		COMMAND &quot;${JAVA_ARCHIVE}&quot; &quot;cmf&quot; &quot;${NullJavaAI_SRC}/manifest.mf&quot; &quot;${NullJavaAI_SRC}/ai.jar&quot; &quot;-C&quot; &quot;${NullJavaAI_SRC}/build&quot; &quot;${NullJavaAI_PKG_FIRST_PART}&quot;
 		WORKING_DIRECTORY &quot;${NullJavaAI_SRC}&quot;
 		COMMENT &quot;  Creating Java AI library ai.jar&quot; VERBATIM)
@@ -200,6 +208,49 @@
 endif (JAVA_FOUND AND EXISTS ${NullJavaAI_SRC})
 
 
+## Null Object Oriented Java AI
+if (NOT JAVA_FOUND)
+	FIND_PACKAGE(JAVA) # Note: this is not the CMake builtin FindJava
+endif (NOT JAVA_FOUND)
+set(NullOOJavaAI_SRC &quot;${SKIRMISH_SRC}/NullOOJavaAI&quot;)
+if (JAVA_FOUND AND EXISTS ${NullOOJavaAI_SRC})
+	set(NullOOJavaAI_VERS &quot;UNKNOWN_VERSION&quot;)
+	if (EXISTS ${NullOOJavaAI_SRC}/VERSION)
+		file(STRINGS &quot;${NullOOJavaAI_SRC}/VERSION&quot; NullOOJavaAI_VERS LIMIT_COUNT 1)
+	endif (EXISTS ${NullOOJavaAI_SRC}/VERSION)
+	set(NullOOJavaAI_TARGET &quot;NullOOJavaAI-${NullOOJavaAI_VERS}&quot;)
+	set(NullOOJavaAI_DATA_DIR ${SKIRMISH_DATA}/NullOOJavaAI/${NullOOJavaAI_VERS})
+	set(NullOOJavaAI_PKG &quot;nulloojavaai&quot;)
+	set(NullOOJavaAI_PKG_FIRST_PART &quot;nulloojavaai&quot;)
+	set(Java_AIINTERFACE_SRC &quot;../../Interfaces/Java&quot;)
+	set(NullOOJavaAI_CLASSPATH &quot;.${PATH_DELIM}${Java_AIINTERFACE_SRC}/interface.jar${PATH_DELIM}${Java_AIINTERFACE_SRC}/jlib/jna.jar${PATH_DELIM}${Java_AIINTERFACE_SRC}/jlib/vecmath.jar&quot;)
+	message(STATUS &quot;${NullOOJavaAI_VERS}\t(NullOOJavaAI Version)&quot;)
+
+	file(REMOVE_RECURSE &quot;${NullOOJavaAI_SRC}/build&quot;)
+	file(MAKE_DIRECTORY &quot;${NullOOJavaAI_SRC}/build&quot;)
+	file(GLOB_RECURSE NullOOJavaAI_JAVA_SOURCES RELATIVE &quot;${NullOOJavaAI_SRC}&quot; FOLLOW_SYMLINKS &quot;${NullOOJavaAI_SRC}*.java&quot;)
+	#string(REPLACE &quot;;&quot; &quot; &quot; tmpVar &quot;${NullOOJavaAI_JAVA_SOURCES}&quot;)
+	set(srcListFile &quot;${NullOOJavaAI_SRC}/build/srcList.txt&quot;)
+	foreach(srcFile ${NullOOJavaAI_JAVA_SOURCES})
+		file(APPEND ${srcListFile} &quot;${srcFile}\n&quot;)
+	endforeach(srcFile)
+	#set(NullOOJavaAI_JAVA_SOURCES &quot;${tmpVar}&quot;)
+	#add_custom_command(OUTPUT &quot;${NullOOJavaAI_DATA_DIR}/ai.jar&quot;
+	#add_custom_command(TARGET ${NullOOJavaAI_TARGET}
+	add_custom_target(${NullOOJavaAI_TARGET} ALL
+		COMMAND &quot;${JAVA_COMPILE}&quot; &quot;-cp&quot; &quot;\&quot;${NullOOJavaAI_CLASSPATH}\&quot;&quot; &quot;-d&quot; &quot;${NullOOJavaAI_SRC}/build&quot; &quot;@${srcListFile}&quot;
+		COMMAND &quot;${JAVA_ARCHIVE}&quot; &quot;cmf&quot; &quot;${NullOOJavaAI_SRC}/manifest.mf&quot; &quot;${NullOOJavaAI_SRC}/ai.jar&quot; &quot;-C&quot; &quot;${NullOOJavaAI_SRC}/build&quot; &quot;${NullOOJavaAI_PKG_FIRST_PART}&quot;
+		WORKING_DIRECTORY &quot;${NullOOJavaAI_SRC}&quot;
+		COMMENT &quot;  Creating Java OO AI library ai.jar&quot; VERBATIM)
+
+	install (FILES ${NullOOJavaAI_SRC}/AIInfo.lua DESTINATION ${NullOOJavaAI_DATA_DIR})
+	if (EXISTS ${NullOOJavaAI_SRC}/AIOptions.lua)
+		install (FILES ${NullOOJavaAI_SRC}/AIOptions.lua DESTINATION ${NullOOJavaAI_DATA_DIR})
+	endif (EXISTS ${NullOOJavaAI_SRC}/AIOptions.lua)
+	install (FILES ${NullOOJavaAI_SRC}/ai.jar DESTINATION ${NullOOJavaAI_DATA_DIR})
+endif (JAVA_FOUND AND EXISTS ${NullOOJavaAI_SRC})
+
+
 ## JCAI
 # does currently not build in win32
 if (UNIX)

Modified: branches/caiinterface/AI/Wrappers/LegacyCpp/AIAICallback.cpp
===================================================================
--- branches/caiinterface/AI/Wrappers/LegacyCpp/AIAICallback.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/AI/Wrappers/LegacyCpp/AIAICallback.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -54,7 +54,7 @@
 
 static int resIndMetal = -1;
 static int resIndEnergy = -1;
-static inline int getResourceIndex_Metal(SAICallback* sAICallback, int teamId) {
+static inline int getResourceId_Metal(SAICallback* sAICallback, int teamId) {
 
 	if (resIndMetal == -1) {
 		resIndMetal = sAICallback-&gt;Clb_0MULTI1FETCH3ResourceByName0Resource(teamId, &quot;Metal&quot;);
@@ -62,7 +62,7 @@
 
 	return resIndMetal;
 }
-static inline int getResourceIndex_Energy(SAICallback* sAICallback, int teamId) {
+static inline int getResourceId_Energy(SAICallback* sAICallback, int teamId) {
 
 	if (resIndEnergy == -1) {
 		resIndEnergy = sAICallback-&gt;Clb_0MULTI1FETCH3ResourceByName0Resource(teamId, &quot;Energy&quot;);
@@ -803,13 +803,13 @@
 
 bool CAIAICallback::GetUnitResourceInfo(int unitId, UnitResourceInfo* resourceInfo) {
 
-	static int m = getResourceIndex_Metal(sAICallback, teamId);
-	static int e = getResourceIndex_Energy(sAICallback, teamId);
-	resourceInfo-&gt;energyMake = sAICallback-&gt;Clb_Unit_0REF1Resource2resourceIndex0getResourceMake(teamId, unitId, e);
+	static int m = getResourceId_Metal(sAICallback, teamId);
+	static int e = getResourceId_Energy(sAICallback, teamId);
+	resourceInfo-&gt;energyMake = sAICallback-&gt;Clb_Unit_0REF1Resource2resourceId0getResourceMake(teamId, unitId, e);
 	if (resourceInfo-&gt;energyMake &lt; 0) { return false; }
-	resourceInfo-&gt;energyUse = sAICallback-&gt;Clb_Unit_0REF1Resource2resourceIndex0getResourceUse(teamId, unitId, e);
-	resourceInfo-&gt;metalMake = sAICallback-&gt;Clb_Unit_0REF1Resource2resourceIndex0getResourceMake(teamId, unitId, m);
-	resourceInfo-&gt;metalUse = sAICallback-&gt;Clb_Unit_0REF1Resource2resourceIndex0getResourceUse(teamId, unitId, m);
+	resourceInfo-&gt;energyUse = sAICallback-&gt;Clb_Unit_0REF1Resource2resourceId0getResourceUse(teamId, unitId, e);
+	resourceInfo-&gt;metalMake = sAICallback-&gt;Clb_Unit_0REF1Resource2resourceId0getResourceMake(teamId, unitId, m);
+	resourceInfo-&gt;metalUse = sAICallback-&gt;Clb_Unit_0REF1Resource2resourceId0getResourceUse(teamId, unitId, m);
 	return true;
 }
 
@@ -821,8 +821,8 @@
 
 const UnitDef* CAIAICallback::GetUnitDefById(int unitDefId) {
 	//logT(&quot;entering: GetUnitDefById sAICallback&quot;);
-	static int m = getResourceIndex_Metal(sAICallback, teamId);
-	static int e = getResourceIndex_Energy(sAICallback, teamId);
+	static int m = getResourceId_Metal(sAICallback, teamId);
+	static int e = getResourceId_Energy(sAICallback, teamId);
 
 	if (unitDefId &lt; 0) {
 		return NULL;
@@ -842,20 +842,20 @@
 unitDef-&gt;cobID = sAICallback-&gt;Clb_UnitDef_getCobId(teamId, unitDefId);
 unitDef-&gt;techLevel = sAICallback-&gt;Clb_UnitDef_getTechLevel(teamId, unitDefId);
 unitDef-&gt;gaia = sAICallback-&gt;Clb_UnitDef_getGaia(teamId, unitDefId);
-unitDef-&gt;metalUpkeep = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getUpkeep(teamId, unitDefId, m);
-unitDef-&gt;energyUpkeep = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getUpkeep(teamId, unitDefId, e);
-unitDef-&gt;metalMake = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getResourceMake(teamId, unitDefId, m);
-unitDef-&gt;makesMetal = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getMakesResource(teamId, unitDefId, m);
-unitDef-&gt;energyMake = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getResourceMake(teamId, unitDefId, e);
-unitDef-&gt;metalCost = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getCost(teamId, unitDefId, m);
-unitDef-&gt;energyCost = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getCost(teamId, unitDefId, e);
+unitDef-&gt;metalUpkeep = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getUpkeep(teamId, unitDefId, m);
+unitDef-&gt;energyUpkeep = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getUpkeep(teamId, unitDefId, e);
+unitDef-&gt;metalMake = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getResourceMake(teamId, unitDefId, m);
+unitDef-&gt;makesMetal = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getMakesResource(teamId, unitDefId, m);
+unitDef-&gt;energyMake = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getResourceMake(teamId, unitDefId, e);
+unitDef-&gt;metalCost = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getCost(teamId, unitDefId, m);
+unitDef-&gt;energyCost = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getCost(teamId, unitDefId, e);
 unitDef-&gt;buildTime = sAICallback-&gt;Clb_UnitDef_getBuildTime(teamId, unitDefId);
-unitDef-&gt;extractsMetal = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getExtractsResource(teamId, unitDefId, m);
-unitDef-&gt;extractRange = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getResourceExtractorRange(teamId, unitDefId, m);
-unitDef-&gt;windGenerator = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getWindResourceGenerator(teamId, unitDefId, e);
-unitDef-&gt;tidalGenerator = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getTidalResourceGenerator(teamId, unitDefId, e);
-unitDef-&gt;metalStorage = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getStorage(teamId, unitDefId, m);
-unitDef-&gt;energyStorage = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getStorage(teamId, unitDefId, e);
+unitDef-&gt;extractsMetal = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getExtractsResource(teamId, unitDefId, m);
+unitDef-&gt;extractRange = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getResourceExtractorRange(teamId, unitDefId, m);
+unitDef-&gt;windGenerator = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getWindResourceGenerator(teamId, unitDefId, e);
+unitDef-&gt;tidalGenerator = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getTidalResourceGenerator(teamId, unitDefId, e);
+unitDef-&gt;metalStorage = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getStorage(teamId, unitDefId, m);
+unitDef-&gt;energyStorage = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getStorage(teamId, unitDefId, e);
 unitDef-&gt;autoHeal = sAICallback-&gt;Clb_UnitDef_getAutoHeal(teamId, unitDefId);
 unitDef-&gt;idleAutoHeal = sAICallback-&gt;Clb_UnitDef_getIdleAutoHeal(teamId, unitDefId);
 unitDef-&gt;idleTime = sAICallback-&gt;Clb_UnitDef_getIdleTime(teamId, unitDefId);
@@ -1021,7 +1021,7 @@
 unitDef-&gt;flareSalvoSize = sAICallback-&gt;Clb_UnitDef_getFlareSalvoSize(teamId, unitDefId);
 unitDef-&gt;flareSalvoDelay = sAICallback-&gt;Clb_UnitDef_getFlareSalvoDelay(teamId, unitDefId);
 unitDef-&gt;smoothAnim = sAICallback-&gt;Clb_UnitDef_isSmoothAnim(teamId, unitDefId);
-unitDef-&gt;isMetalMaker = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0isResourceMaker(teamId, unitDefId, m);
+unitDef-&gt;isMetalMaker = sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0isResourceMaker(teamId, unitDefId, m);
 unitDef-&gt;canLoopbackAttack = sAICallback-&gt;Clb_UnitDef_isCanLoopbackAttack(teamId, unitDefId);
 unitDef-&gt;levelGround = sAICallback-&gt;Clb_UnitDef_isLevelGround(teamId, unitDefId);
 unitDef-&gt;useBuildingGroundDecal = sAICallback-&gt;Clb_UnitDef_isUseBuildingGroundDecal(teamId, unitDefId);
@@ -1211,12 +1211,12 @@
 const unsigned char* CAIAICallback::GetMetalMap() {
 
 	static unsigned char* metalMap = NULL;
-	static int m = getResourceIndex_Metal(sAICallback, teamId);
+	static int m = getResourceId_Metal(sAICallback, teamId);
 
 	if (metalMap == NULL) {
-		int size = sAICallback-&gt;Clb_Map_0ARRAY1SIZE0REF1Resource2resourceIndex0getResourceMap(teamId, m);
+		int size = sAICallback-&gt;Clb_Map_0ARRAY1SIZE0REF1Resource2resourceId0getResourceMap(teamId, m);
 		metalMap = new unsigned char[size]; // NOTE: memory leack, but will be used till end of the game anyway
-		sAICallback-&gt;Clb_Map_0ARRAY1VALS0REF1Resource2resourceIndex0getResourceMap(teamId, m, metalMap, size);
+		sAICallback-&gt;Clb_Map_0ARRAY1VALS0REF1Resource2resourceId0getResourceMap(teamId, m, metalMap, size);
 	}
 
 	return metalMap;
@@ -1235,13 +1235,13 @@
 }
 
 float CAIAICallback::GetMaxMetal() {
-	static int m = getResourceIndex_Metal(sAICallback, teamId);
-	return sAICallback-&gt;Clb_Map_0REF1Resource2resourceIndex0getMaxResource(teamId, m);
+	static int m = getResourceId_Metal(sAICallback, teamId);
+	return sAICallback-&gt;Clb_Map_0REF1Resource2resourceId0getMaxResource(teamId, m);
 }
 
 float CAIAICallback::GetExtractorRadius() {
-	static int m = getResourceIndex_Metal(sAICallback, teamId);
-	return sAICallback-&gt;Clb_Map_0REF1Resource2resourceIndex0getExtractorRadius(teamId, m);
+	static int m = getResourceId_Metal(sAICallback, teamId);
+	return sAICallback-&gt;Clb_Map_0REF1Resource2resourceId0getExtractorRadius(teamId, m);
 }
 
 float CAIAICallback::GetMinWind() {
@@ -1412,43 +1412,43 @@
 }
 
 float CAIAICallback::GetMetal() {
-	int m = getResourceIndex_Metal(sAICallback, teamId);
-	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getCurrent(teamId, m);
+	int m = getResourceId_Metal(sAICallback, teamId);
+	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getCurrent(teamId, m);
 }
 
 float CAIAICallback::GetMetalIncome() {
-	int m = getResourceIndex_Metal(sAICallback, teamId);
-	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getIncome(teamId, m);
+	int m = getResourceId_Metal(sAICallback, teamId);
+	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getIncome(teamId, m);
 }
 
 float CAIAICallback::GetMetalUsage() {
-	int m = getResourceIndex_Metal(sAICallback, teamId);
-	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getUsage(teamId, m);
+	int m = getResourceId_Metal(sAICallback, teamId);
+	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getUsage(teamId, m);
 }
 
 float CAIAICallback::GetMetalStorage() {
-	int m = getResourceIndex_Metal(sAICallback, teamId);
-	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getStorage(teamId, m);
+	int m = getResourceId_Metal(sAICallback, teamId);
+	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getStorage(teamId, m);
 }
 
 float CAIAICallback::GetEnergy() {
-	int e = getResourceIndex_Energy(sAICallback, teamId);
-	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getCurrent(teamId, e);
+	int e = getResourceId_Energy(sAICallback, teamId);
+	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getCurrent(teamId, e);
 }
 
 float CAIAICallback::GetEnergyIncome() {
-	int e = getResourceIndex_Energy(sAICallback, teamId);
-	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getIncome(teamId, e);
+	int e = getResourceId_Energy(sAICallback, teamId);
+	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getIncome(teamId, e);
 }
 
 float CAIAICallback::GetEnergyUsage() {
-	int e = getResourceIndex_Energy(sAICallback, teamId);
-	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getUsage(teamId, e);
+	int e = getResourceId_Energy(sAICallback, teamId);
+	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getUsage(teamId, e);
 }
 
 float CAIAICallback::GetEnergyStorage() {
-	int e = getResourceIndex_Energy(sAICallback, teamId);
-	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getStorage(teamId, e);
+	int e = getResourceId_Energy(sAICallback, teamId);
+	return sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getStorage(teamId, e);
 }
 
 int CAIAICallback::GetFeatures(int* featureIds, int featureIds_max) {
@@ -1466,8 +1466,8 @@
 
 const FeatureDef* CAIAICallback::GetFeatureDefById(int featureDefId) {
 
-	static int m = getResourceIndex_Metal(sAICallback, teamId);
-	static int e = getResourceIndex_Energy(sAICallback, teamId);
+	static int m = getResourceId_Metal(sAICallback, teamId);
+	static int e = getResourceId_Energy(sAICallback, teamId);
 
 	if (featureDefId &lt; 0) {
 		return NULL;
@@ -1482,8 +1482,8 @@
 featureDef-&gt;description = sAICallback-&gt;Clb_FeatureDef_getDescription(teamId, featureDefId);
 featureDef-&gt;filename = sAICallback-&gt;Clb_FeatureDef_getFileName(teamId, featureDefId);
 featureDef-&gt;id = sAICallback-&gt;Clb_FeatureDef_getId(teamId, featureDefId);
-featureDef-&gt;metal = sAICallback-&gt;Clb_FeatureDef_0REF1Resource2resourceIndex0getContainedResource(teamId, featureDefId, m);
-featureDef-&gt;energy = sAICallback-&gt;Clb_FeatureDef_0REF1Resource2resourceIndex0getContainedResource(teamId, featureDefId, e);
+featureDef-&gt;metal = sAICallback-&gt;Clb_FeatureDef_0REF1Resource2resourceId0getContainedResource(teamId, featureDefId, m);
+featureDef-&gt;energy = sAICallback-&gt;Clb_FeatureDef_0REF1Resource2resourceId0getContainedResource(teamId, featureDefId, e);
 featureDef-&gt;maxHealth = sAICallback-&gt;Clb_FeatureDef_getMaxHealth(teamId, featureDefId);
 featureDef-&gt;reclaimTime = sAICallback-&gt;Clb_FeatureDef_getReclaimTime(teamId, featureDefId);
 featureDef-&gt;mass = sAICallback-&gt;Clb_FeatureDef_getMass(teamId, featureDefId);
@@ -1570,8 +1570,8 @@
 
 const WeaponDef* CAIAICallback::GetWeaponDefById(int weaponDefId) {
 
-	static int m = getResourceIndex_Metal(sAICallback, teamId);
-	static int e = getResourceIndex_Energy(sAICallback, teamId);
+	static int m = getResourceId_Metal(sAICallback, teamId);
+	static int e = getResourceId_Energy(sAICallback, teamId);
 
 //	logT(&quot;entering: GetWeaponDefById sAICallback&quot;);
 	if (weaponDefId &lt; 0) {
@@ -1650,8 +1650,8 @@
 weaponDef-&gt;restTime = sAICallback-&gt;Clb_WeaponDef_getRestTime(teamId, weaponDefId);
 weaponDef-&gt;uptime = sAICallback-&gt;Clb_WeaponDef_getUpTime(teamId, weaponDefId);
 weaponDef-&gt;flighttime = sAICallback-&gt;Clb_WeaponDef_getFlightTime(teamId, weaponDefId);
-weaponDef-&gt;metalcost = sAICallback-&gt;Clb_WeaponDef_0REF1Resource2resourceIndex0getCost(teamId, weaponDefId, m);
-weaponDef-&gt;energycost = sAICallback-&gt;Clb_WeaponDef_0REF1Resource2resourceIndex0getCost(teamId, weaponDefId, e);
+weaponDef-&gt;metalcost = sAICallback-&gt;Clb_WeaponDef_0REF1Resource2resourceId0getCost(teamId, weaponDefId, m);
+weaponDef-&gt;energycost = sAICallback-&gt;Clb_WeaponDef_0REF1Resource2resourceId0getCost(teamId, weaponDefId, e);
 weaponDef-&gt;supplycost = sAICallback-&gt;Clb_WeaponDef_getSupplyCost(teamId, weaponDefId);
 weaponDef-&gt;projectilespershot = sAICallback-&gt;Clb_WeaponDef_getProjectilesPerShot(teamId, weaponDefId);
 weaponDef-&gt;id = sAICallback-&gt;Clb_WeaponDef_getId(teamId, weaponDefId);
@@ -1705,13 +1705,13 @@
 weaponDef-&gt;visibleShield = sAICallback-&gt;Clb_WeaponDef_isVisibleShield(teamId, weaponDefId);
 weaponDef-&gt;visibleShieldRepulse = sAICallback-&gt;Clb_WeaponDef_isVisibleShieldRepulse(teamId, weaponDefId);
 weaponDef-&gt;visibleShieldHitFrames = sAICallback-&gt;Clb_WeaponDef_getVisibleShieldHitFrames(teamId, weaponDefId);
-weaponDef-&gt;shieldEnergyUse = sAICallback-&gt;Clb_WeaponDef_Shield_0REF1Resource2resourceIndex0getResourceUse(teamId, weaponDefId, e);
+weaponDef-&gt;shieldEnergyUse = sAICallback-&gt;Clb_WeaponDef_Shield_0REF1Resource2resourceId0getResourceUse(teamId, weaponDefId, e);
 weaponDef-&gt;shieldRadius = sAICallback-&gt;Clb_WeaponDef_Shield_getRadius(teamId, weaponDefId);
 weaponDef-&gt;shieldForce = sAICallback-&gt;Clb_WeaponDef_Shield_getForce(teamId, weaponDefId);
 weaponDef-&gt;shieldMaxSpeed = sAICallback-&gt;Clb_WeaponDef_Shield_getMaxSpeed(teamId, weaponDefId);
 weaponDef-&gt;shieldPower = sAICallback-&gt;Clb_WeaponDef_Shield_getPower(teamId, weaponDefId);
 weaponDef-&gt;shieldPowerRegen = sAICallback-&gt;Clb_WeaponDef_Shield_getPowerRegen(teamId, weaponDefId);
-weaponDef-&gt;shieldPowerRegenEnergy = sAICallback-&gt;Clb_WeaponDef_Shield_0REF1Resource2resourceIndex0getPowerRegenResource(teamId, weaponDefId, e);
+weaponDef-&gt;shieldPowerRegenEnergy = sAICallback-&gt;Clb_WeaponDef_Shield_0REF1Resource2resourceId0getPowerRegenResource(teamId, weaponDefId, e);
 weaponDef-&gt;shieldStartingPower = sAICallback-&gt;Clb_WeaponDef_Shield_getStartingPower(teamId, weaponDefId);
 weaponDef-&gt;shieldRechargeDelay = sAICallback-&gt;Clb_WeaponDef_Shield_getRechargeDelay(teamId, weaponDefId);
 weaponDef-&gt;shieldGoodColor = float3(sAICallback-&gt;Clb_WeaponDef_Shield_getGoodColor(teamId, weaponDefId));
@@ -2241,38 +2241,38 @@
 
 int CAIAICallback::HandleCommand(int commandId, void* data) {
 
-	int cmdTopicIndex = commandId;
+	int cmdTopicId = commandId;
 	int ret = -99;
 
 	switch (commandId) {
 		case AIHCQuerySubVersionId: {
 //			SQuerySubVersionCommand cmd;
-//			ret = sAICallback-&gt;Clb_handleCommand(teamId, COMMAND_TO_ID_ENGINE, -1, cmdTopicIndex, &amp;cmd);
+//			ret = sAICallback-&gt;Clb_handleCommand(teamId, COMMAND_TO_ID_ENGINE, -1, cmdTopicId, &amp;cmd);
 			ret = sAICallback-&gt;Clb_Game_getAiInterfaceVersion(teamId);
 			break;
 		}
 		case AIHCAddMapPointId: {
 			AIHCAddMapPoint* myData = (AIHCAddMapPoint*) data;
 			SAddPointDrawCommand cmd = {myData-&gt;pos.toSAIFloat3(), myData-&gt;label};
-			ret = sAICallback-&gt;Clb_handleCommand(teamId, COMMAND_TO_ID_ENGINE, -1, cmdTopicIndex, &amp;cmd);
+			ret = sAICallback-&gt;Clb_handleCommand(teamId, COMMAND_TO_ID_ENGINE, -1, cmdTopicId, &amp;cmd);
 			break;
 		}
 		case AIHCAddMapLineId: {
 			AIHCAddMapLine* myData = (AIHCAddMapLine*) data;
 			SAddLineDrawCommand cmd = {myData-&gt;posfrom.toSAIFloat3(), myData-&gt;posto.toSAIFloat3()};
-			ret = sAICallback-&gt;Clb_handleCommand(teamId, COMMAND_TO_ID_ENGINE, -1, cmdTopicIndex, &amp;cmd);
+			ret = sAICallback-&gt;Clb_handleCommand(teamId, COMMAND_TO_ID_ENGINE, -1, cmdTopicId, &amp;cmd);
 			break;
 		}
 		case AIHCRemoveMapPointId: {
 			AIHCRemoveMapPoint* myData = (AIHCRemoveMapPoint*) data;
 			SRemovePointDrawCommand cmd = {myData-&gt;pos.toSAIFloat3()};
-			ret = sAICallback-&gt;Clb_handleCommand(teamId, COMMAND_TO_ID_ENGINE, -1, cmdTopicIndex, &amp;cmd);
+			ret = sAICallback-&gt;Clb_handleCommand(teamId, COMMAND_TO_ID_ENGINE, -1, cmdTopicId, &amp;cmd);
 			break;
 		}
 		case AIHCSendStartPosId: {
 			AIHCSendStartPos* myData = (AIHCSendStartPos*) data;
 			SSendStartPosCommand cmd = {myData-&gt;ready, myData-&gt;pos.toSAIFloat3()};
-			ret = sAICallback-&gt;Clb_handleCommand(teamId, COMMAND_TO_ID_ENGINE, -1, cmdTopicIndex, &amp;cmd);
+			ret = sAICallback-&gt;Clb_handleCommand(teamId, COMMAND_TO_ID_ENGINE, -1, cmdTopicId, &amp;cmd);
 			break;
 		}
 	}

Added: branches/caiinterface/rts/ExternalAI/AIInterfaceKey.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/AIInterfaceKey.cpp	                        (rev 0)
+++ branches/caiinterface/rts/ExternalAI/AIInterfaceKey.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -0,0 +1,85 @@
+/*
+	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
+
+	This program is free software; you can redistribute it and/or modify
+	it under the terms of the GNU General Public License as published by
+	the Free Software Foundation; either version 2 of the License, or
+	(at your option) any later version.
+
+	This program is distributed in the hope that it will be useful,
+	but WITHOUT ANY WARRANTY; without even the implied warranty of
+	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+	GNU General Public License for more details.
+
+	You should have received a copy of the GNU General Public License
+	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#include &quot;AIInterfaceKey.h&quot;
+
+CR_BIND(AIInterfaceKey,)
+
+CR_REG_METADATA(AIInterfaceKey, (
+		CR_MEMBER(shortName),
+		CR_MEMBER(version)
+		));
+
+AIInterfaceKey::AIInterfaceKey(
+		const std::string&amp; shortName,
+		const std::string&amp; version)
+		: shortName(shortName),
+		version(version) {}
+
+
+AIInterfaceKey::AIInterfaceKey(const AIInterfaceKey&amp; toCopy)
+		: shortName(toCopy.shortName),
+		version(toCopy.version) {}
+
+AIInterfaceKey::~AIInterfaceKey() {}
+
+bool AIInterfaceKey::isEqual(const AIInterfaceKey&amp; otherKey) const {
+
+	if (shortName == otherKey.shortName) {
+		return version == otherKey.version;
+	} else {
+		return false;
+	}
+}
+bool AIInterfaceKey::isLessThen(const AIInterfaceKey&amp; otherKey) const {
+
+	if (shortName == otherKey.shortName) {
+		return version &lt; otherKey.version;
+	} else {
+		return shortName &lt; otherKey.shortName;
+	}
+}
+
+const std::string&amp; AIInterfaceKey::GetShortName() const {
+	return shortName;
+}
+const std::string&amp; AIInterfaceKey::GetVersion() const {
+	return version;
+}
+
+bool AIInterfaceKey::IsUnspecified() const {
+	return shortName == &quot;&quot;;
+}
+
+bool AIInterfaceKey::operator==(const AIInterfaceKey&amp; otherKey) const {
+	return isEqual(otherKey);
+}
+bool AIInterfaceKey::operator!=(const AIInterfaceKey&amp; otherKey) const {
+	return !isEqual(otherKey);
+}
+bool AIInterfaceKey::operator&lt;(const AIInterfaceKey&amp; otherKey) const {
+	return isLessThen(otherKey);
+}
+bool AIInterfaceKey::operator&gt;(const AIInterfaceKey&amp; otherKey) const {
+	return !isLessThen(otherKey) &amp;&amp; !isEqual(otherKey);
+}
+bool AIInterfaceKey::operator&lt;=(const AIInterfaceKey&amp; otherKey) const {
+	return isLessThen(otherKey) || isEqual(otherKey);
+}
+bool AIInterfaceKey::operator&gt;=(const AIInterfaceKey&amp; otherKey) const {
+	return !isLessThen(otherKey);
+}


Property changes on: branches/caiinterface/rts/ExternalAI/AIInterfaceKey.cpp
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/caiinterface/rts/ExternalAI/AIInterfaceKey.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/AIInterfaceKey.h	                        (rev 0)
+++ branches/caiinterface/rts/ExternalAI/AIInterfaceKey.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -0,0 +1,54 @@
+/*
+	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
+
+	This program is free software; you can redistribute it and/or modify
+	it under the terms of the GNU General Public License as published by
+	the Free Software Foundation; either version 2 of the License, or
+	(at your option) any later version.
+
+	This program is distributed in the hope that it will be useful,
+	but WITHOUT ANY WARRANTY; without even the implied warranty of
+	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+	GNU General Public License for more details.
+
+	You should have received a copy of the GNU General Public License
+	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef _AIINTERFACEKEY_H
+#define _AIINTERFACEKEY_H
+
+#include &lt;string&gt;
+#include &quot;creg/creg.h&quot;
+
+struct AIInterfaceKey {
+	CR_DECLARE_STRUCT(AIInterfaceKey);
+
+private:
+	std::string shortName;
+	std::string version;
+
+	bool isEqual(const AIInterfaceKey&amp; otherKey) const;
+	bool isLessThen(const AIInterfaceKey&amp; otherKey) const;
+
+public:
+	AIInterfaceKey(
+			const std::string&amp; shortName = &quot;&quot;,
+			const std::string&amp; version = &quot;&quot;);
+	AIInterfaceKey(const AIInterfaceKey&amp; toCopy);
+	~AIInterfaceKey();
+
+	const std::string&amp; GetShortName() const;
+	const std::string&amp; GetVersion() const;
+
+	bool IsUnspecified() const;
+
+	bool operator==(const AIInterfaceKey&amp; otherKey) const;
+	bool operator!=(const AIInterfaceKey&amp; otherKey) const;
+	bool operator&lt;(const AIInterfaceKey&amp; otherKey) const;
+	bool operator&gt;(const AIInterfaceKey&amp; otherKey) const;
+	bool operator&lt;=(const AIInterfaceKey&amp; otherKey) const;
+	bool operator&gt;=(const AIInterfaceKey&amp; otherKey) const;
+};
+
+#endif // _AIINTERFACEKEY_H


Property changes on: branches/caiinterface/rts/ExternalAI/AIInterfaceKey.h
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: branches/caiinterface/rts/ExternalAI/AIInterfaceLibrary.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/AIInterfaceLibrary.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/AIInterfaceLibrary.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -37,10 +37,10 @@
 		const std::string&amp; libFileName)
 		: specifier(interfaceSpecifier) {
 */
-CAIInterfaceLibrary::CAIInterfaceLibrary(const CAIInterfaceLibraryInfo* _info)
+CAIInterfaceLibrary::CAIInterfaceLibrary(const CAIInterfaceLibraryInfo&amp; _info)
 		: info(_info) {
 
-	std::string libFileName = info-&gt;GetFileName();
+	std::string libFileName = info.GetFileName();
 	if (libFileName.empty()) {
 		handleerror(NULL, &quot;Error while loading AI Interface Library.&quot;
 				&quot; No file name specified in AIInterface.lua&quot;,
@@ -73,9 +73,9 @@
 
 	if (sAIInterfaceLibrary.initStatic != NULL) {
 		staticGlobalData = createStaticGlobalData();
-		unsigned int infSize = info-&gt;GetInfo().size();
-		const char** infKeys = info-&gt;GetCInfoKeys();
-		const char** infValues = info-&gt;GetCInfoValues();
+		unsigned int infSize = info.GetInfo().size();
+		const char** infKeys = info.GetCInfoKeys();
+		const char** infValues = info.GetCInfoValues();
 		int ret = sAIInterfaceLibrary.initStatic(infSize, infKeys, infValues, staticGlobalData);
 		if (ret != 0) {
 			// initializing the library failed!
@@ -111,8 +111,8 @@
 	}
 }
 
-SAIInterfaceSpecifier CAIInterfaceLibrary::GetSpecifier() const {
-	return info-&gt;GetSpecifier();
+AIInterfaceKey CAIInterfaceLibrary::GetKey() const {
+	return info.GetKey();
 }
 
 LevelOfSupport CAIInterfaceLibrary::GetLevelOfSupportFor(
@@ -146,16 +146,16 @@
 int CAIInterfaceLibrary::GetLoadCount() const {
 
 	int totalSkirmishAILibraryLoadCount = 0;
-	std::map&lt;const SSAISpecifier, int&gt;::const_iterator salc;
+	std::map&lt;const SkirmishAIKey, int&gt;::const_iterator salc;
 	for (salc=skirmishAILoadCount.begin();  salc != skirmishAILoadCount.end(); salc++) {
 		totalSkirmishAILibraryLoadCount += salc-&gt;second;
 	}
 
 	int totalGroupAILibraryLoadCount = 0;
-	std::map&lt;const SGAISpecifier, int&gt;::const_iterator galc;
-	for (galc=groupAILoadCount.begin();  galc != groupAILoadCount.end(); galc++) {
-		totalGroupAILibraryLoadCount += galc-&gt;second;
-	}
+//	std::map&lt;const SGAISpecifier, int&gt;::const_iterator galc;
+//	for (galc=groupAILoadCount.begin();  galc != groupAILoadCount.end(); galc++) {
+//		totalGroupAILibraryLoadCount += galc-&gt;second;
+//	}
 
 	return totalSkirmishAILibraryLoadCount + totalGroupAILibraryLoadCount;
 }
@@ -179,56 +179,54 @@
 */
 //const ISkirmishAILibrary* CAIInterfaceLibrary::FetchSkirmishAILibrary(const SSAISpecifier&amp; sAISpecifier) {
 //const ISkirmishAILibrary* CAIInterfaceLibrary::FetchSkirmishAILibrary(const InfoItem* info, unsigned int numInfo) {
-const ISkirmishAILibrary* CAIInterfaceLibrary::FetchSkirmishAILibrary(const CSkirmishAILibraryInfo* aiInfo) {
+const ISkirmishAILibrary* CAIInterfaceLibrary::FetchSkirmishAILibrary(const CSkirmishAILibraryInfo&amp; aiInfo) {
 
 	ISkirmishAILibrary* ai = NULL;
 
 //	const struct InfoItem* info = aiInfo-&gt;GetInfoCReference();
 //	unsigned int numInfoItems = aiInfo-&gt;GetInfo().size();
-	unsigned int infSize = aiInfo-&gt;GetInfo().size();
-	const char** infKeys = aiInfo-&gt;GetCInfoKeys();
-	const char** infValues = aiInfo-&gt;GetCInfoValues();
+	unsigned int infSize = aiInfo.GetInfo().size();
+	const char** infKeys = aiInfo.GetCInfoKeys();
+	const char** infValues = aiInfo.GetCInfoValues();
 
-	SSAISpecifier sAISpecifier = aiInfo-&gt;GetSpecifier();
-	SSAIKey sAIkey = {info-&gt;GetSpecifier(), sAISpecifier};
-	if (skirmishAILoadCount[sAISpecifier] == 0) {
+	const SkirmishAIKey&amp; skirmishAIKey = aiInfo.GetKey();
+	if (skirmishAILoadCount[skirmishAIKey] == 0) {
 		//const SSAILibrary* sLib = sAIInterfaceLibrary.loadSkirmishAILibrary(&amp;sAISpecifier);
 		const SSAILibrary* sLib =
 				sAIInterfaceLibrary.loadSkirmishAILibrary(infSize, infKeys, infValues);
-		ai = new CSkirmishAILibrary(*sLib, sAIkey);
-		loadedSkirmishAILibraries[sAISpecifier] = ai;
+		ai = new CSkirmishAILibrary(*sLib, skirmishAIKey);
+		loadedSkirmishAILibraries[skirmishAIKey] = ai;
 	} else {
-		ai = loadedSkirmishAILibraries[sAISpecifier];
+		ai = loadedSkirmishAILibraries[skirmishAIKey];
 	}
 
-	skirmishAILoadCount[sAISpecifier]++;
+	skirmishAILoadCount[skirmishAIKey]++;
 
 	return ai;
 }
-int CAIInterfaceLibrary::ReleaseSkirmishAILibrary(const SSAISpecifier&amp; sAISpecifier) {
+int CAIInterfaceLibrary::ReleaseSkirmishAILibrary(const SkirmishAIKey&amp; key) {
 
 	const IAILibraryManager* libMan = IAILibraryManager::GetInstance();
-	SSAIKey sAIkey = {info-&gt;GetSpecifier(), sAISpecifier};
-	const CSkirmishAILibraryInfo* aiInfo = libMan-&gt;GetSkirmishAIInfos().find(sAIkey)-&gt;second;
+	const CSkirmishAILibraryInfo* aiInfo = libMan-&gt;GetSkirmishAIInfos().find(key)-&gt;second;
 	unsigned int infSize = aiInfo-&gt;GetInfo().size();
 	const char** infKeys = aiInfo-&gt;GetCInfoKeys();
 	const char** infValues = aiInfo-&gt;GetCInfoValues();
 
-	if (skirmishAILoadCount[sAISpecifier] == 0) {
+	if (skirmishAILoadCount[key] == 0) {
 		return 0;
 	}
 
-	skirmishAILoadCount[sAISpecifier]--;
+	skirmishAILoadCount[key]--;
 
-	if (skirmishAILoadCount[sAISpecifier] == 0) {
-		loadedSkirmishAILibraries.erase(sAISpecifier);
+	if (skirmishAILoadCount[key] == 0) {
+		loadedSkirmishAILibraries.erase(key);
 		sAIInterfaceLibrary.unloadSkirmishAILibrary(infSize, infKeys, infValues);
 	}
 
-	return skirmishAILoadCount[sAISpecifier];
+	return skirmishAILoadCount[key];
 }
-int CAIInterfaceLibrary::GetSkirmishAILibraryLoadCount(const SSAISpecifier&amp; sAISpecifier) const {
-	return skirmishAILoadCount.at(sAISpecifier);
+int CAIInterfaceLibrary::GetSkirmishAILibraryLoadCount(const SkirmishAIKey&amp; key) const {
+	return skirmishAILoadCount.at(key);
 }
 int CAIInterfaceLibrary::ReleaseAllSkirmishAILibraries() {
 
@@ -442,8 +440,8 @@
 //		const std::string&amp; fileNameMainPart) {
 std::string CAIInterfaceLibrary::FindLibFile() {
 
-	const std::string&amp; dataDir = info-&gt;GetDataDir();
-	const std::string&amp; fileName = info-&gt;GetFileName();
+	const std::string&amp; dataDir = info.GetDataDir();
+	const std::string&amp; fileName = info.GetFileName();
 
 	std::string libFileName(fileName); // eg. C-0.1
 	#ifndef _WIN32

Modified: branches/caiinterface/rts/ExternalAI/AIInterfaceLibrary.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/AIInterfaceLibrary.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/AIInterfaceLibrary.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -22,6 +22,7 @@
 
 #include &quot;Platform/SharedLib.h&quot;
 #include &quot;Interface/SAIInterfaceLibrary.h&quot;
+//#include &quot;AIInterfaceLibraryInfo.h&quot;
 
 #include &lt;string&gt;
 #include &lt;map&gt;
@@ -36,13 +37,13 @@
 //	CAIInterfaceLibrary(const std::string&amp; libFileName);
 	//CAIInterfaceLibrary(const std::string&amp; libFileName, const SAIInterfaceSpecifier&amp; interfaceSpecifier);
 	//CAIInterfaceLibrary(const SAIInterfaceSpecifier&amp; interfaceSpecifier, const std::string&amp; libFileName = &quot;&quot;);
-	CAIInterfaceLibrary(const CAIInterfaceLibraryInfo* info);
+	CAIInterfaceLibrary(const CAIInterfaceLibraryInfo&amp; info);
 	virtual ~CAIInterfaceLibrary();
 
 //	static CAIInterfaceLibrary* Load(const std::string&amp; libFileName); // increments load counter
 //	static CAIInterfaceLibrary* Get(const std::string&amp; shortName, const std::string&amp; version); // does not increment load counter
 
-	virtual SAIInterfaceSpecifier GetSpecifier() const;
+	virtual AIInterfaceKey GetKey() const;
 
 	virtual LevelOfSupport GetLevelOfSupportFor(
 			const std::string&amp; engineVersionString, int engineVersionNumber) const;
@@ -55,9 +56,9 @@
 	//virtual std::vector&lt;SSAISpecifier&gt; GetSkirmishAILibrarySpecifiers() const;
 	//virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const SSAISpecifier&amp; sAISpecifier);
 	//virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const InfoItem* info, unsigned int numInfo);
-	virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const CSkirmishAILibraryInfo* aiInfo);
-	virtual int ReleaseSkirmishAILibrary(const SSAISpecifier&amp; sAISpecifier);
-	virtual int GetSkirmishAILibraryLoadCount(const SSAISpecifier&amp; sAISpecifier) const;
+	virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const CSkirmishAILibraryInfo&amp; aiInfo);
+	virtual int ReleaseSkirmishAILibrary(const SkirmishAIKey&amp; sAISpecifier);
+	virtual int GetSkirmishAILibraryLoadCount(const SkirmishAIKey&amp; sAISpecifier) const;
 	virtual int ReleaseAllSkirmishAILibraries();
 
 //	// Group AI methods
@@ -78,11 +79,11 @@
 	std::string libFilePath;
 	SharedLib* sharedLib;
 	SAIInterfaceLibrary sAIInterfaceLibrary;
-	const CAIInterfaceLibraryInfo* info;
-	std::map&lt;const SSAISpecifier, ISkirmishAILibrary*, SSAISpecifier_Comparator&gt; loadedSkirmishAILibraries;
-	std::map&lt;const SSAISpecifier, int, SSAISpecifier_Comparator&gt; skirmishAILoadCount;
-	std::map&lt;const SGAISpecifier, IGroupAILibrary*, SGAISpecifier_Comparator&gt; loadedGroupAILibraries;
-	std::map&lt;const SGAISpecifier, int, SGAISpecifier_Comparator&gt; groupAILoadCount;
+	const CAIInterfaceLibraryInfo&amp; info;
+	std::map&lt;const SkirmishAIKey, ISkirmishAILibrary*&gt; loadedSkirmishAILibraries;
+	std::map&lt;const SkirmishAIKey, int&gt; skirmishAILoadCount;
+//	std::map&lt;const SGAISpecifier, IGroupAILibrary*, SGAISpecifier_Comparator&gt; loadedGroupAILibraries;
+//	std::map&lt;const SGAISpecifier, int, SGAISpecifier_Comparator&gt; groupAILoadCount;
 
 private:
 	static const int MAX_INFOS = 128;

Modified: branches/caiinterface/rts/ExternalAI/AIInterfaceLibraryInfo.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/AIInterfaceLibraryInfo.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/AIInterfaceLibraryInfo.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -18,8 +18,10 @@
 #include &quot;AIInterfaceLibraryInfo.h&quot;
 
 #include &quot;IAIInterfaceLibrary.h&quot;
+#include &quot;AIInterfaceKey.h&quot;
 #include &quot;Interface/aidefines.h&quot;
 #include &quot;Interface/SInfo.h&quot;
+#include &quot;Interface/SAIInterfaceLibrary.h&quot;
 
 #include &quot;Platform/errorhandler.h&quot;
 #include &quot;FileSystem/VFSModes.h&quot;
@@ -82,12 +84,12 @@
 }
 */
 
-SAIInterfaceSpecifier CAIInterfaceLibraryInfo::GetSpecifier() const {
+AIInterfaceKey CAIInterfaceLibraryInfo::GetKey() const {
 
 	const char* sn = info.at(AI_INTERFACE_PROPERTY_SHORT_NAME).value;
 	const char* v = info.at(AI_INTERFACE_PROPERTY_VERSION).value;
-	SAIInterfaceSpecifier specifier = {sn, v};
-	return specifier;
+	AIInterfaceKey key = AIInterfaceKey(sn, v);
+	return key;
 }
 
 std::string CAIInterfaceLibraryInfo::GetDataDir() const {

Modified: branches/caiinterface/rts/ExternalAI/AIInterfaceLibraryInfo.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/AIInterfaceLibraryInfo.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/AIInterfaceLibraryInfo.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -16,15 +16,16 @@
 */
 
 #ifndef _AIINTERFACELIBRARYINFO_H
-#define	_AIINTERFACELIBRARYINFO_H
+#define _AIINTERFACELIBRARYINFO_H
 
-#include &quot;Interface/SAIInterfaceLibrary.h&quot;
+//#include &quot;AIInterfaceKey.h&quot;
 
 #include &lt;map&gt;
 #include &lt;string&gt;
 
 class IAIInterfaceLibrary;
 struct InfoItem;
+struct AIInterfaceKey;
 
 class CAIInterfaceLibraryInfo {
 public:
@@ -40,7 +41,7 @@
 
 	//virtual LevelOfSupport GetLevelOfSupportForCurrentEngine() const;
 
-	virtual SAIInterfaceSpecifier GetSpecifier() const;
+	virtual AIInterfaceKey GetKey() const;
 
 	virtual std::string GetDataDir() const;
 	virtual std::string GetFileName() const; // when the AI is &quot;libRAI-0.600.so&quot; or &quot;RAI-0.600.dll&quot;, this value should be &quot;RAI-0.600&quot;
@@ -70,4 +71,4 @@
 	const char** infoValues_c;
 };
 
-#endif	// _AIINTERFACELIBRARYINFO_H
+#endif // _AIINTERFACELIBRARYINFO_H

Modified: branches/caiinterface/rts/ExternalAI/AILibraryManager.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/AILibraryManager.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/AILibraryManager.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -154,7 +154,7 @@
 
 		SAIInterfaceSpecifier interfaceSpecifier = interfaceLib-&gt;GetSpecifier();
 		interfaceSpecifier = copySAIInterfaceSpecifier(&amp;interfaceSpecifier);
-		interfaceSpecifiers.push_back(interfaceSpecifier);
+		interfaceKeys.push_back(interfaceSpecifier);
 
 		// generate and store the interface info
 		CAIInterfaceLibraryInfo* interfaceInfo = new CAIInterfaceLibraryInfo(*interfaceLib);
@@ -229,8 +229,7 @@
 	// {AI_INTERFACES_DATA_DIR}/{*}/{*}/InterfaceInfo.lua
 	T_dirs aiInterfaceDataDirs =
 			FindDirsAndDirectSubDirs(AI_INTERFACES_DATA_DIR);
-	typedef std::map&lt;const SAIInterfaceSpecifier, std::set&lt;std::string&gt;,
-			SAIInterfaceSpecifier_Comparator&gt; T_dupInt;
+	typedef std::map&lt;const AIInterfaceKey, std::set&lt;std::string&gt; &gt; T_dupInt;
 	T_dupInt duplicateInterfaceInfoCheck;
 	for (T_dirs::iterator dir = aiInterfaceDataDirs.begin();
 			dir != aiInterfaceDataDirs.end(); ++dir) {
@@ -246,13 +245,13 @@
 			interfaceInfo-&gt;SetDataDir(noSlashAtEnd(possibleDataDir));
 			interfaceInfo-&gt;CreateCReferences();
 
-			SAIInterfaceSpecifier interfaceSpecifier = interfaceInfo-&gt;GetSpecifier();
+			AIInterfaceKey interfaceKey = interfaceInfo-&gt;GetKey();
 
-			interfaceSpecifiers.insert(interfaceSpecifier);
-			interfaceInfos[interfaceSpecifier] = interfaceInfo;
+			interfaceKeys.insert(interfaceKey);
+			interfaceInfos[interfaceKey] = interfaceInfo;
 
 			// so we can check if one interface is specified multiple times
-			duplicateInterfaceInfoCheck[interfaceSpecifier].insert(infoFile.at(0));
+			duplicateInterfaceInfoCheck[interfaceKey].insert(infoFile.at(0));
 		}
 	}
 
@@ -263,8 +262,8 @@
 			duplicateInterfaceInfos[info-&gt;first] = info-&gt;second;
 
 			logOutput.Print(&quot;WARNING: Duplicate AI Interface Info found:&quot;);
-			logOutput.Print(&quot;\tfor interface: %s %s&quot;, info-&gt;first.shortName,
-					info-&gt;first.version);
+			logOutput.Print(&quot;\tfor interface: %s %s&quot;, info-&gt;first.GetShortName().c_str(),
+					info-&gt;first.GetVersion().c_str());
 			logOutput.Print(&quot;\tin files:&quot;);
 			std::set&lt;std::string&gt;::const_iterator dir;
 			for (dir = info-&gt;second.begin(); dir != info-&gt;second.end(); ++dir) {
@@ -298,15 +297,15 @@
 			skirmishAIInfo-&gt;SetDataDir(noSlashAtEnd(possibleDataDir));
 			skirmishAIInfo-&gt;CreateCReferences();
 
-			SSAISpecifier aiSpecifier = skirmishAIInfo-&gt;GetSpecifier();
-			SAIInterfaceSpecifier interfaceSpecifier =
+			SkirmishAIKey aiKey = skirmishAIInfo-&gt;GetKey();
+			AIInterfaceKey interfaceKey =
 					FindFittingInterfaceSpecifier(
 							skirmishAIInfo-&gt;GetInterfaceShortName(),
 							skirmishAIInfo-&gt;GetInterfaceVersion(),
-							interfaceSpecifiers);
-			if (interfaceSpecifier.shortName != NULL) {
-				aiSpecifier = copySSAISpecifier(&amp;aiSpecifier);
-				SSAIKey skirmishAIKey = {interfaceSpecifier, aiSpecifier};
+							interfaceKeys);
+			if (!interfaceKey.IsUnspecified()) {
+//				aiSpecifier = copySSAISpecifier(&amp;aiSpecifier);
+				SkirmishAIKey skirmishAIKey = SkirmishAIKey(aiKey, interfaceKey);
 				skirmishAIKeys.insert(skirmishAIKey);
 				skirmishAIInfos[skirmishAIKey] = skirmishAIInfo;
 
@@ -323,8 +322,8 @@
 			duplicateSkirmishAIInfos[info-&gt;first] = info-&gt;second;
 
 			logOutput.Print(&quot;WARNING: Duplicate Skirmish AI Info found:&quot;);
-			logOutput.Print(&quot;\tfor Skirmish AI: %s %s&quot;, info-&gt;first.ai.shortName,
-					info-&gt;first.ai.version);
+			logOutput.Print(&quot;\tfor Skirmish AI: %s %s&quot;, info-&gt;first.GetShortName().c_str(),
+					info-&gt;first.GetVersion().c_str());
 			logOutput.Print(&quot;\tin files:&quot;);
 			std::set&lt;std::string&gt;::const_iterator dir;
 			for (dir = info-&gt;second.begin(); dir != info-&gt;second.end(); ++dir) {
@@ -363,7 +362,7 @@
 //					FindFittingInterfaceSpecifier(
 //							groupAIInfo-&gt;GetInterfaceShortName(),
 //							groupAIInfo-&gt;GetInterfaceVersion(),
-//							interfaceSpecifiers);
+//							interfaceKeys);
 //			if (interfaceSpecifier.shortName != NULL) {
 //				aiSpecifier = copySGAISpecifier(&amp;aiSpecifier);
 //				SGAIKey groupAIKey = {interfaceSpecifier, aiSpecifier};
@@ -415,7 +414,7 @@
 
 		SAIInterfaceSpecifier interfaceSpecifier = interfaceLib-&gt;GetSpecifier();
 		interfaceSpecifier = copySAIInterfaceSpecifier(&amp;interfaceSpecifier);
-		interfaceSpecifiers.push_back(interfaceSpecifier);
+		interfaceKeys.push_back(interfaceSpecifier);
 
 		// generate and store the interface info
 		CAIInterfaceLibraryInfo* interfaceInfo = new CAIInterfaceLibraryInfo(*interfaceLib);
@@ -477,7 +476,7 @@
 	skirmishAIInfos.clear();
 //	groupAIInfos.clear();
 
-	interfaceSpecifiers.clear();
+	interfaceKeys.clear();
 	skirmishAIKeys.clear();
 //	groupAIKeys.clear();
 }
@@ -548,11 +547,11 @@
 
 	ReleaseEverything();
 
-	// delete all strings contained in skirmish AI specifiers
-	IAILibraryManager::T_skirmishAIKeys::iterator sSpec;
-	for (sSpec=skirmishAIKeys.begin(); sSpec!=skirmishAIKeys.end(); sSpec++) {
-		deleteSSAISpecifier(&amp;(sSpec-&gt;ai));
-	}
+//	// delete all strings contained in skirmish AI specifiers
+//	IAILibraryManager::T_skirmishAIKeys::iterator sSpec;
+//	for (sSpec=skirmishAIKeys.begin(); sSpec!=skirmishAIKeys.end(); sSpec++) {
+//		deleteSSAISpecifier(&amp;(sSpec-&gt;ai));
+//	}
 
 //	// delete all strings contained in group AI specifiers
 //	IAILibraryManager::T_groupAIKeys::iterator gSpec;
@@ -560,17 +559,17 @@
 //		deleteSGAISpecifier(&amp;(gSpec-&gt;ai));
 //	}
 
-	// delete all strings contained in interface specifiers
-	IAILibraryManager::T_interfaceSpecs::iterator iSpec;
-	for (iSpec=interfaceSpecifiers.begin(); iSpec!=interfaceSpecifiers.end(); iSpec++) {
-		deleteSAIInterfaceSpecifier(&amp;(*iSpec));
-	}
+//	// delete all strings contained in interface specifiers
+//	IAILibraryManager::T_interfaceSpecs::iterator iSpec;
+//	for (iSpec=interfaceKeys.begin(); iSpec!=interfaceKeys.end(); iSpec++) {
+//		deleteSAIInterfaceSpecifier(&amp;(*iSpec));
+//	}
 
 	DeleteCOptions();
 }
 
-const IAILibraryManager::T_interfaceSpecs&amp; CAILibraryManager::GetInterfaceSpecifiers() const {
-	return interfaceSpecifiers;
+const IAILibraryManager::T_interfaceSpecs&amp; CAILibraryManager::GetInterfaceKeys() const {
+	return interfaceKeys;
 }
 const IAILibraryManager::T_skirmishAIKeys&amp; CAILibraryManager::GetSkirmishAIKeys() const {
 	return skirmishAIKeys;
@@ -593,14 +592,13 @@
 
 	if (!usedSkirmishAIInfos_initialized) {
 		const CTeam* team = NULL;
-		for (unsigned int t = 0; t &lt; (unsigned int)MAX_TEAMS; ++t) {
+		for (unsigned int t = 0; t &lt; (unsigned int)teamHandler-&gt;ActiveTeams(); ++t) {
 			team = teamHandler-&gt;Team(t);
 			if (team != NULL &amp;&amp; team-&gt;isAI) {
+				const std::string&amp; t_sn = team-&gt;skirmishAIKey.GetShortName();
+				const std::string&amp; t_v = team-&gt;skirmishAIKey.GetVersion();
+
 				IAILibraryManager::T_skirmishAIInfos::const_iterator aiInfo;
-				const char * tmpStr = team-&gt;skirmishAISpecifier.ai.shortName;
-				const std::string&amp; t_sn = tmpStr != NULL ? tmpStr : &quot;&quot;;
-				tmpStr = team-&gt;skirmishAISpecifier.ai.version;
-				const std::string&amp; t_v = tmpStr != NULL ? tmpStr : &quot;&quot;;
 				for (aiInfo = skirmishAIInfos.begin(); aiInfo != skirmishAIInfos.end(); ++aiInfo) {
 					const std::string&amp; ai_sn = aiInfo-&gt;second-&gt;GetShortName();
 					const std::string&amp; ai_v = aiInfo-&gt;second-&gt;GetVersion();
@@ -627,34 +625,30 @@
 //}
 
 
-std::vector&lt;SSAIKey&gt; CAILibraryManager::FittingSkirmishAIKeys(
-		const SSAISpecifier&amp; skirmishAISpecifier) const {
+std::vector&lt;SkirmishAIKey&gt; CAILibraryManager::FittingSkirmishAIKeys(
+		const SkirmishAIKey&amp; skirmishAIKey) const {
 
-	std::vector&lt;SSAIKey&gt; applyingKeys;
+	std::vector&lt;SkirmishAIKey&gt; applyingKeys;
 
-	if (skirmishAISpecifier.shortName == NULL || strlen(skirmishAISpecifier.shortName) == 0) {
+	if (skirmishAIKey.IsUnspecified()) {
 		return applyingKeys;
 	}
 
-	std::string aiName(skirmishAISpecifier.shortName);
-
 	bool checkVersion = false;
-	std::string aiVersion;
-	if (skirmishAISpecifier.version != NULL &amp;&amp; strlen(skirmishAISpecifier.version) &gt; 0) {
-		aiVersion = std::string(skirmishAISpecifier.version);
+	if (skirmishAIKey.GetVersion() != &quot;&quot;) {
 		checkVersion = true;
 	}
 
-	std::set&lt;SSAIKey&gt;::const_iterator sasi;
+	std::set&lt;SkirmishAIKey&gt;::const_iterator sasi;
 	for (sasi=skirmishAIKeys.begin(); sasi!=skirmishAIKeys.end(); sasi++) {
 
 		// check if the ai name fits
-		if (aiName != sasi-&gt;ai.shortName) {
+		if (skirmishAIKey.GetShortName() != sasi-&gt;GetShortName()) {
 			continue;
 		}
 
 		// check if the ai version fits (if one is specifyed)
-		if (checkVersion &amp;&amp; aiVersion != sasi-&gt;ai.version) {
+		if (checkVersion &amp;&amp; skirmishAIKey.GetVersion() != sasi-&gt;GetVersion()) {
 			continue;
 		}
 
@@ -708,18 +702,18 @@
 //	return applyingKeys;
 //}
 
-const ISkirmishAILibrary* CAILibraryManager::FetchSkirmishAILibrary(const SSAIKey&amp; skirmishAIKey) {
+const ISkirmishAILibrary* CAILibraryManager::FetchSkirmishAILibrary(const SkirmishAIKey&amp; skirmishAIKey) {
 
 	T_skirmishAIInfos::const_iterator aiInfo = skirmishAIInfos.find(skirmishAIKey);
 	if (aiInfo == skirmishAIInfos.end()) {
 		return NULL;
 	}
-	return FetchInterface(skirmishAIKey.interface)-&gt;FetchSkirmishAILibrary(aiInfo-&gt;second);
+	return FetchInterface(skirmishAIKey.GetInterface())-&gt;FetchSkirmishAILibrary(*(aiInfo-&gt;second));
 }
 
-void CAILibraryManager::ReleaseSkirmishAILibrary(const SSAIKey&amp; skirmishAIKey) {
-	FetchInterface(skirmishAIKey.interface)-&gt;ReleaseSkirmishAILibrary(skirmishAIKey.ai);
-	ReleaseInterface(skirmishAIKey.interface); // only releases the library if its load count is 0
+void CAILibraryManager::ReleaseSkirmishAILibrary(const SkirmishAIKey&amp; skirmishAIKey) {
+	FetchInterface(skirmishAIKey.GetInterface())-&gt;ReleaseSkirmishAILibrary(skirmishAIKey);
+	ReleaseInterface(skirmishAIKey.GetInterface()); // only releases the library if its load count is 0
 }
 
 void CAILibraryManager::ReleaseAllSkirmishAILibraries() {
@@ -803,18 +797,18 @@
 
 
 
-IAIInterfaceLibrary* CAILibraryManager::FetchInterface(const SAIInterfaceSpecifier&amp; interfaceSpecifier) {
+IAIInterfaceLibrary* CAILibraryManager::FetchInterface(const AIInterfaceKey&amp; interfaceKey) {
 
 	IAIInterfaceLibrary* interfaceLib = NULL;
 
-	T_loadedInterfaces::const_iterator interfacePos = loadedAIInterfaceLibraries.find(interfaceSpecifier);
+	T_loadedInterfaces::const_iterator interfacePos = loadedAIInterfaceLibraries.find(interfaceKey);
 	if (interfacePos == loadedAIInterfaceLibraries.end()) { // interface not yet loaded
-		T_interfaceInfos::const_iterator interfaceInfo = interfaceInfos.find(interfaceSpecifier);
+		T_interfaceInfos::const_iterator interfaceInfo = interfaceInfos.find(interfaceKey);
 		if (interfaceInfo != interfaceInfos.end()) {
-std::string tst = interfaceInfo-&gt;second-&gt;GetDataDir();
+//std::string tst = interfaceInfo-&gt;second-&gt;GetDataDir();
 			//interfaceLib = new CAIInterfaceLibrary(interfaceSpecifier);
-			interfaceLib = new CAIInterfaceLibrary(interfaceInfo-&gt;second);
-			loadedAIInterfaceLibraries[interfaceSpecifier] = interfaceLib;
+			interfaceLib = new CAIInterfaceLibrary(*(interfaceInfo-&gt;second));
+			loadedAIInterfaceLibraries[interfaceKey] = interfaceLib;
 		} else {
 			// unavailable interface requested, returning NULL
 		}
@@ -825,9 +819,9 @@
 	return interfaceLib;
 }
 
-void CAILibraryManager::ReleaseInterface(const SAIInterfaceSpecifier&amp; interfaceSpecifier) {
+void CAILibraryManager::ReleaseInterface(const AIInterfaceKey&amp; interfaceKey) {
 
-	T_loadedInterfaces::iterator interfacePos = loadedAIInterfaceLibraries.find(interfaceSpecifier);
+	T_loadedInterfaces::iterator interfacePos = loadedAIInterfaceLibraries.find(interfaceKey);
 	if (interfacePos != loadedAIInterfaceLibraries.end()) {
 		IAIInterfaceLibrary* interfaceLib = interfacePos-&gt;second;
 		if (interfaceLib-&gt;GetLoadCount() == 0) {
@@ -886,28 +880,25 @@
 	return found;
 }
 
-SAIInterfaceSpecifier CAILibraryManager::FindFittingInterfaceSpecifier(
+AIInterfaceKey CAILibraryManager::FindFittingInterfaceSpecifier(
 		const std::string&amp; shortName,
 		const std::string&amp; minVersion,
-		const T_interfaceSpecs&amp; specs) {
+		const T_interfaceSpecs&amp; keys) {
 
-	std::set&lt;SAIInterfaceSpecifier&gt;::const_iterator spec;
+	std::set&lt;AIInterfaceKey&gt;::const_iterator key;
 	int minDiff = INT_MAX;
-	const char* chosenShortName = NULL;
-	const char* chosenVersion = NULL;
-	for (spec=specs.begin(); spec!=specs.end(); spec++) {
-		if (shortName == spec-&gt;shortName) {
-			int diff = versionCompare(spec-&gt;version, minVersion);
+	AIInterfaceKey fittingKey = AIInterfaceKey(); // unspecified key
+	for (key=keys.begin(); key!=keys.end(); key++) {
+		if (shortName == key-&gt;GetShortName()) {
+			int diff = versionCompare(key-&gt;GetVersion(), minVersion);
 			if (diff &gt;= 0 &amp;&amp; diff &lt; minDiff) {
-				chosenShortName = spec-&gt;shortName;
-				chosenVersion = spec-&gt;version;
+				fittingKey = *key;
 				minDiff = diff;
 			}
 		}
 	}
 
-	SAIInterfaceSpecifier found = {chosenShortName, chosenVersion};
-	return found;
+	return fittingKey;
 }
 
 std::vector&lt;std::string&gt; split(const std::string&amp; str, const char sep) {

Modified: branches/caiinterface/rts/ExternalAI/AILibraryManager.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/AILibraryManager.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/AILibraryManager.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -43,7 +43,7 @@
 	CAILibraryManager(); // looks for interface and AIs supported by them (ret != 0: error)
 	~CAILibraryManager(); // unloads all shared libraries that are currently loaded (interfaces and implementations)
 
-	virtual const T_interfaceSpecs&amp; GetInterfaceSpecifiers() const;
+	virtual const T_interfaceSpecs&amp; GetInterfaceKeys() const;
 	virtual const T_skirmishAIKeys&amp; GetSkirmishAIKeys() const;
 //	virtual const T_groupAIKeys&amp; GetGroupAIKeys() const;
 
@@ -61,15 +61,15 @@
 	virtual const T_dupSkirm&amp; GetDuplicateSkirmishAIInfos() const;
 //	virtual const T_dupGroup&amp; GetDuplicateGroupAIInfos() const;
 
-	virtual std::vector&lt;SSAIKey&gt; FittingSkirmishAIKeys(const SSAISpecifier&amp; skirmishAISpecifier) const;
+	virtual std::vector&lt;SkirmishAIKey&gt; FittingSkirmishAIKeys(const SkirmishAIKey&amp; skirmishAIKey) const;
 //	virtual std::vector&lt;SSAIKey&gt; FittingSkirmishAIKeys(const std::string&amp; skirmishAISpecifier) const;
 	// a Skirmish AI (its library) is only really loaded when it is not yet loaded.
-	virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const SSAIKey&amp; skirmishAIKey);
+	virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const SkirmishAIKey&amp; skirmishAIKey);
 	// a Skirmish AI is only unloaded when ReleaseSkirmishAILibrary() is called
 	// as many times as GetSkirmishAILibrary() was.
 	// loading and unloading of the interfaces
 	// is handled internally/automatically.
-	virtual void ReleaseSkirmishAILibrary(const SSAIKey&amp; skirmishAIKey);
+	virtual void ReleaseSkirmishAILibrary(const SkirmishAIKey&amp; skirmishAIKey);
 	virtual void ReleaseAllSkirmishAILibraries(); // unloads all currently Skirmish loaded AIs
 
 //	virtual std::vector&lt;SGAIKey&gt; ResolveGroupAIKey(const std::string&amp; groupAISpecifier) const;
@@ -85,10 +85,10 @@
 	virtual void ReleaseEverything(); // unloads all currently loaded AIs and interfaces
 
 private:
-	typedef std::map&lt;const SAIInterfaceSpecifier, IAIInterfaceLibrary*, SAIInterfaceSpecifier_Comparator&gt; T_loadedInterfaces;
+	typedef std::map&lt;const AIInterfaceKey, IAIInterfaceLibrary*&gt; T_loadedInterfaces;
 	T_loadedInterfaces loadedAIInterfaceLibraries;
 
-	T_interfaceSpecs interfaceSpecifiers;
+	T_interfaceSpecs interfaceKeys;
 	T_skirmishAIKeys skirmishAIKeys;
 //	T_groupAIKeys groupAIKeys;
 //	std::vector&lt;const SAIInterfaceSpecifier&gt; interfaceLibrarySpecifiers;
@@ -131,11 +131,11 @@
 	/**
 	 * Loads the interface if it is not yet loaded; increments load count.
 	 */
-	IAIInterfaceLibrary* FetchInterface(const SAIInterfaceSpecifier&amp; interfaceSpecifier);
+	IAIInterfaceLibrary* FetchInterface(const AIInterfaceKey&amp; interfaceKey);
 	/**
 	 * Unloads the interface if its load count reaches 0.
 	 */
-	void ReleaseInterface(const SAIInterfaceSpecifier&amp; interfaceSpecifier);
+	void ReleaseInterface(const AIInterfaceKey&amp; interfaceKey);
 //	// the interface has to be loaded already. if it is not, a pointer to NULL will be returned.
 //	s_p&lt;ISkirmishAILibraryInterface&gt; GetInterface(const s_p&lt;const ISkirmishAILibraryInterfaceInfo&gt;&amp; interfaceInfo) const;
 //	// if the filename is not found, a pointer to NULL will be returned.
@@ -202,7 +202,7 @@
 	 * available: 0.1, 0.3, 0.5
 	 * chosen: 0.3
 	 */
-	static SAIInterfaceSpecifier FindFittingInterfaceSpecifier(
+	static AIInterfaceKey FindFittingInterfaceSpecifier(
 			const std::string&amp; shortName,
 			const std::string&amp; minVersion,
 			const T_interfaceSpecs&amp; specs);

Modified: branches/caiinterface/rts/ExternalAI/EngineOutHandler.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/EngineOutHandler.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/EngineOutHandler.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -460,7 +460,7 @@
 		attackDir_damagedsView = ZeroVector;
 	}
 	int dt = damaged.team;
-	int at = attacker-&gt;team;
+	int at = attacker ? attacker-&gt;team : -1;
 
 	if (hasSkirmishAIs) {
 		try {
@@ -556,7 +556,7 @@
 
 
 
-bool CEngineOutHandler::CreateSkirmishAI(int teamId, const SSAIKey&amp; key) {
+bool CEngineOutHandler::CreateSkirmishAI(int teamId, const SkirmishAIKey&amp; key) {
 
 	if ((teamId &lt; 0) || (teamId &gt;= (int)activeTeams)) {
 		return false;

Modified: branches/caiinterface/rts/ExternalAI/EngineOutHandler.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/EngineOutHandler.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/EngineOutHandler.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -29,7 +29,7 @@
 class CUnit;
 class CGroup;
 class WeaponDef;
-struct SSAIKey;
+struct SkirmishAIKey;
 class CSkirmishAIWrapper;
 struct SGAIKey;
 class CGroupAIWrapper;
@@ -80,7 +80,7 @@
 
 
 	// Skirmish AI stuff
-	bool CreateSkirmishAI(int teamId, const SSAIKey&amp; key);
+	bool CreateSkirmishAI(int teamId, const SkirmishAIKey&amp; key);
 	bool IsSkirmishAI(int teamId) const;
 	void DestroySkirmishAI(int teamId);
 	//const CSkirmishAIWrapper* GetSkirmishAI(int teamId);

Modified: branches/caiinterface/rts/ExternalAI/GroupAI.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/GroupAI.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/GroupAI.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -35,7 +35,7 @@
 	int teamId;
 	int groupId;
 //	const SGAIKey key;
-	const IGroupAILibrary* library;
+//	const IGroupAILibrary* library;
 };
 
 #endif // _GROUPAI_H

Modified: branches/caiinterface/rts/ExternalAI/GroupAILibrary.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/GroupAILibrary.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/GroupAILibrary.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -1,110 +1,110 @@
-/*
-	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
-	
-	This program is free software; you can redistribute it and/or modify
-	it under the terms of the GNU General Public License as published by
-	the Free Software Foundation; either version 2 of the License, or
-	(at your option) any later version.
-
-	This program is distributed in the hope that it will be useful,
-	but WITHOUT ANY WARRANTY; without even the implied warranty of
-	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-	GNU General Public License for more details.
-
-	You should have received a copy of the GNU General Public License
-	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#include &quot;GroupAILibrary.h&quot;
-
-#include &quot;Interface/SAIInterfaceLibrary.h&quot;
-#include &quot;LogOutput.h&quot;
-#include &lt;string&gt;
-
-CGroupAILibrary::CGroupAILibrary(const SGAILibrary&amp; ai,
-		const SGAISpecifier&amp; specifier,
-		const InfoItem info[], unsigned int numInfoItems)
-		: sGAI(ai), specifier(specifier),
-		info(info), numInfoItems(numInfoItems) {}
-
-CGroupAILibrary::~CGroupAILibrary() {}
-	
-SGAISpecifier CGroupAILibrary::GetSpecifier() const {
-	return specifier;
-}
-
-LevelOfSupport CGroupAILibrary::GetLevelOfSupportFor(int teamId, int groupId,
-			const std::string&amp; engineVersionString, int engineVersionNumber,
-		const SAIInterfaceSpecifier&amp; interfaceSpecifier) const {
-	
-	if (sGAI.getLevelOfSupportFor != NULL) {
-		return sGAI.getLevelOfSupportFor(teamId, groupId,
-				engineVersionString.c_str(), engineVersionNumber,
-				interfaceSpecifier.shortName, interfaceSpecifier.version);
-	} else {
-		return LOS_Unknown;
-	}
-}
-	
-/*
-std::map&lt;std::string, InfoItem&gt; CGroupAILibrary::GetInfo() const {
-	
-	std::map&lt;std::string, InfoItem&gt; info;
-	
-	if (sGAI.getInfo != NULL) {
-		InfoItem infs[MAX_INFOS];
-		int num = sGAI.getInfo(infs, MAX_INFOS);
-
-		int i;
-		for (i=0; i &lt; num; ++i) {
-			InfoItem newII = copyInfoItem(&amp;infs[i]);
-			info[std::string(newII.key)] = newII;
-		}
-	}
-
-	return info;
-}
-std::vector&lt;Option&gt; CGroupAILibrary::GetOptions() const {
-	
-	std::vector&lt;Option&gt; ops;
-	
-	if (sGAI.getOptions != NULL) {
-		Option options[MAX_OPTIONS];
-		int num = sGAI.getOptions(options, MAX_OPTIONS);
-
-		int i;
-		for (i=0; i &lt; num; ++i) {
-			ops.push_back(options[i]);
-		}
-	}
-
-	return ops;
-}
-*/
-
-
-void CGroupAILibrary::Init(int teamId, int groupId) const {
-	
-	if (sGAI.init != NULL) {
-		int error = sGAI.init(teamId, groupId, info, numInfoItems);
-		if (error != 0) {
-			// init failed
-			logOutput.Print(&quot;Failed to initialize an AI for team %d and group %d, error: %d&quot;, teamId, groupId, error);
-		}
-	}
-}
-
-void CGroupAILibrary::Release(int teamId, int groupId) const {
-	
-	if (sGAI.release != NULL) {
-		int error = sGAI.release(teamId, groupId);
-		if (error != 0) {
-			// release failed
-			logOutput.Print(&quot;Failed to release the AI for team %d and group %d, error: %d&quot;, teamId, groupId, error);
-		}
-	}
-}
-
-int CGroupAILibrary::HandleEvent(int teamId, int groupId, int topic, const void* data) const {
-	return sGAI.handleEvent(teamId, groupId, topic, data);
-}
+///*
+//	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
+//
+//	This program is free software; you can redistribute it and/or modify
+//	it under the terms of the GNU General Public License as published by
+//	the Free Software Foundation; either version 2 of the License, or
+//	(at your option) any later version.
+//
+//	This program is distributed in the hope that it will be useful,
+//	but WITHOUT ANY WARRANTY; without even the implied warranty of
+//	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+//	GNU General Public License for more details.
+//
+//	You should have received a copy of the GNU General Public License
+//	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+//*/
+//
+//#include &quot;GroupAILibrary.h&quot;
+//
+//#include &quot;Interface/SAIInterfaceLibrary.h&quot;
+//#include &quot;LogOutput.h&quot;
+//#include &lt;string&gt;
+//
+//CGroupAILibrary::CGroupAILibrary(const SGAILibrary&amp; ai,
+//		const SGAISpecifier&amp; specifier,
+//		const InfoItem info[], unsigned int numInfoItems)
+//		: sGAI(ai), specifier(specifier),
+//		info(info), numInfoItems(numInfoItems) {}
+//
+//CGroupAILibrary::~CGroupAILibrary() {}
+//
+//SGAISpecifier CGroupAILibrary::GetSpecifier() const {
+//	return specifier;
+//}
+//
+//LevelOfSupport CGroupAILibrary::GetLevelOfSupportFor(int teamId, int groupId,
+//			const std::string&amp; engineVersionString, int engineVersionNumber,
+//		const SAIInterfaceSpecifier&amp; interfaceSpecifier) const {
+//
+//	if (sGAI.getLevelOfSupportFor != NULL) {
+//		return sGAI.getLevelOfSupportFor(teamId, groupId,
+//				engineVersionString.c_str(), engineVersionNumber,
+//				interfaceSpecifier.shortName, interfaceSpecifier.version);
+//	} else {
+//		return LOS_Unknown;
+//	}
+//}
+//
+///*
+//std::map&lt;std::string, InfoItem&gt; CGroupAILibrary::GetInfo() const {
+//
+//	std::map&lt;std::string, InfoItem&gt; info;
+//
+//	if (sGAI.getInfo != NULL) {
+//		InfoItem infs[MAX_INFOS];
+//		int num = sGAI.getInfo(infs, MAX_INFOS);
+//
+//		int i;
+//		for (i=0; i &lt; num; ++i) {
+//			InfoItem newII = copyInfoItem(&amp;infs[i]);
+//			info[std::string(newII.key)] = newII;
+//		}
+//	}
+//
+//	return info;
+//}
+//std::vector&lt;Option&gt; CGroupAILibrary::GetOptions() const {
+//
+//	std::vector&lt;Option&gt; ops;
+//
+//	if (sGAI.getOptions != NULL) {
+//		Option options[MAX_OPTIONS];
+//		int num = sGAI.getOptions(options, MAX_OPTIONS);
+//
+//		int i;
+//		for (i=0; i &lt; num; ++i) {
+//			ops.push_back(options[i]);
+//		}
+//	}
+//
+//	return ops;
+//}
+//*/
+//
+//
+//void CGroupAILibrary::Init(int teamId, int groupId) const {
+//
+//	if (sGAI.init != NULL) {
+//		int error = sGAI.init(teamId, groupId, info, numInfoItems);
+//		if (error != 0) {
+//			// init failed
+//			logOutput.Print(&quot;Failed to initialize an AI for team %d and group %d, error: %d&quot;, teamId, groupId, error);
+//		}
+//	}
+//}
+//
+//void CGroupAILibrary::Release(int teamId, int groupId) const {
+//
+//	if (sGAI.release != NULL) {
+//		int error = sGAI.release(teamId, groupId);
+//		if (error != 0) {
+//			// release failed
+//			logOutput.Print(&quot;Failed to release the AI for team %d and group %d, error: %d&quot;, teamId, groupId, error);
+//		}
+//	}
+//}
+//
+//int CGroupAILibrary::HandleEvent(int teamId, int groupId, int topic, const void* data) const {
+//	return sGAI.handleEvent(teamId, groupId, topic, data);
+//}

Modified: branches/caiinterface/rts/ExternalAI/GroupAILibrary.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/GroupAILibrary.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/GroupAILibrary.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -1,63 +1,63 @@
-/*
-	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
-	
-	This program is free software; you can redistribute it and/or modify
-	it under the terms of the GNU General Public License as published by
-	the Free Software Foundation; either version 2 of the License, or
-	(at your option) any later version.
-
-	This program is distributed in the hope that it will be useful,
-	but WITHOUT ANY WARRANTY; without even the implied warranty of
-	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-	GNU General Public License for more details.
-
-	You should have received a copy of the GNU General Public License
-	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#ifndef _GROUPAILIBRARY_H
-#define	_GROUPAILIBRARY_H
-
-
-#include &quot;IGroupAILibrary.h&quot;
-
-#include &quot;Interface/SGAILibrary.h&quot;
-
-class CGroupAILibrary : public IGroupAILibrary {
-public:
-	CGroupAILibrary(const SGAILibrary&amp; ai, const SGAISpecifier&amp; specifier,
-			const InfoItem info[], unsigned int numInfoItems);
-	virtual ~CGroupAILibrary();
-	
-	virtual SGAISpecifier GetSpecifier() const;
-	/**
-	 * Level of Support for a specific engine version and ai interface.
-	 * @return see enum LevelOfSupport (higher values could be used optionally)
-	 */
-	virtual LevelOfSupport GetLevelOfSupportFor(int teamId, int groupId,
-			const std::string&amp; engineVersionString, int engineVersionNumber,
-			const SAIInterfaceSpecifier&amp; interfaceSpecifier) const;
-	
-//    virtual std::map&lt;std::string, InfoItem&gt; GetInfo() const;
-//	virtual std::vector&lt;Option&gt; GetOptions() const;
-	
-	
-    virtual void Init(int teamId, int groupId) const;
-    virtual void Release(int teamId, int groupId) const;
-    virtual int HandleEvent(int teamId, int groupId, int topic, const void* data) const;
-	
-private:
-	SGAILibrary sGAI;
-	SGAISpecifier specifier;
-	const InfoItem* info;
-	unsigned int numInfoItems;
-	
-private:
-//	void reportInterfaceFunctionError(const std::string* libFileName, const std::string* functionName);
-	
-	static const int MAX_INFOS = 128;
-	static const int MAX_OPTIONS = 128;
-};
-
-#endif	/* _GROUPAILIBRARY_H */
-
+///*
+//	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
+//
+//	This program is free software; you can redistribute it and/or modify
+//	it under the terms of the GNU General Public License as published by
+//	the Free Software Foundation; either version 2 of the License, or
+//	(at your option) any later version.
+//
+//	This program is distributed in the hope that it will be useful,
+//	but WITHOUT ANY WARRANTY; without even the implied warranty of
+//	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+//	GNU General Public License for more details.
+//
+//	You should have received a copy of the GNU General Public License
+//	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+//*/
+//
+//#ifndef _GROUPAILIBRARY_H
+//#define	_GROUPAILIBRARY_H
+//
+//
+//#include &quot;IGroupAILibrary.h&quot;
+//
+//#include &quot;Interface/SGAILibrary.h&quot;
+//
+//class CGroupAILibrary : public IGroupAILibrary {
+//public:
+//	CGroupAILibrary(const SGAILibrary&amp; ai, const SGAISpecifier&amp; specifier,
+//			const InfoItem info[], unsigned int numInfoItems);
+//	virtual ~CGroupAILibrary();
+//
+//	virtual SGAISpecifier GetSpecifier() const;
+//	/**
+//	 * Level of Support for a specific engine version and ai interface.
+//	 * @return see enum LevelOfSupport (higher values could be used optionally)
+//	 */
+//	virtual LevelOfSupport GetLevelOfSupportFor(int teamId, int groupId,
+//			const std::string&amp; engineVersionString, int engineVersionNumber,
+//			const SAIInterfaceSpecifier&amp; interfaceSpecifier) const;
+//
+////    virtual std::map&lt;std::string, InfoItem&gt; GetInfo() const;
+////	virtual std::vector&lt;Option&gt; GetOptions() const;
+//
+//
+//    virtual void Init(int teamId, int groupId) const;
+//    virtual void Release(int teamId, int groupId) const;
+//    virtual int HandleEvent(int teamId, int groupId, int topic, const void* data) const;
+//
+//private:
+//	SGAILibrary sGAI;
+//	SGAISpecifier specifier;
+//	const InfoItem* info;
+//	unsigned int numInfoItems;
+//
+//private:
+////	void reportInterfaceFunctionError(const std::string* libFileName, const std::string* functionName);
+//
+//	static const int MAX_INFOS = 128;
+//	static const int MAX_OPTIONS = 128;
+//};
+//
+//#endif	/* _GROUPAILIBRARY_H */
+//

Modified: branches/caiinterface/rts/ExternalAI/IAIInterfaceLibrary.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/IAIInterfaceLibrary.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/IAIInterfaceLibrary.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -19,17 +19,19 @@
 #define	_IAIINTERFACELIBRARY_H
 
 #include &quot;ISkirmishAILibrary.h&quot;
-#include &quot;IGroupAILibrary.h&quot;
+//#include &quot;IGroupAILibrary.h&quot;
 #include &lt;string&gt;
 
 class CSkirmishAILibraryInfo;
-class CGroupAILibraryInfo;
+//class CGroupAILibraryInfo;
+struct AIInterfaceKey;
+struct SkirmishAIKey;
 
 class IAIInterfaceLibrary {
 public:
 	virtual ~IAIInterfaceLibrary() {}
 
-	virtual SAIInterfaceSpecifier GetSpecifier() const = 0;
+	virtual AIInterfaceKey GetKey() const = 0;
 
 	virtual LevelOfSupport GetLevelOfSupportFor(
 			const std::string&amp; engineVersionString, int engineVersionNumber) const = 0;
@@ -62,7 +64,7 @@
 	 */
 	//virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const SSAISpecifier&amp; sAISpecifier) = 0;
 	//virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const InfoItem* info, unsigned int numInfo) = 0;
-	virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const CSkirmishAILibraryInfo* skirmishAIInfo) = 0;
+	virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const CSkirmishAILibraryInfo&amp; skirmishAIInfo) = 0;
 	/**
 	 * @brief	unloads the Skirmish AI library
 	 * This unloads the Skirmish AI library.
@@ -71,19 +73,19 @@
 	 * of that AI are still in use, as it will result in a crash.
 	 * Decrements the load counter.
 	 */
-	virtual int ReleaseSkirmishAILibrary(const SSAISpecifier&amp; sAISpecifier) = 0;
+	virtual int ReleaseSkirmishAILibrary(const SkirmishAIKey&amp; key) = 0;
 	/**
 	 * @brief	is the Skirmish AI library loaded
 	 */
-	bool IsSkirmishAILibraryLoaded(const SSAISpecifier&amp; sAISpecifier) const {
-		return GetSkirmishAILibraryLoadCount(sAISpecifier) &gt; 0;
+	bool IsSkirmishAILibraryLoaded(const SkirmishAIKey&amp; key) const {
+		return GetSkirmishAILibraryLoadCount(key) &gt; 0;
 	}
 	/**
 	 * @brief	how many times is the Skirmish AI loaded
 	 * Thought the AI library may be loaded only once, it can be logically
 	 * loaded multiple times (load counter).
 	 */
-	virtual int GetSkirmishAILibraryLoadCount(const SSAISpecifier&amp; sAISpecifier) const = 0;
+	virtual int GetSkirmishAILibraryLoadCount(const SkirmishAIKey&amp; key) const = 0;
 	/**
 	 * @brief	unloads all AIs
 	 * Unloads all AI libraries currently loaded through this interface.

Modified: branches/caiinterface/rts/ExternalAI/IAILibraryManager.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/IAILibraryManager.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/IAILibraryManager.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -18,8 +18,10 @@
 #include &quot;IAILibraryManager.h&quot;
 
 
-#include &quot;StdAfx.h&quot;
+#include &quot;Sync/Syncify.h&quot;
 #include &quot;AILibraryManager.h&quot;
+#include &quot;AIInterfaceKey.h&quot;
+#include &quot;SkirmishAIKey.h&quot;
 
 #include &lt;iostream&gt;
 
@@ -46,32 +48,31 @@
 void IAILibraryManager::OutputAIInterfacesInfo() {
 
 	const IAILibraryManager* myLibManager = IAILibraryManager::GetInstance();
-	const T_interfaceSpecs&amp; specs =
-			myLibManager-&gt;GetInterfaceSpecifiers();
+	const T_interfaceSpecs&amp; keys =
+			myLibManager-&gt;GetInterfaceKeys();
 	
 	std::cout &lt;&lt; &quot;#&quot; &lt;&lt; std::endl;
 	std::cout &lt;&lt; &quot;# Available Spring Skirmish AIs&quot; &lt;&lt; std::endl;
 	std::cout &lt;&lt; &quot;# -----------------------------&quot; &lt;&lt; std::endl;
 	std::cout &lt;&lt; &quot;# [Name]              [Version]&quot; &lt;&lt; std::endl;
 	
-	T_interfaceSpecs::const_iterator spec;
-    for (spec=specs.begin(); spec != specs.end(); spec++) {
+	T_interfaceSpecs::const_iterator key;
+    for (key=keys.begin(); key != keys.end(); key++) {
 		std::cout &lt;&lt; &quot;  &quot;;
-		std::cout &lt;&lt; spec-&gt;shortName &lt;&lt; fillUpTo(spec-&gt;shortName, 20);
-		std::cout &lt;&lt; spec-&gt;version &lt;&lt; fillUpTo(spec-&gt;version, 20) &lt;&lt; std::endl;
+		std::cout &lt;&lt; key-&gt;GetShortName() &lt;&lt; fillUpTo(key-&gt;GetShortName(), 20);
+		std::cout &lt;&lt; key-&gt;GetVersion() &lt;&lt; fillUpTo(key-&gt;GetVersion(), 20) &lt;&lt; std::endl;
     }
 	
 	std::cout &lt;&lt; &quot;#&quot; &lt;&lt; std::endl;
 }
 
-SSAIKey IAILibraryManager::ResolveSkirmishAIKey(const SSAISpecifier&amp; skirmishAISpecifier) const {
+SkirmishAIKey IAILibraryManager::ResolveSkirmishAIKey(const SkirmishAIKey&amp; skirmishAIKey) const {
 
-	std::vector&lt;SSAIKey&gt; fittingKeys = FittingSkirmishAIKeys(skirmishAISpecifier);
+	std::vector&lt;SkirmishAIKey&gt; fittingKeys = FittingSkirmishAIKeys(skirmishAIKey);
 	if (fittingKeys.size() &gt; 0) {
 		return fittingKeys[0];
 	} else {
-		SSAIKey nullKey = {{NULL, NULL}, {NULL, NULL}};
-		return nullKey;
+		return SkirmishAIKey();
 	}
 }
 
@@ -89,11 +90,11 @@
 	T_skirmishAIKeys::const_iterator key;
     for (key=keys.begin(); key != keys.end(); key++) {
 		std::cout &lt;&lt; &quot;  &quot;;
-		std::cout &lt;&lt; key-&gt;ai.shortName &lt;&lt; fillUpTo(key-&gt;ai.shortName, 20);
-		std::cout &lt;&lt; key-&gt;ai.version &lt;&lt; fillUpTo(key-&gt;ai.version, 20);
-		std::cout &lt;&lt; key-&gt;interface.shortName
-				&lt;&lt; fillUpTo(key-&gt;interface.shortName, 20);
-		std::cout &lt;&lt; key-&gt;interface.version &lt;&lt; std::endl;
+		std::cout &lt;&lt; key-&gt;GetShortName() &lt;&lt; fillUpTo(key-&gt;GetShortName(), 20);
+		std::cout &lt;&lt; key-&gt;GetVersion() &lt;&lt; fillUpTo(key-&gt;GetVersion(), 20);
+		std::cout &lt;&lt; key-&gt;GetInterface().GetShortName()
+				&lt;&lt; fillUpTo(key-&gt;GetInterface().GetShortName(), 20);
+		std::cout &lt;&lt; key-&gt;GetInterface().GetVersion() &lt;&lt; std::endl;
     }
 	
 	const T_dupSkirm&amp; duplicateSkirmishAIInfos =
@@ -102,8 +103,8 @@
 			info != duplicateSkirmishAIInfos.end(); ++info) {
 		std::cout &lt;&lt; &quot;# WARNING: Duplicate Skirmish AI Info found:&quot;
 				&lt;&lt; std::endl;
-		std::cout &lt;&lt; &quot;# \tfor Skirmish AI: &quot; &lt;&lt; info-&gt;first.ai.shortName
-				&lt;&lt; &quot; &quot; &lt;&lt; info-&gt;first.ai.version &lt;&lt; std::endl;
+		std::cout &lt;&lt; &quot;# \tfor Skirmish AI: &quot; &lt;&lt; info-&gt;first.GetShortName()
+				&lt;&lt; &quot; &quot; &lt;&lt; info-&gt;first.GetVersion() &lt;&lt; std::endl;
 		std::cout &lt;&lt; &quot;# \tin files:&quot; &lt;&lt; std::endl;
 		std::set&lt;std::string&gt;::const_iterator dir;
 		for (dir = info-&gt;second.begin(); dir != info-&gt;second.end(); ++dir) {

Modified: branches/caiinterface/rts/ExternalAI/IAILibraryManager.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/IAILibraryManager.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/IAILibraryManager.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -22,14 +22,17 @@
 #include &quot;ISkirmishAILibrary.h&quot;
 #include &quot;AIInterfaceLibraryInfo.h&quot;
 #include &quot;SkirmishAILibraryInfo.h&quot;
-#include &quot;GroupAILibraryInfo.h&quot;
+//#include &quot;GroupAILibraryInfo.h&quot;
+//#include &quot;SkirmishAIKey.h&quot;
+//#include &quot;AIInterfaceKey.h&quot;
 
 #include &lt;vector&gt;
 #include &lt;map&gt;
 #include &lt;set&gt;
 
-struct SSAIKey;
-struct SGAIKey;
+struct AIInterfaceKey;
+struct SkirmishAIKey;
+//struct SGAIKey;
 
 /**
  * @brief manages AIs and AI interfaces
@@ -39,17 +42,16 @@
 public:
 	virtual ~IAILibraryManager() {}
 
-	typedef std::set&lt;SAIInterfaceSpecifier, SAIInterfaceSpecifier_Comparator&gt; T_interfaceSpecs;
-	typedef std::set&lt;SSAIKey, SSAIKey_Comparator&gt; T_skirmishAIKeys;
+	typedef std::set&lt;AIInterfaceKey&gt; T_interfaceSpecs;
+	typedef std::set&lt;SkirmishAIKey&gt; T_skirmishAIKeys;
 //	typedef std::set&lt;SGAIKey, SGAIKey_Comparator&gt; T_groupAIKeys;
 
-	virtual const T_interfaceSpecs&amp; GetInterfaceSpecifiers() const = 0;
+	virtual const T_interfaceSpecs&amp; GetInterfaceKeys() const = 0;
 	virtual const T_skirmishAIKeys&amp; GetSkirmishAIKeys() const = 0;
 //	virtual const T_groupAIKeys&amp; GetGroupAIKeys() const = 0;
 
-	typedef std::map&lt;const SAIInterfaceSpecifier, CAIInterfaceLibraryInfo*,
-			SAIInterfaceSpecifier_Comparator&gt; T_interfaceInfos;
-	typedef std::map&lt;const SSAIKey, CSkirmishAILibraryInfo*, SSAIKey_Comparator&gt;
+	typedef std::map&lt;const AIInterfaceKey, CAIInterfaceLibraryInfo*&gt; T_interfaceInfos;
+	typedef std::map&lt;const SkirmishAIKey, CSkirmishAILibraryInfo*&gt;
 			T_skirmishAIInfos;
 //	typedef std::map&lt;const SGAIKey, CGroupAILibraryInfo*, SGAIKey_Comparator&gt;
 //			T_groupAIInfos;
@@ -64,9 +66,8 @@
 
 	virtual const T_skirmishAIInfos&amp; GetUsedSkirmishAIInfos() = 0;
 
-	typedef std::map&lt;const SAIInterfaceSpecifier, std::set&lt;std::string&gt;,
-			SAIInterfaceSpecifier_Comparator&gt; T_dupInt;
-	typedef std::map&lt;const SSAIKey, std::set&lt;std::string&gt;, SSAIKey_Comparator&gt;
+	typedef std::map&lt;const AIInterfaceKey, std::set&lt;std::string&gt; &gt; T_dupInt;
+	typedef std::map&lt;const SkirmishAIKey, std::set&lt;std::string&gt; &gt;
 			T_dupSkirm;
 //	typedef std::map&lt;const SGAIKey, std::set&lt;std::string&gt;, SGAIKey_Comparator&gt;
 //			T_dupGroup;
@@ -77,18 +78,18 @@
 	virtual const T_dupSkirm&amp; GetDuplicateSkirmishAIInfos() const = 0;
 //	virtual const T_dupGroup&amp; GetDuplicateGroupAIInfos() const = 0;
 
-	SSAIKey ResolveSkirmishAIKey(const SSAISpecifier&amp; skirmishAISpecifier) const;
+	SkirmishAIKey ResolveSkirmishAIKey(const SkirmishAIKey&amp; skirmishAIKey) const;
 protected:
-	virtual std::vector&lt;SSAIKey&gt; FittingSkirmishAIKeys(const SSAISpecifier&amp; skirmishAISpecifier) const = 0;
+	virtual std::vector&lt;SkirmishAIKey&gt; FittingSkirmishAIKeys(const SkirmishAIKey&amp; skirmishAIKey) const = 0;
 //	virtual std::vector&lt;SSAIKey&gt; FittingSkirmishAIKeys(const std::string&amp; skirmishAISpecifier) const = 0;
 public:
 	// a Skirmish AI (its library) is only really loaded when it is not yet loaded.
-	virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const SSAIKey&amp; skirmishAIKey) = 0;
+	virtual const ISkirmishAILibrary* FetchSkirmishAILibrary(const SkirmishAIKey&amp; skirmishAIKey) = 0;
 	// a Skirmish AI is only unloaded when ReleaseSkirmishAILibrary() is called
 	// as many times as GetSkirmishAILibrary() was.
 	// loading and unloading of the interfaces
 	// is handled internally/automatically.
-	virtual void ReleaseSkirmishAILibrary(const SSAIKey&amp; skirmishAIKey) = 0;
+	virtual void ReleaseSkirmishAILibrary(const SkirmishAIKey&amp; skirmishAIKey) = 0;
 	virtual void ReleaseAllSkirmishAILibraries() = 0; // unloads all currently Skirmish loaded AIs
 
 //	virtual std::vector&lt;SGAIKey&gt; ResolveGroupAIKey(const std::string&amp; groupAISpecifier) const = 0;

Modified: branches/caiinterface/rts/ExternalAI/ISkirmishAILibrary.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/ISkirmishAILibrary.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/ISkirmishAILibrary.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -1,6 +1,6 @@
 /*
 	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
-	
+
 	This program is free software; you can redistribute it and/or modify
 	it under the terms of the GNU General Public License as published by
 	the Free Software Foundation; either version 2 of the License, or
@@ -16,39 +16,37 @@
 */
 
 #ifndef _ISKIRMISHAILIBRARY_H
-#define	_ISKIRMISHAILIBRARY_H
+#define _ISKIRMISHAILIBRARY_H
 
 #include &quot;Interface/ELevelOfSupport.h&quot;
 #include &lt;string&gt;
 #include &lt;vector&gt;
 #include &lt;map&gt;
 
-struct SSAISpecifier;
+struct SkirmishAIKey;
 struct InfoItem;
 struct Option;
-struct SAIInterfaceSpecifier;
+struct AIInterfaceKey;
 
 class ISkirmishAILibrary {
 public:
 	virtual ~ISkirmishAILibrary() {}
-	
-	virtual SSAISpecifier GetSpecifier() const = 0;
+
+	virtual SkirmishAIKey GetKey() const = 0;
 	/**
 	 * Level of Support for a specific engine version and AI interface.
 	 * @return see enum LevelOfSupport (higher values could be used optionally)
 	 */
 	virtual LevelOfSupport GetLevelOfSupportFor(int teamId,
 			const std::string&amp; engineVersionString, int engineVersionNumber,
-			const SAIInterfaceSpecifier&amp; interfaceSpecifier) const = 0;
-	
+			const AIInterfaceKey&amp; interfaceKey) const = 0;
+
 //    virtual std::map&lt;std::string, InfoItem&gt; GetInfo(int teamId) const = 0;
 //	virtual std::vector&lt;Option&gt; GetOptions(int teamId) const = 0;
-	
-	
+
     virtual void Init(int teamId) const = 0;
     virtual void Release(int teamId) const = 0;
     virtual int HandleEvent(int teamId, int topic, const void* data) const = 0;
 };
 
-#endif	/* _ISKIRMISHAILIBRARY_H */
-
+#endif // _ISKIRMISHAILIBRARY_H

Modified: branches/caiinterface/rts/ExternalAI/Interface/AISCommands.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/Interface/AISCommands.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/Interface/AISCommands.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -140,7 +140,7 @@
 	float handicap;
 }; // COMMAND_CHEATS_SET_MY_HANDICAP
 struct SGiveMeResourceCheatCommand {
-	int resourceIndex;
+	int resourceId;
 	float amount;
 }; // COMMAND_CHEATS_GIVE_ME_RESOURCE
 struct SGiveMeNewUnitCheatCommand {

Modified: branches/caiinterface/rts/ExternalAI/Interface/SAICallback.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/Interface/SAICallback.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/Interface/SAICallback.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -90,12 +90,12 @@
 // BEGINN OBJECT Resource
 int (CALLING_CONV *Clb_0MULTI1SIZE0Resource)(int teamId);
 int (CALLING_CONV *Clb_0MULTI1FETCH3ResourceByName0Resource)(int teamId, const char* resourceName);
-const char* (CALLING_CONV *Clb_Resource_getName)(int teamId, int resourceIndex);
-float (CALLING_CONV *Clb_Resource_getOptimum)(int teamId, int resourceIndex);
-float (CALLING_CONV *Clb_Economy_0REF1Resource2resourceIndex0getCurrent)(int teamId, int resourceIndex);
-float (CALLING_CONV *Clb_Economy_0REF1Resource2resourceIndex0getIncome)(int teamId, int resourceIndex);
-float (CALLING_CONV *Clb_Economy_0REF1Resource2resourceIndex0getUsage)(int teamId, int resourceIndex);
-float (CALLING_CONV *Clb_Economy_0REF1Resource2resourceIndex0getStorage)(int teamId, int resourceIndex);
+const char* (CALLING_CONV *Clb_Resource_getName)(int teamId, int resourceId);
+float (CALLING_CONV *Clb_Resource_getOptimum)(int teamId, int resourceId);
+float (CALLING_CONV *Clb_Economy_0REF1Resource2resourceId0getCurrent)(int teamId, int resourceId);
+float (CALLING_CONV *Clb_Economy_0REF1Resource2resourceId0getIncome)(int teamId, int resourceId);
+float (CALLING_CONV *Clb_Economy_0REF1Resource2resourceId0getUsage)(int teamId, int resourceId);
+float (CALLING_CONV *Clb_Economy_0REF1Resource2resourceId0getStorage)(int teamId, int resourceId);
 // END OBJECT Resource
 
 
@@ -122,15 +122,15 @@
 int (CALLING_CONV *Clb_UnitDef_getCobId)(int teamId, int unitDefId);
 int (CALLING_CONV *Clb_UnitDef_getTechLevel)(int teamId, int unitDefId);
 const char* (CALLING_CONV *Clb_UnitDef_getGaia)(int teamId, int unitDefId);
-float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceIndex0getUpkeep)(int teamId, int unitDefId, int resourceIndex);
-float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceIndex0getResourceMake)(int teamId, int unitDefId, int resourceIndex);
-float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceIndex0getMakesResource)(int teamId, int unitDefId, int resourceIndex);
-float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceIndex0getCost)(int teamId, int unitDefId, int resourceIndex);
-float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceIndex0getExtractsResource)(int teamId, int unitDefId, int resourceIndex);
-float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceIndex0getResourceExtractorRange)(int teamId, int unitDefId, int resourceIndex);
-float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceIndex0getWindResourceGenerator)(int teamId, int unitDefId, int resourceIndex);
-float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceIndex0getTidalResourceGenerator)(int teamId, int unitDefId, int resourceIndex);
-float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceIndex0getStorage)(int teamId, int unitDefId, int resourceIndex);
+float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceId0getUpkeep)(int teamId, int unitDefId, int resourceId);
+float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceId0getResourceMake)(int teamId, int unitDefId, int resourceId);
+float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceId0getMakesResource)(int teamId, int unitDefId, int resourceId);
+float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceId0getCost)(int teamId, int unitDefId, int resourceId);
+float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceId0getExtractsResource)(int teamId, int unitDefId, int resourceId);
+float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceId0getResourceExtractorRange)(int teamId, int unitDefId, int resourceId);
+float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceId0getWindResourceGenerator)(int teamId, int unitDefId, int resourceId);
+float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceId0getTidalResourceGenerator)(int teamId, int unitDefId, int resourceId);
+float (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceId0getStorage)(int teamId, int unitDefId, int resourceId);
 float (CALLING_CONV *Clb_UnitDef_getBuildTime)(int teamId, int unitDefId);
 float (CALLING_CONV *Clb_UnitDef_getAutoHeal)(int teamId, int unitDefId);
 float (CALLING_CONV *Clb_UnitDef_getIdleAutoHeal)(int teamId, int unitDefId);
@@ -298,7 +298,7 @@
 int (CALLING_CONV *Clb_UnitDef_getFlareSalvoSize)(int teamId, int unitDefId);
 int (CALLING_CONV *Clb_UnitDef_getFlareSalvoDelay)(int teamId, int unitDefId);
 bool (CALLING_CONV *Clb_UnitDef_isSmoothAnim)(int teamId, int unitDefId);
-bool (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceIndex0isResourceMaker)(int teamId, int unitDefId, int resourceIndex);
+bool (CALLING_CONV *Clb_UnitDef_0REF1Resource2resourceId0isResourceMaker)(int teamId, int unitDefId, int resourceId);
 bool (CALLING_CONV *Clb_UnitDef_isCanLoopbackAttack)(int teamId, int unitDefId);
 bool (CALLING_CONV *Clb_UnitDef_isLevelGround)(int teamId, int unitDefId);
 bool (CALLING_CONV *Clb_UnitDef_isUseBuildingGroundDecal)(int teamId, int unitDefId);
@@ -338,14 +338,14 @@
 float (CALLING_CONV *Clb_UnitDef_MoveData_getMaxBreaking)(int teamId, int unitDefId);
 bool (CALLING_CONV *Clb_UnitDef_MoveData_isSubMarine)(int teamId, int unitDefId);
 int (CALLING_CONV *Clb_UnitDef_0MULTI1SIZE0WeaponMount)(int teamId, int unitDefId);
-const char* (CALLING_CONV *Clb_UnitDef_WeaponMount_getName)(int teamId, int unitDefId, int weaponMountIndex);
-int (CALLING_CONV *Clb_UnitDef_WeaponMount_0SINGLE1FETCH2WeaponDef0getWeaponDef)(int teamId, int unitDefId, int weaponMountIndex);
-int (CALLING_CONV *Clb_UnitDef_WeaponMount_getSlavedTo)(int teamId, int unitDefId, int weaponMountIndex);
-struct SAIFloat3 (CALLING_CONV *Clb_UnitDef_WeaponMount_getMainDir)(int teamId, int unitDefId, int weaponMountIndex);
-float (CALLING_CONV *Clb_UnitDef_WeaponMount_getMaxAngleDif)(int teamId, int unitDefId, int weaponMountIndex);
-float (CALLING_CONV *Clb_UnitDef_WeaponMount_getFuelUsage)(int teamId, int unitDefId, int weaponMountIndex);
-unsigned int (CALLING_CONV *Clb_UnitDef_WeaponMount_getBadTargetCategory)(int teamId, int unitDefId, int weaponMountIndex);
-unsigned int (CALLING_CONV *Clb_UnitDef_WeaponMount_getOnlyTargetCategory)(int teamId, int unitDefId, int weaponMountIndex);
+const char* (CALLING_CONV *Clb_UnitDef_WeaponMount_getName)(int teamId, int unitDefId, int weaponMountId);
+int (CALLING_CONV *Clb_UnitDef_WeaponMount_0SINGLE1FETCH2WeaponDef0getWeaponDef)(int teamId, int unitDefId, int weaponMountId);
+int (CALLING_CONV *Clb_UnitDef_WeaponMount_getSlavedTo)(int teamId, int unitDefId, int weaponMountId);
+struct SAIFloat3 (CALLING_CONV *Clb_UnitDef_WeaponMount_getMainDir)(int teamId, int unitDefId, int weaponMountId);
+float (CALLING_CONV *Clb_UnitDef_WeaponMount_getMaxAngleDif)(int teamId, int unitDefId, int weaponMountId);
+float (CALLING_CONV *Clb_UnitDef_WeaponMount_getFuelUsage)(int teamId, int unitDefId, int weaponMountId);
+unsigned int (CALLING_CONV *Clb_UnitDef_WeaponMount_getBadTargetCategory)(int teamId, int unitDefId, int weaponMountId);
+unsigned int (CALLING_CONV *Clb_UnitDef_WeaponMount_getOnlyTargetCategory)(int teamId, int unitDefId, int weaponMountId);
 // END OBJECT UnitDef
 
 
@@ -386,27 +386,27 @@
 /* for the type of the command queue, see CCommandQueue::CommandQueueType CommandQueue.h */
 int (CALLING_CONV *Clb_Unit_CurrentCommand_0STATIC0getType)(int teamId, int unitId);
 /* for the id, see CMD_xxx codes in Command.h  (custom codes can also be used) */
-int (CALLING_CONV *Clb_Unit_CurrentCommand_getId)(int teamId, int unitId, int commandIndex);
-unsigned char (CALLING_CONV *Clb_Unit_CurrentCommand_getOptions)(int teamId, int unitId, int commandIndex);
-unsigned int (CALLING_CONV *Clb_Unit_CurrentCommand_getTag)(int teamId, int unitId, int commandIndex);
-int (CALLING_CONV *Clb_Unit_CurrentCommand_getTimeOut)(int teamId, int unitId, int commandIndex);
-int (CALLING_CONV *Clb_Unit_CurrentCommand_0ARRAY1SIZE0getParams)(int teamId, int unitId, int commandIndex);
-int (CALLING_CONV *Clb_Unit_CurrentCommand_0ARRAY1VALS0getParams)(int teamId, int unitId, int commandIndex, float params[], int params_max);
+int (CALLING_CONV *Clb_Unit_CurrentCommand_getId)(int teamId, int unitId, int commandId);
+unsigned char (CALLING_CONV *Clb_Unit_CurrentCommand_getOptions)(int teamId, int unitId, int commandId);
+unsigned int (CALLING_CONV *Clb_Unit_CurrentCommand_getTag)(int teamId, int unitId, int commandId);
+int (CALLING_CONV *Clb_Unit_CurrentCommand_getTimeOut)(int teamId, int unitId, int commandId);
+int (CALLING_CONV *Clb_Unit_CurrentCommand_0ARRAY1SIZE0getParams)(int teamId, int unitId, int commandId);
+int (CALLING_CONV *Clb_Unit_CurrentCommand_0ARRAY1VALS0getParams)(int teamId, int unitId, int commandId, float params[], int params_max);
 int (CALLING_CONV *Clb_Unit_0MULTI1SIZE0SupportedCommand)(int teamId, int unitId);
 /* for the id, see CMD_xxx codes in Command.h  (custom codes can also be used) */
-int (CALLING_CONV *Clb_Unit_SupportedCommand_getId)(int teamId, int unitId, int commandIndex);
-const char* (CALLING_CONV *Clb_Unit_SupportedCommand_getName)(int teamId, int unitId, int commandIndex);
-const char* (CALLING_CONV *Clb_Unit_SupportedCommand_getToolTip)(int teamId, int unitId, int commandIndex);
-bool (CALLING_CONV *Clb_Unit_SupportedCommand_isShowUnique)(int teamId, int unitId, int commandIndex);
-bool (CALLING_CONV *Clb_Unit_SupportedCommand_isDisabled)(int teamId, int unitId, int commandIndex);
-int (CALLING_CONV *Clb_Unit_SupportedCommand_0ARRAY1SIZE0getParams)(int teamId, int unitId, int commandIndex);
-int (CALLING_CONV *Clb_Unit_SupportedCommand_0ARRAY1VALS0getParams)(int teamId, int unitId, int commandIndex, const char* params[], int params_max);
+int (CALLING_CONV *Clb_Unit_SupportedCommand_getId)(int teamId, int unitId, int commandId);
+const char* (CALLING_CONV *Clb_Unit_SupportedCommand_getName)(int teamId, int unitId, int commandId);
+const char* (CALLING_CONV *Clb_Unit_SupportedCommand_getToolTip)(int teamId, int unitId, int commandId);
+bool (CALLING_CONV *Clb_Unit_SupportedCommand_isShowUnique)(int teamId, int unitId, int commandId);
+bool (CALLING_CONV *Clb_Unit_SupportedCommand_isDisabled)(int teamId, int unitId, int commandId);
+int (CALLING_CONV *Clb_Unit_SupportedCommand_0ARRAY1SIZE0getParams)(int teamId, int unitId, int commandId);
+int (CALLING_CONV *Clb_Unit_SupportedCommand_0ARRAY1VALS0getParams)(int teamId, int unitId, int commandId, const char* params[], int params_max);
 float (CALLING_CONV *Clb_Unit_getHealth)(int teamId, int unitId);
 float (CALLING_CONV *Clb_Unit_getSpeed)(int teamId, int unitId);
 float (CALLING_CONV *Clb_Unit_getPower)(int teamId, int unitId);
 int (CALLING_CONV *Clb_Unit_0MULTI1SIZE0ResourceInfo)(int teamId, int unitId);
-float (CALLING_CONV *Clb_Unit_0REF1Resource2resourceIndex0getResourceUse)(int teamId, int unitId, int resourceIndex);
-float (CALLING_CONV *Clb_Unit_0REF1Resource2resourceIndex0getResourceMake)(int teamId, int unitId, int resourceIndex);
+float (CALLING_CONV *Clb_Unit_0REF1Resource2resourceId0getResourceUse)(int teamId, int unitId, int resourceId);
+float (CALLING_CONV *Clb_Unit_0REF1Resource2resourceId0getResourceMake)(int teamId, int unitId, int resourceId);
 struct SAIFloat3 (CALLING_CONV *Clb_Unit_getPos)(int teamId, int unitId);
 bool (CALLING_CONV *Clb_Unit_isActivated)(int teamId, int unitId);
 bool (CALLING_CONV *Clb_Unit_isBeingBuilt)(int teamId, int unitId);
@@ -423,13 +423,13 @@
 int (CALLING_CONV *Clb_0MULTI1VALS0Group)(int teamId, int groupIds[], int groupIds_max);
 int (CALLING_CONV *Clb_Group_0MULTI1SIZE0SupportedCommand)(int teamId, int groupId);
 /* for the id, see CMD_xxx codes in Command.h  (custom codes can also be used) */
-int (CALLING_CONV *Clb_Group_SupportedCommand_getId)(int teamId, int groupId, int commandIndex);
-const char* (CALLING_CONV *Clb_Group_SupportedCommand_getName)(int teamId, int groupId, int commandIndex);
-const char* (CALLING_CONV *Clb_Group_SupportedCommand_getToolTip)(int teamId, int groupId, int commandIndex);
-bool (CALLING_CONV *Clb_Group_SupportedCommand_isShowUnique)(int teamId, int groupId, int commandIndex);
-bool (CALLING_CONV *Clb_Group_SupportedCommand_isDisabled)(int teamId, int groupId, int commandIndex);
-int (CALLING_CONV *Clb_Group_SupportedCommand_0ARRAY1SIZE0getParams)(int teamId, int groupId, int commandIndex);
-int (CALLING_CONV *Clb_Group_SupportedCommand_0ARRAY1VALS0getParams)(int teamId, int groupId, int commandIndex, const char* params[], int params_max);
+int (CALLING_CONV *Clb_Group_SupportedCommand_getId)(int teamId, int groupId, int commandId);
+const char* (CALLING_CONV *Clb_Group_SupportedCommand_getName)(int teamId, int groupId, int commandId);
+const char* (CALLING_CONV *Clb_Group_SupportedCommand_getToolTip)(int teamId, int groupId, int commandId);
+bool (CALLING_CONV *Clb_Group_SupportedCommand_isShowUnique)(int teamId, int groupId, int commandId);
+bool (CALLING_CONV *Clb_Group_SupportedCommand_isDisabled)(int teamId, int groupId, int commandId);
+int (CALLING_CONV *Clb_Group_SupportedCommand_0ARRAY1SIZE0getParams)(int teamId, int groupId, int commandId);
+int (CALLING_CONV *Clb_Group_SupportedCommand_0ARRAY1VALS0getParams)(int teamId, int groupId, int commandId, const char* params[], int params_max);
 /* for the id, see CMD_xxx codes in Command.h  (custom codes can also be used) */
 int (CALLING_CONV *Clb_Group_OrderPreview_getId)(int teamId, int groupId);
 unsigned char (CALLING_CONV *Clb_Group_OrderPreview_getOptions)(int teamId, int groupId);
@@ -467,12 +467,12 @@
 int (CALLING_CONV *Clb_Map_0ARRAY1VALS0getRadarMap)(int teamId, unsigned short radarValues[], int radarValues_max);
 int (CALLING_CONV *Clb_Map_0ARRAY1SIZE0getJammerMap)(int teamId);
 int (CALLING_CONV *Clb_Map_0ARRAY1VALS0getJammerMap)(int teamId, unsigned short jammerValues[], int jammerValues_max);
-int (CALLING_CONV *Clb_Map_0ARRAY1SIZE0REF1Resource2resourceIndex0getResourceMap)(int teamId, int resourceIndex);
-int (CALLING_CONV *Clb_Map_0ARRAY1VALS0REF1Resource2resourceIndex0getResourceMap)(int teamId, int resourceIndex, unsigned char resources[], int resources_max);
+int (CALLING_CONV *Clb_Map_0ARRAY1SIZE0REF1Resource2resourceId0getResourceMap)(int teamId, int resourceId);
+int (CALLING_CONV *Clb_Map_0ARRAY1VALS0REF1Resource2resourceId0getResourceMap)(int teamId, int resourceId, unsigned char resources[], int resources_max);
 const char* (CALLING_CONV *Clb_Map_getName)(int teamId);
 float (CALLING_CONV *Clb_Map_getElevationAt)(int teamId, float x, float z);
-float (CALLING_CONV *Clb_Map_0REF1Resource2resourceIndex0getMaxResource)(int teamId, int resourceIndex);
-float (CALLING_CONV *Clb_Map_0REF1Resource2resourceIndex0getExtractorRadius)(int teamId, int resourceIndex);
+float (CALLING_CONV *Clb_Map_0REF1Resource2resourceId0getMaxResource)(int teamId, int resourceId);
+float (CALLING_CONV *Clb_Map_0REF1Resource2resourceId0getExtractorRadius)(int teamId, int resourceId);
 float (CALLING_CONV *Clb_Map_getMinWind)(int teamId);
 float (CALLING_CONV *Clb_Map_getMaxWind)(int teamId);
 float (CALLING_CONV *Clb_Map_getTidalStrength)(int teamId);
@@ -481,14 +481,14 @@
 //int (CALLING_CONV *Clb_Map_getLines)(int teamId, struct SAIFloat3 firstPositions[], struct SAIFloat3 secondPositions[], unsigned char colors[][3], int maxLines);
 //int (CALLING_CONV *Clb_Map_getPoints)(int teamId, struct SAIFloat3 positions[], struct SAIFloat3 colors[], const char* labels[], int maxPoints);
 int (CALLING_CONV *Clb_Map_0MULTI1SIZE0Point)(int teamId);
-struct SAIFloat3 (CALLING_CONV *Clb_Map_Point_getPosition)(int teamId, int pointIndex);
-struct SAIFloat3 (CALLING_CONV *Clb_Map_Point_getColor)(int teamId, int pointIndex);
-const char* (CALLING_CONV *Clb_Map_Point_getLabel)(int teamId, int pointIndex);
+struct SAIFloat3 (CALLING_CONV *Clb_Map_Point_getPosition)(int teamId, int pointId);
+struct SAIFloat3 (CALLING_CONV *Clb_Map_Point_getColor)(int teamId, int pointId);
+const char* (CALLING_CONV *Clb_Map_Point_getLabel)(int teamId, int pointId);
 //int (CALLING_CONV *Clb_Map_getLines)(int teamId, struct SAIFloat3 firstPositions[], struct SAIFloat3 secondPositions[], struct SAIFloat3 colors[], int maxLines);
 int (CALLING_CONV *Clb_Map_0MULTI1SIZE0Line)(int teamId);
-struct SAIFloat3 (CALLING_CONV *Clb_Map_Line_getFirstPosition)(int teamId, int lineIndex);
-struct SAIFloat3 (CALLING_CONV *Clb_Map_Line_getSecondPosition)(int teamId, int lineIndex);
-struct SAIFloat3 (CALLING_CONV *Clb_Map_Line_getColor)(int teamId, int lineIndex);
+struct SAIFloat3 (CALLING_CONV *Clb_Map_Line_getFirstPosition)(int teamId, int lineId);
+struct SAIFloat3 (CALLING_CONV *Clb_Map_Line_getSecondPosition)(int teamId, int lineId);
+struct SAIFloat3 (CALLING_CONV *Clb_Map_Line_getColor)(int teamId, int lineId);
 bool (CALLING_CONV *Clb_Map_canBuildAt)(int teamId, int unitDefId, struct SAIFloat3 pos, int facing);
 struct SAIFloat3 (CALLING_CONV *Clb_Map_findClosestBuildSite)(int teamId, int unitDefId, struct SAIFloat3 pos, float searchRadius, int minDist, int facing);
 // BEGINN OBJECT Map
@@ -502,7 +502,7 @@
 const char* (CALLING_CONV *Clb_FeatureDef_getName)(int teamId, int featureDefId);
 const char* (CALLING_CONV *Clb_FeatureDef_getDescription)(int teamId, int featureDefId);
 const char* (CALLING_CONV *Clb_FeatureDef_getFileName)(int teamId, int featureDefId);
-float (CALLING_CONV *Clb_FeatureDef_0REF1Resource2resourceIndex0getContainedResource)(int teamId, int featureDefId, int resourceIndex);
+float (CALLING_CONV *Clb_FeatureDef_0REF1Resource2resourceId0getContainedResource)(int teamId, int featureDefId, int resourceId);
 float (CALLING_CONV *Clb_FeatureDef_getMaxHealth)(int teamId, int featureDefId);
 float (CALLING_CONV *Clb_FeatureDef_getReclaimTime)(int teamId, int featureDefId);
 float (CALLING_CONV *Clb_FeatureDef_getMass)(int teamId, int featureDefId);
@@ -574,7 +574,7 @@
 float (CALLING_CONV *Clb_WeaponDef_Damage_getImpulseBoost)(int teamId, int weaponDefId);
 float (CALLING_CONV *Clb_WeaponDef_Damage_getCraterMult)(int teamId, int weaponDefId);
 float (CALLING_CONV *Clb_WeaponDef_Damage_getCraterBoost)(int teamId, int weaponDefId);
-//float (CALLING_CONV *Clb_WeaponDef_Damage_getType)(int teamId, int weaponDefId, int typeIndex);
+//float (CALLING_CONV *Clb_WeaponDef_Damage_getType)(int teamId, int weaponDefId, int typeId);
 int (CALLING_CONV *Clb_WeaponDef_Damage_0ARRAY1SIZE0getTypes)(int teamId, int weaponDefId);
 int (CALLING_CONV *Clb_WeaponDef_Damage_0ARRAY1VALS0getTypes)(int teamId, int weaponDefId, float types[], int types_max);
 
@@ -600,7 +600,7 @@
 float (CALLING_CONV *Clb_WeaponDef_getRestTime)(int teamId, int weaponDefId);
 float (CALLING_CONV *Clb_WeaponDef_getUpTime)(int teamId, int weaponDefId);
 int (CALLING_CONV *Clb_WeaponDef_getFlightTime)(int teamId, int weaponDefId);
-float (CALLING_CONV *Clb_WeaponDef_0REF1Resource2resourceIndex0getCost)(int teamId, int weaponDefId, int resourceIndex);
+float (CALLING_CONV *Clb_WeaponDef_0REF1Resource2resourceId0getCost)(int teamId, int weaponDefId, int resourceId);
 float (CALLING_CONV *Clb_WeaponDef_getSupplyCost)(int teamId, int weaponDefId);
 int (CALLING_CONV *Clb_WeaponDef_getProjectilesPerShot)(int teamId, int weaponDefId);
 int (CALLING_CONV *Clb_WeaponDef_getTdfId)(int teamId, int weaponDefId);
@@ -653,13 +653,13 @@
 bool (CALLING_CONV *Clb_WeaponDef_isVisibleShield)(int teamId, int weaponDefId);
 bool (CALLING_CONV *Clb_WeaponDef_isVisibleShieldRepulse)(int teamId, int weaponDefId);
 int (CALLING_CONV *Clb_WeaponDef_getVisibleShieldHitFrames)(int teamId, int weaponDefId);
-float (CALLING_CONV *Clb_WeaponDef_Shield_0REF1Resource2resourceIndex0getResourceUse)(int teamId, int weaponDefId, int resourceIndex);
+float (CALLING_CONV *Clb_WeaponDef_Shield_0REF1Resource2resourceId0getResourceUse)(int teamId, int weaponDefId, int resourceId);
 float (CALLING_CONV *Clb_WeaponDef_Shield_getRadius)(int teamId, int weaponDefId);
 float (CALLING_CONV *Clb_WeaponDef_Shield_getForce)(int teamId, int weaponDefId);
 float (CALLING_CONV *Clb_WeaponDef_Shield_getMaxSpeed)(int teamId, int weaponDefId);
 float (CALLING_CONV *Clb_WeaponDef_Shield_getPower)(int teamId, int weaponDefId);
 float (CALLING_CONV *Clb_WeaponDef_Shield_getPowerRegen)(int teamId, int weaponDefId);
-float (CALLING_CONV *Clb_WeaponDef_Shield_0REF1Resource2resourceIndex0getPowerRegenResource)(int teamId, int weaponDefId, int resourceIndex);
+float (CALLING_CONV *Clb_WeaponDef_Shield_0REF1Resource2resourceId0getPowerRegenResource)(int teamId, int weaponDefId, int resourceId);
 float (CALLING_CONV *Clb_WeaponDef_Shield_getStartingPower)(int teamId, int weaponDefId);
 int (CALLING_CONV *Clb_WeaponDef_Shield_getRechargeDelay)(int teamId, int weaponDefId);
 struct SAIFloat3 (CALLING_CONV *Clb_WeaponDef_Shield_getGoodColor)(int teamId, int weaponDefId);

Modified: branches/caiinterface/rts/ExternalAI/Interface/SAIInterfaceLibrary.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/Interface/SAIInterfaceLibrary.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/Interface/SAIInterfaceLibrary.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -21,88 +21,88 @@
 #include &lt;string.h&gt;
 #include &lt;stdlib.h&gt;
 
-struct SAIInterfaceSpecifier copySAIInterfaceSpecifier(const struct SAIInterfaceSpecifier* const orig) {
+//struct SAIInterfaceSpecifier copySAIInterfaceSpecifier(const struct SAIInterfaceSpecifier* const orig) {
+//
+//	struct SAIInterfaceSpecifier copy;
+//
+//	char* tmpStr = (char *) malloc(sizeof(char) * strlen(orig-&gt;shortName) + 1);
+//	strcpy(tmpStr, orig-&gt;shortName);
+//	copy.shortName = tmpStr;
+//
+//	tmpStr = (char *) malloc(sizeof(char) * strlen(orig-&gt;version) + 1);
+//	strcpy(tmpStr, orig-&gt;version);
+//	copy.version = tmpStr;
+//
+//	return copy;
+//}
+//void deleteSAIInterfaceSpecifier(const struct SAIInterfaceSpecifier* const spec) {
+//	free(const_cast&lt;char*&gt;(spec-&gt;shortName));
+//	free(const_cast&lt;char*&gt;(spec-&gt;version));
+//}
 
-	struct SAIInterfaceSpecifier copy;
 
-	char* tmpStr = (char *) malloc(sizeof(char) * strlen(orig-&gt;shortName) + 1);
-	strcpy(tmpStr, orig-&gt;shortName);
-	copy.shortName = tmpStr;
-
-	tmpStr = (char *) malloc(sizeof(char) * strlen(orig-&gt;version) + 1);
-	strcpy(tmpStr, orig-&gt;version);
-	copy.version = tmpStr;
-
-	return copy;
-}
-void deleteSAIInterfaceSpecifier(const struct SAIInterfaceSpecifier* const spec) {
-	free(const_cast&lt;char*&gt;(spec-&gt;shortName));
-	free(const_cast&lt;char*&gt;(spec-&gt;version));
-}
-
-
 #ifdef	__cplusplus
 
-CR_BIND(SSAIKey,)
-//CR_BIND(SGAIKey,)
+//CR_BIND(SSAIKey,)
+////CR_BIND(SGAIKey,)
+//
+//bool SAIInterfaceSpecifier_Comparator::operator()(const struct SAIInterfaceSpecifier&amp; a, const struct SAIInterfaceSpecifier&amp; b) const {
+//
+//	bool isLess = false;
+//
+//	int shortNameComp = strcmp(a.shortName, b.shortName);
+//	if (shortNameComp &lt; 0) {
+//		return isLess = true;
+//	} else if (shortNameComp == 0) {
+//		int versionComp = strcmp(a.version, b.version);
+//
+//		if (versionComp &lt; 0) {
+//			isLess = true;
+//		}
+//	}
+//
+//	return isLess;
+//}
+//bool SAIInterfaceSpecifier_Comparator::IsEmpty(const struct SAIInterfaceSpecifier&amp; spec) {
+//
+//	bool empty = false;
+//
+//	if (spec.shortName == NULL || spec.version == NULL) {
+//		empty = true;
+//	}
+//
+//	return empty;
+//}
+//
+//bool SSAIKey_Comparator::operator()(const struct SSAIKey&amp; a, const struct SSAIKey&amp; b) const {
+//
+//	bool isLess = false;
+//
+//	bool interfaceLess = SAIInterfaceSpecifier_Comparator()(a.interface, b.interface);
+//	if (interfaceLess) {
+//		isLess = true;
+//	} else if (!(SAIInterfaceSpecifier_Comparator()(b.interface, a.interface))) { // -&gt; interfaces are equal
+//		bool aiLess = SSAISpecifier_Comparator()(a.ai, b.ai);
+//
+//		if (aiLess) {
+//			isLess = true;
+//		}
+//	}
+//
+//	return isLess;
+//}
+//bool SSAIKey_Comparator::IsEmpty(const struct SSAIKey&amp; key) {
+//
+//	bool empty = false;
+//
+//	if (SAIInterfaceSpecifier_Comparator::IsEmpty(key.interface)
+//			|| SSAISpecifier_Comparator::IsEmpty(key.ai)) {
+//		empty = true;
+//	}
+//
+//	return empty;
+//}
 
-bool SAIInterfaceSpecifier_Comparator::operator()(const struct SAIInterfaceSpecifier&amp; a, const struct SAIInterfaceSpecifier&amp; b) const {
-
-	bool isLess = false;
-
-	int shortNameComp = strcmp(a.shortName, b.shortName);
-	if (shortNameComp &lt; 0) {
-		return isLess = true;
-	} else if (shortNameComp == 0) {
-		int versionComp = strcmp(a.version, b.version);
-
-		if (versionComp &lt; 0) {
-			isLess = true;
-		}
-	}
-
-	return isLess;
-}
-bool SAIInterfaceSpecifier_Comparator::IsEmpty(const struct SAIInterfaceSpecifier&amp; spec) {
-
-	bool empty = false;
-
-	if (spec.shortName == NULL || spec.version == NULL) {
-		empty = true;
-	}
-
-	return empty;
-}
-
-bool SSAIKey_Comparator::operator()(const struct SSAIKey&amp; a, const struct SSAIKey&amp; b) const {
-
-	bool isLess = false;
-
-	bool interfaceLess = SAIInterfaceSpecifier_Comparator()(a.interface, b.interface);
-	if (interfaceLess) {
-		isLess = true;
-	} else if (!(SAIInterfaceSpecifier_Comparator()(b.interface, a.interface))) { // -&gt; interfaces are equal
-		bool aiLess = SSAISpecifier_Comparator()(a.ai, b.ai);
-
-		if (aiLess) {
-			isLess = true;
-		}
-	}
-
-	return isLess;
-}
-bool SSAIKey_Comparator::IsEmpty(const struct SSAIKey&amp; key) {
-
-	bool empty = false;
-
-	if (SAIInterfaceSpecifier_Comparator::IsEmpty(key.interface)
-			|| SSAISpecifier_Comparator::IsEmpty(key.ai)) {
-		empty = true;
-	}
-
-	return empty;
-}
-
 //bool SGAIKey_Comparator::operator()(const struct SGAIKey&amp; a, const struct SGAIKey&amp; b) const {
 //
 //	bool isLess = false;

Modified: branches/caiinterface/rts/ExternalAI/Interface/SAIInterfaceLibrary.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/Interface/SAIInterfaceLibrary.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/Interface/SAIInterfaceLibrary.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -42,29 +42,29 @@
 #define AI_INTERFACE_PROPERTY_SUPPORTED_LANGUAGES    &quot;supportedLanguages&quot;    // [string]
 #define AI_INTERFACE_PROPERTY_ENGINE_VERSION         &quot;engineVersion&quot;         // [int] the engine version number the AI was compiled, but may work with newer or older ones too
 
-/**
- * @brief struct Artificial Intelligence Interface Specifier
- */
-struct SAIInterfaceSpecifier {
-	const char* shortName; // [may not contain: spaces, '_', '#']
-	const char* version; // [may not contain: spaces, '_', '#']
-};
+///**
+// * @brief struct Artificial Intelligence Interface Specifier
+// */
+//struct SAIInterfaceSpecifier {
+//	const char* shortName; // [may not contain: spaces, '_', '#']
+//	const char* version; // [may not contain: spaces, '_', '#']
+//};
 
-struct SAIInterfaceSpecifier copySAIInterfaceSpecifier(
-		const struct SAIInterfaceSpecifier* const orig);
-void deleteSAIInterfaceSpecifier(
-		const struct SAIInterfaceSpecifier* const spec);
+//struct SAIInterfaceSpecifier copySAIInterfaceSpecifier(
+//		const struct SAIInterfaceSpecifier* const orig);
+//void deleteSAIInterfaceSpecifier(
+//		const struct SAIInterfaceSpecifier* const spec);
 
 
-/**
- * @brief struct Skirmish Artificial Intelligence Key
- * Compleetly specifies a skirmish AI together with an interface.
- */
-struct SSAIKey {
-	CR_DECLARE_STRUCT(SSAIKey);
-	struct SAIInterfaceSpecifier interface;
-	struct SSAISpecifier ai;
-};
+///**
+// * @brief struct Skirmish Artificial Intelligence Key
+// * Compleetly specifies a skirmish AI together with an interface.
+// */
+//struct SSAIKey {
+//	CR_DECLARE_STRUCT(SSAIKey);
+//	struct SAIInterfaceSpecifier interface;
+//	struct SSAISpecifier ai;
+//};
 
 /**
  * @brief struct Group Artificial Intelligence Key
@@ -202,29 +202,29 @@
 
 
 #ifdef	__cplusplus
-struct SAIInterfaceSpecifier_Comparator {
-	/**
-	 * The key comparison function, a Strict Weak Ordering;
-	 * it returns true if its first argument is less
-	 * than its second argument, and false otherwise.
-	 * This is also defined as map::key_compare.
-	 */
-	bool operator()(const struct SAIInterfaceSpecifier&amp; a,
-			const struct SAIInterfaceSpecifier&amp; b) const;
-	static bool IsEmpty(const struct SAIInterfaceSpecifier&amp; spec);
-};
+//struct SAIInterfaceSpecifier_Comparator {
+//	/**
+//	 * The key comparison function, a Strict Weak Ordering;
+//	 * it returns true if its first argument is less
+//	 * than its second argument, and false otherwise.
+//	 * This is also defined as map::key_compare.
+//	 */
+//	bool operator()(const struct SAIInterfaceSpecifier&amp; a,
+//			const struct SAIInterfaceSpecifier&amp; b) const;
+//	static bool IsEmpty(const struct SAIInterfaceSpecifier&amp; spec);
+//};
+//
+//struct SSAIKey_Comparator {
+//	/**
+//	 * The key comparison function, a Strict Weak Ordering;
+//	 * it returns true if its first argument is less
+//	 * than its second argument, and false otherwise.
+//	 * This is also defined as map::key_compare.
+//	 */
+//	bool operator()(const struct SSAIKey&amp; a, const struct SSAIKey&amp; b) const;
+//	static bool IsEmpty(const struct SSAIKey&amp; key);
+//};
 
-struct SSAIKey_Comparator {
-	/**
-	 * The key comparison function, a Strict Weak Ordering;
-	 * it returns true if its first argument is less
-	 * than its second argument, and false otherwise.
-	 * This is also defined as map::key_compare.
-	 */
-	bool operator()(const struct SSAIKey&amp; a, const struct SSAIKey&amp; b) const;
-	static bool IsEmpty(const struct SSAIKey&amp; key);
-};
-
 //struct SGAIKey_Comparator {
 //	/**
 //	 * The key comparison function, a Strict Weak Ordering;

Modified: branches/caiinterface/rts/ExternalAI/Interface/SInfo.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/Interface/SInfo.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/Interface/SInfo.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -1,6 +1,6 @@
 /*
 	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
-	
+
 	This program is free software; you can redistribute it and/or modify
 	it under the terms of the GNU General Public License as published by
 	the Free Software Foundation; either version 2 of the License, or
@@ -116,10 +116,13 @@
 	unsigned int i = 0;
 	std::set&lt;std::string&gt; infoSet;
 	for (int index = 1; root.KeyExists(index) &amp;&amp; i &lt; max; index++) {
-		InfoItem infoItem;
-		if (ParseInfo(root, index, infoItem, infoSet)) {
-			info[i++] = infoItem;
+		bool parseOk = ParseInfo(root, index, info[i], infoSet);
+		if (!parseOk) {
+			info[i].key = NULL;
+			info[i].value = NULL;
+			info[i].desc = NULL;
 		}
+		i++;
 	}
 	
 	return i;
@@ -130,5 +133,4 @@
 	return ParseInfo(fileName, SPRING_VFS_RAW, SPRING_VFS_RAW, info, max);
 }
 
-#endif	/* defined(__cplusplus) &amp;&amp; !defined(BUILDING_AI) &amp;&amp; !defined(BUILDING_AI_INTERFACE) */
-
+#endif // defined(__cplusplus) &amp;&amp; !defined(BUILDING_AI) &amp;&amp; !defined(BUILDING_AI_INTERFACE)

Modified: branches/caiinterface/rts/ExternalAI/Interface/SSAILibrary.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/Interface/SSAILibrary.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/Interface/SSAILibrary.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -15,61 +15,61 @@
 	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
 */
 
-#include &quot;SSAILibrary.h&quot;
-
-#include &lt;string.h&gt;
-#include &lt;stdlib.h&gt;
-
-
-#if !defined BUILDING_AI
-struct SSAISpecifier copySSAISpecifier(const struct SSAISpecifier* const orig) {
-	
-	struct SSAISpecifier copy;
-	
-	char* tmpStr = (char *) malloc(sizeof(char) * (strlen(orig-&gt;shortName) + 1));
-	strcpy(tmpStr, orig-&gt;shortName);
-	copy.shortName = tmpStr;
-	
-	tmpStr = (char *) malloc(sizeof(char) * (strlen(orig-&gt;version) + 1));
-	strcpy(tmpStr, orig-&gt;version);
-	copy.version = tmpStr;
-	
-	return copy;
-}
-void deleteSSAISpecifier(const struct SSAISpecifier* const spec) {
-	free(const_cast&lt;char*&gt;(spec-&gt;shortName));
-	free(const_cast&lt;char*&gt;(spec-&gt;version));
-}
-
-#ifdef	__cplusplus
-
-bool SSAISpecifier_Comparator::operator()(const struct SSAISpecifier&amp; a, const struct SSAISpecifier&amp; b) const {
-
-	bool isLess = false;
-	
-	int shortNameComp = strcmp(a.shortName, b.shortName);
-	if (shortNameComp &lt; 0) {
-		return isLess = true;
-	} else if (shortNameComp == 0) {
-		int versionComp = strcmp(a.version, b.version);
-		
-		if (versionComp &lt; 0) {
-			isLess = true;
-		}
-	}
-
-	return isLess;
-}
-bool SSAISpecifier_Comparator::IsEmpty(const struct SSAISpecifier&amp; spec) {
-	
-	bool empty = false;
-	
-	if (spec.shortName == NULL || spec.version == NULL) {
-		empty = true;
-	}
-	
-	return empty;
-}
-
-#endif	// defined __cplusplus
-#endif	// !defined BUILDING_AI
+//#include &quot;SSAILibrary.h&quot;
+//
+//#include &lt;string.h&gt;
+//#include &lt;stdlib.h&gt;
+//
+//
+//#if !defined BUILDING_AI
+//struct SSAISpecifier copySSAISpecifier(const struct SSAISpecifier* const orig) {
+//
+//	struct SSAISpecifier copy;
+//
+//	char* tmpStr = (char *) malloc(sizeof(char) * (strlen(orig-&gt;shortName) + 1));
+//	strcpy(tmpStr, orig-&gt;shortName);
+//	copy.shortName = tmpStr;
+//
+//	tmpStr = (char *) malloc(sizeof(char) * (strlen(orig-&gt;version) + 1));
+//	strcpy(tmpStr, orig-&gt;version);
+//	copy.version = tmpStr;
+//
+//	return copy;
+//}
+//void deleteSSAISpecifier(const struct SSAISpecifier* const spec) {
+//	free(const_cast&lt;char*&gt;(spec-&gt;shortName));
+//	free(const_cast&lt;char*&gt;(spec-&gt;version));
+//}
+//
+//#ifdef	__cplusplus
+//
+//bool SSAISpecifier_Comparator::operator()(const struct SSAISpecifier&amp; a, const struct SSAISpecifier&amp; b) const {
+//
+//	bool isLess = false;
+//
+//	int shortNameComp = strcmp(a.shortName, b.shortName);
+//	if (shortNameComp &lt; 0) {
+//		return isLess = true;
+//	} else if (shortNameComp == 0) {
+//		int versionComp = strcmp(a.version, b.version);
+//
+//		if (versionComp &lt; 0) {
+//			isLess = true;
+//		}
+//	}
+//
+//	return isLess;
+//}
+//bool SSAISpecifier_Comparator::IsEmpty(const struct SSAISpecifier&amp; spec) {
+//
+//	bool empty = false;
+//
+//	if (spec.shortName == NULL || spec.version == NULL) {
+//		empty = true;
+//	}
+//
+//	return empty;
+//}
+//
+//#endif	// defined __cplusplus
+//#endif	// !defined BUILDING_AI

Modified: branches/caiinterface/rts/ExternalAI/Interface/SSAILibrary.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/Interface/SSAILibrary.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/Interface/SSAILibrary.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -16,7 +16,7 @@
 */
 
 #ifndef _SSAILIBRARY_H
-#define	_SSAILIBRARY_H
+#define _SSAILIBRARY_H
 
 #ifdef	__cplusplus
 extern &quot;C&quot; {
@@ -40,30 +40,30 @@
 #define SKIRMISH_AI_PROPERTY_INTERFACE_VERSION       &quot;interfaceVersion&quot;      // [string: [a-zA-Z0-9_.]*] the interface version number the AI was compiled, but may work with newer or older ones too
 
 #if !defined BUILDING_AI
-/**
- * @brief struct Skirmish Artificial Intelligence Specifier
- */
-struct SSAISpecifier {
-	const char* shortName; // [may not contain: spaces, '_', '#']
-	const char* version; // [may not contain: spaces, '_', '#']
-};
-
-struct SSAISpecifier copySSAISpecifier(const struct SSAISpecifier* const orig);
-void deleteSSAISpecifier(const struct SSAISpecifier* const spec);
-
-#if defined __cplusplus
-struct SSAISpecifier_Comparator {
-	/**
-	 * The key comparison function, a Strict Weak Ordering;
-	 * it returns true if its first argument is less
-	 * than its second argument, and false otherwise.
-	 * This is also defined as map::key_compare.
-	 */
-	bool operator()(const struct SSAISpecifier&amp; a,
-			const struct SSAISpecifier&amp; b) const;
-	static bool IsEmpty(const struct SSAISpecifier&amp; spec);
-};
-#endif	// defined __cplusplus
+///**
+// * @brief struct Skirmish Artificial Intelligence Specifier
+// */
+//struct SSAISpecifier {
+//	const char* shortName; // [may not contain: spaces, '_', '#']
+//	const char* version; // [may not contain: spaces, '_', '#']
+//};
+//
+//struct SSAISpecifier copySSAISpecifier(const struct SSAISpecifier* const orig);
+//void deleteSSAISpecifier(const struct SSAISpecifier* const spec);
+//
+//#if defined __cplusplus
+//struct SSAISpecifier_Comparator {
+//	/**
+//	 * The key comparison function, a Strict Weak Ordering;
+//	 * it returns true if its first argument is less
+//	 * than its second argument, and false otherwise.
+//	 * This is also defined as map::key_compare.
+//	 */
+//	bool operator()(const struct SSAISpecifier&amp; a,
+//			const struct SSAISpecifier&amp; b) const;
+//	static bool IsEmpty(const struct SSAISpecifier&amp; spec);
+//};
+//#endif	// defined __cplusplus
 #endif	// !defined BUILDING_AI
 
 /**
@@ -209,4 +209,4 @@
 }	// extern &quot;C&quot;
 #endif
 
-#endif	// _SSAILIBRARY_H
+#endif // _SSAILIBRARY_H

Added: branches/caiinterface/rts/ExternalAI/Interface/SSkirmishAISpecifier.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/Interface/SSkirmishAISpecifier.cpp	                        (rev 0)
+++ branches/caiinterface/rts/ExternalAI/Interface/SSkirmishAISpecifier.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -0,0 +1,128 @@
+/*
+	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
+
+	This program is free software; you can redistribute it and/or modify
+	it under the terms of the GNU General Public License as published by
+	the Free Software Foundation; either version 2 of the License, or
+	(at your option) any later version.
+
+	This program is distributed in the hope that it will be useful,
+	but WITHOUT ANY WARRANTY; without even the implied warranty of
+	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+	GNU General Public License for more details.
+
+	You should have received a copy of the GNU General Public License
+	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#include &quot;SSkirmishAISpecifier.h&quot;
+
+#include &lt;string.h&gt;
+#include &lt;stdlib.h&gt;
+
+
+#if defined BUILDING_AI_INTERFACE
+struct SSkirmishAISpecifier SSkirmishAISpecifier_copy(
+		const struct SSkirmishAISpecifier* const orig) {
+
+	struct SSkirmishAISpecifier copy;
+
+	char* tmpStr = (char *) malloc(sizeof(char) * (strlen(orig-&gt;shortName) + 1));
+	strcpy(tmpStr, orig-&gt;shortName);
+	copy.shortName = tmpStr;
+
+	tmpStr = (char *) malloc(sizeof(char) * (strlen(orig-&gt;version) + 1));
+	strcpy(tmpStr, orig-&gt;version);
+	copy.version = tmpStr;
+
+	return copy;
+}
+
+void SSkirmishAISpecifier_delete(
+		const struct SSkirmishAISpecifier* const spec) {
+	free(const_cast&lt;char*&gt;(spec-&gt;shortName));
+	free(const_cast&lt;char*&gt;(spec-&gt;version));
+}
+
+
+
+// by DeeViLiSh
+static int string_simpleHash(const char* const input) {
+
+	int b    = 378551; // Ramdom Ranges I've chosen (can be modified)
+	int a    = 63689;
+	int hash = 0;      // Output hash
+	int i;             // Temp number that scrolls through the string array
+
+	int size = strlen(input);
+	for(i = 0; i &lt; size; i++) { // Loop to convert each character
+		hash = hash * a + input[i];       // Algorithm that hashs
+		a    = a * b;
+	}
+
+	return (hash &amp; 0x7FFFFFFF); // Returns the hashed string
+}
+
+int SSkirmishAISpecifier_hash(
+		const struct SSkirmishAISpecifier* const spec) {
+
+	bool useShortName = spec-&gt;shortName != NULL;
+	bool useVersion = spec-&gt;version != NULL;
+
+	int size_hashString = 0;
+	if (useShortName) {
+		size_hashString += strlen(spec-&gt;shortName);
+	}
+	size_hashString += 1; // for the '#' char
+	if (useVersion) {
+		size_hashString += strlen(spec-&gt;version);
+	}
+	size_hashString += 1; // for the '\0' char
+
+	char hashString[size_hashString];
+	hashString[0] = '\0';
+
+	if (useShortName) {
+		strcat(hashString, spec-&gt;shortName);
+	}
+	strcat(hashString, &quot;#&quot;);
+	if (useVersion) {
+		strcat(hashString, spec-&gt;version);
+	}
+
+	int keyHash = string_simpleHash(hashString);
+
+	return keyHash;
+}
+
+int SSkirmishAISpecifier_compare(
+		const struct SSkirmishAISpecifier* const specThis,
+		const struct SSkirmishAISpecifier* const specThat) {
+
+	int comp = strcmp(specThis-&gt;shortName, specThat-&gt;shortName);
+	if (comp == 0) {
+		comp = strcmp(specThis-&gt;version, specThat-&gt;version);
+	}
+	return comp;
+}
+
+bool SSkirmishAISpecifier_isUnspecified(
+		const struct SSkirmishAISpecifier* const spec) {
+	return spec-&gt;shortName == NULL || spec-&gt;version == NULL;
+}
+
+static const SSkirmishAISpecifier unspecifiedSpec = {NULL, NULL};
+struct SSkirmishAISpecifier SSkirmishAISpecifier_getUnspecified() {
+	return unspecifiedSpec;
+}
+
+
+#ifdef __cplusplus
+bool SSkirmishAISpecifier_Comparator::operator()(
+		const struct SSkirmishAISpecifier&amp; specThis,
+		const struct SSkirmishAISpecifier&amp; specThat) const {
+	return SSkirmishAISpecifier_compare(&amp;specThis, &amp;specThat) &lt; 0;
+}
+#endif // defined __cplusplus
+
+#endif // defined BUILDING_AI_INTERFACE


Property changes on: branches/caiinterface/rts/ExternalAI/Interface/SSkirmishAISpecifier.cpp
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/caiinterface/rts/ExternalAI/Interface/SSkirmishAISpecifier.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/Interface/SSkirmishAISpecifier.h	                        (rev 0)
+++ branches/caiinterface/rts/ExternalAI/Interface/SSkirmishAISpecifier.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -0,0 +1,72 @@
+/*
+	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
+
+	This program is free software; you can redistribute it and/or modify
+	it under the terms of the GNU General Public License as published by
+	the Free Software Foundation; either version 2 of the License, or
+	(at your option) any later version.
+
+	This program is distributed in the hope that it will be useful,
+	but WITHOUT ANY WARRANTY; without even the implied warranty of
+	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+	GNU General Public License for more details.
+
+	You should have received a copy of the GNU General Public License
+	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+/**
+ * The struct and the helper functions in this file are here for convenience
+ * when building AI interfaces. The SSkirmishAISpecifier struct can be of use
+ * as key type for C++ maps or C hash maps (eg. to cache loaded Skirmish AIs).
+ * Engine side, we are using the C++ struct SkirmishAIKey for the same purposes.
+ */
+
+#ifndef _SSKIRMISHAISPECIFIER_H
+#define _SSKIRMISHAISPECIFIER_H
+
+#ifdef	__cplusplus
+extern &quot;C&quot; {
+#endif
+
+#if defined BUILDING_AI_INTERFACE
+/**
+ * @brief struct Skirmish Artificial Intelligence Specifier
+ */
+struct SSkirmishAISpecifier {
+	const char* shortName; // [may not contain: spaces, '_', '#']
+	const char* version; // [may not contain: spaces, '_', '#']
+};
+
+struct SSkirmishAISpecifier SSkirmishAISpecifier_copy(
+		const struct SSkirmishAISpecifier* const orig);
+void SSkirmishAISpecifier_delete(const struct SSkirmishAISpecifier* const spec);
+int SSkirmishAISpecifier_hash(
+		const struct SSkirmishAISpecifier* const spec);
+int SSkirmishAISpecifier_compare(
+		const struct SSkirmishAISpecifier* const specThis,
+		const struct SSkirmishAISpecifier* const specThat);
+bool SSkirmishAISpecifier_isUnspecified(
+		const struct SSkirmishAISpecifier* const spec);
+struct SSkirmishAISpecifier SSkirmishAISpecifier_getUnspecified();
+
+#if defined __cplusplus
+struct SSkirmishAISpecifier_Comparator {
+	/**
+	 * The key comparison function, a Strict Weak Ordering;
+	 * it returns true if its first argument is less
+	 * than its second argument, and false otherwise.
+	 * This is also defined as map::key_compare.
+	 */
+	bool operator()(const struct SSkirmishAISpecifier&amp; specThis,
+			const struct SSkirmishAISpecifier&amp; specThat) const;
+};
+#endif // defined __cplusplus
+
+#endif // defined BUILDING_AI_INTERFACE
+
+#ifdef __cplusplus
+}
+#endif
+
+#endif // _SSKIRMISHAISPECIFIER_H


Property changes on: branches/caiinterface/rts/ExternalAI/Interface/SSkirmishAISpecifier.h
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: branches/caiinterface/rts/ExternalAI/SAICallback.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/SAICallback.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/SAICallback.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -195,10 +195,10 @@
 		{
 			SGiveMeResourceCheatCommand* cmd = (SGiveMeResourceCheatCommand*) commandData;
 			if (clbCheat != NULL) {
-				if (cmd-&gt;resourceIndex == rh-&gt;GetMetalIndex()) {
+				if (cmd-&gt;resourceId == rh-&gt;GetMetalId()) {
 					clbCheat-&gt;GiveMeMetal(cmd-&gt;amount);
 					ret = 0;
-				} else if (cmd-&gt;resourceIndex == rh-&gt;GetEnergyIndex()) {
+				} else if (cmd-&gt;resourceId == rh-&gt;GetEnergyId()) {
 					clbCheat-&gt;GiveMeEnergy(cmd-&gt;amount);
 					ret = 0;
 				} else {
@@ -768,31 +768,31 @@
 	return size;
 }
 
-EXPORT(const unsigned char*) _Clb_Map_0REF1Resource2resourceIndex0getResourceMap(int teamId, int resourceIndex) {
+EXPORT(const unsigned char*) _Clb_Map_0REF1Resource2resourceId0getResourceMap(int teamId, int resourceId) {
 
 	IAICallback* clb = team_callback[teamId];
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return clb-&gt;GetMetalMap();
 	} else {
 		return NULL;
 	}
 }
-EXPORT(int) _Clb_Map_0ARRAY1SIZE0REF1Resource2resourceIndex0getResourceMap(int teamId, int resourceIndex) {
+EXPORT(int) _Clb_Map_0ARRAY1SIZE0REF1Resource2resourceId0getResourceMap(int teamId, int resourceId) {
 
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return readmap-&gt;metalMap-&gt;GetSizeX() * readmap-&gt;metalMap-&gt;GetSizeZ();
 	} else {
 		return 0;
 	}
 }
-EXPORT(int) _Clb_Map_0ARRAY1VALS0REF1Resource2resourceIndex0getResourceMap(int teamId, int resourceIndex, unsigned char resources[], int resources_max) {
+EXPORT(int) _Clb_Map_0ARRAY1VALS0REF1Resource2resourceId0getResourceMap(int teamId, int resourceId, unsigned char resources[], int resources_max) {
 
 	IAICallback* clb = team_callback[teamId];
-	int size = _Clb_Map_0ARRAY1SIZE0REF1Resource2resourceIndex0getResourceMap(teamId, resourceIndex);
+	int size = _Clb_Map_0ARRAY1SIZE0REF1Resource2resourceId0getResourceMap(teamId, resourceId);
 	size = min(size, resources_max);
 
 	const unsigned char* tmpMap;
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		tmpMap = clb-&gt;GetMetalMap();
 	} else {
 		tmpMap = NULL;
@@ -815,20 +815,20 @@
 	IAICallback* clb = team_callback[teamId]; return clb-&gt;GetElevation(x, z);
 }
 
-EXPORT(float) _Clb_Map_0REF1Resource2resourceIndex0getMaxResource(int teamId, int resourceIndex) {
+EXPORT(float) _Clb_Map_0REF1Resource2resourceId0getMaxResource(int teamId, int resourceId) {
 
 	IAICallback* clb = team_callback[teamId];
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return clb-&gt;GetMaxMetal();
 	} else {
 		return NULL;
 	}
 }
 
-EXPORT(float) _Clb_Map_0REF1Resource2resourceIndex0getExtractorRadius(int teamId, int resourceIndex) {
+EXPORT(float) _Clb_Map_0REF1Resource2resourceId0getExtractorRadius(int teamId, int resourceId) {
 
 	IAICallback* clb = team_callback[teamId];
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return clb-&gt;GetExtractorRadius();
 	} else {
 		return NULL;
@@ -866,31 +866,31 @@
 EXPORT(int) _Clb_Map_0MULTI1SIZE0Point(int teamId) {
 	return team_callback[teamId]-&gt;GetMapPoints(tmpPointMarkerArr[teamId], TMP_ARR_SIZE);
 }
-EXPORT(struct SAIFloat3) _Clb_Map_Point_getPosition(int teamId, int pointIndex) {
-	return tmpPointMarkerArr[teamId][pointIndex].pos.toSAIFloat3();
+EXPORT(struct SAIFloat3) _Clb_Map_Point_getPosition(int teamId, int pointId) {
+	return tmpPointMarkerArr[teamId][pointId].pos.toSAIFloat3();
 }
-EXPORT(struct SAIFloat3) _Clb_Map_Point_getColor(int teamId, int pointIndex) {
+EXPORT(struct SAIFloat3) _Clb_Map_Point_getColor(int teamId, int pointId) {
 
-	unsigned char* color = tmpPointMarkerArr[teamId][pointIndex].color;
+	unsigned char* color = tmpPointMarkerArr[teamId][pointId].color;
 	SAIFloat3 f3color = {color[0], color[1], color[2]};
 	return f3color;
 }
-EXPORT(const char*) _Clb_Map_Point_getLabel(int teamId, int pointIndex) {
-	return tmpPointMarkerArr[teamId][pointIndex].label;
+EXPORT(const char*) _Clb_Map_Point_getLabel(int teamId, int pointId) {
+	return tmpPointMarkerArr[teamId][pointId].label;
 }
 
 EXPORT(int) _Clb_Map_0MULTI1SIZE0Line(int teamId) {
 	return team_callback[teamId]-&gt;GetMapLines(tmpLineMarkerArr[teamId], TMP_ARR_SIZE);
 }
-EXPORT(struct SAIFloat3) _Clb_Map_Line_getFirstPosition(int teamId, int lineIndex) {
-	return tmpLineMarkerArr[teamId][lineIndex].pos.toSAIFloat3();
+EXPORT(struct SAIFloat3) _Clb_Map_Line_getFirstPosition(int teamId, int lineId) {
+	return tmpLineMarkerArr[teamId][lineId].pos.toSAIFloat3();
 }
-EXPORT(struct SAIFloat3) _Clb_Map_Line_getSecondPosition(int teamId, int lineIndex) {
-	return tmpLineMarkerArr[teamId][lineIndex].pos2.toSAIFloat3();
+EXPORT(struct SAIFloat3) _Clb_Map_Line_getSecondPosition(int teamId, int lineId) {
+	return tmpLineMarkerArr[teamId][lineId].pos2.toSAIFloat3();
 }
-EXPORT(struct SAIFloat3) _Clb_Map_Line_getColor(int teamId, int lineIndex) {
+EXPORT(struct SAIFloat3) _Clb_Map_Line_getColor(int teamId, int lineId) {
 
-	unsigned char* color = tmpLineMarkerArr[teamId][lineIndex].color;
+	unsigned char* color = tmpLineMarkerArr[teamId][lineId].color;
 	SAIFloat3 f3color = {color[0], color[1], color[2]};
 	return f3color;
 }
@@ -941,56 +941,56 @@
 	return rh-&gt;GetNumResources();
 }
 EXPORT(int) _Clb_0MULTI1FETCH3ResourceByName0Resource(int teamId, const char* resourceName) {
-	return rh-&gt;GetResourceIndex(resourceName);
+	return rh-&gt;GetResourceId(resourceName);
 }
-EXPORT(const char*) _Clb_Resource_getName(int teamId, int resourceIndex) {
-	return rh-&gt;GetResource(resourceIndex)-&gt;name.c_str();
+EXPORT(const char*) _Clb_Resource_getName(int teamId, int resourceId) {
+	return rh-&gt;GetResource(resourceId)-&gt;name.c_str();
 }
-EXPORT(float) _Clb_Resource_getOptimum(int teamId, int resourceIndex) {
-	return rh-&gt;GetResource(resourceIndex)-&gt;optimum;
+EXPORT(float) _Clb_Resource_getOptimum(int teamId, int resourceId) {
+	return rh-&gt;GetResource(resourceId)-&gt;optimum;
 }
-EXPORT(float) _Clb_Economy_0REF1Resource2resourceIndex0getCurrent(int teamId, int resourceIndex) {
+EXPORT(float) _Clb_Economy_0REF1Resource2resourceId0getCurrent(int teamId, int resourceId) {
 
 	IAICallback* clb = team_callback[teamId];
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return clb-&gt;GetMetal();
-	} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	} else if (resourceId == rh-&gt;GetEnergyId()) {
 		return clb-&gt;GetEnergy();
 	} else {
 		return -1.0f;
 	}
 }
 
-EXPORT(float) _Clb_Economy_0REF1Resource2resourceIndex0getIncome(int teamId, int resourceIndex) {
+EXPORT(float) _Clb_Economy_0REF1Resource2resourceId0getIncome(int teamId, int resourceId) {
 
 	IAICallback* clb = team_callback[teamId];
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return clb-&gt;GetMetalIncome();
-	} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	} else if (resourceId == rh-&gt;GetEnergyId()) {
 		return clb-&gt;GetEnergyIncome();
 	} else {
 		return -1.0f;
 	}
 }
 
-EXPORT(float) _Clb_Economy_0REF1Resource2resourceIndex0getUsage(int teamId, int resourceIndex) {
+EXPORT(float) _Clb_Economy_0REF1Resource2resourceId0getUsage(int teamId, int resourceId) {
 
 	IAICallback* clb = team_callback[teamId];
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return clb-&gt;GetMetalUsage();
-	} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	} else if (resourceId == rh-&gt;GetEnergyId()) {
 		return clb-&gt;GetEnergyUsage();
 	} else {
 		return -1.0f;
 	}
 }
 
-EXPORT(float) _Clb_Economy_0REF1Resource2resourceIndex0getStorage(int teamId, int resourceIndex) {
+EXPORT(float) _Clb_Economy_0REF1Resource2resourceId0getStorage(int teamId, int resourceId) {
 
 	IAICallback* clb = team_callback[teamId];
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return clb-&gt;GetMetalStorage();
-	} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	} else if (resourceId == rh-&gt;GetEnergyId()) {
 		return clb-&gt;GetEnergyStorage();
 	} else {
 		return -1.0f;
@@ -1063,90 +1063,90 @@
 EXPORT(int) _Clb_UnitDef_getCobId(int teamId, int unitDefId) {return getUnitDefById(teamId, unitDefId)-&gt;cobID;}
 EXPORT(int) _Clb_UnitDef_getTechLevel(int teamId, int unitDefId) {return getUnitDefById(teamId, unitDefId)-&gt;techLevel;}
 EXPORT(const char*) _Clb_UnitDef_getGaia(int teamId, int unitDefId) {return getUnitDefById(teamId, unitDefId)-&gt;gaia.c_str();}
-EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceIndex0getUpkeep(int teamId, int unitDefId, int resourceIndex) {
+EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceId0getUpkeep(int teamId, int unitDefId, int resourceId) {
 
 	const UnitDef* ud = getUnitDefById(teamId, unitDefId);
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return ud-&gt;metalUpkeep;
-	} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	} else if (resourceId == rh-&gt;GetEnergyId()) {
 		return ud-&gt;energyUpkeep;
 	} else {
 		return 0.0f;
 	}
 }
-EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceIndex0getResourceMake(int teamId, int unitDefId, int resourceIndex) {
+EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceId0getResourceMake(int teamId, int unitDefId, int resourceId) {
 
 	const UnitDef* ud = getUnitDefById(teamId, unitDefId);
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return ud-&gt;metalMake;
-	} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	} else if (resourceId == rh-&gt;GetEnergyId()) {
 		return ud-&gt;energyMake;
 	} else {
 		return 0.0f;
 	}
 }
-EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceIndex0getMakesResource(int teamId, int unitDefId, int resourceIndex) {
+EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceId0getMakesResource(int teamId, int unitDefId, int resourceId) {
 
 	const UnitDef* ud = getUnitDefById(teamId, unitDefId);
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return ud-&gt;makesMetal;
 	} else {
 		return 0.0f;
 	}
 }
-EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceIndex0getCost(int teamId, int unitDefId, int resourceIndex) {
+EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceId0getCost(int teamId, int unitDefId, int resourceId) {
 
 	const UnitDef* ud = getUnitDefById(teamId, unitDefId);
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return ud-&gt;metalCost;
-	} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	} else if (resourceId == rh-&gt;GetEnergyId()) {
 		return ud-&gt;energyCost;
 	} else {
 		return 0.0f;
 	}
 }
-EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceIndex0getExtractsResource(int teamId, int unitDefId, int resourceIndex) {
+EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceId0getExtractsResource(int teamId, int unitDefId, int resourceId) {
 
 	const UnitDef* ud = getUnitDefById(teamId, unitDefId);
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return ud-&gt;extractsMetal;
 	} else {
 		return 0.0f;
 	}
 }
-EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceIndex0getResourceExtractorRange(int teamId, int unitDefId, int resourceIndex) {
+EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceId0getResourceExtractorRange(int teamId, int unitDefId, int resourceId) {
 
 	const UnitDef* ud = getUnitDefById(teamId, unitDefId);
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return ud-&gt;extractRange;
 	} else {
 		return 0.0f;
 	}
 }
-EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceIndex0getWindResourceGenerator(int teamId, int unitDefId, int resourceIndex) {
+EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceId0getWindResourceGenerator(int teamId, int unitDefId, int resourceId) {
 
 	const UnitDef* ud = getUnitDefById(teamId, unitDefId);
-	if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	if (resourceId == rh-&gt;GetEnergyId()) {
 		return ud-&gt;windGenerator;
 	} else {
 		return 0.0f;
 	}
 }
-EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceIndex0getTidalResourceGenerator(int teamId, int unitDefId, int resourceIndex) {
+EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceId0getTidalResourceGenerator(int teamId, int unitDefId, int resourceId) {
 
 	const UnitDef* ud = getUnitDefById(teamId, unitDefId);
-	if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	if (resourceId == rh-&gt;GetEnergyId()) {
 		return ud-&gt;tidalGenerator;
 	} else {
 		return 0.0f;
 	}
 }
-EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceIndex0getStorage(int teamId, int unitDefId, int resourceIndex) {
+EXPORT(float) _Clb_UnitDef_0REF1Resource2resourceId0getStorage(int teamId, int unitDefId, int resourceId) {
 
 	const UnitDef* ud = getUnitDefById(teamId, unitDefId);
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return ud-&gt;metalStorage;
-	} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	} else if (resourceId == rh-&gt;GetEnergyId()) {
 		return ud-&gt;energyStorage;
 	} else {
 		return 0.0f;
@@ -1318,10 +1318,10 @@
 EXPORT(int) _Clb_UnitDef_getFlareSalvoSize(int teamId, int unitDefId) {return getUnitDefById(teamId, unitDefId)-&gt;flareSalvoSize;}
 EXPORT(int) _Clb_UnitDef_getFlareSalvoDelay(int teamId, int unitDefId) {return getUnitDefById(teamId, unitDefId)-&gt;flareSalvoDelay;}
 EXPORT(bool) _Clb_UnitDef_isSmoothAnim(int teamId, int unitDefId) {return getUnitDefById(teamId, unitDefId)-&gt;smoothAnim;}
-EXPORT(bool) _Clb_UnitDef_0REF1Resource2resourceIndex0isResourceMaker(int teamId, int unitDefId, int resourceIndex) {
+EXPORT(bool) _Clb_UnitDef_0REF1Resource2resourceId0isResourceMaker(int teamId, int unitDefId, int resourceId) {
 
 	const UnitDef* ud = getUnitDefById(teamId, unitDefId);
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return ud-&gt;isMetalMaker;
 	} else {
 		return false;
@@ -1392,16 +1392,16 @@
 EXPORT(float) _Clb_UnitDef_MoveData_getMaxBreaking(int teamId, int unitDefId) {return getUnitDefById(teamId, unitDefId)-&gt;movedata-&gt;maxBreaking;}
 EXPORT(bool) _Clb_UnitDef_MoveData_isSubMarine(int teamId, int unitDefId) {return getUnitDefById(teamId, unitDefId)-&gt;movedata-&gt;subMarine;}
 EXPORT(int) _Clb_UnitDef_0MULTI1SIZE0WeaponMount(int teamId, int unitDefId) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.size();}
-EXPORT(const char*) _Clb_UnitDef_WeaponMount_getName(int teamId, int unitDefId, int weaponIndex) {
-	return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponIndex).name.c_str();
+EXPORT(const char*) _Clb_UnitDef_WeaponMount_getName(int teamId, int unitDefId, int weaponMountId) {
+	return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponMountId).name.c_str();
 }
-EXPORT(int) _Clb_UnitDef_WeaponMount_0SINGLE1FETCH2WeaponDef0getWeaponDef(int teamId, int unitDefId, int weaponIndex) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponIndex).def-&gt;id;}
-EXPORT(int) _Clb_UnitDef_WeaponMount_getSlavedTo(int teamId, int unitDefId, int weaponIndex) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponIndex).slavedTo;}
-EXPORT(SAIFloat3) _Clb_UnitDef_WeaponMount_getMainDir(int teamId, int unitDefId, int weaponIndex) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponIndex).mainDir.toSAIFloat3();}
-EXPORT(float) _Clb_UnitDef_WeaponMount_getMaxAngleDif(int teamId, int unitDefId, int weaponIndex) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponIndex).maxAngleDif;}
-EXPORT(float) _Clb_UnitDef_WeaponMount_getFuelUsage(int teamId, int unitDefId, int weaponIndex) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponIndex).fuelUsage;}
-EXPORT(unsigned int) _Clb_UnitDef_WeaponMount_getBadTargetCategory(int teamId, int unitDefId, int weaponIndex) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponIndex).badTargetCat;}
-EXPORT(unsigned int) _Clb_UnitDef_WeaponMount_getOnlyTargetCategory(int teamId, int unitDefId, int weaponIndex) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponIndex).onlyTargetCat;}
+EXPORT(int) _Clb_UnitDef_WeaponMount_0SINGLE1FETCH2WeaponDef0getWeaponDef(int teamId, int unitDefId, int weaponMountId) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponMountId).def-&gt;id;}
+EXPORT(int) _Clb_UnitDef_WeaponMount_getSlavedTo(int teamId, int unitDefId, int weaponMountId) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponMountId).slavedTo;}
+EXPORT(SAIFloat3) _Clb_UnitDef_WeaponMount_getMainDir(int teamId, int unitDefId, int weaponMountId) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponMountId).mainDir.toSAIFloat3();}
+EXPORT(float) _Clb_UnitDef_WeaponMount_getMaxAngleDif(int teamId, int unitDefId, int weaponMountId) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponMountId).maxAngleDif;}
+EXPORT(float) _Clb_UnitDef_WeaponMount_getFuelUsage(int teamId, int unitDefId, int weaponMountId) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponMountId).fuelUsage;}
+EXPORT(unsigned int) _Clb_UnitDef_WeaponMount_getBadTargetCategory(int teamId, int unitDefId, int weaponMountId) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponMountId).badTargetCat;}
+EXPORT(unsigned int) _Clb_UnitDef_WeaponMount_getOnlyTargetCategory(int teamId, int unitDefId, int weaponMountId) {return getUnitDefById(teamId, unitDefId)-&gt;weapons.at(weaponMountId).onlyTargetCat;}
 //########### END UnitDef
 
 
@@ -1459,28 +1459,28 @@
 EXPORT(int) _Clb_Unit_0MULTI1SIZE0SupportedCommand(int teamId, int unitId) {
 	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;size();
 }
-EXPORT(int) _Clb_Unit_SupportedCommand_getId(int teamId, int unitId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandIndex).id;
+EXPORT(int) _Clb_Unit_SupportedCommand_getId(int teamId, int unitId, int commandId) {
+	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandId).id;
 }
-EXPORT(const char*) _Clb_Unit_SupportedCommand_getName(int teamId, int unitId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandIndex).name.c_str();
+EXPORT(const char*) _Clb_Unit_SupportedCommand_getName(int teamId, int unitId, int commandId) {
+	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandId).name.c_str();
 }
-EXPORT(const char*) _Clb_Unit_SupportedCommand_getToolTip(int teamId, int unitId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandIndex).tooltip.c_str();
+EXPORT(const char*) _Clb_Unit_SupportedCommand_getToolTip(int teamId, int unitId, int commandId) {
+	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandId).tooltip.c_str();
 }
-EXPORT(bool) _Clb_Unit_SupportedCommand_isShowUnique(int teamId, int unitId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandIndex).showUnique;
+EXPORT(bool) _Clb_Unit_SupportedCommand_isShowUnique(int teamId, int unitId, int commandId) {
+	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandId).showUnique;
 }
-EXPORT(bool) _Clb_Unit_SupportedCommand_isDisabled(int teamId, int unitId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandIndex).disabled;
+EXPORT(bool) _Clb_Unit_SupportedCommand_isDisabled(int teamId, int unitId, int commandId) {
+	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandId).disabled;
 }
-EXPORT(int) _Clb_Unit_SupportedCommand_0ARRAY1SIZE0getParams(int teamId, int unitId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandIndex).params.size();
+EXPORT(int) _Clb_Unit_SupportedCommand_0ARRAY1SIZE0getParams(int teamId, int unitId, int commandId) {
+	return team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandId).params.size();
 }
-EXPORT(int) _Clb_Unit_SupportedCommand_0ARRAY1VALS0getParams(int teamId, int unitId, int commandIndex, const char** params, int params_max) {
+EXPORT(int) _Clb_Unit_SupportedCommand_0ARRAY1VALS0getParams(int teamId, int unitId, int commandId, const char** params, int params_max) {
 
 	const std::vector&lt;std::string&gt; ps
-			= team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandIndex).params;
+			= team_callback[teamId]-&gt;GetUnitCommands(unitId)-&gt;at(commandId).params;
 	int size = ps.size();
 	if (params_max &lt; size) {
 		size = params_max;
@@ -1563,47 +1563,47 @@
 		return team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;GetType();
 	}
 }
-EXPORT(int) _Clb_Unit_CurrentCommand_getId(int teamId, int unitId, int commandIndex) {
+EXPORT(int) _Clb_Unit_CurrentCommand_getId(int teamId, int unitId, int commandId) {
 
 	if (_Clb_Cheats_isEnabled(teamId)) {
-		return team_cheatCallback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandIndex).id;
+		return team_cheatCallback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandId).id;
 	} else {
-		return team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandIndex).id;
+		return team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandId).id;
 	}
 }
-EXPORT(unsigned char) _Clb_Unit_CurrentCommand_getOptions(int teamId, int unitId, int commandIndex) {
+EXPORT(unsigned char) _Clb_Unit_CurrentCommand_getOptions(int teamId, int unitId, int commandId) {
 
 	if (_Clb_Cheats_isEnabled(teamId)) {
-		return team_cheatCallback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandIndex).options;
+		return team_cheatCallback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandId).options;
 	} else {
-		return team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandIndex).options;
+		return team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandId).options;
 	}
 }
-EXPORT(unsigned int) _Clb_Unit_CurrentCommand_getTag(int teamId, int unitId, int commandIndex) {
+EXPORT(unsigned int) _Clb_Unit_CurrentCommand_getTag(int teamId, int unitId, int commandId) {
 
 	if (_Clb_Cheats_isEnabled(teamId)) {
-		return team_cheatCallback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandIndex).tag;
+		return team_cheatCallback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandId).tag;
 	} else {
-		return team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandIndex).tag;
+		return team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandId).tag;
 	}
 }
-EXPORT(int) _Clb_Unit_CurrentCommand_getTimeOut(int teamId, int unitId, int commandIndex) {
+EXPORT(int) _Clb_Unit_CurrentCommand_getTimeOut(int teamId, int unitId, int commandId) {
 
 	if (_Clb_Cheats_isEnabled(teamId)) {
-		return team_cheatCallback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandIndex).timeOut;
+		return team_cheatCallback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandId).timeOut;
 	} else {
-		return team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandIndex).timeOut;
+		return team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandId).timeOut;
 	}
 }
-EXPORT(int) _Clb_Unit_CurrentCommand_0ARRAY1SIZE0getParams(int teamId, int unitId, int commandIndex) {
+EXPORT(int) _Clb_Unit_CurrentCommand_0ARRAY1SIZE0getParams(int teamId, int unitId, int commandId) {
 
 	if (_Clb_Cheats_isEnabled(teamId)) {
-		return team_cheatCallback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandIndex).params.size();
+		return team_cheatCallback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandId).params.size();
 	} else {
-		return team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandIndex).params.size();
+		return team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId)-&gt;at(commandId).params.size();
 	}
 }
-EXPORT(int) _Clb_Unit_CurrentCommand_0ARRAY1VALS0getParams(int teamId, int unitId, int commandIndex, float* params, int params_max) {
+EXPORT(int) _Clb_Unit_CurrentCommand_0ARRAY1VALS0getParams(int teamId, int unitId, int commandId, float* params, int params_max) {
 
 	const CCommandQueue* cc = NULL;
 	if (_Clb_Cheats_isEnabled(teamId)) {
@@ -1612,11 +1612,11 @@
 		cc = team_callback[teamId]-&gt;GetCurrentUnitCommands(unitId);
 	}
 
-	if (commandIndex &gt;= (int)cc-&gt;size()) {
+	if (commandId &gt;= (int)cc-&gt;size()) {
 		return -1;
 	}
 
-	const std::vector&lt;float&gt; ps = cc-&gt;at(commandIndex).params;
+	const std::vector&lt;float&gt; ps = cc-&gt;at(commandId).params;
 	int numParams = ps.size();
 	if (params_max &lt; numParams) {
 		numParams = params_max;
@@ -1670,7 +1670,7 @@
 EXPORT(int) _Clb_Unit_0MULTI1SIZE0ResourceInfo(int teamId, int unitId) {
 	return _Clb_0MULTI1SIZE0Resource(teamId);
 }
-EXPORT(float) _Clb_Unit_0REF1Resource2resourceIndex0getResourceUse(int teamId, int unitId, int resourceIndex) {
+EXPORT(float) _Clb_Unit_0REF1Resource2resourceId0getResourceUse(int teamId, int unitId, int resourceId) {
 
 	int res = -1.0F;
 	UnitResourceInfo resourceInfo;
@@ -1682,16 +1682,16 @@
 		fetchOk = team_callback[teamId]-&gt;GetUnitResourceInfo(unitId, &amp;resourceInfo);
 	}
 	if (fetchOk) {
-		if (resourceIndex == rh-&gt;GetMetalIndex()) {
+		if (resourceId == rh-&gt;GetMetalId()) {
 			res = resourceInfo.metalUse;
-		} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+		} else if (resourceId == rh-&gt;GetEnergyId()) {
 			res = resourceInfo.energyUse;
 		}
 	}
 
 	return res;
 }
-EXPORT(float) _Clb_Unit_0REF1Resource2resourceIndex0getResourceMake(int teamId, int unitId, int resourceIndex) {
+EXPORT(float) _Clb_Unit_0REF1Resource2resourceId0getResourceMake(int teamId, int unitId, int resourceId) {
 
 	int res = -1.0F;
 	UnitResourceInfo resourceInfo;
@@ -1703,9 +1703,9 @@
 		fetchOk = team_callback[teamId]-&gt;GetUnitResourceInfo(unitId, &amp;resourceInfo);
 	}
 	if (fetchOk) {
-		if (resourceIndex == rh-&gt;GetMetalIndex()) {
+		if (resourceId == rh-&gt;GetMetalId()) {
 			res = resourceInfo.metalMake;
-		} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+		} else if (resourceId == rh-&gt;GetEnergyId()) {
 			res = resourceInfo.energyMake;
 		}
 	}
@@ -1887,12 +1887,12 @@
 EXPORT(const char*) _Clb_FeatureDef_getDescription(int teamId, int featureDefId) {return getFeatureDefById(teamId, featureDefId)-&gt;description.c_str();}
 EXPORT(const char*) _Clb_FeatureDef_getFileName(int teamId, int featureDefId) {return getFeatureDefById(teamId, featureDefId)-&gt;filename.c_str();}
 EXPORT(int) _Clb_FeatureDef_getId(int teamId, int featureDefId) {return getFeatureDefById(teamId, featureDefId)-&gt;id;}
-EXPORT(float) _Clb_FeatureDef_0REF1Resource2resourceIndex0getContainedResource(int teamId, int featureDefId, int resourceIndex) {
+EXPORT(float) _Clb_FeatureDef_0REF1Resource2resourceId0getContainedResource(int teamId, int featureDefId, int resourceId) {
 
 	const FeatureDef* fd = getFeatureDefById(teamId, featureDefId);
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return fd-&gt;metal;
-	} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	} else if (resourceId == rh-&gt;GetEnergyId()) {
 		return fd-&gt;energy;
 	} else {
 		return 0.0f;
@@ -2066,12 +2066,12 @@
 EXPORT(float) _Clb_WeaponDef_getRestTime(int teamId, int weaponDefId) {return getWeaponDefById(teamId, weaponDefId)-&gt;restTime;}
 EXPORT(float) _Clb_WeaponDef_getUpTime(int teamId, int weaponDefId) {return getWeaponDefById(teamId, weaponDefId)-&gt;uptime;}
 EXPORT(int) _Clb_WeaponDef_getFlightTime(int teamId, int weaponDefId) {return getWeaponDefById(teamId, weaponDefId)-&gt;flighttime;}
-EXPORT(float) _Clb_WeaponDef_0REF1Resource2resourceIndex0getCost(int teamId, int weaponDefId, int resourceIndex) {
+EXPORT(float) _Clb_WeaponDef_0REF1Resource2resourceId0getCost(int teamId, int weaponDefId, int resourceId) {
 
 	const WeaponDef* wd = getWeaponDefById(teamId, weaponDefId);
-	if (resourceIndex == rh-&gt;GetMetalIndex()) {
+	if (resourceId == rh-&gt;GetMetalId()) {
 		return wd-&gt;metalcost;
-	} else if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	} else if (resourceId == rh-&gt;GetEnergyId()) {
 		return wd-&gt;energycost;
 	} else {
 		return 0.0f;
@@ -2129,10 +2129,10 @@
 EXPORT(bool) _Clb_WeaponDef_isVisibleShield(int teamId, int weaponDefId) {return getWeaponDefById(teamId, weaponDefId)-&gt;visibleShield;}
 EXPORT(bool) _Clb_WeaponDef_isVisibleShieldRepulse(int teamId, int weaponDefId) {return getWeaponDefById(teamId, weaponDefId)-&gt;visibleShieldRepulse;}
 EXPORT(int) _Clb_WeaponDef_getVisibleShieldHitFrames(int teamId, int weaponDefId) {return getWeaponDefById(teamId, weaponDefId)-&gt;visibleShieldHitFrames;}
-EXPORT(float) _Clb_WeaponDef_Shield_0REF1Resource2resourceIndex0getResourceUse(int teamId, int weaponDefId, int resourceIndex) {
+EXPORT(float) _Clb_WeaponDef_Shield_0REF1Resource2resourceId0getResourceUse(int teamId, int weaponDefId, int resourceId) {
 
 	const WeaponDef* wd = getWeaponDefById(teamId, weaponDefId);
-	if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	if (resourceId == rh-&gt;GetEnergyId()) {
 		return wd-&gt;shieldEnergyUse;
 	} else {
 		return 0.0f;
@@ -2143,10 +2143,10 @@
 EXPORT(float) _Clb_WeaponDef_Shield_getMaxSpeed(int teamId, int weaponDefId) {return getWeaponDefById(teamId, weaponDefId)-&gt;shieldMaxSpeed;}
 EXPORT(float) _Clb_WeaponDef_Shield_getPower(int teamId, int weaponDefId) {return getWeaponDefById(teamId, weaponDefId)-&gt;shieldPower;}
 EXPORT(float) _Clb_WeaponDef_Shield_getPowerRegen(int teamId, int weaponDefId) {return getWeaponDefById(teamId, weaponDefId)-&gt;shieldPowerRegen;}
-EXPORT(float) _Clb_WeaponDef_Shield_0REF1Resource2resourceIndex0getPowerRegenResource(int teamId, int weaponDefId, int resourceIndex) {
+EXPORT(float) _Clb_WeaponDef_Shield_0REF1Resource2resourceId0getPowerRegenResource(int teamId, int weaponDefId, int resourceId) {
 
 	const WeaponDef* wd = getWeaponDefById(teamId, weaponDefId);
-	if (resourceIndex == rh-&gt;GetEnergyIndex()) {
+	if (resourceId == rh-&gt;GetEnergyId()) {
 		return wd-&gt;shieldPowerRegenEnergy;
 	} else {
 		return 0.0f;
@@ -2208,28 +2208,28 @@
 EXPORT(int) _Clb_Group_0MULTI1SIZE0SupportedCommand(int teamId, int groupId) {
 	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;size();
 }
-EXPORT(int) _Clb_Group_SupportedCommand_getId(int teamId, int groupId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandIndex).id;
+EXPORT(int) _Clb_Group_SupportedCommand_getId(int teamId, int groupId, int commandId) {
+	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandId).id;
 }
-EXPORT(const char*) _Clb_Group_SupportedCommand_getName(int teamId, int groupId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandIndex).name.c_str();
+EXPORT(const char*) _Clb_Group_SupportedCommand_getName(int teamId, int groupId, int commandId) {
+	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandId).name.c_str();
 }
-EXPORT(const char*) _Clb_Group_SupportedCommand_getToolTip(int teamId, int groupId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandIndex).tooltip.c_str();
+EXPORT(const char*) _Clb_Group_SupportedCommand_getToolTip(int teamId, int groupId, int commandId) {
+	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandId).tooltip.c_str();
 }
-EXPORT(bool) _Clb_Group_SupportedCommand_isShowUnique(int teamId, int groupId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandIndex).showUnique;
+EXPORT(bool) _Clb_Group_SupportedCommand_isShowUnique(int teamId, int groupId, int commandId) {
+	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandId).showUnique;
 }
-EXPORT(bool) _Clb_Group_SupportedCommand_isDisabled(int teamId, int groupId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandIndex).disabled;
+EXPORT(bool) _Clb_Group_SupportedCommand_isDisabled(int teamId, int groupId, int commandId) {
+	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandId).disabled;
 }
-EXPORT(int) _Clb_Group_SupportedCommand_0ARRAY1SIZE0getParams(int teamId, int groupId, int commandIndex) {
-	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandIndex).params.size();
+EXPORT(int) _Clb_Group_SupportedCommand_0ARRAY1SIZE0getParams(int teamId, int groupId, int commandId) {
+	return team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandId).params.size();
 }
-EXPORT(int) _Clb_Group_SupportedCommand_0ARRAY1VALS0getParams(int teamId, int groupId, int commandIndex, const char** params, int params_max) {
+EXPORT(int) _Clb_Group_SupportedCommand_0ARRAY1VALS0getParams(int teamId, int groupId, int commandId, const char** params, int params_max) {
 
 	const std::vector&lt;std::string&gt; ps
-			= team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandIndex).params;
+			= team_callback[teamId]-&gt;GetGroupCommands(groupId)-&gt;at(commandId).params;
 	int size = ps.size();
 	if (params_max &lt; size) {
 		size = params_max;
@@ -2341,10 +2341,10 @@
 	sAICallback-&gt;Clb_0MULTI1FETCH3ResourceByName0Resource = _Clb_0MULTI1FETCH3ResourceByName0Resource;
 	sAICallback-&gt;Clb_Resource_getName = _Clb_Resource_getName;
 	sAICallback-&gt;Clb_Resource_getOptimum = _Clb_Resource_getOptimum;
-	sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getCurrent = _Clb_Economy_0REF1Resource2resourceIndex0getCurrent;
-	sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getIncome = _Clb_Economy_0REF1Resource2resourceIndex0getIncome;
-	sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getUsage = _Clb_Economy_0REF1Resource2resourceIndex0getUsage;
-	sAICallback-&gt;Clb_Economy_0REF1Resource2resourceIndex0getStorage = _Clb_Economy_0REF1Resource2resourceIndex0getStorage;
+	sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getCurrent = _Clb_Economy_0REF1Resource2resourceId0getCurrent;
+	sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getIncome = _Clb_Economy_0REF1Resource2resourceId0getIncome;
+	sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getUsage = _Clb_Economy_0REF1Resource2resourceId0getUsage;
+	sAICallback-&gt;Clb_Economy_0REF1Resource2resourceId0getStorage = _Clb_Economy_0REF1Resource2resourceId0getStorage;
 	sAICallback-&gt;Clb_File_getSize = _Clb_File_getSize;
 	sAICallback-&gt;Clb_File_getContent = _Clb_File_getContent;
 	sAICallback-&gt;Clb_File_locateForReading = _Clb_File_locateForReading;
@@ -2362,15 +2362,15 @@
 	sAICallback-&gt;Clb_UnitDef_getCobId = _Clb_UnitDef_getCobId;
 	sAICallback-&gt;Clb_UnitDef_getTechLevel = _Clb_UnitDef_getTechLevel;
 	sAICallback-&gt;Clb_UnitDef_getGaia = _Clb_UnitDef_getGaia;
-	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getUpkeep = _Clb_UnitDef_0REF1Resource2resourceIndex0getUpkeep;
-	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getResourceMake = _Clb_UnitDef_0REF1Resource2resourceIndex0getResourceMake;
-	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getMakesResource = _Clb_UnitDef_0REF1Resource2resourceIndex0getMakesResource;
-	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getCost = _Clb_UnitDef_0REF1Resource2resourceIndex0getCost;
-	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getExtractsResource = _Clb_UnitDef_0REF1Resource2resourceIndex0getExtractsResource;
-	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getResourceExtractorRange = _Clb_UnitDef_0REF1Resource2resourceIndex0getResourceExtractorRange;
-	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getWindResourceGenerator = _Clb_UnitDef_0REF1Resource2resourceIndex0getWindResourceGenerator;
-	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getTidalResourceGenerator = _Clb_UnitDef_0REF1Resource2resourceIndex0getTidalResourceGenerator;
-	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0getStorage = _Clb_UnitDef_0REF1Resource2resourceIndex0getStorage;
+	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getUpkeep = _Clb_UnitDef_0REF1Resource2resourceId0getUpkeep;
+	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getResourceMake = _Clb_UnitDef_0REF1Resource2resourceId0getResourceMake;
+	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getMakesResource = _Clb_UnitDef_0REF1Resource2resourceId0getMakesResource;
+	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getCost = _Clb_UnitDef_0REF1Resource2resourceId0getCost;
+	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getExtractsResource = _Clb_UnitDef_0REF1Resource2resourceId0getExtractsResource;
+	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getResourceExtractorRange = _Clb_UnitDef_0REF1Resource2resourceId0getResourceExtractorRange;
+	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getWindResourceGenerator = _Clb_UnitDef_0REF1Resource2resourceId0getWindResourceGenerator;
+	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getTidalResourceGenerator = _Clb_UnitDef_0REF1Resource2resourceId0getTidalResourceGenerator;
+	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0getStorage = _Clb_UnitDef_0REF1Resource2resourceId0getStorage;
 	sAICallback-&gt;Clb_UnitDef_getBuildTime = _Clb_UnitDef_getBuildTime;
 	sAICallback-&gt;Clb_UnitDef_getAutoHeal = _Clb_UnitDef_getAutoHeal;
 	sAICallback-&gt;Clb_UnitDef_getIdleAutoHeal = _Clb_UnitDef_getIdleAutoHeal;
@@ -2536,7 +2536,7 @@
 	sAICallback-&gt;Clb_UnitDef_getFlareSalvoSize = _Clb_UnitDef_getFlareSalvoSize;
 	sAICallback-&gt;Clb_UnitDef_getFlareSalvoDelay = _Clb_UnitDef_getFlareSalvoDelay;
 	sAICallback-&gt;Clb_UnitDef_isSmoothAnim = _Clb_UnitDef_isSmoothAnim;
-	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceIndex0isResourceMaker = _Clb_UnitDef_0REF1Resource2resourceIndex0isResourceMaker;
+	sAICallback-&gt;Clb_UnitDef_0REF1Resource2resourceId0isResourceMaker = _Clb_UnitDef_0REF1Resource2resourceId0isResourceMaker;
 	sAICallback-&gt;Clb_UnitDef_isCanLoopbackAttack = _Clb_UnitDef_isCanLoopbackAttack;
 	sAICallback-&gt;Clb_UnitDef_isLevelGround = _Clb_UnitDef_isLevelGround;
 	sAICallback-&gt;Clb_UnitDef_isUseBuildingGroundDecal = _Clb_UnitDef_isUseBuildingGroundDecal;
@@ -2631,8 +2631,8 @@
 	sAICallback-&gt;Clb_Unit_getSpeed = _Clb_Unit_getSpeed;
 	sAICallback-&gt;Clb_Unit_getPower = _Clb_Unit_getPower;
 	sAICallback-&gt;Clb_Unit_0MULTI1SIZE0ResourceInfo = _Clb_Unit_0MULTI1SIZE0ResourceInfo;
-	sAICallback-&gt;Clb_Unit_0REF1Resource2resourceIndex0getResourceUse = _Clb_Unit_0REF1Resource2resourceIndex0getResourceUse;
-	sAICallback-&gt;Clb_Unit_0REF1Resource2resourceIndex0getResourceMake = _Clb_Unit_0REF1Resource2resourceIndex0getResourceMake;
+	sAICallback-&gt;Clb_Unit_0REF1Resource2resourceId0getResourceUse = _Clb_Unit_0REF1Resource2resourceId0getResourceUse;
+	sAICallback-&gt;Clb_Unit_0REF1Resource2resourceId0getResourceMake = _Clb_Unit_0REF1Resource2resourceId0getResourceMake;
 	sAICallback-&gt;Clb_Unit_getPos = _Clb_Unit_getPos;
 	sAICallback-&gt;Clb_Unit_isActivated = _Clb_Unit_isActivated;
 	sAICallback-&gt;Clb_Unit_isBeingBuilt = _Clb_Unit_isBeingBuilt;
@@ -2677,12 +2677,12 @@
 	sAICallback-&gt;Clb_Map_0ARRAY1VALS0getRadarMap = _Clb_Map_0ARRAY1VALS0getRadarMap;
 	sAICallback-&gt;Clb_Map_0ARRAY1SIZE0getJammerMap = _Clb_Map_0ARRAY1SIZE0getJammerMap;
 	sAICallback-&gt;Clb_Map_0ARRAY1VALS0getJammerMap = _Clb_Map_0ARRAY1VALS0getJammerMap;
-	sAICallback-&gt;Clb_Map_0ARRAY1SIZE0REF1Resource2resourceIndex0getResourceMap = _Clb_Map_0ARRAY1SIZE0REF1Resource2resourceIndex0getResourceMap;
-	sAICallback-&gt;Clb_Map_0ARRAY1VALS0REF1Resource2resourceIndex0getResourceMap = _Clb_Map_0ARRAY1VALS0REF1Resource2resourceIndex0getResourceMap;
+	sAICallback-&gt;Clb_Map_0ARRAY1SIZE0REF1Resource2resourceId0getResourceMap = _Clb_Map_0ARRAY1SIZE0REF1Resource2resourceId0getResourceMap;
+	sAICallback-&gt;Clb_Map_0ARRAY1VALS0REF1Resource2resourceId0getResourceMap = _Clb_Map_0ARRAY1VALS0REF1Resource2resourceId0getResourceMap;
 	sAICallback-&gt;Clb_Map_getName = _Clb_Map_getName;
 	sAICallback-&gt;Clb_Map_getElevationAt = _Clb_Map_getElevationAt;
-	sAICallback-&gt;Clb_Map_0REF1Resource2resourceIndex0getMaxResource = _Clb_Map_0REF1Resource2resourceIndex0getMaxResource;
-	sAICallback-&gt;Clb_Map_0REF1Resource2resourceIndex0getExtractorRadius = _Clb_Map_0REF1Resource2resourceIndex0getExtractorRadius;
+	sAICallback-&gt;Clb_Map_0REF1Resource2resourceId0getMaxResource = _Clb_Map_0REF1Resource2resourceId0getMaxResource;
+	sAICallback-&gt;Clb_Map_0REF1Resource2resourceId0getExtractorRadius = _Clb_Map_0REF1Resource2resourceId0getExtractorRadius;
 	sAICallback-&gt;Clb_Map_getMinWind = _Clb_Map_getMinWind;
 	sAICallback-&gt;Clb_Map_getMaxWind = _Clb_Map_getMaxWind;
 	sAICallback-&gt;Clb_Map_getTidalStrength = _Clb_Map_getTidalStrength;
@@ -2703,7 +2703,7 @@
 	sAICallback-&gt;Clb_FeatureDef_getName = _Clb_FeatureDef_getName;
 	sAICallback-&gt;Clb_FeatureDef_getDescription = _Clb_FeatureDef_getDescription;
 	sAICallback-&gt;Clb_FeatureDef_getFileName = _Clb_FeatureDef_getFileName;
-	sAICallback-&gt;Clb_FeatureDef_0REF1Resource2resourceIndex0getContainedResource = _Clb_FeatureDef_0REF1Resource2resourceIndex0getContainedResource;
+	sAICallback-&gt;Clb_FeatureDef_0REF1Resource2resourceId0getContainedResource = _Clb_FeatureDef_0REF1Resource2resourceId0getContainedResource;
 	sAICallback-&gt;Clb_FeatureDef_getMaxHealth = _Clb_FeatureDef_getMaxHealth;
 	sAICallback-&gt;Clb_FeatureDef_getReclaimTime = _Clb_FeatureDef_getReclaimTime;
 	sAICallback-&gt;Clb_FeatureDef_getMass = _Clb_FeatureDef_getMass;
@@ -2784,7 +2784,7 @@
 	sAICallback-&gt;Clb_WeaponDef_getRestTime = _Clb_WeaponDef_getRestTime;
 	sAICallback-&gt;Clb_WeaponDef_getUpTime = _Clb_WeaponDef_getUpTime;
 	sAICallback-&gt;Clb_WeaponDef_getFlightTime = _Clb_WeaponDef_getFlightTime;
-	sAICallback-&gt;Clb_WeaponDef_0REF1Resource2resourceIndex0getCost = _Clb_WeaponDef_0REF1Resource2resourceIndex0getCost;
+	sAICallback-&gt;Clb_WeaponDef_0REF1Resource2resourceId0getCost = _Clb_WeaponDef_0REF1Resource2resourceId0getCost;
 	sAICallback-&gt;Clb_WeaponDef_getSupplyCost = _Clb_WeaponDef_getSupplyCost;
 	sAICallback-&gt;Clb_WeaponDef_getProjectilesPerShot = _Clb_WeaponDef_getProjectilesPerShot;
 	sAICallback-&gt;Clb_WeaponDef_getTdfId = _Clb_WeaponDef_getTdfId;
@@ -2837,13 +2837,13 @@
 	sAICallback-&gt;Clb_WeaponDef_isVisibleShield = _Clb_WeaponDef_isVisibleShield;
 	sAICallback-&gt;Clb_WeaponDef_isVisibleShieldRepulse = _Clb_WeaponDef_isVisibleShieldRepulse;
 	sAICallback-&gt;Clb_WeaponDef_getVisibleShieldHitFrames = _Clb_WeaponDef_getVisibleShieldHitFrames;
-	sAICallback-&gt;Clb_WeaponDef_Shield_0REF1Resource2resourceIndex0getResourceUse = _Clb_WeaponDef_Shield_0REF1Resource2resourceIndex0getResourceUse;
+	sAICallback-&gt;Clb_WeaponDef_Shield_0REF1Resource2resourceId0getResourceUse = _Clb_WeaponDef_Shield_0REF1Resource2resourceId0getResourceUse;
 	sAICallback-&gt;Clb_WeaponDef_Shield_getRadius = _Clb_WeaponDef_Shield_getRadius;
 	sAICallback-&gt;Clb_WeaponDef_Shield_getForce = _Clb_WeaponDef_Shield_getForce;
 	sAICallback-&gt;Clb_WeaponDef_Shield_getMaxSpeed = _Clb_WeaponDef_Shield_getMaxSpeed;
 	sAICallback-&gt;Clb_WeaponDef_Shield_getPower = _Clb_WeaponDef_Shield_getPower;
 	sAICallback-&gt;Clb_WeaponDef_Shield_getPowerRegen = _Clb_WeaponDef_Shield_getPowerRegen;
-	sAICallback-&gt;Clb_WeaponDef_Shield_0REF1Resource2resourceIndex0getPowerRegenResource = _Clb_WeaponDef_Shield_0REF1Resource2resourceIndex0getPowerRegenResource;
+	sAICallback-&gt;Clb_WeaponDef_Shield_0REF1Resource2resourceId0getPowerRegenResource = _Clb_WeaponDef_Shield_0REF1Resource2resourceId0getPowerRegenResource;
 	sAICallback-&gt;Clb_WeaponDef_Shield_getStartingPower = _Clb_WeaponDef_Shield_getStartingPower;
 	sAICallback-&gt;Clb_WeaponDef_Shield_getRechargeDelay = _Clb_WeaponDef_Shield_getRechargeDelay;
 	sAICallback-&gt;Clb_WeaponDef_Shield_getGoodColor = _Clb_WeaponDef_Shield_getGoodColor;

Modified: branches/caiinterface/rts/ExternalAI/SStaticGlobalData.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/SStaticGlobalData.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/SStaticGlobalData.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -26,6 +26,7 @@
 #include &quot;Game/GameVersion.h&quot;			// for VERSION_STRING
 #include &quot;FileSystem/FileSystem.h&quot;	// for data directories
 #include &quot;ExternalAI/IAILibraryManager.h&quot;
+#include &quot;ExternalAI/SkirmishAIKey.h&quot;
 #include &quot;IAILibraryManager.h&quot;	// for AI info
 
 #include &quot;LogOutput.h&quot; // TODO: remove again

Modified: branches/caiinterface/rts/ExternalAI/SkirmishAI.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/SkirmishAI.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/SkirmishAI.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -20,7 +20,7 @@
 #include &quot;IAILibraryManager.h&quot;
 #include &quot;ISkirmishAILibrary.h&quot;
 
-CSkirmishAI::CSkirmishAI(int teamId, const SSAIKey&amp; key)
+CSkirmishAI::CSkirmishAI(int teamId, const SkirmishAIKey&amp; key)
 		: teamId(teamId), key(key) {
 
 	library = IAILibraryManager::GetInstance()-&gt;FetchSkirmishAILibrary(key);

Modified: branches/caiinterface/rts/ExternalAI/SkirmishAI.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/SkirmishAI.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/SkirmishAI.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -20,20 +20,20 @@
 
 #include &quot;ISkirmishAI.h&quot;
 //#include &quot;ISkirmishAILibrary.h&quot;
-#include &quot;Interface/SAIInterfaceLibrary.h&quot;
+#include &quot;SkirmishAIKey.h&quot;
 
 class ISkirmishAILibrary;
 
 class CSkirmishAI : public ISkirmishAI {
 public:
-	CSkirmishAI(int teamId, const SSAIKey&amp; skirmishAIKey);
+	CSkirmishAI(int teamId, const SkirmishAIKey&amp; skirmishAIKey);
 	virtual ~CSkirmishAI();
 
 	virtual int HandleEvent(int topic, const void* data) const;
 
 private:
 	int teamId;
-	const SSAIKey key;
+	const SkirmishAIKey key;
 	const ISkirmishAILibrary* library;
 };
 

Added: branches/caiinterface/rts/ExternalAI/SkirmishAIKey.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/SkirmishAIKey.cpp	                        (rev 0)
+++ branches/caiinterface/rts/ExternalAI/SkirmishAIKey.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -0,0 +1,101 @@
+/*
+	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
+
+	This program is free software; you can redistribute it and/or modify
+	it under the terms of the GNU General Public License as published by
+	the Free Software Foundation; either version 2 of the License, or
+	(at your option) any later version.
+
+	This program is distributed in the hope that it will be useful,
+	but WITHOUT ANY WARRANTY; without even the implied warranty of
+	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+	GNU General Public License for more details.
+
+	You should have received a copy of the GNU General Public License
+	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#include &quot;SkirmishAIKey.h&quot;
+
+CR_BIND(SkirmishAIKey,)
+
+CR_REG_METADATA(SkirmishAIKey, (
+		CR_MEMBER(shortName),
+		CR_MEMBER(version),
+		CR_MEMBER(interface)
+		));
+
+SkirmishAIKey::SkirmishAIKey(
+		const std::string&amp; shortName,
+		const std::string&amp; version,
+		const AIInterfaceKey&amp; interface)
+		: shortName(shortName),
+		version(version),
+		interface(interface) {}
+
+SkirmishAIKey::SkirmishAIKey(const SkirmishAIKey&amp; base,
+		const AIInterfaceKey&amp; interface)
+		: shortName(base.shortName),
+		version(base.version),
+		interface(interface) {}
+
+SkirmishAIKey::SkirmishAIKey(const SkirmishAIKey&amp; toCopy)
+		: shortName(toCopy.shortName),
+		version(toCopy.version),
+		interface(toCopy.interface) {}
+
+SkirmishAIKey::~SkirmishAIKey() {}
+
+
+bool SkirmishAIKey::isEqual(const SkirmishAIKey&amp; otherKey) const {
+
+	if (shortName == otherKey.shortName) {
+		return version == otherKey.version;
+	} else {
+		return false;
+	}
+}
+bool SkirmishAIKey::isLessThen(const SkirmishAIKey&amp; otherKey) const {
+
+	if (shortName == otherKey.shortName) {
+		return version &lt; otherKey.version;
+	} else {
+		return shortName &lt; otherKey.shortName;
+	}
+}
+
+const std::string&amp; SkirmishAIKey::GetShortName() const {
+	return shortName;
+}
+const std::string&amp; SkirmishAIKey::GetVersion() const {
+	return version;
+}
+const AIInterfaceKey&amp; SkirmishAIKey::GetInterface() const {
+	return interface;
+}
+
+bool SkirmishAIKey::IsUnspecified() const {
+	return shortName == &quot;&quot;;
+}
+bool SkirmishAIKey::IsFullySpecified() const {
+	return shortName != &quot;&quot; || !interface.IsUnspecified();
+}
+
+bool SkirmishAIKey::operator==(const SkirmishAIKey&amp; otherKey) const {
+	return isEqual(otherKey);
+}
+bool SkirmishAIKey::operator!=(const SkirmishAIKey&amp; otherKey) const {
+	return !isEqual(otherKey);
+}
+bool SkirmishAIKey::operator&lt;(const SkirmishAIKey&amp; otherKey) const {
+	return isLessThen(otherKey);
+}
+bool SkirmishAIKey::operator&gt;(const SkirmishAIKey&amp; otherKey) const {
+	return !isLessThen(otherKey) &amp;&amp; !isEqual(otherKey);
+}
+bool SkirmishAIKey::operator&lt;=(const SkirmishAIKey&amp; otherKey) const {
+	return isLessThen(otherKey) || isEqual(otherKey);
+}
+bool SkirmishAIKey::operator&gt;=(const SkirmishAIKey&amp; otherKey) const {
+	return !isLessThen(otherKey);
+}


Property changes on: branches/caiinterface/rts/ExternalAI/SkirmishAIKey.cpp
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/caiinterface/rts/ExternalAI/SkirmishAIKey.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/SkirmishAIKey.h	                        (rev 0)
+++ branches/caiinterface/rts/ExternalAI/SkirmishAIKey.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -0,0 +1,61 @@
+/*
+	Copyright (c) 2008 Robin Vobruba &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">hoijui.quaero at gmail.com</A>&gt;
+
+	This program is free software; you can redistribute it and/or modify
+	it under the terms of the GNU General Public License as published by
+	the Free Software Foundation; either version 2 of the License, or
+	(at your option) any later version.
+
+	This program is distributed in the hope that it will be useful,
+	but WITHOUT ANY WARRANTY; without even the implied warranty of
+	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+	GNU General Public License for more details.
+
+	You should have received a copy of the GNU General Public License
+	along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef _SKIRMISHAIKEY_H
+#define _SKIRMISHAIKEY_H
+
+#include &lt;string&gt;
+#include &quot;creg/creg.h&quot;
+#include &quot;AIInterfaceKey.h&quot;
+
+struct SkirmishAIKey
+{
+	CR_DECLARE_STRUCT(SkirmishAIKey);
+
+private:
+	std::string shortName;
+	std::string version;
+	AIInterfaceKey interface;
+
+	bool isEqual(const SkirmishAIKey&amp; otherKey) const;
+	bool isLessThen(const SkirmishAIKey&amp; otherKey) const;
+
+public:
+	SkirmishAIKey(
+			const std::string&amp; shortName = &quot;&quot;,
+			const std::string&amp; version = &quot;&quot;,
+			const AIInterfaceKey&amp; interface = AIInterfaceKey());
+	SkirmishAIKey(const SkirmishAIKey&amp; base, const AIInterfaceKey&amp; interface);
+	SkirmishAIKey(const SkirmishAIKey&amp; toCopy);
+	~SkirmishAIKey();
+
+	const std::string&amp; GetShortName() const;
+	const std::string&amp; GetVersion() const;
+	const AIInterfaceKey&amp; GetInterface() const;
+
+	bool IsUnspecified() const;
+	bool IsFullySpecified() const;
+
+	bool operator==(const SkirmishAIKey&amp; otherKey) const;
+	bool operator!=(const SkirmishAIKey&amp; otherKey) const;
+	bool operator&lt;(const SkirmishAIKey&amp; otherKey) const;
+	bool operator&gt;(const SkirmishAIKey&amp; otherKey) const;
+	bool operator&lt;=(const SkirmishAIKey&amp; otherKey) const;
+	bool operator&gt;=(const SkirmishAIKey&amp; otherKey) const;
+};
+
+#endif // _SKIRMISHAIKEY_H


Property changes on: branches/caiinterface/rts/ExternalAI/SkirmishAIKey.h
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: branches/caiinterface/rts/ExternalAI/SkirmishAILibrary.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/SkirmishAILibrary.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/SkirmishAILibrary.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -20,29 +20,27 @@
 //#include &quot;Interface/SAIInterfaceLibrary.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;IAILibraryManager.h&quot;
+#include &quot;AIInterfaceKey.h&quot;
 #include &lt;string&gt;
 
 CSkirmishAILibrary::CSkirmishAILibrary(const SSAILibrary&amp; ai,
-		const SSAIKey&amp; key)
+		const SkirmishAIKey&amp; key)
 		: sSAI(ai), key(key) {}
 
 CSkirmishAILibrary::~CSkirmishAILibrary() {}
 
-SSAISpecifier CSkirmishAILibrary::GetSpecifier() const {
-	return key.ai;
-}
-SSAIKey CSkirmishAILibrary::GetKey() const {
+SkirmishAIKey CSkirmishAILibrary::GetKey() const {
 	return key;
 }
 
 LevelOfSupport CSkirmishAILibrary::GetLevelOfSupportFor(int teamId,
 			const std::string&amp; engineVersionString, int engineVersionNumber,
-		const SAIInterfaceSpecifier&amp; interfaceSpecifier) const {
+		const AIInterfaceKey&amp; interfaceKey) const {
 
 	if (sSAI.getLevelOfSupportFor != NULL) {
 		return sSAI.getLevelOfSupportFor(teamId, engineVersionString.c_str(),
-				engineVersionNumber, interfaceSpecifier.shortName,
-				interfaceSpecifier.version);
+				engineVersionNumber, interfaceKey.GetShortName().c_str(),
+				interfaceKey.GetVersion().c_str());
 	} else {
 		return LOS_Unknown;
 	}

Modified: branches/caiinterface/rts/ExternalAI/SkirmishAILibrary.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/SkirmishAILibrary.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/SkirmishAILibrary.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -20,17 +20,18 @@
 
 #include &quot;ISkirmishAILibrary.h&quot;
 
-#include &quot;Interface/SAIInterfaceLibrary.h&quot;
+#include &quot;SkirmishAIKey.h&quot;
 #include &quot;Interface/SSAILibrary.h&quot;
 #include &lt;vector&gt;
 
+struct AIInterfaceKey;
+
 class CSkirmishAILibrary : public ISkirmishAILibrary {
 public:
-	CSkirmishAILibrary(const SSAILibrary&amp; ai, const SSAIKey&amp; key);
+	CSkirmishAILibrary(const SSAILibrary&amp; ai, const SkirmishAIKey&amp; key);
 	virtual ~CSkirmishAILibrary();
 
-	virtual SSAISpecifier GetSpecifier() const;
-	virtual SSAIKey GetKey() const;
+	virtual SkirmishAIKey GetKey() const;
 
 	/**
 	 * Level of Support for a specific engine version and ai interface.
@@ -38,7 +39,7 @@
 	 */
 	virtual LevelOfSupport GetLevelOfSupportFor(int teamId,
 			const std::string&amp; engineVersionString, int engineVersionNumber,
-			const SAIInterfaceSpecifier&amp; interfaceSpecifier) const;
+			const AIInterfaceKey&amp; interfaceKey) const;
 
 	virtual void Init(int teamId) const;
 	virtual void Release(int teamId) const;
@@ -46,7 +47,7 @@
 
 private:
 	SSAILibrary sSAI;
-	SSAIKey key;
+	SkirmishAIKey key;
 
 private:
 	static const int MAX_INFOS = 128;

Modified: branches/caiinterface/rts/ExternalAI/SkirmishAILibraryInfo.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/SkirmishAILibraryInfo.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/SkirmishAILibraryInfo.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -19,7 +19,9 @@
 
 #include &quot;Interface/aidefines.h&quot;
 #include &quot;Interface/SSAILibrary.h&quot;
-#include &quot;Interface/SAIInterfaceLibrary.h&quot;
+#include &quot;Interface/SInfo.h&quot;
+#include &quot;Interface/SOption.h&quot;
+#include &quot;SkirmishAIKey.h&quot;
 #include &quot;ISkirmishAILibrary.h&quot;
 
 #include &quot;Platform/errorhandler.h&quot;
@@ -52,6 +54,8 @@
 			SPRING_VFS_RAW, tmpInfo, MAX_INFOS);
 	for (unsigned int i=0; i &lt; num; ++i) {
 		info[std::string(tmpInfo[i].key)] = tmpInfo[i];
+		InfoItem ii = copyInfoItem(&amp;(tmpInfo[i]));
+		info[std::string(ii.key)] = ii;
 	}
 
 	if (!aiOptionFile.empty()) {
@@ -73,12 +77,12 @@
 	}
 }
 
-SSAISpecifier CSkirmishAILibraryInfo::GetSpecifier() const {
+SkirmishAIKey CSkirmishAILibraryInfo::GetKey() const {
 
 	const char* sn = info.at(SKIRMISH_AI_PROPERTY_SHORT_NAME).value;
 	const char* v = info.at(SKIRMISH_AI_PROPERTY_VERSION).value;
-	SSAISpecifier specifier = {sn, v};
-	return specifier;
+	SkirmishAIKey key = SkirmishAIKey(sn, v);
+	return key;
 }
 
 std::string CSkirmishAILibraryInfo::GetDataDir() const {

Modified: branches/caiinterface/rts/ExternalAI/SkirmishAILibraryInfo.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/SkirmishAILibraryInfo.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/SkirmishAILibraryInfo.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -27,8 +27,8 @@
 class ISkirmishAILibrary;
 struct InfoItem;
 struct Option;
-struct SAIInterfaceSpecifier;
-struct SSAISpecifier;
+//struct SAIInterfaceSpecifier;
+struct SkirmishAIKey;
 
 class CSkirmishAILibraryInfo {
 public:
@@ -42,7 +42,7 @@
 	virtual void FreeCReferences();
 public:
 
-	virtual SSAISpecifier GetSpecifier() const;
+	virtual SkirmishAIKey GetKey() const;
 
 	virtual std::string GetDataDir() const;
 	virtual std::string GetFileName() const;

Modified: branches/caiinterface/rts/ExternalAI/SkirmishAIWrapper.cpp
===================================================================
--- branches/caiinterface/rts/ExternalAI/SkirmishAIWrapper.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/SkirmishAIWrapper.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -36,7 +36,7 @@
 
 #include &lt;sstream&gt;
 
-CR_BIND_DERIVED(CSkirmishAIWrapper, CObject, (0, SSAIKey()))
+CR_BIND_DERIVED(CSkirmishAIWrapper, CObject, (0, SkirmishAIKey()))
 CR_REG_METADATA(CSkirmishAIWrapper, (
 	CR_MEMBER(teamId),
 	CR_MEMBER(cheatEvents),
@@ -72,7 +72,7 @@
 	}
 
 
-CSkirmishAIWrapper::CSkirmishAIWrapper(int teamId, const SSAIKey&amp; key)
+CSkirmishAIWrapper::CSkirmishAIWrapper(int teamId, const SkirmishAIKey&amp; key)
 		: teamId(teamId), cheatEvents(false), key(key) {
 
 	LoadSkirmishAI(false);

Modified: branches/caiinterface/rts/ExternalAI/SkirmishAIWrapper.h
===================================================================
--- branches/caiinterface/rts/ExternalAI/SkirmishAIWrapper.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/ExternalAI/SkirmishAIWrapper.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -21,8 +21,8 @@
 #include &quot;Object.h&quot;
 #include &quot;ISkirmishAI.h&quot;
 #include &quot;GlobalAICallback.h&quot;
+#include &quot;SkirmishAIKey.h&quot;
 #include &quot;Interface/SAICallback.h&quot;
-#include &quot;Interface/SAIInterfaceLibrary.h&quot;
 #include &quot;Platform/SharedLib.h&quot;
 
 #include &lt;map&gt;
@@ -36,7 +36,7 @@
 public:
 	CR_DECLARE(CSkirmishAIWrapper);
 
-	CSkirmishAIWrapper(int teamId, const SSAIKey&amp; key);
+	CSkirmishAIWrapper(int teamId, const SkirmishAIKey&amp; key);
 	~CSkirmishAIWrapper();
 
 	void Serialize(creg::ISerializer *s);
@@ -92,7 +92,7 @@
 	ISkirmishAI* ai;
 	CGlobalAICallback* callback;
 	SAICallback* c_callback;
-	SSAIKey key;
+	SkirmishAIKey key;
 	const struct InfoItem* info;
 	unsigned int size_info;
 

Modified: branches/caiinterface/rts/Game/GameServer.cpp
===================================================================
--- branches/caiinterface/rts/Game/GameServer.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Game/GameServer.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -18,6 +18,7 @@
 #include &lt;stdlib.h&gt; // why is this here?
 
 #include &quot;mmgr.h&quot;
+#include &quot;ExternalAI/SkirmishAIKey.h&quot;
 
 #include &quot;GameServer.h&quot;
 
@@ -1218,7 +1219,7 @@
 				hasPlayer = true;
 			}
 		}
-		if (!SSAIKey_Comparator::IsEmpty(teamHandler-&gt;Team(a)-&gt;skirmishAISpecifier)) // is not empty?
+		if (!teamHandler-&gt;Team(a)-&gt;skirmishAIKey.IsUnspecified()) // is not empty?
 			hasPlayer = true;
 
 		if (!teamHandler-&gt;Team(a)-&gt;isDead &amp;&amp; !teamHandler-&gt;Team(a)-&gt;gaia &amp;&amp; hasPlayer)

Modified: branches/caiinterface/rts/Game/Player.cpp
===================================================================
--- branches/caiinterface/rts/Game/Player.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Game/Player.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -10,7 +10,6 @@
 #include &quot;PlayerHandler.h&quot;
 #include &quot;Sim/Misc/TeamHandler.h&quot;
 #include &quot;Sim/Misc/GlobalSynced.h&quot;
-#include &quot;ExternalAI/Interface/SAIInterfaceLibrary.h&quot;
 #ifdef DIRECT_CONTROL_ALLOWED
 #  include &quot;UI/MouseHandler.h&quot;
 #  include &quot;CameraHandler.h&quot;
@@ -111,7 +110,7 @@
 	for (int t = 0; t &lt; teamHandler-&gt;ActiveTeams(); t++) {
 		const CTeam* team = teamHandler-&gt;Team(t);
 		if (team &amp;&amp; team-&gt;isAI &amp;&amp;
-			!SSAIKey_Comparator::IsEmpty(team-&gt;skirmishAISpecifier) &amp;&amp; // is not empty? -&gt; luaAI does not require client control
+			!team-&gt;skirmishAIKey.IsUnspecified() &amp;&amp; // is not empty? -&gt; luaAI does not require client control
 			(team-&gt;leader == playerNum)) {
 			controlledTeams.insert(t);
 		}

Modified: branches/caiinterface/rts/Game/StartScripts/CommanderScript.cpp
===================================================================
--- branches/caiinterface/rts/Game/StartScripts/CommanderScript.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Game/StartScripts/CommanderScript.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -7,7 +7,7 @@
 
 #include &quot;CommanderScript.h&quot;
 #include &quot;ExternalAI/EngineOutHandler.h&quot;
-#include &quot;ExternalAI/Interface/SAIInterfaceLibrary.h&quot;
+#include &quot;ExternalAI/SkirmishAIKey.h&quot;
 #include &quot;Game/Game.h&quot;
 #include &quot;Game/GameSetup.h&quot;
 #include &quot;Game/UI/MiniMap.h&quot;
@@ -58,9 +58,9 @@
 		team-&gt;energyStorage = 20;
 
 		// create a Skirmish AI if required
-		if (!SSAIKey_Comparator::IsEmpty(team-&gt;skirmishAISpecifier) // is an AI specifyed?
+		if (!team-&gt;skirmishAIKey.IsUnspecified() // is an AI specifyed?
 				&amp;&amp; (gu-&gt;myPlayerNum == team-&gt;leader)) {
-			eoh-&gt;CreateSkirmishAI(a, team-&gt;skirmishAISpecifier);
+			eoh-&gt;CreateSkirmishAI(a, team-&gt;skirmishAIKey);
 		}
 
 		// get the team startup info

Modified: branches/caiinterface/rts/Game/StartScripts/SkirmishAITestScript.cpp
===================================================================
--- branches/caiinterface/rts/Game/StartScripts/SkirmishAITestScript.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Game/StartScripts/SkirmishAITestScript.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -22,19 +22,19 @@
 extern std::string stupidGlobalMapname;
 
 
-CSkirmishAITestScript::CSkirmishAITestScript(const SSAIKey&amp; key,
+CSkirmishAITestScript::CSkirmishAITestScript(const SkirmishAIKey&amp; key,
 		const std::map&lt;std::string, std::string&gt;&amp; options)
 		: CScript(std::string(&quot;Skirmish AI test (&quot;)
-			+ std::string(key.ai.shortName) + std::string(&quot; v&quot;)
-			+ std::string(key.ai.version) + std::string(&quot;)&quot;)),
+			+ std::string(key.GetShortName()) + std::string(&quot; v&quot;)
+			+ std::string(key.GetVersion() + std::string(&quot;)&quot;))),
 		key(key), options(options)
 {
-	// make sure CSelectedUnits::AiOrder()
-	// still works without a setup script
-	teamHandler-&gt;Team(1)-&gt;isAI = true;
-	teamHandler-&gt;Team(1)-&gt;skirmishAISpecifier = key;
-	teamHandler-&gt;Team(1)-&gt;skirmishAIOptions = options;
-	teamHandler-&gt;Team(1)-&gt;leader = 0;
+	teamHandler-&gt;Team(skirmishAI_teamId)-&gt;isAI = true;
+	teamHandler-&gt;Team(skirmishAI_teamId)-&gt;skirmishAIKey
+			= SkirmishAIKey(
+					&quot;CSkirmishAITestScript:TEMP&quot;,
+					&quot;CSkirmishAITestScript:TEMP&quot;);
+	teamHandler-&gt;Team(skirmishAI_teamId)-&gt;leader = 0;
 }
 
 
@@ -42,18 +42,25 @@
 
 void CSkirmishAITestScript::GameStart(void)
 {
-	eoh-&gt;CreateSkirmishAI(1, key);
+	// make sure CSelectedUnits::AiOrder()
+	// still works without a setup script
+	teamHandler-&gt;Team(skirmishAI_teamId)-&gt;isAI = true;
+	teamHandler-&gt;Team(skirmishAI_teamId)-&gt;skirmishAIKey = key;
+	teamHandler-&gt;Team(skirmishAI_teamId)-&gt;skirmishAIOptions = options;
+	teamHandler-&gt;Team(skirmishAI_teamId)-&gt;leader = 0;
 
-	teamHandler-&gt;Team(0)-&gt;energy        = 1000;
-	teamHandler-&gt;Team(0)-&gt;energyStorage = 1000;
-	teamHandler-&gt;Team(0)-&gt;metal         = 1000;
-	teamHandler-&gt;Team(0)-&gt;metalStorage  = 1000;
+	teamHandler-&gt;Team(player_teamId)-&gt;energy        = 1000;
+	teamHandler-&gt;Team(player_teamId)-&gt;energyStorage = 1000;
+	teamHandler-&gt;Team(player_teamId)-&gt;metal         = 1000;
+	teamHandler-&gt;Team(player_teamId)-&gt;metalStorage  = 1000;
 
-	teamHandler-&gt;Team(1)-&gt;energy        = 1000;
-	teamHandler-&gt;Team(1)-&gt;energyStorage = 1000;
-	teamHandler-&gt;Team(1)-&gt;metal         = 1000;
-	teamHandler-&gt;Team(1)-&gt;metalStorage  = 1000;
+	teamHandler-&gt;Team(skirmishAI_teamId)-&gt;energy        = 1000;
+	teamHandler-&gt;Team(skirmishAI_teamId)-&gt;energyStorage = 1000;
+	teamHandler-&gt;Team(skirmishAI_teamId)-&gt;metal         = 1000;
+	teamHandler-&gt;Team(skirmishAI_teamId)-&gt;metalStorage  = 1000;
 
+	eoh-&gt;CreateSkirmishAI(1, key);
+
 	const std::string startUnit0 = sideParser.GetStartUnit(0, &quot;&quot;);
 	const std::string startUnit1 = sideParser.GetStartUnit(1, startUnit0);
 	// default to side 1, in case mod has only 1 side

Modified: branches/caiinterface/rts/Game/StartScripts/SkirmishAITestScript.h
===================================================================
--- branches/caiinterface/rts/Game/StartScripts/SkirmishAITestScript.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Game/StartScripts/SkirmishAITestScript.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -2,21 +2,23 @@
 #define _SKIRMISHAITESTSCRIPT_H
 
 #include &quot;Script.h&quot;
-#include &quot;ExternalAI/Interface/SAIInterfaceLibrary.h&quot;
+#include &quot;ExternalAI/SkirmishAIKey.h&quot;
 
 #include &lt;map&gt;
 #include &lt;string&gt;
 
 class CSkirmishAITestScript : public CScript
 {
-	SSAIKey key;
+	SkirmishAIKey key;
 	std::map&lt;std::string, std::string&gt; options;
+	static const int player_teamId = 0;
+	static const int skirmishAI_teamId = 1;
 public:
-	CSkirmishAITestScript(const SSAIKey&amp; key,
+	CSkirmishAITestScript(const SkirmishAIKey&amp; key,
 			const std::map&lt;std::string, std::string&gt;&amp; options = (std::map&lt;std::string, std::string&gt;()));
 	~CSkirmishAITestScript(void);
 
 	void GameStart(void);
 };
 
-#endif	// _SKIRMISHAITESTSCRIPT_H
+#endif // _SKIRMISHAITESTSCRIPT_H

Modified: branches/caiinterface/rts/Sim/Misc/Resource.cpp
===================================================================
--- branches/caiinterface/rts/Sim/Misc/Resource.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Sim/Misc/Resource.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -23,8 +23,7 @@
 
 CR_REG_METADATA(CResource, (
 				CR_MEMBER(name),
-				CR_MEMBER(optimum),
-				CR_MEMBER(goodToHave)
+				CR_MEMBER(optimum)
 				));
 
 //////////////////////////////////////////////////////////////////////

Modified: branches/caiinterface/rts/Sim/Misc/Resource.h
===================================================================
--- branches/caiinterface/rts/Sim/Misc/Resource.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Sim/Misc/Resource.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -31,7 +31,6 @@
 
 	std::string name;
 	float optimum;
-	bool goodToHave;
 };
 
 #endif // _RESOURCE_H

Modified: branches/caiinterface/rts/Sim/Misc/ResourceHandler.cpp
===================================================================
--- branches/caiinterface/rts/Sim/Misc/ResourceHandler.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Sim/Misc/ResourceHandler.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -64,21 +64,21 @@
 }
 
 
-const CResource* CResourceHandler::GetResource(int resourceIndex) const
+const CResource* CResourceHandler::GetResource(int resourceId) const
 {
-	if (resourceIndex &gt;= (int)resources.size()) {
+	if (resourceId &gt;= (int)resources.size()) {
 		return NULL;
 	} else {
-		return &amp;resources[resourceIndex];
+		return &amp;resources[resourceId];
 	}
 }
 
 const CResource* CResourceHandler::GetResourceByName(const std::string&amp; resourceName) const
 {
-	return GetResource(GetResourceIndex(resourceName));
+	return GetResource(GetResourceId(resourceName));
 }
 
-int CResourceHandler::GetResourceIndex(const std::string&amp; resourceName) const
+int CResourceHandler::GetResourceId(const std::string&amp; resourceName) const
 {
 	int size_res = resources.size();
 	for (int r=0; r &lt; size_res; ++r) {
@@ -96,24 +96,24 @@
 }
 
 
-//bool CResourceHandler::IsMetal(int resourceIndex) const
+//bool CResourceHandler::IsMetal(int resourceId) const
 //{
-//	const CResource* res = GetResource(resourceIndex);
+//	const CResource* res = GetResource(resourceId);
 //	return res &amp;&amp; (res-&gt;name == &quot;Metal&quot;);
 //}
 //
-//bool CResourceHandler::IsEnergy(int resourceIndex) const
+//bool CResourceHandler::IsEnergy(int resourceId) const
 //{
-//	const CResource* res = GetResource(resourceIndex);
+//	const CResource* res = GetResource(resourceId);
 //	return res &amp;&amp; (res-&gt;name == &quot;Energy&quot;);
 //}
 
-int CResourceHandler::GetMetalIndex() const
+int CResourceHandler::GetMetalId() const
 {
 	return METAL_INDEX;
 }
 
-int CResourceHandler::GetEnergyIndex() const
+int CResourceHandler::GetEnergyId() const
 {
 	return ENERGY_INDEX;
 }

Modified: branches/caiinterface/rts/Sim/Misc/ResourceHandler.h
===================================================================
--- branches/caiinterface/rts/Sim/Misc/ResourceHandler.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Sim/Misc/ResourceHandler.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -33,12 +33,12 @@
 
 	/**
 	 * @brief	resource
-	 * @param	resourceIndex index to fetch
+	 * @param	resourceId index to fetch
 	 * @return	the searched resource
 	 *
 	 * Accesses a CResource instance at a given index
 	 */
-	const CResource* GetResource(int resourceIndex) const;
+	const CResource* GetResource(int resourceId) const;
 	/**
 	 * @brief	resource by name
 	 * @param	resourceName name of the resource to fetch
@@ -54,14 +54,14 @@
 	 *
 	 * Accesses a resource by name
 	 */
-	int GetResourceIndex(const std::string&amp; resourceName) const;
+	int GetResourceId(const std::string&amp; resourceName) const;
 
 	unsigned int GetNumResources() const;
 
-//	bool IsMetal(int resourceIndex) const;
-//	bool IsEnergy(int resourceIndex) const;
-	int GetMetalIndex() const;
-	int GetEnergyIndex() const;
+//	bool IsMetal(int resourceId) const;
+//	bool IsEnergy(int resourceId) const;
+	int GetMetalId() const;
+	int GetEnergyId() const;
 
 private:
 	static CResourceHandler* instance;

Modified: branches/caiinterface/rts/Sim/Misc/Team.cpp
===================================================================
--- branches/caiinterface/rts/Sim/Misc/Team.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Sim/Misc/Team.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -40,7 +40,7 @@
 				CR_MEMBER(side),
 				CR_MEMBER(isAI),
 				CR_MEMBER(luaAI),
-				CR_MEMBER(skirmishAISpecifier),
+				CR_MEMBER(skirmishAIKey),
 				CR_MEMBER(skirmishAIOptions),
 				CR_MEMBER(units),
 				CR_MEMBER(startPos),

Modified: branches/caiinterface/rts/Sim/Misc/Team.h
===================================================================
--- branches/caiinterface/rts/Sim/Misc/Team.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Sim/Misc/Team.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -10,7 +10,7 @@
 #include &lt;list&gt;
 #include &quot;Platform/byteorder.h&quot;
 #include &quot;Sim/Units/UnitSet.h&quot;
-#include &quot;ExternalAI/Interface/SAIInterfaceLibrary.h&quot;
+#include &quot;ExternalAI/SkirmishAIKey.h&quot;
 
 class CTeam
 {
@@ -67,7 +67,7 @@
 
 	bool isAI;
 	std::string luaAI;
-	SSAIKey skirmishAISpecifier;
+	SkirmishAIKey skirmishAIKey;
 	std::map&lt;std::string, std::string&gt; skirmishAIOptions;
 
 	// color info is unsynced

Modified: branches/caiinterface/rts/Sim/Misc/TeamHandler.cpp
===================================================================
--- branches/caiinterface/rts/Sim/Misc/TeamHandler.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/Sim/Misc/TeamHandler.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -92,17 +92,16 @@
 			team-&gt;isAI = true;
 		} else if (!(teamStartingData.skirmishAIShortName.empty())) {
 			if (setup-&gt;hostDemo) {
-				SSAIKey key = {{NULL, NULL}, {NULL, NULL}};
-				team-&gt;skirmishAISpecifier = key;
+				team-&gt;skirmishAIKey = SkirmishAIKey(); // unspecifyed AI Key
 			} else {
 				const char* sn = teamStartingData.skirmishAIShortName.c_str();
 				const char* v = teamStartingData.skirmishAIVersion.empty()
 						? NULL : teamStartingData.skirmishAIVersion.c_str();
-				SSAISpecifier spec = {sn, v};
-				SSAIKey fittingKey =
+				SkirmishAIKey spec = SkirmishAIKey(sn, v);
+				SkirmishAIKey fittingKey =
 						IAILibraryManager::GetInstance()-&gt;ResolveSkirmishAIKey(spec);
-				if (!SSAIKey_Comparator::IsEmpty(fittingKey)) {
-					team-&gt;skirmishAISpecifier = fittingKey;
+				if (!fittingKey.IsUnspecified()) {
+					team-&gt;skirmishAIKey = fittingKey;
 					team-&gt;skirmishAIOptions = teamStartingData.skirmishAIOptions;
 					team-&gt;isAI = true;
 				} else {
@@ -110,7 +109,7 @@
 					char s_msg[MAX_MSG_LENGTH + 1];
 					SNPRINTF(s_msg, MAX_MSG_LENGTH,
 							&quot;Specifyed Skirmish AI could not be found: %s (version: %s)&quot;,
-							spec.shortName, spec.version != NULL ? spec.version : &quot;&lt;not specifyed&gt;&quot;);
+							spec.GetShortName().c_str(), spec.GetVersion() != &quot;&quot; ? spec.GetVersion().c_str() : &quot;&lt;not specifyed&gt;&quot;);
 					handleerror(NULL, s_msg, &quot;Team Handler Error&quot;, MBF_OK | MBF_EXCL);
 				}
 			}

Modified: branches/caiinterface/rts/System/Script/LuaFunctions.cpp
===================================================================
--- branches/caiinterface/rts/System/Script/LuaFunctions.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/System/Script/LuaFunctions.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -44,11 +44,11 @@
 		eventHandler.GameOver();
 	}
 
-	void CreateSkirmishAI(int teamId, const SSAIKey&amp; key,
+	void CreateSkirmishAI(int teamId, const SkirmishAIKey&amp; key,
 			const std::map&lt;std::string, std::string&gt;&amp; options)
 	{
 		teamHandler-&gt;Team(teamId)-&gt;isAI = true;
-		teamHandler-&gt;Team(teamId)-&gt;skirmishAISpecifier = key;
+		teamHandler-&gt;Team(teamId)-&gt;skirmishAIKey = key;
 		teamHandler-&gt;Team(teamId)-&gt;skirmishAIOptions = options;
 		teamHandler-&gt;Team(teamId)-&gt;leader = 0;
 		eoh-&gt;CreateSkirmishAI(teamId, key);

Modified: branches/caiinterface/rts/System/Script/LuaFunctions.h
===================================================================
--- branches/caiinterface/rts/System/Script/LuaFunctions.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/rts/System/Script/LuaFunctions.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -15,7 +15,7 @@
 class CTeam;
 class CFeature;
 struct UnitDef;
-struct SSAIKey;
+struct SkirmishAIKey;
 
 // This class is meant to contain COBject and its descendants only..
 template&lt;class A&gt;
@@ -32,7 +32,7 @@
 
 namespace luafunctions
 {
-	void CreateSkirmishAI(int teamId, const SSAIKey&amp; key,
+	void CreateSkirmishAI(int teamId, const SkirmishAIKey&amp; key,
 			const std::map&lt;std::string, std::string&gt;&amp; options = (std::map&lt;std::string, std::string&gt;()));
 	void EndGame();
 	void UnitGiveCommand(CObject_pointer&lt;CUnit&gt;* u, Command* c);

Added: branches/caiinterface/rts/build/cmake/FindJAVA.cmake
===================================================================
--- branches/caiinterface/rts/build/cmake/FindJAVA.cmake	                        (rev 0)
+++ branches/caiinterface/rts/build/cmake/FindJAVA.cmake	2008-12-04 11:02:27 UTC (rev 7115)
@@ -0,0 +1,235 @@
+################################################################################
+# cmake module for finding JAVA
+#
+# sets following variables:
+#
+# JAVA_FOUND    - TRUE/FALSE (javadoc in ignored for the test)
+#
+# JAVA_HOME     - base dir where subdirs bin, lib, jre and include are located
+# JAVA_BIN_PATH - path to subdirectory &quot;${JAVA_HOME}/bin&quot;
+#
+# JAVA_RUNTIME  - path to ${JAVA_BIN_PATH}/java
+# JAVA_COMPILE  - path to ${JAVA_BIN_PATH}/javac
+# JAVA_ARCHIVE  - path to ${JAVA_BIN_PATH}/jar
+# JAVA_DOC      - path to ${JAVA_BIN_PATH}/javadoc
+#
+# JAVA_MAJOR_VERSION
+# JAVA_MINOR_VERSION
+# JAVA_PATCH_LEVEL
+#
+# JAVA_VERSION - ${JAVA_MAJOR_VERSION}.${JAVA_MINOR_VERSION}.${JAVA_PATCH_LEVEL}
+#
+# @author Jan Engels, DESY
+################################################################################
+
+SET( JAVA_FOUND FALSE )
+MARK_AS_ADVANCED( JAVA_FOUND )
+
+IF( NOT DEFINED ENV{JDK_HOME} AND 
+    NOT DEFINED ENV{JAVA_HOME} AND
+    NOT DEFINED JAVA_HOME AND
+    NOT DEFINED JDK_HOME )
+
+    IF( NOT JAVA_FIND_QUIETLY )
+        MESSAGE( STATUS &quot;Autodetecting Java...&quot; )
+    ENDIF()
+    
+    # use the CMake FindJava.cmake module
+    FIND_PACKAGE( Java )
+    
+    IF( JAVA_RUNTIME AND JAVA_COMPILE AND JAVA_ARCHIVE )
+        IF( UNIX AND NOT APPLE )
+            # look for the file binary
+            FIND_PROGRAM( FILE_BIN
+                file
+                /bin
+                /usr/bin
+                /usr/local/bin
+                /sbin
+            )
+            MARK_AS_ADVANCED( FILE_BIN )
+            
+            IF( FILE_BIN )
+
+                # initialize some variables
+                SET( java_bin &quot;${JAVA_RUNTIME}&quot; )
+                SET( java_link_found TRUE )
+                SET( java_link_error FALSE )
+                MARK_AS_ADVANCED( java_bin java_link_found java_link_error )
+
+                # dereference links
+                WHILE( java_link_found AND NOT java_link_error )
+                    # check if the java binary is a symbolic link
+                    EXEC_PROGRAM( ${FILE_BIN} ARGS &quot;${java_bin}&quot;
+                        OUTPUT_VARIABLE out_tmp
+                        RETURN_VALUE out_ret )
+                    IF( out_ret )
+                        IF( NOT JAVA_FIND_QUIETLY )
+                            MESSAGE( STATUS &quot;Error dereferencing links to Java Home!!&quot; )
+                            MESSAGE( STATUS &quot;${out_tmp}&quot; )
+                        ENDIF()
+                        SET( java_link_error TRUE )
+                    ENDIF()
+                    IF( NOT java_link_error )
+                        # set variable if link is found
+                        STRING( REGEX MATCH &quot; symbolic link to &quot; java_link_found &quot;${out_tmp}&quot; )
+                        IF( java_link_found )
+                            # get the file to where the link points to
+                            STRING( REGEX REPLACE &quot;.* symbolic link to[^/]+([^'`&#180;]+).*&quot; &quot;\\1&quot; out_regex &quot;${out_tmp}&quot; )
+                            IF( NOT JAVA_FIND_QUIETLY )
+                                MESSAGE( STATUS &quot;Java binary ${java_bin} is a symbolic link to ${out_regex}&quot; )
+                            ENDIF()
+                            SET( java_bin &quot;${out_regex}&quot; )
+                        ENDIF()
+                    ENDIF()
+                ENDWHILE()
+
+                # check if something went wrong
+                IF( NOT java_link_error )
+                    # if not set JAVA_RUNTIME to the dereferenced link
+                    SET( JAVA_RUNTIME &quot;${java_bin}&quot; )
+                ENDIF()
+            ENDIF()
+        ENDIF()
+        
+        # extract java home path out of full path to java runtime
+        STRING( REGEX REPLACE &quot;(.*)\\/[^/]+\\/java$&quot; &quot;\\1&quot; JAVA_HOME ${JAVA_RUNTIME} )
+        # extract java bin path out of full path to java runtime
+        STRING( REGEX REPLACE &quot;(.*)\\/java$&quot; &quot;\\1&quot; JAVA_BIN_PATH ${JAVA_RUNTIME} )
+    ELSE()
+        IF( NOT JAVA_FIND_QUIETLY )
+            MESSAGE( STATUS &quot;Failed to autodetect Java!!&quot; )
+        ENDIF()
+    ENDIF()
+ELSE()
+    # definition of JAVA_HOME or JDK_HOME in cmake has priority over env vars
+    IF( DEFINED JDK_HOME OR DEFINED JAVA_HOME )
+        # ensure that both variables are set correctly (JDK_HOME as well as JAVA_HOME)
+        IF( DEFINED JDK_HOME AND DEFINED JAVA_HOME )
+            IF( NOT &quot;${JDK_HOME}&quot; STREQUAL &quot;${JAVA_HOME}&quot; )
+                IF( NOT JAVA_FIND_QUIETLY )
+                    MESSAGE( STATUS 
+                        &quot;WARNING: JDK_HOME and JAVA_HOME are set to different paths!!&quot; )
+                    MESSAGE( STATUS &quot;JDK_HOME: ${JDK_HOME}&quot; )
+                    MESSAGE( STATUS &quot;JAVA_HOME: ${JAVA_HOME}&quot; )
+                    MESSAGE( STATUS &quot;${JAVA_HOME} will be used in this installation!!&quot; )
+                ENDIF()
+            ENDIF()
+        ELSE()
+            IF( NOT DEFINED JAVA_HOME )
+                SET( JAVA_HOME &quot;${JDK_HOME}&quot; )
+            ENDIF()
+        ENDIF()
+    ELSE()
+        # in case JDK_HOME or JAVA_HOME already set ensure that both variables
+        # are set correctly (JDK_HOME as well as JAVA_HOME)
+        IF( DEFINED ENV{JDK_HOME} AND DEFINED ENV{JAVA_HOME} )
+            IF( NOT &quot;$ENV{JDK_HOME}&quot; STREQUAL &quot;$ENV{JAVA_HOME}&quot; )
+                IF( NOT JAVA_FIND_QUIETLY )
+                    MESSAGE( STATUS 
+                        &quot;WARNING: JDK_HOME and JAVA_HOME are set to different paths!!&quot; )
+                    MESSAGE( STATUS &quot;JDK_HOME: $ENV{JDK_HOME}&quot; )
+                    MESSAGE( STATUS &quot;JAVA_HOME: $ENV{JAVA_HOME}&quot; )
+                    MESSAGE( STATUS &quot;$ENV{JAVA_HOME} will be used in this installation!!&quot; )
+                ENDIF()
+            ENDIF()
+            SET( JAVA_HOME &quot;$ENV{JAVA_HOME}&quot; )
+        ELSE()
+            IF( DEFINED ENV{JAVA_HOME} )
+                SET( JAVA_HOME &quot;$ENV{JAVA_HOME}&quot; )
+            ENDIF()
+            IF( DEFINED ENV{JDK_HOME} )
+                SET( JAVA_HOME &quot;$ENV{JDK_HOME}&quot; )
+            ENDIF()
+        ENDIF()
+    ENDIF()
+
+    SET( JAVA_BIN_PATH JAVA_BIN_PATH-NOTFOUND )
+    FIND_PATH( JAVA_BIN_PATH
+        java
+        ${JAVA_HOME}/bin
+        ${JAVA_HOME}/Commands   # FIXME MacOS
+        NO_DEFAULT_PATH )
+    
+    IF( NOT JAVA_BIN_PATH AND NOT JAVA_FIND_QUIETLY )
+        MESSAGE( STATUS &quot;${JAVA_HOME} is not a valid path for Java!!&quot; )
+    ENDIF()
+
+    IF( JAVA_BIN_PATH )
+        # find java, javac, jar and javadoc
+        SET( JAVA_RUNTIME JAVA_RUNTIME-NOTFOUND )
+        FIND_PROGRAM( JAVA_RUNTIME
+            java
+            ${JAVA_BIN_PATH}
+            NO_DEFAULT_PATH )
+      
+        SET( JAVA_COMPILE JAVA_COMPILE-NOTFOUND )
+        FIND_PROGRAM( JAVA_COMPILE
+            javac
+            ${JAVA_BIN_PATH}
+            NO_DEFAULT_PATH )
+        
+        SET( JAVA_ARCHIVE JAVA_ARCHIVE-NOTFOUND )
+        FIND_PROGRAM( JAVA_ARCHIVE
+            jar
+            ${JAVA_BIN_PATH}
+            NO_DEFAULT_PATH )
+         
+        SET( JAVA_DOC JAVA_DOC-NOTFOUND )
+        FIND_PROGRAM( JAVA_DOC
+            javadoc
+            ${JAVA_BIN_PATH}
+            NO_DEFAULT_PATH )
+        
+        # abort if not found
+        IF( NOT JAVA_RUNTIME AND NOT JAVA_FIND_QUIETLY )
+            MESSAGE( STATUS &quot;Could not find java!!&quot; )
+        ENDIF()
+        IF( NOT JAVA_COMPILE AND NOT JAVA_FIND_QUIETLY )
+            MESSAGE( STATUS &quot;Could not find javac!!&quot; )
+        ENDIF()
+        IF( NOT JAVA_ARCHIVE AND NOT JAVA_FIND_QUIETLY )
+            MESSAGE( STATUS &quot;Could not find jar!!&quot; )
+        ENDIF()
+        IF( NOT JAVA_DOC AND NOT JAVA_FIND_QUIETLY )
+            MESSAGE( STATUS &quot;Could not find javadoc!!&quot; )
+        ENDIF()
+    ENDIF()
+ENDIF()
+
+IF( JAVA_RUNTIME AND JAVA_COMPILE AND JAVA_ARCHIVE )
+    
+    SET( JAVA_FOUND TRUE )
+    
+    # parse the output of java -version
+    EXEC_PROGRAM( &quot;${JAVA_RUNTIME}&quot; ARGS &quot;-version&quot;
+            OUTPUT_VARIABLE out_tmp
+            RETURN_VALUE out_ret )
+
+    IF( out_ret )
+        IF( NOT JAVA_FIND_QUIETLY )
+            MESSAGE( STATUS &quot;Error executing java -version!! Java version variables will not be set!!&quot; )
+        ENDIF()
+    ELSE()
+        # extract major/minor version and patch level from &quot;java -version&quot; output
+        STRING( REGEX REPLACE &quot;.* version \&quot;([0-9]+)\\.[0-9]+\\.[0-9]+.*&quot;
+                &quot;\\1&quot; JAVA_MAJOR_VERSION &quot;${out_tmp}&quot; )
+        STRING( REGEX REPLACE &quot;.* version \&quot;[0-9]+\\.([0-9]+)\\.[0-9]+.*&quot;
+                &quot;\\1&quot; JAVA_MINOR_VERSION &quot;${out_tmp}&quot; )
+        STRING( REGEX REPLACE &quot;.* version \&quot;[0-9]+\\.[0-9]+\\.([0-9]+).*&quot;
+                &quot;\\1&quot; JAVA_PATCH_LEVEL &quot;${out_tmp}&quot; )
+
+        SET( JAVA_VERSION &quot;${JAVA_MAJOR_VERSION}.${JAVA_MINOR_VERSION}.${JAVA_PATCH_LEVEL}&quot; )
+
+        # display info
+        MESSAGE( STATUS &quot;Java version ${JAVA_VERSION} configured successfully!&quot; )
+    ENDIF()
+ELSE()
+    IF( JAVA_FIND_REQUIRED )
+        MESSAGE( FATAL_ERROR &quot;Failed configuring Java!!&quot; )
+    ENDIF()
+    IF( NOT JAVA_FIND_QUIETLY )
+        MESSAGE( STATUS &quot;Failed configuring Java!!&quot; )
+    ENDIF()
+ENDIF()
+


Property changes on: branches/caiinterface/rts/build/cmake/FindJAVA.cmake
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: branches/caiinterface/tools/unitsync/unitsync.cpp
===================================================================
--- branches/caiinterface/tools/unitsync/unitsync.cpp	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/tools/unitsync/unitsync.cpp	2008-12-04 11:02:27 UTC (rev 7115)
@@ -21,7 +21,7 @@
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;Sim/Misc/SideParser.h&quot;
 #include &quot;ExternalAI/Interface/aidefines.h&quot;
-#include &quot;ExternalAI/Interface/SSAILibrary.h&quot;
+//#include &quot;ExternalAI/Interface/SSkirmishAISpecifier.h&quot;
 #include &quot;ExternalAI/Interface/SInfo.h&quot;
 #include &quot;ExternalAI/Interface/SOption.h&quot;
 #include &quot;System/Exceptions.h&quot;
@@ -1927,23 +1927,23 @@
 	return NULL;
 }
 
-EXPORT(struct SSAISpecifier) GetSkirmishAISpecifier(int index) {
-	
-	SSAISpecifier spec = {NULL, NULL};
-	
-	int num = GetSkirmishAIInfoCount(index);
-	
-	for (int i=0; i &lt; num; ++i) {
-		string info_key = string(GetInfoKey(i));
-		if (info_key == SKIRMISH_AI_PROPERTY_SHORT_NAME) {
-			spec.shortName = GetInfoValue(i);
-		} else if (info_key == SKIRMISH_AI_PROPERTY_VERSION) {
-			spec.version = GetInfoValue(i);
-		}
-	}
-	
-	return spec;
-}
+//EXPORT(struct SSkirmishAISpecifier) GetSkirmishAISpecifier(int index) {
+//
+//	SSkirmishAISpecifier spec = {NULL, NULL};
+//
+//	int num = GetSkirmishAIInfoCount(index);
+//
+//	for (int i=0; i &lt; num; ++i) {
+//		string info_key = string(GetInfoKey(i));
+//		if (info_key == SKIRMISH_AI_PROPERTY_SHORT_NAME) {
+//			spec.shortName = GetInfoValue(i);
+//		} else if (info_key == SKIRMISH_AI_PROPERTY_VERSION) {
+//			spec.version = GetInfoValue(i);
+//		}
+//	}
+//
+//	return spec;
+//}
 
 EXPORT(int) GetSkirmishAIOptionCount(int index) {
 

Modified: branches/caiinterface/tools/unitsync/unitsync_api.h
===================================================================
--- branches/caiinterface/tools/unitsync/unitsync_api.h	2008-12-03 00:22:20 UTC (rev 7114)
+++ branches/caiinterface/tools/unitsync/unitsync_api.h	2008-12-04 11:02:27 UTC (rev 7115)
@@ -41,7 +41,7 @@
 EXPORT(int         ) GetInfoMap(const char* filename, const char* name, void* data, int typeHint);
 
 EXPORT(int         ) GetSkirmishAICount();
-EXPORT(struct SSAISpecifier) GetSkirmishAISpecifier(int index);
+//EXPORT(struct SSkirmishAISpecifier) GetSkirmishAISpecifier(int index);
 EXPORT(int         ) GetSkirmishAIInfoCount(int index);
 EXPORT(const char* ) GetInfoKey(int index);
 EXPORT(const char* ) GetInfoValue(int index);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001883.html">[Taspring-linux-commit] r7114 - trunk/rts/System/Net
</A></li>
	<LI>Next message: <A HREF="001885.html">[Taspring-linux-commit] r7116 - in Lobby/TASClient: . Interface
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1884">[ date ]</a>
              <a href="thread.html#1884">[ thread ]</a>
              <a href="subject.html#1884">[ subject ]</a>
              <a href="author.html#1884">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
