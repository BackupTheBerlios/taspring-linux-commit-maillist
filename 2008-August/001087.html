<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r6317 - trunk/Lobby/TASClient
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-August/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r6317%20-%20trunk/Lobby/TASClient&In-Reply-To=%3C20080826150409.D09FC47ED%40progate.clan-sy.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001086.html">
   <LINK REL="Next"  HREF="001088.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r6317 - trunk/Lobby/TASClient</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r6317%20-%20trunk/Lobby/TASClient&In-Reply-To=%3C20080826150409.D09FC47ED%40progate.clan-sy.com%3E"
       TITLE="[Taspring-linux-commit] r6317 - trunk/Lobby/TASClient">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Tue Aug 26 17:04:09 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001086.html">[Taspring-linux-commit] r6316 - trunk/rts/Sim/MoveTypes/MoveMath
</A></li>
        <LI>Next message: <A HREF="001088.html">[Taspring-linux-commit] r6318 - trunk/Lobby/TASClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1087">[ date ]</a>
              <a href="thread.html#1087">[ thread ]</a>
              <a href="subject.html#1087">[ subject ]</a>
              <a href="author.html#1087">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: satirik
Date: 2008-08-26 17:04:08 +0200 (Tue, 26 Aug 2008)
New Revision: 6317

Added:
   trunk/Lobby/TASClient/LogonFormUnit.ddp
   trunk/Lobby/TASClient/LogonFormUnit.dfm
   trunk/Lobby/TASClient/LogonFormUnit.pas
Modified:
   trunk/Lobby/TASClient/BattleFormUnit.dfm
   trunk/Lobby/TASClient/LobbyScriptUnit.pas
   trunk/Lobby/TASClient/MainUnit.dfm
   trunk/Lobby/TASClient/MainUnit.pas
   trunk/Lobby/TASClient/PreferencesFormUnit.dfm
   trunk/Lobby/TASClient/PreferencesFormUnit.pas
   trunk/Lobby/TASClient/TASClient.cfg
   trunk/Lobby/TASClient/TASClient.dof
   trunk/Lobby/TASClient/TASClient.dpr
   trunk/Lobby/TASClient/TASClient.res
   trunk/Lobby/TASClient/Utility.pas
Log:
* python : SetMenuItemState(id,checked,enabled) api added
* battle host icon is back
* logon form added with 'remember passwords' option to make it easier to use on public comp
* luaoption section disabled to make it work with current version

Modified: trunk/Lobby/TASClient/BattleFormUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/BattleFormUnit.dfm	2008-08-25 12:42:00 UTC (rev 6316)
+++ trunk/Lobby/TASClient/BattleFormUnit.dfm	2008-08-26 15:04:08 UTC (rev 6317)
@@ -1,6 +1,6 @@
 object BattleForm: TBattleForm
-  Left = 263
-  Top = 291
+  Left = 497
+  Top = 190
   Width = 787
   Height = 586
   Caption = 'Battle window'
@@ -4093,13 +4093,14 @@
           Height = 273
           Align = alClient
           Color = clBtnFace
-          ActiveTabIndex = 3
+          ActiveTabIndex = 0
           TabAutofit = True
           ThemeType = tttNone
           OnActiveTabChange = SpTBXTabControl1ActiveTabChange
           HiddenItems = &lt;&gt;
           object GameOptionsTab: TSpTBXTabItem
             Caption = 'Game options'
+            Checked = True
             CustomWidth = 103
             CustomHeight = 30
             ThemeType = tttNone
@@ -4119,7 +4120,6 @@
           object ModTab: TSpTBXTabItem
             Caption = 'Mod options'
             Wrapping = twWrap
-            Checked = True
             CustomWidth = 103
             ThemeType = tttNone
           end
@@ -4192,6 +4192,166 @@
               end
             end
           end
+          object MapTabSheet: TSpTBXTabSheet
+            Left = 0
+            Top = 34
+            Width = 419
+            Height = 239
+            Caption = 'Map options'
+            ImageIndex = -1
+            DesignSize = (
+              419
+              239)
+            TabItem = 'MapTab'
+            object MapOptionsScrollBox: TTntScrollBox
+              Left = 8
+              Top = 48
+              Width = 402
+              Height = 189
+              VertScrollBar.Smooth = True
+              VertScrollBar.Tracking = True
+              Anchors = [akLeft, akTop, akRight, akBottom]
+              BiDiMode = bdLeftToRight
+              BorderStyle = bsNone
+              Color = clBtnFace
+              Ctl3D = False
+              ParentBiDiMode = False
+              ParentBackground = True
+              ParentColor = False
+              ParentCtl3D = False
+              TabOrder = 0
+            end
+            object panelMapOptionsDefault: TSpTBXPanel
+              Left = 8
+              Top = 4
+              Width = 402
+              Height = 41
+              Align = alCustom
+              TabOrder = 1
+              object btLoadDefaultMPO: TSpTBXButton
+                Left = 149
+                Top = 8
+                Width = 113
+                Height = 25
+                Caption = 'Load default'
+                TabOrder = 0
+                OnClick = btLoadDefaultMPOClick
+                LinkFont.Charset = DEFAULT_CHARSET
+                LinkFont.Color = clBlue
+                LinkFont.Height = -11
+                LinkFont.Name = 'MS Sans Serif'
+                LinkFont.Style = [fsUnderline]
+              end
+              object btSetAsDefaultMPO: TSpTBXButton
+                Left = 269
+                Top = 8
+                Width = 113
+                Height = 25
+                Caption = 'Set as default'
+                TabOrder = 1
+                OnClick = btSetAsDefaultMPOClick
+                LinkFont.Charset = DEFAULT_CHARSET
+                LinkFont.Color = clBlue
+                LinkFont.Height = -11
+                LinkFont.Name = 'MS Sans Serif'
+                LinkFont.Style = [fsUnderline]
+              end
+              object btLoadMapsDefaultMPO: TSpTBXButton
+                Left = 29
+                Top = 8
+                Width = 113
+                Height = 25
+                Caption = 'Load map'#39's default'
+                TabOrder = 2
+                OnClick = btLoadMapsDefaultMPOClick
+                LinkFont.Charset = DEFAULT_CHARSET
+                LinkFont.Color = clBlue
+                LinkFont.Height = -11
+                LinkFont.Name = 'MS Sans Serif'
+                LinkFont.Style = [fsUnderline]
+              end
+            end
+          end
+          object ModTabSheet: TSpTBXTabSheet
+            Left = 0
+            Top = 34
+            Width = 419
+            Height = 239
+            Caption = 'Mod options'
+            ImageIndex = -1
+            DesignSize = (
+              419
+              239)
+            TabItem = 'ModTab'
+            object ModOptionsScrollBox: TTntScrollBox
+              Left = 8
+              Top = 48
+              Width = 402
+              Height = 189
+              VertScrollBar.Smooth = True
+              VertScrollBar.Tracking = True
+              Anchors = [akLeft, akTop, akRight, akBottom]
+              BiDiMode = bdLeftToRight
+              BorderStyle = bsNone
+              Color = clBtnFace
+              Ctl3D = False
+              ParentBiDiMode = False
+              ParentBackground = True
+              ParentColor = False
+              ParentCtl3D = False
+              TabOrder = 0
+            end
+            object panelModOptionsDefault: TSpTBXPanel
+              Left = 8
+              Top = 4
+              Width = 402
+              Height = 41
+              Align = alCustom
+              TabOrder = 1
+              object btLoadDefaultMDO: TSpTBXButton
+                Left = 149
+                Top = 8
+                Width = 113
+                Height = 25
+                Caption = 'Load default'
+                TabOrder = 0
+                OnClick = btLoadDefaultMDOClick
+                LinkFont.Charset = DEFAULT_CHARSET
+                LinkFont.Color = clBlue
+                LinkFont.Height = -11
+                LinkFont.Name = 'MS Sans Serif'
+                LinkFont.Style = [fsUnderline]
+              end
+              object btSetAsDefaultMDO: TSpTBXButton
+                Left = 269
+                Top = 8
+                Width = 113
+                Height = 25
+                Caption = 'Set as default'
+                TabOrder = 1
+                OnClick = btSetAsDefaultMDOClick
+                LinkFont.Charset = DEFAULT_CHARSET
+                LinkFont.Color = clBlue
+                LinkFont.Height = -11
+                LinkFont.Name = 'MS Sans Serif'
+                LinkFont.Style = [fsUnderline]
+              end
+              object btLoadModsDefaultMDO: TSpTBXButton
+                Left = 29
+                Top = 8
+                Width = 113
+                Height = 25
+                Caption = 'Load mod'#39's default'
+                TabOrder = 2
+                OnClick = btLoadModsDefaultMDOClick
+                LinkFont.Charset = DEFAULT_CHARSET
+                LinkFont.Color = clBlue
+                LinkFont.Height = -11
+                LinkFont.Name = 'MS Sans Serif'
+                LinkFont.Style = [fsUnderline]
+              end
+            end
+          end
           object SpTBXTabSheet2: TSpTBXTabSheet
             Left = 0
             Top = 34
@@ -4462,166 +4622,6 @@
               LinkFont.Style = [fsUnderline]
             end
           end
-          object MapTabSheet: TSpTBXTabSheet
-            Left = 0
-            Top = 34
-            Width = 419
-            Height = 239
-            Caption = 'Map options'
-            ImageIndex = -1
-            DesignSize = (
-              419
-              239)
-            TabItem = 'MapTab'
-            object MapOptionsScrollBox: TTntScrollBox
-              Left = 8
-              Top = 48
-              Width = 402
-              Height = 189
-              VertScrollBar.Smooth = True
-              VertScrollBar.Tracking = True
-              Anchors = [akLeft, akTop, akRight, akBottom]
-              BiDiMode = bdLeftToRight
-              BorderStyle = bsNone
-              Color = clBtnFace
-              Ctl3D = False
-              ParentBiDiMode = False
-              ParentBackground = True
-              ParentColor = False
-              ParentCtl3D = False
-              TabOrder = 0
-            end
-            object panelMapOptionsDefault: TSpTBXPanel
-              Left = 8
-              Top = 4
-              Width = 402
-              Height = 41
-              Align = alCustom
-              TabOrder = 1
-              object btLoadDefaultMPO: TSpTBXButton
-                Left = 149
-                Top = 8
-                Width = 113
-                Height = 25
-                Caption = 'Load default'
-                TabOrder = 0
-                OnClick = btLoadDefaultMPOClick
-                LinkFont.Charset = DEFAULT_CHARSET
-                LinkFont.Color = clBlue
-                LinkFont.Height = -11
-                LinkFont.Name = 'MS Sans Serif'
-                LinkFont.Style = [fsUnderline]
-              end
-              object btSetAsDefaultMPO: TSpTBXButton
-                Left = 269
-                Top = 8
-                Width = 113
-                Height = 25
-                Caption = 'Set as default'
-                TabOrder = 1
-                OnClick = btSetAsDefaultMPOClick
-                LinkFont.Charset = DEFAULT_CHARSET
-                LinkFont.Color = clBlue
-                LinkFont.Height = -11
-                LinkFont.Name = 'MS Sans Serif'
-                LinkFont.Style = [fsUnderline]
-              end
-              object btLoadMapsDefaultMPO: TSpTBXButton
-                Left = 29
-                Top = 8
-                Width = 113
-                Height = 25
-                Caption = 'Load map'#39's default'
-                TabOrder = 2
-                OnClick = btLoadMapsDefaultMPOClick
-                LinkFont.Charset = DEFAULT_CHARSET
-                LinkFont.Color = clBlue
-                LinkFont.Height = -11
-                LinkFont.Name = 'MS Sans Serif'
-                LinkFont.Style = [fsUnderline]
-              end
-            end
-          end
-          object ModTabSheet: TSpTBXTabSheet
-            Left = 0
-            Top = 34
-            Width = 419
-            Height = 239
-            Caption = 'Mod options'
-            ImageIndex = -1
-            DesignSize = (
-              419
-              239)
-            TabItem = 'ModTab'
-            object ModOptionsScrollBox: TTntScrollBox
-              Left = 8
-              Top = 48
-              Width = 402
-              Height = 189
-              VertScrollBar.Smooth = True
-              VertScrollBar.Tracking = True
-              Anchors = [akLeft, akTop, akRight, akBottom]
-              BiDiMode = bdLeftToRight
-              BorderStyle = bsNone
-              Color = clBtnFace
-              Ctl3D = False
-              ParentBiDiMode = False
-              ParentBackground = True
-              ParentColor = False
-              ParentCtl3D = False
-              TabOrder = 0
-            end
-            object panelModOptionsDefault: TSpTBXPanel
-              Left = 8
-              Top = 4
-              Width = 402
-              Height = 41
-              Align = alCustom
-              TabOrder = 1
-              object btLoadDefaultMDO: TSpTBXButton
-                Left = 149
-                Top = 8
-                Width = 113
-                Height = 25
-                Caption = 'Load default'
-                TabOrder = 0
-                OnClick = btLoadDefaultMDOClick
-                LinkFont.Charset = DEFAULT_CHARSET
-                LinkFont.Color = clBlue
-                LinkFont.Height = -11
-                LinkFont.Name = 'MS Sans Serif'
-                LinkFont.Style = [fsUnderline]
-              end
-              object btSetAsDefaultMDO: TSpTBXButton
-                Left = 269
-                Top = 8
-                Width = 113
-                Height = 25
-                Caption = 'Set as default'
-                TabOrder = 1
-                OnClick = btSetAsDefaultMDOClick
-                LinkFont.Charset = DEFAULT_CHARSET
-                LinkFont.Color = clBlue
-                LinkFont.Height = -11
-                LinkFont.Name = 'MS Sans Serif'
-                LinkFont.Style = [fsUnderline]
-              end
-              object btLoadModsDefaultMDO: TSpTBXButton
-                Left = 29
-                Top = 8
-                Width = 113
-                Height = 25
-                Caption = 'Load mod'#39's default'
-                TabOrder = 2
-                OnClick = btLoadModsDefaultMDOClick
-                LinkFont.Charset = DEFAULT_CHARSET
-                LinkFont.Color = clBlue
-                LinkFont.Height = -11
-                LinkFont.Name = 'MS Sans Serif'
-                LinkFont.Style = [fsUnderline]
-              end
-            end
-          end
         end
       end
       object Panel6: TPanel
@@ -4854,9 +4854,9 @@
         105)
       object VDTBattleClients: TVirtualDrawTree
         Left = 8
-        Top = 6
+        Top = 8
         Width = 461
-        Height = 91
+        Height = 89
         Anchors = [akLeft, akTop, akRight, akBottom]
         Font.Charset = DEFAULT_CHARSET
         Font.Color = clWindowText
@@ -5057,8 +5057,9 @@
         Left = 474
         Top = 8
         Width = 44
-        Height = 0
+        Height = 13
         Hint = 'Team counters'
+        Caption = '0/0'
         Anchors = [akTop, akRight]
         ParentShowHint = False
         ShowHint = True
@@ -5123,8 +5124,8 @@
   end
   object PlayerControlPopupMenu: TSpTBXPopupMenu
     OnInitPopup = PlayerControlPopupMenuInitPopup
-    Left = 232
-    Top = 336
+    Left = 304
+    Top = 360
     object SetTeamItem: TSpTBXSubmenuItem
       Caption = 'Set id'
       OnClick = SetTeamItemClick

Modified: trunk/Lobby/TASClient/LobbyScriptUnit.pas
===================================================================
--- trunk/Lobby/TASClient/LobbyScriptUnit.pas	2008-08-25 12:42:00 UTC (rev 6316)
+++ trunk/Lobby/TASClient/LobbyScriptUnit.pas	2008-08-26 15:04:08 UTC (rev 6317)
@@ -48,6 +48,7 @@
       function AddItemToMenu(menu: string;itemCaption: string; callInArgs: Variant; callbackModuleName: string; callbackFunctionName: string): integer;
       function AddSubmenuToMenu(menu: string; itemCaption: string): integer;
       function AddSeparatorToMenu(menu: string): integer;
+      procedure SetMenuItemState(id: integer; c: boolean; e: boolean);
 
       procedure DisplaySimpleNotification(title: string; msg: string; displayTime: integer);
       procedure DisplayNotification(title: string; msg: string; callInArgs: Variant; callbackModuleName: string; callbackFunctionName: string; displayTime: integer);
@@ -1425,6 +1426,19 @@
   end;
 end;
 
+procedure TGUI.SetMenuItemState(id: integer; c: boolean; e: boolean);
+var
+  i: integer;
+begin
+  for i:=0 to MenuItemList.Count-1 do
+    if PScriptMenuItem(MenuItemList[i]).id = id then
+    begin
+      PScriptMenuItem(MenuItemList[i]).item.Checked := c;
+      PScriptMenuItem(MenuItemList[i]).item.Enabled := e;
+      Exit;
+    end;
+end;
+
 procedure TGUI.RemoveFromMenu(id: integer);
 var
   i: integer;

Added: trunk/Lobby/TASClient/LogonFormUnit.ddp
===================================================================
(Binary files differ)


Property changes on: trunk/Lobby/TASClient/LogonFormUnit.ddp
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/Lobby/TASClient/LogonFormUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/LogonFormUnit.dfm	                        (rev 0)
+++ trunk/Lobby/TASClient/LogonFormUnit.dfm	2008-08-26 15:04:08 UTC (rev 6317)
@@ -0,0 +1,249 @@
+object LogonForm: TLogonForm
+  Left = 527
+  Top = 376
+  BorderStyle = bsDialog
+  Caption = 'Logon'
+  ClientHeight = 350
+  ClientWidth = 310
+  Color = clBtnFace
+  Constraints.MaxHeight = 1000
+  Constraints.MaxWidth = 1680
+  Font.Charset = DEFAULT_CHARSET
+  Font.Color = clWindowText
+  Font.Height = -11
+  Font.Name = 'MS Sans Serif'
+  Font.Style = []
+  FormStyle = fsStayOnTop
+  OldCreateOrder = False
+  Position = poScreenCenter
+  OnCreate = FormCreate
+  OnShow = FormShow
+  PixelsPerInch = 96
+  TextHeight = 13
+  object SpTBXTitleBar1: TSpTBXTitleBar
+    Left = 0
+    Top = 0
+    Width = 310
+    Height = 350
+    Caption = 'Logon'
+    object gbServerSettings: TSpTBXGroupBox
+      Left = 16
+      Top = 40
+      Width = 281
+      Height = 81
+      Caption = 'Server settings'
+      TabOrder = 1
+      object lblServer: TSpTBXLabel
+        Left = 16
+        Top = 24
+        Width = 37
+        Height = 13
+        Caption = 'Server :'
+        LinkFont.Charset = DEFAULT_CHARSET
+        LinkFont.Color = clBlue
+        LinkFont.Height = -11
+        LinkFont.Name = 'MS Sans Serif'
+        LinkFont.Style = [fsUnderline]
+      end
+      object txtPort: TSpTBXEdit
+        Left = 64
+        Top = 48
+        Width = 57
+        Height = 21
+        TabOrder = 1
+        Text = '8200'
+      end
+      object lblPort: TSpTBXLabel
+        Left = 16
+        Top = 48
+        Width = 25
+        Height = 13
+        Caption = 'Port :'
+        LinkFont.Charset = DEFAULT_CHARSET
+        LinkFont.Color = clBlue
+        LinkFont.Height = -11
+        LinkFont.Name = 'MS Sans Serif'
+        LinkFont.Style = [fsUnderline]
+      end
+      object beServer: TSpTBXButtonEdit
+        Left = 64
+        Top = 24
+        Width = 209
+        Height = 21
+        TabOrder = 3
+        EditButton.Left = 185
+        EditButton.Top = 0
+        EditButton.Width = 20
+        EditButton.Height = 17
+        EditButton.Caption = '...'
+        EditButton.Align = alRight
+        EditButton.DropDownArrow = False
+        EditButton.DropDownMenu = PreferencesForm.AddressPopupMenu
+        EditButton.LinkFont.Charset = DEFAULT_CHARSET
+        EditButton.LinkFont.Color = clBlue
+        EditButton.LinkFont.Height = -11
+        EditButton.LinkFont.Name = 'MS Sans Serif'
+        EditButton.LinkFont.Style = [fsUnderline]
+      end
+    end
+    object gbAccountDetails: TSpTBXGroupBox
+      Left = 16
+      Top = 128
+      Width = 281
+      Height = 121
+      Caption = 'Account details'
+      TabOrder = 2
+      object lblLogin: TSpTBXLabel
+        Left = 16
+        Top = 24
+        Width = 54
+        Height = 13
+        Caption = 'Username :'
+        LinkFont.Charset = DEFAULT_CHARSET
+        LinkFont.Color = clBlue
+        LinkFont.Height = -11
+        LinkFont.Name = 'MS Sans Serif'
+        LinkFont.Style = [fsUnderline]
+      end
+      object txtLogin: TSpTBXEdit
+        Left = 136
+        Top = 24
+        Width = 137
+        Height = 21
+        TabOrder = 1
+      end
+      object txtPassword: TSpTBXEdit
+        Left = 136
+        Top = 48
+        Width = 137
+        Height = 21
+        TabOrder = 2
+        OnChange = txtPasswordChange
+        PasswordCharW = '*'
+      end
+      object lblPassword: TSpTBXLabel
+        Left = 16
+        Top = 48
+        Width = 52
+        Height = 13
+        Caption = 'Password :'
+        LinkFont.Charset = DEFAULT_CHARSET
+        LinkFont.Color = clBlue
+        LinkFont.Height = -11
+        LinkFont.Name = 'MS Sans Serif'
+        LinkFont.Style = [fsUnderline]
+      end
+      object SpTBXLabel1: TSpTBXLabel
+        Left = 16
+        Top = 72
+        Width = 87
+        Height = 13
+        Caption = 'Ladder password :'
+        LinkFont.Charset = DEFAULT_CHARSET
+        LinkFont.Color = clBlue
+        LinkFont.Height = -11
+        LinkFont.Name = 'MS Sans Serif'
+        LinkFont.Style = [fsUnderline]
+      end
+      object beLadderPassword: TSpTBXButtonEdit
+        Left = 136
+        Top = 72
+        Width = 137
+        Height = 21
+        ReadOnly = True
+        TabOrder = 5
+        EditButton.Left = 107
+        EditButton.Top = 0
+        EditButton.Width = 26
+        EditButton.Height = 17
+        EditButton.Caption = '...'
+        EditButton.Align = alRight
+        EditButton.OnClick = beLadderPasswordSubEditButton0Click
+        EditButton.LinkFont.Charset = DEFAULT_CHARSET
+        EditButton.LinkFont.Color = clBlue
+        EditButton.LinkFont.Height = -11
+        EditButton.LinkFont.Name = 'MS Sans Serif'
+        EditButton.LinkFont.Style = [fsUnderline]
+        PasswordCharW = '*'
+      end
+      object chkRememberPasswords: TSpTBXCheckBox
+        Left = 136
+        Top = 96
+        Width = 117
+        Height = 15
+        Caption = 'remember passwords'
+        TabOrder = 6
+      end
+      object SpTBXLabel2: TSpTBXLabel
+        Left = 16
+        Top = 88
+        Width = 43
+        Height = 13
+        Caption = '(optional)'
+        LinkFont.Charset = DEFAULT_CHARSET
+        LinkFont.Color = clBlue
+        LinkFont.Height = -11
+        LinkFont.Name = 'MS Sans Serif'
+        LinkFont.Style = [fsUnderline]
+      end
+    end
+    object btRegisterLadder: TSpTBXButton
+      Left = 16
+      Top = 288
+      Width = 105
+      Height = 25
+      Caption = 'Register Ladder'
+      TabOrder = 3
+      OnClick = btRegisterLadderClick
+      LinkFont.Charset = DEFAULT_CHARSET
+      LinkFont.Color = clBlue
+      LinkFont.Height = -11
+      LinkFont.Name = 'MS Sans Serif'
+      LinkFont.Style = [fsUnderline]
+    end
+    object btRegister: TSpTBXButton
+      Left = 16
+      Top = 256
+      Width = 105
+      Height = 25
+      Caption = 'Register'
+      TabOrder = 4
+      OnClick = btRegisterClick
+      LinkFont.Charset = DEFAULT_CHARSET
+      LinkFont.Color = clBlue
+      LinkFont.Height = -11
+      LinkFont.Name = 'MS Sans Serif'
+      LinkFont.Style = [fsUnderline]
+    end
+    object btLogin: TSpTBXButton
+      Left = 136
+      Top = 256
+      Width = 161
+      Height = 57
+      Caption = 'Login'
+      Font.Charset = DEFAULT_CHARSET
+      Font.Color = clWindowText
+      Font.Height = -11
+      Font.Name = 'MS Sans Serif'
+      Font.Style = [fsBold]
+      ParentFont = False
+      TabOrder = 5
+      OnClick = btLoginClick
+      Images = MainForm.ConnectionStateImageList
+      ImageIndex = 0
+      LinkFont.Charset = DEFAULT_CHARSET
+      LinkFont.Color = clBlue
+      LinkFont.Height = -11
+      LinkFont.Name = 'MS Sans Serif'
+      LinkFont.Style = [fsUnderline]
+    end
+    object chkUseLogonForm: TSpTBXCheckBox
+      Left = 16
+      Top = 320
+      Width = 89
+      Height = 15
+      Caption = 'Use logon form'
+      TabOrder = 6
+    end
+  end
+end

Added: trunk/Lobby/TASClient/LogonFormUnit.pas
===================================================================
--- trunk/Lobby/TASClient/LogonFormUnit.pas	                        (rev 0)
+++ trunk/Lobby/TASClient/LogonFormUnit.pas	2008-08-26 15:04:08 UTC (rev 6317)
@@ -0,0 +1,146 @@
+unit LogonFormUnit;
+
+interface
+
+uses
+  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
+  Dialogs, SpTBXControls, StdCtrls, SpTBXEditors, TBXDkPanels, SpTBXItem;
+
+type
+  TLogonForm = class(TForm)
+    SpTBXTitleBar1: TSpTBXTitleBar;
+    gbServerSettings: TSpTBXGroupBox;
+    lblServer: TSpTBXLabel;
+    txtPort: TSpTBXEdit;
+    lblPort: TSpTBXLabel;
+    beServer: TSpTBXButtonEdit;
+    gbAccountDetails: TSpTBXGroupBox;
+    lblLogin: TSpTBXLabel;
+    txtLogin: TSpTBXEdit;
+    txtPassword: TSpTBXEdit;
+    lblPassword: TSpTBXLabel;
+    SpTBXLabel1: TSpTBXLabel;
+    beLadderPassword: TSpTBXButtonEdit;
+    chkRememberPasswords: TSpTBXCheckBox;
+    btRegisterLadder: TSpTBXButton;
+    btRegister: TSpTBXButton;
+    btLogin: TSpTBXButton;
+    chkUseLogonForm: TSpTBXCheckBox;
+    SpTBXLabel2: TSpTBXLabel;
+    procedure FormCreate(Sender: TObject);
+    procedure btLoginClick(Sender: TObject);
+    procedure FormShow(Sender: TObject);
+    procedure txtPasswordChange(Sender: TObject);
+    procedure beLadderPasswordSubEditButton0Click(Sender: TObject);
+    procedure btRegisterClick(Sender: TObject);
+    procedure btRegisterLadderClick(Sender: TObject);
+  private
+    { Private declarations }
+  public
+    { Public declarations }
+  end;
+
+var
+  LogonForm: TLogonForm;
+
+implementation
+
+uses PreferencesFormUnit,MainUnit, Misc, NewAccountUnit;
+
+{$R *.dfm}
+
+procedure TLogonForm.FormCreate(Sender: TObject);
+begin
+  if not SpTBXTitleBar1.Active then
+    RemoveSpTBXTitleBarMarges(self);
+end;
+
+procedure TLogonForm.btLoginClick(Sender: TObject);
+begin
+  if Status.ReceivingLoginInfo then Exit;
+
+  if txtLogin.Text = '' then
+  begin
+    MessageDlg('&quot;Username&quot; field should not be left empty!', mtWarning, [mbOK], 0);
+    Exit;
+  end;
+
+  if (not VerifyName(txtLogin.Text)) or (not VerifyName(txtPassword.Text) and PasswordChanged) then
+  begin
+    MessageDlg('Your username and/or password consists of illegal characters!', mtWarning, [mbOK], 0);
+    Exit;
+  end;
+
+  Preferences.ServerIP := beServer.Text;
+  Preferences.ServerPort := txtPort.Text;
+  Preferences.Username := txtLogin.Text;
+  Preferences.Password := txtPassword.Text;
+  Preferences.LadderPassword := beLadderPassword.Text;
+  Preferences.RememberPasswords := chkRememberPasswords.Checked;
+  Preferences.UseLogonForm := chkUseLogonForm.Checked;
+
+  if Status.LoggedIn and ((Status.Username &lt;&gt; txtLogin.Text) or (MainForm.Socket.Addr &lt;&gt; beServer.Text) or (MainForm.Socket.Port &lt;&gt; txtPort.Text)) then
+  begin
+    MainForm.TryToDisconnect;
+  end
+  else
+    if Status.LoggedIn then
+    begin
+      Close;
+      Exit;
+    end;
+
+  if PasswordChanged then
+    txtPassword.Text := Misc.GetMD5Hash(txtPassword.Text);
+
+
+
+  MainForm.TryToConnect;
+  Close;
+end;
+
+procedure TLogonForm.FormShow(Sender: TObject);
+begin
+  PasswordChanged := False;
+end;
+
+procedure TLogonForm.txtPasswordChange(Sender: TObject);
+begin
+  PasswordChanged := True;
+end;
+
+procedure TLogonForm.beLadderPasswordSubEditButton0Click(Sender: TObject);
+begin
+  PreferencesForm.ChangeLadderPasswordButtonClick(nil);
+end;
+
+procedure TLogonForm.btRegisterClick(Sender: TObject);
+begin
+  if Status.ConnectionState = Connected then
+  begin
+    MessageDlg('You are not allowed to register new account while being logged-in!', mtError, [mbOK], 0);
+    Exit;
+  end;
+
+  NewAccountForm.UsernameEdit.Text := txtLogin.Text;
+  NewAccountForm.PasswordEdit.Text := '';
+  NewAccountForm.ConfirmPasswordEdit.Text := '';
+
+  if NewAccountForm.ShowModal = mrCancel then Exit;
+
+  // now let's start account registration process:
+
+  txtLogin.Text := NewAccountForm.UsernameEdit.Text;
+  txtPassword.Text :=  NewAccountForm.PasswordEdit.Text;
+
+  PasswordChanged := true;
+
+  PostMessage(MainForm.Handle, WM_DOREGISTER, 0, 0);
+end;
+
+procedure TLogonForm.btRegisterLadderClick(Sender: TObject);
+begin
+  PreferencesForm.RegisterLadderAccountButtonClick(nil);
+end;
+
+end.

Modified: trunk/Lobby/TASClient/MainUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/MainUnit.dfm	2008-08-25 12:42:00 UTC (rev 6316)
+++ trunk/Lobby/TASClient/MainUnit.dfm	2008-08-26 15:04:08 UTC (rev 6317)
@@ -1,6 +1,6 @@
 object MainForm: TMainForm
-  Left = 603
-  Top = 288
+  Left = 826
+  Top = 633
   Width = 808
   Height = 549
   Caption = '.'
@@ -2208,7 +2208,7 @@
     Left = 209
     Top = 296
     Bitmap = {
-      494C010105000900040010001000FFFFFFFFFF10FFFFFFFFFFFFFFFF424D3600
+      494C010106000900040010001000FFFFFFFFFF10FFFFFFFFFFFFFFFF424D3600
       0000000000003600000028000000400000003000000001002000000000000030
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
@@ -2340,119 +2340,121 @@
       0000000000000000000000000000000000000000000000000000000000000000
       00000000000000000000000000000000000000000000000000004CA4D9002680
       C600105FB2002A85C90000000000000000000000000000000000000000000000
+      0000000000000000000000000000000000000000000000000000A5A5A5008181
+      8100606060008686860000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000000000000000000000000000000000000000000072BEE5005FB2
       DF00257FC5009AD4EE001161B300000000000000000000000000000000000000
+      0000000000000000000000000000000000000000000000000000BFBFBF00B3B3
+      B30080808000D5D5D50062626200000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000005DB1DF006EBCE400000000000000
       00005DB1DF009AD4EE00105EB100000000000000000000000000000000000000
+      000000000000000000000000000000000000B2B2B200BDBDBD00000000000000
+      0000B2B2B200D5D5D5005F5F5F00000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000000000000000000000000000105FB20058ADDD00000000000000
       00002B86C9009AD4EE002883C800000000000000000000000000000000000000
+      00000000000000000000000000000000000060606000AEAEAE00000000000000
+      000087878700D5D5D50084848400000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000000000000000000000000000105FB2002680C600449ED600105E
       B100257FC5009CD5EF002E89CB00000000000000000000000000000000000000
+      00000000000000000000000000000000000060606000818181009F9F9F005F5F
+      5F0080808000D6D6D6008A8A8A00000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000000000000000000000000000105FB200105FB200257FC500439D
       D5009AD4EE00257FC5009ED6EF0048A1D7000000000000000000000000000000
+      0000000000000000000000000000000000006060600060606000808080009E9E
+      9E00D5D5D50080808000D7D7D700A2A2A2000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000000000000000000000000000000000002781C700257FC500257F
       C5001D75C0009AD4EE00000000009AD4EE00328DCD0000000000000000000000
+      0000000000000000000000000000000000000000000082828200808080008080
+      800076767600D5D5D50000000000D5D5D5008E8E8E0000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000348FCE009CD5EF00000000009AD4EE00429CD500000000000000
       0000000000000000000000000000000000000000000000000000000000000000
+      00000000000090909000D6D6D60000000000D5D5D5009D9D9D00000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000000000001B71BD009AD4EE00000000009AD4EE00257FC5002680
       C600105FB2001D75C00000000000000000000000000000000000000000000000
+      0000000000000000000072727200D5D5D50000000000D5D5D500808080008181
+      8100606060007676760000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       00000000000000000000000000002680C6009AD4EE002680C6009AD4EE009AD4
       EE009CD5EF009CD5EF0051A8DB00000000000000000000000000000000000000
+      000000000000000000000000000081818100D5D5D50081818100D5D5D500D5D5
+      D500D6D6D600D6D6D600A9A9A900000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000000000000000000000000000105FB2009AD4EE002680C600105E
       B10051A8DB002680C6002E89CB00000000000000000000000000000000000000
+      00000000000000000000000000000000000060606000D5D5D500818181005F5F
+      5F00A9A9A900818181008A8A8A00000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000000000000000000000000000105FB200449ED600237DC4000000
       0000000000004CA4D900449ED600000000000000000000000000000000000000
+      000000000000000000000000000000000000606060009F9F9F007E7E7E000000
+      000000000000A5A5A5009F9F9F00000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000000000000000000000000000105FB200257FC5005CB0DF000000
       00000000000073BFE50087CAEA00000000000000000000000000000000000000
+      0000000000000000000000000000000000006060600080808000B1B1B1000000
+      000000000000C0C0C000CBCBCB00000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000000000000000000000000000105FB200105EB100257FC500449E
       D60087CAEA000000000000000000000000000000000000000000000000000000
+      000000000000000000000000000000000000606060005F5F5F00808080009F9F
+      9F00CBCBCB000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       000000000000000000000000000000000000000000001161B3001161B300257F
       C50077C1E6000000000000000000000000000000000000000000000000000000
+      0000000000000000000000000000000000000000000062626200626262008080
+      8000C2C2C2000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
@@ -2494,8 +2496,6 @@
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
-      0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000096969600979797009797
       970097979700A4A4A40000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
@@ -2600,11 +2600,11 @@
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
       0000000000000000000000000000000000000000000000000000000000000000
-      00000000000000000000000000000000C3FF000000000000C1FF000000000000
-      31FF00000000000031FF00000000000001FF00000000000000FF000000000000
-      827F000000000000F93F000000000000FC83000000000000FE01000000000000
-      FF01000000000000FF19000000000000FF19000000000000FF07000000000000
-      FF87000000000000FFFF000000000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
+      00000000000000000000000000000000C3FFC3FF00000000C1FFC1FF00000000
+      31FF31FF0000000031FF31FF0000000001FF01FF0000000000FF00FF00000000
+      827F827F00000000F93FF93F00000000FC83FC8300000000FE01FE0100000000
+      FF01FF0100000000FF19FF1900000000FF19FF1900000000FF07FF0700000000
+      FF87FF8700000000FFFFFFFF00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
       FFFFFFFFFFFFFFFFFFFFFFFFFFFF83FFF00FF00FF00F8003F00FF00FF00FCC03
       F00FF00FF00FE403F00FF00FF00F821FF00FF00FF00F830FF00FF00FF00FFF87
       F00FF00FF00FFC03F00FF00FF00FFC03FFFFFFFFFFFFFC03FFFFFFFFFFFFFFFF

Modified: trunk/Lobby/TASClient/MainUnit.pas
===================================================================
--- trunk/Lobby/TASClient/MainUnit.pas	2008-08-25 12:42:00 UTC (rev 6316)
+++ trunk/Lobby/TASClient/MainUnit.pas	2008-08-26 15:04:08 UTC (rev 6317)
@@ -522,7 +522,7 @@
 const
   VERSION_NUMBER = '0.38'; // Must be float value! (with a period as a decimal seperator)
   CHECK_BETA_LOBBY_URL = '<A HREF="http://tasclient.no-ip.org/TASClient_update_v2.txt">http://tasclient.no-ip.org/TASClient_update_v2.txt</A>';
-  PROGRAM_VERSION = 'TASClient ' + VERSION_NUMBER + ' RC5';
+  PROGRAM_VERSION = 'TASClient ' + VERSION_NUMBER + ' RC7';
   KEEP_ALIVE_INTERVAL = 10000; // in milliseconds. Tells us what should be the maximum &quot;silence&quot; time before we send a ping to the server.
   ASSUME_TIMEOUT_INTERVAL = 30000; // in milliseconds. Must be greater than KEEP_ALIVE_INTERVAL! If server hasn't send any data to us within this interval, then we assume timeout occured. It's us who must make sure we get constant replies from server by pinging it.
   LOCAL_TAB = '$Local'; // caption of main (command) tab window. Must be special so that is different from channel names or user names, that is why there is a &quot;$&quot; in front of it.
@@ -1664,7 +1664,7 @@
   LoginProgressFormUnit, GpIFF, SearchFormUnit, ManageGroups, ColorPicker,
   AwayMessageFormUnit,JclStrings, SearchPlayerFormUnit, MenuFormUnit, Utility,
   PythonScriptDebugFormUnit,LobbyScriptUnit, SpringDownloaderFormUnit,
-  SyncObjs;
+  SyncObjs, LogonFormUnit;
 
 {$R *.dfm}
 
@@ -3720,7 +3720,7 @@
       MenuForm.Show
     else
     begin
-      MainForm.Visible := True;
+      MainForm.Show;
     end;
 
     if Preferences.EnableSpringDownloader then
@@ -4602,6 +4602,7 @@
     else if sl[0] = 'ACCEPTED' then
     begin
       ConnectButton.ImageIndex := 2;
+      LogonForm.btLogin.ImageIndex := ConnectButton.ImageIndex;
       AddMainLog('Login successful!', Colors.Info);
       MainForm.MainTitleBar.Caption := PROGRAM_VERSION+' - '+sl[1];
       MainForm.Caption := PROGRAM_VERSION+' - '+sl[1];
@@ -5944,14 +5945,16 @@
         Exit;
       end;
 
+      tmpBool := Client.GetInGameStatus;
       Client.Status := tmpInt;
+      changed := Client.GetInGameStatus &lt;&gt; tmpBool;
 
       // let's check if this client is founder of any battle. If he is, we must refresh this battle's node. We must also check if he is the founder of the battle user is participating in.
       if Client.InBattle then
       begin
         for i := 0 to Battles.Count-1 do if TClient(TBattle(Battles[i]).Clients[0]).Name = Client.Name then
         begin
-          if (BattleFormUnit.BattleState.Status = Joined) and (BattleState.Battle.ID = TBattle(Battles[i]).ID) and (Client.GetInGameStatus) and (changed) and (not Status.AmIInGame) then
+          if (BattleFormUnit.BattleState.Status = Joined) and (BattleState.Battle.ID = TBattle(Battles[i]).ID) and (Client.GetInGameStatus) and changed and (not Status.AmIInGame) then
           begin
             PostMessage(BattleForm.Handle, WM_STARTGAME, 0, 0);
             // if founder of the battle we are participating in just went in-game, we must launch the game too!
@@ -7302,6 +7305,7 @@
     wsConnecting:
     begin
       ConnectButton.ImageIndex := 1;
+      LogonForm.btLogin.ImageIndex := ConnectButton.ImageIndex;
       Status.ConnectionState := Connecting;
       AddMainLog('Connecting to ' + Socket.Addr + ' ...', Colors.Info);
     end;
@@ -7316,6 +7320,7 @@
       if BattleForm.IsBattleActive and (BattleState.Battle &lt;&gt; nil) then BattleForm.ResetBattleScreen; // we have to check if BattleState.Battle &lt;&gt; nil, because this event is also triggered when form is closing and BattleForm has already been freed
       while Battles.Count &gt; 0 do RemoveBattleByIndex(0); // remove all battles
       ConnectButton.ImageIndex := 0;
+      LogonForm.btLogin.ImageIndex := ConnectButton.ImageIndex;
       if Status.ConnectionState = Connecting then
       begin
         AddMainLog('Cannot connect to server!', Colors.Info);
@@ -7488,6 +7493,9 @@
   PageControl1.OnChange(PageControl1);
   // set focus to TEdit control (we need to do this only once for 1 page only, and TEdit control will always receive focus with any new page):
   (PageControl1.ActivePage.Controls[0] as TEdit).SetFocus;
+
+  if not Status.LoggedIn and Preferences.UseLogonForm then
+    LogonForm.Show;
 end;
 
 { opens a private chat with ClientName if it doesn't already exist.
@@ -8674,6 +8682,12 @@
 
 procedure TMainForm.ConnectButtonClick(Sender: TObject);
 begin
+  if Preferences.UseLogonForm then
+  begin
+    LogonForm.Show;
+    Exit;
+  end;
+
   if Preferences.Username = '' then
   begin
     MessageDlg('To log into the server, you need an account. Use the &quot;Create new account&quot; button to register a new account.',mtInformation,[mbOk],0);

Modified: trunk/Lobby/TASClient/PreferencesFormUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/PreferencesFormUnit.dfm	2008-08-25 12:42:00 UTC (rev 6316)
+++ trunk/Lobby/TASClient/PreferencesFormUnit.dfm	2008-08-26 15:04:08 UTC (rev 6317)
@@ -1,6 +1,6 @@
 object PreferencesForm: TPreferencesForm
-  Left = 1147
-  Top = 228
+  Left = 1006
+  Top = 225
   BorderStyle = bsDialog
   Caption = 'Preferences'
   ClientHeight = 392
@@ -37,7 +37,7 @@
       Width = 401
       Height = 305
       Color = clBtnFace
-      ActiveTabIndex = 6
+      ActiveTabIndex = 2
       TabAutofit = True
       HiddenItems = &lt;&gt;
       object SpTBXTabItem6: TSpTBXTabItem
@@ -50,6 +50,7 @@
       end
       object SpTBXTabItem4: TSpTBXTabItem
         Caption = 'Program'
+        Checked = True
         CustomWidth = 56
       end
       object SpTBXTabItem3: TSpTBXTabItem
@@ -66,131 +67,8 @@
       end
       object SpTBXTabItem7: TSpTBXTabItem
         Caption = 'Scripts'
-        Checked = True
         CustomWidth = 56
       end
-      object SpTBXTabSheet5: TSpTBXTabSheet
-        Left = 0
-        Top = 23
-        Width = 401
-        Height = 282
-        Caption = 'Account'
-        ImageIndex = -1
-        TabItem = 'SpTBXTabItem5'
-        object GroupBox2: TSpTBXGroupBox
-          Left = 16
-          Top = 8
-          Width = 369
-          Height = 257
-          Caption = 'Account details'
-          Color = clNone
-          ParentColor = False
-          TabOrder = 0
-          object RegisterAccountButton: TSpTBXSpeedButton
-            Left = 56
-            Top = 144
-            Width = 185
-            Height = 25
-            Caption = 'Create new account'
-            OnClick = RegisterAccountButtonClick
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object Label4: TSpTBXLabel
-            Left = 24
-            Top = 40
-            Width = 51
-            Height = 13
-            Caption = 'Username:'
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object Label5: TSpTBXLabel
-            Left = 24
-            Top = 72
-            Width = 49
-            Height = 13
-            Caption = 'Password:'
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object UsernameEdit: TSpTBXEdit
-            Left = 120
-            Top = 40
-            Width = 121
-            Height = 21
-            TabOrder = 0
-            OnChange = UsernameEditChange
-          end
-          object PasswordEdit: TSpTBXEdit
-            Left = 120
-            Top = 72
-            Width = 121
-            Height = 21
-            TabOrder = 1
-            OnChange = PasswordEditChange
-            PasswordCharW = '*'
-          end
-          object LadderPasswordEdit: TSpTBXEdit
-            Left = 120
-            Top = 104
-            Width = 121
-            Height = 21
-            Enabled = False
-            TabOrder = 5
-            PasswordCharW = '*'
-          end
-          object SpTBXLabel1: TSpTBXLabel
-            Left = 24
-            Top = 104
-            Width = 87
-            Height = 13
-            Caption = 'Ladder password :'
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object ChangeLadderPasswordButton: TSpTBXButton
-            Left = 248
-            Top = 104
-            Width = 41
-            Height = 21
-            Caption = 'Edit'
-            TabOrder = 7
-            OnClick = ChangeLadderPasswordButtonClick
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object RegisterLadderAccountButton: TSpTBXButton
-            Left = 56
-            Top = 176
-            Width = 185
-            Height = 25
-            Caption = 'Create new ladder account'
-            TabOrder = 8
-            OnClick = RegisterLadderAccountButtonClick
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-        end
-      end
       object SpTBXTabSheet2: TSpTBXTabSheet
         Left = 0
         Top = 23
@@ -393,205 +271,6 @@
           end
         end
       end
-      object SpTBXTabSheet4: TSpTBXTabSheet
-        Left = 0
-        Top = 23
-        Width = 401
-        Height = 282
-        Caption = 'Program'
-        ImageIndex = -1
-        TabItem = 'SpTBXTabItem4'
-        object GroupBox3: TSpTBXGroupBox
-          Left = 16
-          Top = 8
-          Width = 369
-          Height = 257
-          Caption = 'Program settings'
-          Color = clNone
-          ParentColor = False
-          TabOrder = 0
-          object ResetRegistryButton: TSpTBXSpeedButton
-            Left = 240
-            Top = 224
-            Width = 113
-            Height = 22
-            Caption = 'Reset registry data'
-            OnClick = ResetRegistryButtonClick
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object GameSettingsButton: TSpTBXSpeedButton
-            Left = 240
-            Top = 96
-            Width = 113
-            Height = 22
-            Caption = 'Game settings'
-            OnClick = GameSettingsButtonClick
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object NotificationsButton: TSpTBXSpeedButton
-            Left = 240
-            Top = 48
-            Width = 113
-            Height = 22
-            Caption = 'Notifications ...'
-            OnClick = NotificationsButtonClick
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object HighlightingButton: TSpTBXSpeedButton
-            Left = 240
-            Top = 24
-            Width = 113
-            Height = 22
-            Caption = 'Highlighting ...'
-            OnClick = HighlightingButtonClick
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object IgnoreListButton: TSpTBXSpeedButton
-            Left = 240
-            Top = 72
-            Width = 113
-            Height = 22
-            Caption = 'Ignore list ...'
-            OnClick = IgnoreListButtonClick
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object Label6: TSpTBXLabel
-            Left = 16
-            Top = 32
-            Width = 46
-            Height = 13
-            Caption = 'Tab style:'
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object RadioButton4: TSpTBXRadioButton
-            Left = 16
-            Top = 56
-            Width = 38
-            Height = 15
-            Caption = 'tabs'
-            TabOrder = 0
-            TabStop = True
-            Checked = True
-          end
-          object RadioButton5: TSpTBXRadioButton
-            Left = 16
-            Top = 72
-            Width = 53
-            Height = 15
-            Caption = 'buttons'
-            TabOrder = 1
-          end
-          object RadioButton6: TSpTBXRadioButton
-            Left = 16
-            Top = 88
-            Width = 70
-            Height = 15
-            Caption = 'flat buttons'
-            TabOrder = 2
-          end
-          object CheckBox8: TSpTBXCheckBox
-            Left = 16
-            Top = 232
-            Width = 88
-            Height = 15
-            Caption = 'Enable logging'
-            TabOrder = 3
-            Checked = True
-            State = cbChecked
-          end
-          object CheckBox9: TSpTBXCheckBox
-            Left = 16
-            Top = 216
-            Width = 128
-            Height = 15
-            Caption = 'Use sound notifications'
-            TabOrder = 4
-            Checked = True
-            State = cbChecked
-          end
-          object KeyEditorButton: TSpTBXSpeedButton
-            Left = 240
-            Top = 120
-            Width = 113
-            Height = 22
-            Caption = 'Selection key editor'
-            OnClick = KeyEditorButtonClick
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object CheckForNewVersionCheckBox: TSpTBXCheckBox
-            Left = 16
-            Top = 200
-            Width = 168
-            Height = 15
-            Caption = 'Auto update lobby to latest beta'
-            TabOrder = 12
-          end
-          object ColorsButton: TSpTBXButton
-            Left = 240
-            Top = 144
-            Width = 113
-            Height = 22
-            Caption = 'Colors and font ...'
-            TabOrder = 13
-            OnClick = ColorsButtonClick
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object ManageGroupsButton: TSpTBXButton
-            Left = 240
-            Top = 168
-            Width = 113
-            Height = 22
-            Caption = 'Manage groups ...'
-            TabOrder = 14
-            OnClick = ManageGroupsButtonClick
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object EnableSpringDownloaderCheckBox: TSpTBXCheckBox
-            Left = 16
-            Top = 184
-            Width = 144
-            Height = 15
-            Caption = 'Enable Spring Downloader'
-            TabOrder = 15
-          end
-        end
-      end
       object SpTBXTabSheet3: TSpTBXTabSheet
         Left = 0
         Top = 23
@@ -755,6 +434,80 @@
           end
         end
       end
+      object SpTBXTabSheet7: TSpTBXTabSheet
+        Left = 0
+        Top = 23
+        Width = 401
+        Height = 282
+        Caption = 'Scripts'
+        ImageIndex = -1
+        TabItem = 'SpTBXTabItem7'
+        object ScriptsDebugWindowBt: TSpTBXButton
+          Left = 132
+          Top = 56
+          Width = 137
+          Height = 25
+          Caption = 'Debug Window'
+          TabOrder = 0
+          OnClick = ScriptsDebugWindowBtClick
+          LinkFont.Charset = DEFAULT_CHARSET
+          LinkFont.Color = clBlue
+          LinkFont.Height = -11
+          LinkFont.Name = 'MS Sans Serif'
+          LinkFont.Style = [fsUnderline]
+        end
+        object ScriptsReloadBt: TSpTBXButton
+          Left = 132
+          Top = 88
+          Width = 137
+          Height = 25
+          Caption = 'Reload scripts'
+          TabOrder = 1
+          OnClick = ScriptsReloadBtClick
+          LinkFont.Charset = DEFAULT_CHARSET
+          LinkFont.Color = clBlue
+          LinkFont.Height = -11
+          LinkFont.Name = 'MS Sans Serif'
+          LinkFont.Style = [fsUnderline]
+        end
+        object ScriptsLoadNewBt: TSpTBXButton
+          Left = 132
+          Top = 120
+          Width = 137
+          Height = 25
+          Caption = 'Load new scripts'
+          TabOrder = 2
+          OnClick = ScriptsLoadNewBtClick
+          LinkFont.Charset = DEFAULT_CHARSET
+          LinkFont.Color = clBlue
+          LinkFont.Height = -11
+          LinkFont.Name = 'MS Sans Serif'
+          LinkFont.Style = [fsUnderline]
+        end
+        object ScriptsAdvancedOptionsBt: TSpTBXButton
+          Left = 132
+          Top = 152
+          Width = 137
+          Height = 25
+          Caption = 'Advanced options'
+          TabOrder = 3
+          Visible = False
+          OnClick = ScriptsAdvancedOptionsBtClick
+          LinkFont.Charset = DEFAULT_CHARSET
+          LinkFont.Color = clBlue
+          LinkFont.Height = -11
+          LinkFont.Name = 'MS Sans Serif'
+          LinkFont.Style = [fsUnderline]
+        end
+        object EnableScriptsCheckBox: TSpTBXCheckBox
+          Left = 104
+          Top = 24
+          Width = 193
+          Height = 15
+          Caption = 'Enable scripts BETA (requires restart)'
+          TabOrder = 4
+        end
+      end
       object SpTBXTabSheet6: TSpTBXTabSheet
         Left = 0
         Top = 23
@@ -866,79 +619,346 @@
           end
         end
       end
-      object SpTBXTabSheet7: TSpTBXTabSheet
+      object SpTBXTabSheet5: TSpTBXTabSheet
         Left = 0
         Top = 23
         Width = 401
         Height = 282
-        Caption = 'Scripts'
+        Caption = 'Account'
         ImageIndex = -1
-        TabItem = 'SpTBXTabItem7'
-        object ScriptsDebugWindowBt: TSpTBXButton
-          Left = 132
-          Top = 56
-          Width = 137
-          Height = 25
-          Caption = 'Debug Window'
+        TabItem = 'SpTBXTabItem5'
+        object GroupBox2: TSpTBXGroupBox
+          Left = 16
+          Top = 8
+          Width = 369
+          Height = 257
+          Caption = 'Account details'
+          Color = clNone
+          ParentColor = False
           TabOrder = 0
-          OnClick = ScriptsDebugWindowBtClick
-          LinkFont.Charset = DEFAULT_CHARSET
-          LinkFont.Color = clBlue
-          LinkFont.Height = -11
-          LinkFont.Name = 'MS Sans Serif'
-          LinkFont.Style = [fsUnderline]
+          object RegisterAccountButton: TSpTBXSpeedButton
+            Left = 56
+            Top = 160
+            Width = 185
+            Height = 25
+            Caption = 'Create new account'
+            OnClick = RegisterAccountButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object Label4: TSpTBXLabel
+            Left = 24
+            Top = 40
+            Width = 51
+            Height = 13
+            Caption = 'Username:'
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object Label5: TSpTBXLabel
+            Left = 24
+            Top = 72
+            Width = 49
+            Height = 13
+            Caption = 'Password:'
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object UsernameEdit: TSpTBXEdit
+            Left = 120
+            Top = 40
+            Width = 121
+            Height = 21
+            TabOrder = 0
+            OnChange = UsernameEditChange
+          end
+          object PasswordEdit: TSpTBXEdit
+            Left = 120
+            Top = 72
+            Width = 121
+            Height = 21
+            TabOrder = 1
+            OnChange = PasswordEditChange
+            PasswordCharW = '*'
+          end
+          object LadderPasswordEdit: TSpTBXEdit
+            Left = 120
+            Top = 104
+            Width = 121
+            Height = 21
+            Enabled = False
+            TabOrder = 5
+            PasswordCharW = '*'
+          end
+          object SpTBXLabel1: TSpTBXLabel
+            Left = 24
+            Top = 104
+            Width = 87
+            Height = 13
+            Caption = 'Ladder password :'
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object ChangeLadderPasswordButton: TSpTBXButton
+            Left = 248
+            Top = 104
+            Width = 41
+            Height = 21
+            Caption = 'Edit'
+            TabOrder = 7
+            OnClick = ChangeLadderPasswordButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object RegisterLadderAccountButton: TSpTBXButton
+            Left = 56
+            Top = 192
+            Width = 185
+            Height = 25
+            Caption = 'Create new ladder account'
+            TabOrder = 8
+            OnClick = RegisterLadderAccountButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object RememberPasswordsCheckBox: TSpTBXCheckBox
+            Left = 120
+            Top = 128
+            Width = 117
+            Height = 15
+            Caption = 'remember passwords'
+            TabOrder = 9
+          end
         end
-        object ScriptsReloadBt: TSpTBXButton
-          Left = 132
-          Top = 88
-          Width = 137
-          Height = 25
-          Caption = 'Reload scripts'
-          TabOrder = 1
-          OnClick = ScriptsReloadBtClick
-          LinkFont.Charset = DEFAULT_CHARSET
-          LinkFont.Color = clBlue
-          LinkFont.Height = -11
-          LinkFont.Name = 'MS Sans Serif'
-          LinkFont.Style = [fsUnderline]
+      end
+      object SpTBXTabSheet4: TSpTBXTabSheet
+        Left = 0
+        Top = 23
+        Width = 401
+        Height = 282
+        Caption = 'Program'
+        ImageIndex = -1
+        TabItem = 'SpTBXTabItem4'
+        object GroupBox3: TSpTBXGroupBox
+          Left = 16
+          Top = 8
+          Width = 369
+          Height = 257
+          Caption = 'Program settings'
+          Color = clNone
+          ParentColor = False
+          TabOrder = 0
+          object ResetRegistryButton: TSpTBXSpeedButton
+            Left = 240
+            Top = 224
+            Width = 113
+            Height = 22
+            Caption = 'Reset registry data'
+            OnClick = ResetRegistryButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object GameSettingsButton: TSpTBXSpeedButton
+            Left = 240
+            Top = 96
+            Width = 113
+            Height = 22
+            Caption = 'Game settings'
+            OnClick = GameSettingsButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object NotificationsButton: TSpTBXSpeedButton
+            Left = 240
+            Top = 48
+            Width = 113
+            Height = 22
+            Caption = 'Notifications ...'
+            OnClick = NotificationsButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object HighlightingButton: TSpTBXSpeedButton
+            Left = 240
+            Top = 24
+            Width = 113
+            Height = 22
+            Caption = 'Highlighting ...'
+            OnClick = HighlightingButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object IgnoreListButton: TSpTBXSpeedButton
+            Left = 240
+            Top = 72
+            Width = 113
+            Height = 22
+            Caption = 'Ignore list ...'
+            OnClick = IgnoreListButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object Label6: TSpTBXLabel
+            Left = 16
+            Top = 32
+            Width = 46
+            Height = 13
+            Caption = 'Tab style:'
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object RadioButton4: TSpTBXRadioButton
+            Left = 16
+            Top = 56
+            Width = 38
+            Height = 15
+            Caption = 'tabs'
+            TabOrder = 0
+            TabStop = True
+            Checked = True
+          end
+          object RadioButton5: TSpTBXRadioButton
+            Left = 16
+            Top = 72
+            Width = 53
+            Height = 15
+            Caption = 'buttons'
+            TabOrder = 1
+          end
+          object RadioButton6: TSpTBXRadioButton
+            Left = 16
+            Top = 88
+            Width = 70
+            Height = 15
+            Caption = 'flat buttons'
+            TabOrder = 2
+          end
+          object CheckBox8: TSpTBXCheckBox
+            Left = 16
+            Top = 232
+            Width = 88
+            Height = 15
+            Caption = 'Enable logging'
+            TabOrder = 3
+            Checked = True
+            State = cbChecked
+          end
+          object CheckBox9: TSpTBXCheckBox
+            Left = 16
+            Top = 216
+            Width = 128
+            Height = 15
+            Caption = 'Use sound notifications'
+            TabOrder = 4
+            Checked = True
+            State = cbChecked
+          end
+          object KeyEditorButton: TSpTBXSpeedButton
+            Left = 240
+            Top = 120
+            Width = 113
+            Height = 22
+            Caption = 'Selection key editor'
+            OnClick = KeyEditorButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object CheckForNewVersionCheckBox: TSpTBXCheckBox
+            Left = 16
+            Top = 200
+            Width = 168
+            Height = 15
+            Caption = 'Auto update lobby to latest beta'
+            TabOrder = 12
+          end
+          object ColorsButton: TSpTBXButton
+            Left = 240
+            Top = 144
+            Width = 113
+            Height = 22
+            Caption = 'Colors and font ...'
+            TabOrder = 13
+            OnClick = ColorsButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object ManageGroupsButton: TSpTBXButton
+            Left = 240
+            Top = 168
+            Width = 113
+            Height = 22
+            Caption = 'Manage groups ...'
+            TabOrder = 14
+            OnClick = ManageGroupsButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object EnableSpringDownloaderCheckBox: TSpTBXCheckBox
+            Left = 16
+            Top = 184
+            Width = 144
+            Height = 15
+            Caption = 'Enable Spring Downloader'
+            TabOrder = 15
+            Checked = True
+            State = cbChecked
+          end
+          object UseLogonFormCheckBox: TSpTBXCheckBox
+            Left = 16
+            Top = 168
+            Width = 89
+            Height = 15
+            Caption = 'Use logon form'
+            TabOrder = 16
+            Checked = True
+            State = cbChecked
+          end
         end
-        object ScriptsLoadNewBt: TSpTBXButton
-          Left = 132
-          Top = 120
-          Width = 137
-          Height = 25
-          Caption = 'Load new scripts'
-          TabOrder = 2
-          OnClick = ScriptsLoadNewBtClick
-          LinkFont.Charset = DEFAULT_CHARSET
-          LinkFont.Color = clBlue
-          LinkFont.Height = -11
-          LinkFont.Name = 'MS Sans Serif'
-          LinkFont.Style = [fsUnderline]
-        end
-        object ScriptsAdvancedOptionsBt: TSpTBXButton
-          Left = 132
-          Top = 152
-          Width = 137
-          Height = 25
-          Caption = 'Advanced options'
-          TabOrder = 3
-          Visible = False
-          OnClick = ScriptsAdvancedOptionsBtClick
-          LinkFont.Charset = DEFAULT_CHARSET
-          LinkFont.Color = clBlue
-          LinkFont.Height = -11
-          LinkFont.Name = 'MS Sans Serif'
-          LinkFont.Style = [fsUnderline]
-        end
-        object EnableScriptsCheckBox: TSpTBXCheckBox
-          Left = 104
-          Top = 24
-          Width = 193
-          Height = 15
-          Caption = 'Enable scripts BETA (requires restart)'
-          TabOrder = 4
-        end
       end
     end
     object ApplyAndCloseButton: TSpTBXButton

Modified: trunk/Lobby/TASClient/PreferencesFormUnit.pas
===================================================================
--- trunk/Lobby/TASClient/PreferencesFormUnit.pas	2008-08-25 12:42:00 UTC (rev 6316)
+++ trunk/Lobby/TASClient/PreferencesFormUnit.pas	2008-08-26 15:04:08 UTC (rev 6317)
@@ -30,6 +30,7 @@
     Username: string[255];
     Password: string[255];
     LadderPassword : string;
+    RememberPasswords : boolean;
 
     ConnectOnStartup: Boolean;
 
@@ -83,6 +84,8 @@
     EnableScripts: Boolean;
 
     EnableSpringDownloader: Boolean;
+
+    UseLogonForm : boolean;
   end;
 
   TPreferencesForm = class(TForm)
@@ -182,6 +185,8 @@
     DisplayUnitsIconsAndNamesCheckBox: TSpTBXCheckBox;
     EnableScriptsCheckBox: TSpTBXCheckBox;
     EnableSpringDownloaderCheckBox: TSpTBXCheckBox;
+    RememberPasswordsCheckBox: TSpTBXCheckBox;
+    UseLogonFormCheckBox: TSpTBXCheckBox;
 
     function BattleSortStyleToColumn(SortStyle: Integer): Integer;
     function ColumnToBattleSortStyle(Column: Integer): Integer;
@@ -278,7 +283,15 @@
   end;
 
 const
-  DEFAULT_PREFERENCES: TPreferences = (ServerIP:'taspringmaster.clan-sy.com'; ServerPort:'8200'; TabStyle:0; TimeStamps: True; Username:''; Password:''; ConnectOnStartup: False; SortStyle: 1; BattleSortStyle: 1; BattleSortDirection: 0; BattleClientSortStyle: 2;FilterJoinLeftMessages: False;FilterBattleJoinLeftMessages: False; ShowFlags: True; MarkUnknownMaps: False; TaskbarButtons: True; JoinMainChannel: True; ReconnectToBackup: True; SaveLogs: True; UseSoundNotifications: True;AutoCompletionFromCurrentChannel: False; AutoUpdateToBeta: False;DisplayUnitsIconsAndNames: False; UseProxy: False; HighlightColor: 'Green'; UseNotificationsForHighlights: True; UseIgnoreList: False; WarnIfUsingNATTraversing: True; AutoFocusOnPM: True; MapSortStyle: 1; ThemeType: thtTBX; Theme: 'Miranda'; DisableAllSounds: False; SortLocal: False; DisplayQuickJoinPanel : True; LimitChatLogs: False; ChatLogsLimit: 800; SPSkin: 'default.ssk'; DisableScripts : True; EnableScripts : False; EnableSpringDow
 nloader : True);
+  DEFAULT_PREFERENCES: TPreferences = (ServerIP:'taspringmaster.clan-sy.com'; ServerPort:'8200'; TabStyle:0; TimeStamps: True; Username:''; Password:'';
+                                        RememberPasswords: False; ConnectOnStartup: False; SortStyle: 1; BattleSortStyle: 1; BattleSortDirection: 0;
+                                        BattleClientSortStyle: 2;FilterJoinLeftMessages: False;FilterBattleJoinLeftMessages: False; ShowFlags: True;
+                                        MarkUnknownMaps: False; TaskbarButtons: True; JoinMainChannel: True; ReconnectToBackup: True; SaveLogs: True;
+                                        UseSoundNotifications: True;AutoCompletionFromCurrentChannel: False; AutoUpdateToBeta: False;DisplayUnitsIconsAndNames: False;
+                                        UseProxy: False; HighlightColor: 'Green'; UseNotificationsForHighlights: True; UseIgnoreList: False; WarnIfUsingNATTraversing: True;
+                                        AutoFocusOnPM: True; MapSortStyle: 1; ThemeType: thtTBX; Theme: 'Miranda'; DisableAllSounds: False; SortLocal: False;
+                                        DisplayQuickJoinPanel : True; LimitChatLogs: False; ChatLogsLimit: 800; SPSkin: 'default.ssk'; DisableScripts : True;
+                                        EnableScripts : False; EnableSpringDownloader : True; UseLogonForm : True);
 
 var
   PreferencesForm: TPreferencesForm;
@@ -307,7 +320,7 @@
   OnlineMapsUnit, NotificationsUnit, PerformFormUnit, HighlightingUnit,
   NewAccountUnit, IgnoreListUnit, MapListFormUnit, ColorsPreferenceUnit,
   ManageGroups, ReplaysUnit, PythonScriptDebugFormUnit, LobbyScriptUnit,
-  SpringDownloaderFormUnit;
+  SpringDownloaderFormUnit, LogonFormUnit;
 
 {$R *.dfm}
 
@@ -320,7 +333,9 @@
     try Preferences.TimeStamps := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'TimeStamps'); except end;
     try Preferences.Username := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Username'); except end;
     try Preferences.Password := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Password'); except end;
-    if Length(Preferences.Password) &lt;&gt; 24 then // not md5 password = old system
+    try Preferences.RememberPasswords := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'RememberPasswords'); except end;
+    try Preferences.UseLogonForm := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseLogonForm'); except end;
+    if (Length(Preferences.Password) &lt;&gt; 24)  and (Length(Preferences.Password) &gt; 0) then // not md5 password = old system
       Preferences.Password := Misc.GetMD5Hash(Preferences.Password);
     try Preferences.LadderPassword := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LadderPassword'); except end;
     try Preferences.ConnectOnStartup := Misc.GetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ConnectOnStartup'); except end;
@@ -600,8 +615,18 @@
     Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'TabStyle', rdInteger, Preferences.TabStyle);
     Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'TimeStamps', rdInteger, Misc.BoolToInt(Preferences.TimeStamps));
     Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Username', rdString, Preferences.Username);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Password', rdString, Preferences.Password);
-    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LadderPassword', rdString, Preferences.LadderPassword);
+    if Preferences.RememberPasswords then
+    begin
+      Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Password', rdString, Preferences.Password);
+      Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LadderPassword', rdString, Preferences.LadderPassword);
+    end
+    else
+    begin
+      Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'Password', rdString, '');
+      Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'LadderPassword', rdString, '');
+    end;
+    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'RememberPasswords', rdInteger, Misc.BoolToInt(Preferences.RememberPasswords));
+    Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'UseLogonForm', rdInteger, Misc.BoolToInt(Preferences.UseLogonForm));
     Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'ConnectOnStartup', rdInteger, Misc.BoolToInt(Preferences.ConnectOnStartup));
     Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'SortStyle', rdInteger, Preferences.SortStyle);
     Misc.SetRegistryData(HKEY_CURRENT_USER, '\Software\TASClient\Preferences', 'BattleSortStyle', rdInteger, Preferences.BattleSortStyle);
@@ -793,6 +818,8 @@
   p.Username := UsernameEdit.Text;
   p.Password := PasswordEdit.Text;
   p.LadderPassword := LadderPasswordEdit.Text;
+  p.RememberPasswords := RememberPasswordsCheckBox.Checked;
+  p.UseLogonForm := UseLogonFormCheckBox.Checked;
 
   p.ConnectOnStartup := CheckBox2.Checked;
 
@@ -852,6 +879,9 @@
   ServerAddressEdit.Text := p.ServerIP;
   ServerPortEdit.Text := p.ServerPort;
 
+  LogonForm.beServer.Text := p.ServerIP;
+  LogonForm.txtPort.Text := p.ServerPort;
+
   if p.TabStyle = 0 then RadioButton4.Checked := True
   else if p.TabStyle = 1 then RadioButton5.Checked := True
   else if p.TabStyle = 2 then RadioButton6.Checked := True
@@ -864,7 +894,17 @@
   UsernameEdit.Text := p.Username;
   PasswordEdit.Text := p.Password;
   LadderPasswordEdit.Text := p.LadderPassword;
+  RememberPasswordsCheckBox.Checked := p.RememberPasswords;
+  UseLogonFormCheckBox.Checked := p.UseLogonForm;
 
+  LogonForm.txtLogin.Text := p.Username;
+  LogonForm.txtPort.Text := p.ServerPort;
+  LogonForm.beServer.Text := p.ServerIP;
+  LogonForm.beLadderPassword.Text := p.LadderPassword;
+  LogonForm.txtPassword.Text := p.Password;
+  LogonForm.chkRememberPasswords.Checked := p.RememberPasswords;
+  LogonForm.chkUseLogonForm.Checked := p.UseLogonForm;
+
   CheckBox2.Checked := p.ConnectOnStartup;
 
   MainForm.SortPopupMenu.Items[p.SortStyle].Checked := True;
@@ -1054,6 +1094,7 @@
 procedure TPreferencesForm.AddressPopupMenuItemClick(Sender: TObject);
 begin
   ServerAddressEdit.Text := ServerList[(Sender as TSpTBXItem).Tag].Address;
+  LogonForm.beServer.Text := ServerList[(Sender as TSpTBXItem).Tag].Address;
 end;
 
 procedure TPreferencesForm.GameSettingsButtonClick(Sender: TObject);
@@ -1200,9 +1241,15 @@
     if not isOnTheFlyCheck then
     begin
       LadderPasswordEdit.PasswordChar := #0;
+      LogonForm.beLadderPassword.PasswordChar := LadderPasswordEdit.PasswordChar;
       LadderPasswordEdit.Text := 'Checking password ...';
+      LogonForm.beLadderPassword.Text := LadderPasswordEdit.Text;
       ApplyAndCloseButton.Enabled := False;
+      LogonForm.btLogin.Enabled := False;
       ChangeLadderPasswordButton.Enabled := False;
+      LogonForm.beLadderPassword.EditButton.Enabled := False;
+      RegisterLadderAccountButton.Enabled := False;
+      LogonForm.btRegisterLadder.Enabled := False;
     end;
 
     if Preferences.UseProxy then
@@ -1222,7 +1269,11 @@
       MessageDlgThread('Error: Ladder server unavailable.',mtError,[mbOK],0);
       LadderPasswordEdit.Text := '';
       ApplyAndCloseButton.Enabled := True;
+      LogonForm.btLogin.Enabled := True;
       ChangeLadderPasswordButton.Enabled := True;
+      LogonForm.beLadderPassword.EditButton.Enabled := True;
+      RegisterLadderAccountButton.Enabled := True;
+      LogonForm.btRegisterLadder.Enabled := True;
       Exit;
     end;
     HttpCli1.RcvdStream.Seek(0,0);
@@ -1231,11 +1282,15 @@
     HttpCli1.RcvdStream.Free;
 
     LadderPasswordEdit.PasswordChar := '*';
+    LogonForm.beLadderPassword.PasswordChar := LadderPasswordEdit.PasswordChar;
     // parse the html result
     Misc.ParseDelimited(parse1,html,' ','');
     if (parse1[0] = 'error') then begin
       if not isOnTheFlyCheck then
-        LadderPasswordEdit.Text := ''
+      begin
+        LadderPasswordEdit.Text := '';
+        LogonForm.beLadderPassword.Text := LadderPasswordEdit.Text;
+      end
       else
         Preferences.LadderPassword := '';
       parse1.Delete(0);
@@ -1244,13 +1299,20 @@
     else
     begin
       if not isOnTheFlyCheck then
+      begin
         LadderPasswordEdit.Text := password;
+        LogonForm.beLadderPassword.Text := LadderPasswordEdit.Text;
+      end;
     end;
     parse1.Clear;
     if not isOnTheFlyCheck then
     begin
       ApplyAndCloseButton.Enabled := True;
+      LogonForm.btLogin.Enabled := True;
       ChangeLadderPasswordButton.Enabled := True;
+      LogonForm.beLadderPassword.EditButton.Enabled := True;
+      RegisterLadderAccountButton.Enabled := True;
+      LogonForm.btRegisterLadder.Enabled := True;
     end;
   end;
 end;
@@ -1293,9 +1355,15 @@
 
   with PreferencesForm do begin
     LadderPasswordEdit.PasswordChar := #0;
+    LogonForm.beLadderPassword.PasswordChar := LadderPasswordEdit.PasswordChar;
     LadderPasswordEdit.Text := 'Registering acount ...';
+    LogonForm.beLadderPassword.Text := LadderPasswordEdit.Text;
     ApplyAndCloseButton.Enabled := False;
+    LogonForm.btLogin.Enabled := False;
     ChangeLadderPasswordButton.Enabled := False;
+    LogonForm.beLadderPassword.EditButton.Enabled := False;
+    RegisterLadderAccountButton.Enabled := False;
+    LogonForm.btRegisterLadder.Enabled := False;
 
     if Preferences.UseProxy then
     begin
@@ -1314,7 +1382,11 @@
       MessageDlgThread('Error: Ladder server unavailable.',mtError,[mbOK],0);
       LadderPasswordEdit.Text := '';
       ApplyAndCloseButton.Enabled := True;
+      LogonForm.btLogin.Enabled := True;
       ChangeLadderPasswordButton.Enabled := True;
+      LogonForm.beLadderPassword.EditButton.Enabled := True;
+      RegisterLadderAccountButton.Enabled := True;
+      LogonForm.btRegisterLadder.Enabled := True;
       Exit;
     end;
     HttpCli1.RcvdStream.Seek(0,0);
@@ -1323,20 +1395,27 @@
     HttpCli1.RcvdStream.Free;
 
     LadderPasswordEdit.PasswordChar := '*';
+    LogonForm.beLadderPassword.PasswordChar := LadderPasswordEdit.PasswordChar;
     // parse the html result
     Misc.ParseDelimited(parse1,html,' ','');
     if (parse1[0] = 'error') then begin
       LadderPasswordEdit.Text := '';
+      LogonForm.beLadderPassword.Text := LadderPasswordEdit.Text;
       parse1.Delete(0);
       MessageDlgThread(Misc.JoinStringList(parse1,' '),mtError,[mbOK],0)
     end
     else
     begin
       LadderPasswordEdit.Text := password;
+      LogonForm.beLadderPassword.Text := LadderPasswordEdit.Text;
     end;
     parse1.Clear;
     ApplyAndCloseButton.Enabled := True;
+    LogonForm.btLogin.Enabled := True;
     ChangeLadderPasswordButton.Enabled := True;
+    LogonForm.beLadderPassword.EditButton.Enabled := True;
+    RegisterLadderAccountButton.Enabled := True;
+    LogonForm.btRegisterLadder.Enabled := True;
   end;
 end;
 

Modified: trunk/Lobby/TASClient/TASClient.cfg
===================================================================
--- trunk/Lobby/TASClient/TASClient.cfg	2008-08-25 12:42:00 UTC (rev 6316)
+++ trunk/Lobby/TASClient/TASClient.cfg	2008-08-26 15:04:08 UTC (rev 6317)
@@ -31,7 +31,7 @@
 -M
 -$M16384,1048576
 -K$00400000
--E&quot;C:\Program Files\SpringSVN&quot;
+-E&quot;C:\Program Files\Spring&quot;
 -LE&quot;c:\program files\borland\delphi7\Projects\Bpl&quot;
 -LN&quot;c:\program files\borland\delphi7\Projects\Bpl&quot;
 -U&quot;E:\Tools\Developpement\spring_0.74b3_src\SVN\LobbyComponents\graphics32-1_5_1&quot;

Modified: trunk/Lobby/TASClient/TASClient.dof
===================================================================
--- trunk/Lobby/TASClient/TASClient.dof	2008-08-25 12:42:00 UTC (rev 6316)
+++ trunk/Lobby/TASClient/TASClient.dof	2008-08-26 15:04:08 UTC (rev 6317)
@@ -90,7 +90,7 @@
 ImageBase=4194304
 ExeDescription=
 [Directories]
-OutputDir=C:\Program Files\SpringSVN
+OutputDir=C:\Program Files\Spring
 UnitOutputDir=
 PackageDLLOutputDir=
 PackageDCPOutputDir=
@@ -101,10 +101,10 @@
 UsePackages=0
 [Parameters]
 RunParams=
-HostApplication=C:\Program Files\SpringSVN\TASClient.exe
+HostApplication=C:\Program Files\Spring\TASClient.exe
 Launcher=
 UseLauncher=0
-DebugCWD=C:\Program Files\SpringSVN
+DebugCWD=C:\Program Files\Spring
 [Language]
 ActiveLang=
 ProjectLang=
@@ -115,7 +115,7 @@
 MajorVer=0
 MinorVer=3
 Release=0
-Build=418
+Build=423
 Debug=0
 PreRelease=0
 Special=0
@@ -126,7 +126,7 @@
 [Version Info Keys]
 CompanyName=
 FileDescription=TA Spring lobby client
-FileVersion=0.3.0.418
+FileVersion=0.3.0.423
 InternalName=
 LegalCopyright=
 LegalTrademarks=
@@ -145,6 +145,6 @@
 Item0=C:\Program Files\TASpring
 [HistoryLists\hlOutputDirectorry]
 Count=3
-Item0=C:\Program Files\SpringSVN
-Item1=C:\Program Files\Spring
+Item0=C:\Program Files\Spring
+Item1=C:\Program Files\SpringSVN
 Item2=C:\Program Files\TASpring

Modified: trunk/Lobby/TASClient/TASClient.dpr
===================================================================
--- trunk/Lobby/TASClient/TASClient.dpr	2008-08-25 12:42:00 UTC (rev 6316)
+++ trunk/Lobby/TASClient/TASClient.dpr	2008-08-26 15:04:08 UTC (rev 6317)
@@ -110,7 +110,8 @@
   OpenIL in 'openil.pas',
   PythonScriptDebugFormUnit in 'PythonScriptDebugFormUnit.pas' {PythonScriptDebugForm},
   LobbyScriptUnit in 'LobbyScriptUnit.pas',
-  SpringDownloaderFormUnit in 'SpringDownloaderFormUnit.pas' {SpringDownloaderForm};
+  SpringDownloaderFormUnit in 'SpringDownloaderFormUnit.pas' {SpringDownloaderForm},
+  LogonFormUnit in 'LogonFormUnit.pas' {LogonForm};
 
 var
   i: Integer;
@@ -219,6 +220,7 @@
   Application.CreateForm(TColorsPreference, ColorsPreference);
   Application.CreateForm(TSearchPlayerForm, SearchPlayerForm);
   Application.CreateForm(TPythonScriptDebugForm, PythonScriptDebugForm);
+  Application.CreateForm(TLogonForm, LogonForm);
   //Application.CreateForm(TSpringDownloaderForm, SpringDownloaderForm);
   if not MainUnit.RunningUnderWine then
     Application.CreateForm(TMenuForm, MenuForm);

Modified: trunk/Lobby/TASClient/TASClient.res
===================================================================
(Binary files differ)

Modified: trunk/Lobby/TASClient/Utility.pas
===================================================================
--- trunk/Lobby/TASClient/Utility.pas	2008-08-25 12:42:00 UTC (rev 6316)
+++ trunk/Lobby/TASClient/Utility.pas	2008-08-26 15:04:08 UTC (rev 6317)
@@ -162,7 +162,7 @@
 {since 0.76}function GetModOptionCount: Integer; stdcall; external 'UnitSync.dll' name 'GetModOptionCount';
 {since 0.76}function GetOptionKey(optIndex: Integer): PChar; stdcall; external 'UnitSync.dll' name 'GetOptionKey';
 {since 0.76}function GetOptionName(optIndex: Integer): PChar; stdcall; external 'UnitSync.dll' name 'GetOptionName';
-{since 0.77}function GetOptionSection(optIndex: Integer): PChar; stdcall; external 'UnitSync.dll' name 'GetOptionSection';
+{since 0.77}//function GetOptionSection(optIndex: Integer): PChar; stdcall; external 'UnitSync.dll' name 'GetOptionSection';
 {since 0.76}function GetOptionDesc(optIndex: Integer): PChar; stdcall; external 'UnitSync.dll' name 'GetOptionDesc';
 {since 0.76}function GetOptionType(optIndex: Integer): Integer; stdcall; external 'UnitSync.dll' name 'GetOptionType';
 {since 0.76}function GetOptionBoolDef(optIndex: Integer): Boolean; stdcall; external 'UnitSync.dll' name 'GetOptionBoolDef';
@@ -736,7 +736,7 @@
     o^.Key := StrNew(GetOptionKey(i));
     o^.Name := StrNew(GetOptionName(i));
     o^.Description := StrNew(GetOptionDesc(i));
-    o^.Section := StrNew(GetOptionSection(i));
+    //o^.Section := StrNew(GetOptionSection(i));
     if modOptions then
     begin
       o^.KeyPrefix := 'GAME/MODOPTIONS/';


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001086.html">[Taspring-linux-commit] r6316 - trunk/rts/Sim/MoveTypes/MoveMath
</A></li>
	<LI>Next message: <A HREF="001088.html">[Taspring-linux-commit] r6318 - trunk/Lobby/TASClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1087">[ date ]</a>
              <a href="thread.html#1087">[ thread ]</a>
              <a href="subject.html#1087">[ subject ]</a>
              <a href="author.html#1087">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
