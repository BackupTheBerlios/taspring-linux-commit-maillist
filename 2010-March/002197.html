<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r7427 - Lobby/TASClient
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2010-March/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7427%20-%20Lobby/TASClient&In-Reply-To=%3C20100310111709.C70B929CD4%40it-l.eu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002196.html">
   <LINK REL="Next"  HREF="002198.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r7427 - Lobby/TASClient</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7427%20-%20Lobby/TASClient&In-Reply-To=%3C20100310111709.C70B929CD4%40it-l.eu%3E"
       TITLE="[Taspring-linux-commit] r7427 - Lobby/TASClient">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Wed Mar 10 12:17:09 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002196.html">[Taspring-linux-commit] r7426 - Lobby/TASClient
</A></li>
        <LI>Next message: <A HREF="002198.html">[Taspring-linux-commit] r7428 - Lobby/TASClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2197">[ date ]</a>
              <a href="thread.html#2197">[ thread ]</a>
              <a href="subject.html#2197">[ subject ]</a>
              <a href="author.html#2197">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: satirik
Date: 2010-03-10 12:17:09 +0100 (Wed, 10 Mar 2010)
New Revision: 7427

Modified:
   Lobby/TASClient/AddBotUnit.dfm
   Lobby/TASClient/AutoJoinFormUnit.dfm
   Lobby/TASClient/BattleFormUnit.dfm
   Lobby/TASClient/BattleFormUnit.pas
   Lobby/TASClient/HelpUnit.dfm
   Lobby/TASClient/HostBattleFormUnit.dfm
   Lobby/TASClient/HostBattleFormUnit.pas
   Lobby/TASClient/HostInfoUnit.dfm
   Lobby/TASClient/LogonFormUnit.dfm
   Lobby/TASClient/MainUnit.dfm
   Lobby/TASClient/MainUnit.pas
   Lobby/TASClient/ManageGroups.dfm
   Lobby/TASClient/Misc.pas
   Lobby/TASClient/PreferencesFormUnit.dfm
   Lobby/TASClient/PreferencesFormUnit.pas
   Lobby/TASClient/ReplaysUnit.dfm
   Lobby/TASClient/TASClient.dof
   Lobby/TASClient/TASClient.res
Log:
* more space for translations
* filter battles by average rank added
* you can now set the number of chat log lines to load (or disable it)
* switching to a chat should automatically focus the inputbox
* fixed the &quot;Cannot focus a disabled or invisible window&quot; when trying to focus a closed panel

Modified: Lobby/TASClient/AddBotUnit.dfm
===================================================================
--- Lobby/TASClient/AddBotUnit.dfm	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/AddBotUnit.dfm	2010-03-10 11:17:09 UTC (rev 7427)
@@ -43,9 +43,9 @@
       LinkFont.Style = [fsUnderline]
     end
     object ReloadButton: TSpTBXSpeedButton
-      Left = 401
+      Left = 360
       Top = 32
-      Width = 73
+      Width = 114
       Height = 22
       Caption = 'Reload'
       Anchors = [akTop, akRight]
@@ -70,7 +70,7 @@
       LinkFont.Style = [fsUnderline]
     end
     object BotTeamColorButton: TSpTBXSpeedButton
-      Left = 128
+      Left = 160
       Top = 359
       Width = 105
       Height = 21
@@ -86,7 +86,7 @@
     end
     object Label3: TSpTBXLabel
       Left = 24
-      Top = 335
+      Top = 339
       Width = 15
       Height = 13
       Caption = 'Id :'
@@ -99,7 +99,7 @@
     end
     object Label4: TSpTBXLabel
       Left = 24
-      Top = 359
+      Top = 363
       Width = 33
       Height = 13
       Caption = 'Team :'
@@ -152,7 +152,7 @@
       Text = 'Bot'
     end
     object BotSideButton: TSpTBXSpeedButton
-      Left = 128
+      Left = 160
       Top = 335
       Width = 105
       Height = 22
@@ -166,7 +166,7 @@
       LinkFont.Style = [fsUnderline]
     end
     object BotAllyButton: TSpTBXSpinEdit
-      Left = 64
+      Left = 96
       Top = 359
       Width = 49
       Height = 21
@@ -187,7 +187,7 @@
       Value = 1.000000000000000000
     end
     object BotTeamButton: TSpTBXSpinEdit
-      Left = 64
+      Left = 96
       Top = 335
       Width = 49
       Height = 21
@@ -217,6 +217,7 @@
       ClipboardFormats.Strings = (
         'Unicode text')
       Header.AutoSizeIndex = 0
+      Header.DefaultHeight = 17
       Header.Font.Charset = DEFAULT_CHARSET
       Header.Font.Color = clWindowText
       Header.Font.Height = -11

Modified: Lobby/TASClient/AutoJoinFormUnit.dfm
===================================================================
--- Lobby/TASClient/AutoJoinFormUnit.dfm	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/AutoJoinFormUnit.dfm	2010-03-10 11:17:09 UTC (rev 7427)
@@ -211,9 +211,9 @@
           'Desc')
       end
       object btAddPresetToAutoplay: TSpTBXButton
-        Left = 56
+        Left = 8
         Top = 16
-        Width = 113
+        Width = 161
         Height = 33
         Caption = 'Add autoplay'
         TabOrder = 6
@@ -227,9 +227,9 @@
         LinkFont.Style = [fsUnderline]
       end
       object btAddPresetToAutospec: TSpTBXButton
-        Left = 56
+        Left = 16
         Top = 304
-        Width = 113
+        Width = 153
         Height = 33
         Caption = 'Add autospec'
         TabOrder = 7
@@ -342,9 +342,9 @@
       end
     end
     object btClose: TSpTBXButton
-      Left = 313
+      Left = 293
       Top = 528
-      Width = 73
+      Width = 113
       Height = 25
       Caption = 'Close'
       TabOrder = 4
@@ -358,7 +358,7 @@
     object gbOptions: TSpTBXGroupBox
       Left = 8
       Top = 392
-      Width = 321
+      Width = 385
       Height = 129
       Caption = 'Options'
       TabOrder = 5
@@ -372,9 +372,9 @@
       end
     end
     object gbPresets: TSpTBXGroupBox
-      Left = 336
+      Left = 400
       Top = 392
-      Width = 353
+      Width = 289
       Height = 129
       Caption = 'Presets'
       Font.Charset = DEFAULT_CHARSET
@@ -437,7 +437,7 @@
       object lstPresetList: TSpTBXListBox
         Left = 112
         Top = 16
-        Width = 233
+        Width = 169
         Height = 105
         ItemHeight = 16
         Items.Strings = (

Modified: Lobby/TASClient/BattleFormUnit.dfm
===================================================================
--- Lobby/TASClient/BattleFormUnit.dfm	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/BattleFormUnit.dfm	2010-03-10 11:17:09 UTC (rev 7427)
@@ -4613,9 +4613,9 @@
         904
         41)
       object StartButton: TSpTBXButton
-        Left = 120
+        Left = 128
         Top = 8
-        Width = 97
+        Width = 105
         Height = 25
         Caption = 'Start'
         TabOrder = 0
@@ -4627,9 +4627,9 @@
         LinkFont.Style = [fsUnderline]
       end
       object HostButton: TSpTBXButton
-        Left = 224
+        Left = 240
         Top = 8
-        Width = 97
+        Width = 105
         Height = 25
         Caption = 'Host battle'
         TabOrder = 1
@@ -4643,7 +4643,7 @@
       object DisconnectButton: TSpTBXButton
         Left = 16
         Top = 8
-        Width = 97
+        Width = 105
         Height = 25
         Caption = 'Disconnect'
         TabOrder = 2
@@ -4655,9 +4655,9 @@
         LinkFont.Style = [fsUnderline]
       end
       object AddBotButton: TSpTBXButton
-        Left = 432
+        Left = 464
         Top = 8
-        Width = 97
+        Width = 105
         Height = 25
         Caption = 'Add bot'
         TabOrder = 3
@@ -4669,7 +4669,7 @@
         LinkFont.Style = [fsUnderline]
       end
       object LockedCheckBox: TSpTBXCheckBox
-        Left = 640
+        Left = 688
         Top = 13
         Width = 73
         Height = 15
@@ -4690,9 +4690,9 @@
         OnGetImageIndex = LockedCheckBoxGetImageIndex
       end
       object AdminButton: TSpTBXButton
-        Left = 328
+        Left = 352
         Top = 8
-        Width = 97
+        Width = 105
         Height = 25
         Caption = 'Admin'
         TabOrder = 5
@@ -4720,9 +4720,9 @@
         LinkFont.Style = [fsUnderline]
       end
       object ReadyButton: TSpTBXButton
-        Left = 536
+        Left = 576
         Top = 8
-        Width = 97
+        Width = 105
         Height = 25
         Caption = 'I'#39'm ready'
         TabOrder = 7
@@ -4737,9 +4737,9 @@
         ThemeType = thtTBX
       end
       object SSProfileButton: TSpTBXButton
-        Left = 802
+        Left = 794
         Top = 8
-        Width = 97
+        Width = 105
         Height = 25
         Hint = 'Spring Settings Profile. Customize them in the options.'
         Caption = 'Settings'
@@ -4755,7 +4755,7 @@
         LinkFont.Style = [fsUnderline]
       end
       object StartProgressBar: TSpTBXProgressBar
-        Left = 200
+        Left = 216
         Top = 8
         Width = 17
         Height = 25
@@ -5175,7 +5175,7 @@
           end
         end
         object MapSizeLabel: TSpTBXLabel
-          Left = 60
+          Left = 4
           Top = 128
           Width = 54
           Height = 13
@@ -5189,7 +5189,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object TidalStrengthLabel: TSpTBXLabel
-          Left = 38
+          Left = 4
           Top = 143
           Width = 76
           Height = 13
@@ -5203,7 +5203,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object GravityLabel: TSpTBXLabel
-          Left = 69
+          Left = 4
           Top = 158
           Width = 45
           Height = 13
@@ -5217,7 +5217,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object MaxMetalLabel: TSpTBXLabel
-          Left = 51
+          Left = 4
           Top = 173
           Width = 63
           Height = 13
@@ -5231,7 +5231,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object ExtRadiusLabel: TSpTBXLabel
-          Left = 29
+          Left = 4
           Top = 188
           Width = 85
           Height = 13
@@ -12949,7 +12949,7 @@
         BiDiMode = bdLeftToRight
         Color = clBtnFace
         ParentBiDiMode = False
-        ActiveTabIndex = 1
+        ActiveTabIndex = 2
         ThemeType = tttTBX
         OnActiveTabChange = SpTBXTabControl1ActiveTabChange
         HiddenItems = &lt;
@@ -12992,7 +12992,6 @@
         object GameOptionsTab: TSpTBXTabItem
           Caption = 'Game options'
           Wrapping = twWrap
-          Checked = True
           CustomWidth = 80
           CustomHeight = 35
           ThemeType = tttTBX
@@ -13000,6 +12999,7 @@
         object DisabledUnitsTab: TSpTBXTabItem
           Caption = 'Disabled Units (0)'
           Wrapping = twWrap
+          Checked = True
           CustomWidth = 94
           ThemeType = tttTBX
         end
@@ -13015,170 +13015,6 @@
           CustomWidth = 94
           ThemeType = tttTBX
         end
-        object ModTabSheet: TSpTBXTabSheet
-          Left = 0
-          Top = 39
-          Width = 413
-          Height = 230
-          Caption = 'Mod options'
-          ImageIndex = -1
-          Item = ModTab
-          TabControl = SpTBXTabControl1
-          DesignSize = (
-            413
-            230)
-          TabItem = 'ModTab'
-          object ModOptionsScrollBox: TTntScrollBox
-            Left = 8
-            Top = 48
-            Width = 401
-            Height = 177
-            VertScrollBar.Smooth = True
-            VertScrollBar.Tracking = True
-            Anchors = [akLeft, akTop, akBottom]
-            BiDiMode = bdLeftToRight
-            BorderStyle = bsNone
-            Color = clBtnFace
-            Ctl3D = False
-            ParentBiDiMode = False
-            ParentBackground = True
-            ParentColor = False
-            ParentCtl3D = False
-            TabOrder = 0
-          end
-          object panelModOptionsDefault: TSpTBXPanel
-            Left = 8
-            Top = 4
-            Width = 402
-            Height = 41
-            Align = alCustom
-            TabOrder = 1
-            object btLoadDefaultMDO: TSpTBXButton
-              Left = 149
-              Top = 8
-              Width = 113
-              Height = 25
-              Caption = 'Load default'
-              TabOrder = 0
-              OnClick = btLoadDefaultMDOClick
-              LinkFont.Charset = DEFAULT_CHARSET
-              LinkFont.Color = clBlue
-              LinkFont.Height = -11
-              LinkFont.Name = 'MS Sans Serif'
-              LinkFont.Style = [fsUnderline]
-            end
-            object btSetAsDefaultMDO: TSpTBXButton
-              Left = 269
-              Top = 8
-              Width = 113
-              Height = 25
-              Caption = 'Set as default'
-              TabOrder = 1
-              OnClick = btSetAsDefaultMDOClick
-              LinkFont.Charset = DEFAULT_CHARSET
-              LinkFont.Color = clBlue
-              LinkFont.Height = -11
-              LinkFont.Name = 'MS Sans Serif'
-              LinkFont.Style = [fsUnderline]
-            end
-            object btLoadModsDefaultMDO: TSpTBXButton
-              Left = 29
-              Top = 8
-              Width = 113
-              Height = 25
-              Caption = 'Load mod'#39's default'
-              TabOrder = 2
-              OnClick = btLoadModsDefaultMDOClick
-              LinkFont.Charset = DEFAULT_CHARSET
-              LinkFont.Color = clBlue
-              LinkFont.Height = -11
-              LinkFont.Name = 'MS Sans Serif'
-              LinkFont.Style = [fsUnderline]
-            end
-          end
-        end
-        object MapTabSheet: TSpTBXTabSheet
-          Left = 0
-          Top = 39
-          Width = 413
-          Height = 230
-          Caption = 'Map options'
-          ImageIndex = -1
-          Item = MapTab
-          TabControl = SpTBXTabControl1
-          DesignSize = (
-            413
-            230)
-          TabItem = 'MapTab'
-          object MapOptionsScrollBox: TTntScrollBox
-            Left = 8
-            Top = 48
-            Width = 401
-            Height = 177
-            VertScrollBar.Smooth = True
-            VertScrollBar.Tracking = True
-            Anchors = [akLeft, akTop, akBottom]
-            BiDiMode = bdLeftToRight
-            BorderStyle = bsNone
-            Color = clBtnFace
-            Ctl3D = False
-            ParentBiDiMode = False
-            ParentBackground = True
-            ParentColor = False
-            ParentCtl3D = False
-            TabOrder = 0
-          end
-          object panelMapOptionsDefault: TSpTBXPanel
-            Left = 8
-            Top = 4
-            Width = 402
-            Height = 41
-            Align = alCustom
-            TabOrder = 1
-            object btLoadDefaultMPO: TSpTBXButton
-              Left = 149
-              Top = 8
-              Width = 113
-              Height = 25
-              Caption = 'Load default'
-              TabOrder = 0
-              OnClick = btLoadDefaultMPOClick
-              LinkFont.Charset = DEFAULT_CHARSET
-              LinkFont.Color = clBlue
-              LinkFont.Height = -11
-              LinkFont.Name = 'MS Sans Serif'
-              LinkFont.Style = [fsUnderline]
-            end
-            object btSetAsDefaultMPO: TSpTBXButton
-              Left = 269
-              Top = 8
-              Width = 113
-              Height = 25
-              Caption = 'Set as default'
-              TabOrder = 1
-              OnClick = btSetAsDefaultMPOClick
-              LinkFont.Charset = DEFAULT_CHARSET
-              LinkFont.Color = clBlue
-              LinkFont.Height = -11
-              LinkFont.Name = 'MS Sans Serif'
-              LinkFont.Style = [fsUnderline]
-            end
-            object btLoadMapsDefaultMPO: TSpTBXButton
-              Left = 29
-              Top = 8
-              Width = 113
-              Height = 25
-              Caption = 'Load map'#39's default'
-              TabOrder = 2
-              OnClick = btLoadMapsDefaultMPOClick
-              LinkFont.Charset = DEFAULT_CHARSET
-              LinkFont.Color = clBlue
-              LinkFont.Height = -11
-              LinkFont.Name = 'MS Sans Serif'
-              LinkFont.Style = [fsUnderline]
-            end
-          end
-        end
         object SpTBXTabSheet6: TSpTBXTabSheet
           Left = 0
           Top = 39
@@ -13204,78 +13040,6 @@
             OnMouseMove = QuickLookRichEditMouseMove
           end
         end
-        object SpTBXTabSheet1: TSpTBXTabSheet
-          Left = 0
-          Top = 39
-          Width = 413
-          Height = 230
-          Caption = 'Disabled Units (0)'
-          ImageIndex = -1
-          Item = DisabledUnitsTab
-          TabControl = SpTBXTabControl1
-          DesignSize = (
-            413
-            230)
-          TabItem = 'DisabledUnitsTab'
-          object UnitsGroupBox: TSpTBXGroupBox
-            Left = 8
-            Top = 4
-            Width = 401
-            Height = 227
-            Caption = 'Disabled units'
-            Anchors = [akLeft, akTop, akBottom]
-            Color = clNone
-            ParentColor = False
-            TabOrder = 0
-            DesignSize = (
-              401
-              227)
-            object AddUnitsSpeedButton: TSpeedButton
-              Left = 264
-              Top = 10
-              Width = 121
-              Height = 22
-              Caption = 'Add more units'
-              OnClick = AddUnitsSpeedButtonClick
-            end
-            object VDTDisabledUnits: TVirtualDrawTree
-              Left = 16
-              Top = 32
-              Width = 369
-              Height = 183
-              Anchors = [akLeft, akTop, akRight, akBottom]
-              DefaultNodeHeight = 64
-              Header.AutoSizeIndex = 1
-              Header.DefaultHeight = 17
-              Header.Font.Charset = DEFAULT_CHARSET
-              Header.Font.Color = clWindowText
-              Header.Font.Height = -11
-              Header.Font.Name = 'MS Sans Serif'
-              Header.Font.Style = []
-              Header.Options = [hoAutoResize, hoColumnResize, hoDrag]
-              TabOrder = 0
-              TreeOptions.PaintOptions = [toHideFocusRect, toShowButtons, toShowDropmark, toThemeAware, toUseBlendedImages]
-              TreeOptions.SelectionOptions = [toFullRowSelect]
-              OnDrawNode = VDTDisabledUnitsDrawNode
-              Columns = &lt;
-                item
-                  Position = 0
-                  Width = 64
-                  WideText = 'Icon'
-                end
-                item
-                  Position = 1
-                  Width = 201
-                  WideText = 'FullName'
-                end
-                item
-                  Position = 2
-                  Width = 100
-                  WideText = 'Code name'
-                end&gt;
-            end
-          end
-        end
         object SpTBXTabSheet2: TSpTBXTabSheet
           Left = 0
           Top = 39
@@ -13445,7 +13209,7 @@
           end
           object GameEndRadioGroup: TSpTBXRadioGroup
             Left = 16
-            Top = 80
+            Top = 120
             Width = 225
             Height = 65
             Hint = 
@@ -13463,8 +13227,8 @@
           end
           object StartPosRadioGroup: TSpTBXRadioGroup
             Left = 16
-            Top = 8
-            Width = 129
+            Top = 40
+            Width = 225
             Height = 72
             Hint = 
               'Where players will start on the map, using the fixed positions o' +
@@ -13485,9 +13249,9 @@
               'Choose now')
           end
           object LoadDefaultButton: TSpTBXButton
-            Left = 160
-            Top = 16
-            Width = 81
+            Left = 16
+            Top = 8
+            Width = 110
             Height = 25
             Caption = 'Load default'
             TabOrder = 0
@@ -13499,9 +13263,9 @@
             LinkFont.Style = [fsUnderline]
           end
           object SetDefaultButton: TSpTBXButton
-            Left = 160
-            Top = 48
-            Width = 81
+            Left = 130
+            Top = 8
+            Width = 110
             Height = 25
             Caption = 'Set as default'
             TabOrder = 4
@@ -13513,6 +13277,249 @@
             LinkFont.Style = [fsUnderline]
           end
         end
+        object ModTabSheet: TSpTBXTabSheet
+          Left = 0
+          Top = 39
+          Width = 413
+          Height = 230
+          Caption = 'Mod options'
+          ImageIndex = -1
+          Item = ModTab
+          TabControl = SpTBXTabControl1
+          DesignSize = (
+            413
+            230)
+          TabItem = 'ModTab'
+          object ModOptionsScrollBox: TTntScrollBox
+            Left = 8
+            Top = 48
+            Width = 401
+            Height = 177
+            VertScrollBar.Smooth = True
+            VertScrollBar.Tracking = True
+            Anchors = [akLeft, akTop, akBottom]
+            BiDiMode = bdLeftToRight
+            BorderStyle = bsNone
+            Color = clBtnFace
+            Ctl3D = False
+            ParentBiDiMode = False
+            ParentBackground = True
+            ParentColor = False
+            ParentCtl3D = False
+            TabOrder = 0
+          end
+          object panelModOptionsDefault: TSpTBXPanel
+            Left = 8
+            Top = 4
+            Width = 402
+            Height = 41
+            Align = alCustom
+            TabOrder = 1
+            object btLoadDefaultMDO: TSpTBXButton
+              Left = 137
+              Top = 8
+              Width = 128
+              Height = 25
+              Caption = 'Load default'
+              TabOrder = 0
+              OnClick = btLoadDefaultMDOClick
+              LinkFont.Charset = DEFAULT_CHARSET
+              LinkFont.Color = clBlue
+              LinkFont.Height = -11
+              LinkFont.Name = 'MS Sans Serif'
+              LinkFont.Style = [fsUnderline]
+            end
+            object btSetAsDefaultMDO: TSpTBXButton
+              Left = 269
+              Top = 8
+              Width = 128
+              Height = 25
+              Caption = 'Set as default'
+              TabOrder = 1
+              OnClick = btSetAsDefaultMDOClick
+              LinkFont.Charset = DEFAULT_CHARSET
+              LinkFont.Color = clBlue
+              LinkFont.Height = -11
+              LinkFont.Name = 'MS Sans Serif'
+              LinkFont.Style = [fsUnderline]
+            end
+            object btLoadModsDefaultMDO: TSpTBXButton
+              Left = 5
+              Top = 8
+              Width = 128
+              Height = 25
+              Caption = 'Load mod'#39's default'
+              TabOrder = 2
+              OnClick = btLoadModsDefaultMDOClick
+              LinkFont.Charset = DEFAULT_CHARSET
+              LinkFont.Color = clBlue
+              LinkFont.Height = -11
+              LinkFont.Name = 'MS Sans Serif'
+              LinkFont.Style = [fsUnderline]
+            end
+          end
+        end
+        object MapTabSheet: TSpTBXTabSheet
+          Left = 0
+          Top = 39
+          Width = 413
+          Height = 230
+          Caption = 'Map options'
+          ImageIndex = -1
+          Item = MapTab
+          TabControl = SpTBXTabControl1
+          DesignSize = (
+            413
+            230)
+          TabItem = 'MapTab'
+          object MapOptionsScrollBox: TTntScrollBox
+            Left = 8
+            Top = 48
+            Width = 401
+            Height = 177
+            VertScrollBar.Smooth = True
+            VertScrollBar.Tracking = True
+            Anchors = [akLeft, akTop, akBottom]
+            BiDiMode = bdLeftToRight
+            BorderStyle = bsNone
+            Color = clBtnFace
+            Ctl3D = False
+            ParentBiDiMode = False
+            ParentBackground = True
+            ParentColor = False
+            ParentCtl3D = False
+            TabOrder = 0
+          end
+          object panelMapOptionsDefault: TSpTBXPanel
+            Left = 8
+            Top = 4
+            Width = 402
+            Height = 41
+            Align = alCustom
+            TabOrder = 1
+            object btLoadMapsDefaultMPO: TSpTBXButton
+              Left = 5
+              Top = 8
+              Width = 128
+              Height = 25
+              Caption = 'Load map'#39's default'
+              TabOrder = 2
+              OnClick = btLoadMapsDefaultMPOClick
+              LinkFont.Charset = DEFAULT_CHARSET
+              LinkFont.Color = clBlue
+              LinkFont.Height = -11
+              LinkFont.Name = 'MS Sans Serif'
+              LinkFont.Style = [fsUnderline]
+            end
+            object btLoadDefaultMPO: TSpTBXButton
+              Left = 137
+              Top = 8
+              Width = 128
+              Height = 25
+              Caption = 'Load default'
+              TabOrder = 0
+              OnClick = btLoadDefaultMPOClick
+              LinkFont.Charset = DEFAULT_CHARSET
+              LinkFont.Color = clBlue
+              LinkFont.Height = -11
+              LinkFont.Name = 'MS Sans Serif'
+              LinkFont.Style = [fsUnderline]
+            end
+            object btSetAsDefaultMPO: TSpTBXButton
+              Left = 269
+              Top = 8
+              Width = 128
+              Height = 25
+              Caption = 'Set as default'
+              TabOrder = 1
+              OnClick = btSetAsDefaultMPOClick
+              LinkFont.Charset = DEFAULT_CHARSET
+              LinkFont.Color = clBlue
+              LinkFont.Height = -11
+              LinkFont.Name = 'MS Sans Serif'
+              LinkFont.Style = [fsUnderline]
+            end
+          end
+        end
+        object SpTBXTabSheet1: TSpTBXTabSheet
+          Left = 0
+          Top = 39
+          Width = 413
+          Height = 230
+          Caption = 'Disabled Units (0)'
+          ImageIndex = -1
+          Item = DisabledUnitsTab
+          TabControl = SpTBXTabControl1
+          DesignSize = (
+            413
+            230)
+          TabItem = 'DisabledUnitsTab'
+          object UnitsGroupBox: TSpTBXGroupBox
+            Left = 8
+            Top = 4
+            Width = 401
+            Height = 227
+            Caption = 'Disabled units'
+            Anchors = [akLeft, akTop, akBottom]
+            Color = clNone
+            ParentColor = False
+            TabOrder = 0
+            DesignSize = (
+              401
+              227)
+            object VDTDisabledUnits: TVirtualDrawTree
+              Left = 16
+              Top = 32
+              Width = 369
+              Height = 183
+              Anchors = [akLeft, akTop, akRight, akBottom]
+              DefaultNodeHeight = 64
+              Header.AutoSizeIndex = 1
+              Header.DefaultHeight = 17
+              Header.Font.Charset = DEFAULT_CHARSET
+              Header.Font.Color = clWindowText
+              Header.Font.Height = -11
+              Header.Font.Name = 'MS Sans Serif'
+              Header.Font.Style = []
+              Header.Options = [hoAutoResize, hoColumnResize, hoDrag]
+              TabOrder = 0
+              TreeOptions.PaintOptions = [toHideFocusRect, toShowButtons, toShowDropmark, toThemeAware, toUseBlendedImages]
+              TreeOptions.SelectionOptions = [toFullRowSelect]
+              OnDrawNode = VDTDisabledUnitsDrawNode
+              Columns = &lt;
+                item
+                  Position = 0
+                  Width = 64
+                  WideText = 'Icon'
+                end
+                item
+                  Position = 1
+                  Width = 201
+                  WideText = 'FullName'
+                end
+                item
+                  Position = 2
+                  Width = 100
+                  WideText = 'Code name'
+                end&gt;
+            end
+            object AddUnitsSpeedButton: TSpTBXButton
+              Left = 232
+              Top = 10
+              Width = 153
+              Height = 22
+              Caption = 'Add more units'
+              TabOrder = 1
+              OnClick = AddUnitsSpeedButtonClick
+              LinkFont.Charset = DEFAULT_CHARSET
+              LinkFont.Color = clBlue
+              LinkFont.Height = -11
+              LinkFont.Name = 'MS Sans Serif'
+              LinkFont.Style = [fsUnderline]
+              ThemeType = thtTBX
+            end
+          end
+        end
       end
     end
   end
@@ -13819,7 +13826,7 @@
   object QuickLookChangedTmr: TTimer
     Interval = 0
     OnTimer = QuickLookChangedTmrTimer
-    Left = 317
+    Left = 429
     Top = 190
   end
   object SpringSettingsProfilePopupMenu: TSpTBXPopupMenu
@@ -13846,6 +13853,7 @@
     Top = 455
   end
   object NumberSelection: TSpTBXPopupMenu
+    AutoHotkeys = maManual
     Left = 82
     Top = 466
     object Numbers: TTBXToolPalette
@@ -13866,6 +13874,7 @@
     Top = 440
   end
   object SPADSPopupMenu: TSpTBXPopupMenu
+    AutoHotkeys = maManual
     Left = 814
     Top = 376
     object mnuDisableAutohostInterface: TSpTBXItem
@@ -14053,6 +14062,7 @@
     end
   end
   object SPRINGIEPopupMenu: TSpTBXPopupMenu
+    AutoHotkeys = maManual
     OnInitPopup = SPRINGIEPopupMenuInitPopup
     Left = 782
     Top = 376

Modified: Lobby/TASClient/BattleFormUnit.pas
===================================================================
--- Lobby/TASClient/BattleFormUnit.pas	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/BattleFormUnit.pas	2010-03-10 11:17:09 UTC (rev 7427)
@@ -298,7 +298,6 @@
     ModTab: TSpTBXTabItem;
     SpTBXTabSheet1: TSpTBXTabSheet;
     UnitsGroupBox: TSpTBXGroupBox;
-    AddUnitsSpeedButton: TSpeedButton;
     VDTDisabledUnits: TVirtualDrawTree;
     ModTabSheet: TSpTBXTabSheet;
     ModOptionsScrollBox: TTntScrollBox;
@@ -435,6 +434,7 @@
     ChatRichEdit: TExRichEdit;
     AutoHostMsgsRichEdit: TExRichEdit;
     StartProgressBar: TSpTBXProgressBar;
+    AddUnitsSpeedButton: TSpTBXButton;
 
     procedure CreateParams(var Params: TCreateParams); override;
 

Modified: Lobby/TASClient/HelpUnit.dfm
===================================================================
--- Lobby/TASClient/HelpUnit.dfm	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/HelpUnit.dfm	2010-03-10 11:17:09 UTC (rev 7427)
@@ -4,7 +4,7 @@
   BorderStyle = bsDialog
   Caption = 'Help'
   ClientHeight = 474
-  ClientWidth = 617
+  ClientWidth = 785
   Color = clBtnFace
   Constraints.MaxHeight = 1150
   Constraints.MaxWidth = 1920
@@ -22,7 +22,7 @@
   object SpTBXTitleBar1: TSpTBXTitleBar
     Left = 0
     Top = 0
-    Width = 617
+    Width = 785
     Height = 474
     Caption = 'Help'
     FixedSize = True
@@ -30,10 +30,11 @@
     Options.Maximize = False
     TBXStyleBackground = True
     object PageControl1: TSpTBXTabControl
-      Left = 8
-      Top = 32
-      Width = 601
+      Left = 4
+      Top = 30
+      Width = 777
       Height = 401
+      Align = alTop
       Color = clBtnFace
       ActiveTabIndex = 0
       HiddenItems = &lt;&gt;
@@ -54,7 +55,7 @@
       object SpTBXTabSheet4: TSpTBXTabSheet
         Left = 0
         Top = 23
-        Width = 601
+        Width = 777
         Height = 378
         Caption = 'Page 4'
         ImageIndex = -1
@@ -300,7 +301,7 @@
       object SpTBXTabSheet1: TSpTBXTabSheet
         Left = 0
         Top = 23
-        Width = 601
+        Width = 777
         Height = 378
         Caption = 'Page 3'
         ImageIndex = -1
@@ -308,12 +309,14 @@
         TabControl = PageControl1
         TabItem = 'SpTBXTabItem1'
         object TntScrollBox1: TTntScrollBox
-          Left = 8
-          Top = 6
-          Width = 585
-          Height = 363
+          Left = 2
+          Top = 0
+          Width = 773
+          Height = 376
           VertScrollBar.Smooth = True
+          Align = alClient
           BorderStyle = bsNone
+          ParentBackground = True
           TabOrder = 0
           object Label52: TLabel
             Left = 0
@@ -600,7 +603,7 @@
       object SpTBXTabSheet2: TSpTBXTabSheet
         Left = 0
         Top = 23
-        Width = 601
+        Width = 777
         Height = 378
         Caption = 'Page 2'
         ImageIndex = -1
@@ -1043,8 +1046,8 @@
         object Label58: TSpTBXLabel
           Left = 32
           Top = 264
-          Width = 241
-          Height = 97
+          Width = 329
+          Height = 105
           Caption = 
             'Tip: Hold down SHIFT while dragging over the small minimap when ' +
             'hosting a game to set start rectangles. Press 0...9 to change hi' +
@@ -1061,10 +1064,10 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label50: TSpTBXLabel
-          Left = 288
+          Left = 392
           Top = 232
-          Width = 281
-          Height = 89
+          Width = 377
+          Height = 113
           Caption = 
             'Rank does not tell how &quot;good&quot; a player is, but rather how experi' +
             'enced he is (more time you spent playing spring, more experience' +
@@ -1080,7 +1083,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label45: TSpTBXLabel
-          Left = 288
+          Left = 392
           Top = 104
           Width = 70
           Height = 13
@@ -1092,7 +1095,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label46: TSpTBXLabel
-          Left = 288
+          Left = 392
           Top = 120
           Width = 89
           Height = 13
@@ -1104,7 +1107,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label47: TSpTBXLabel
-          Left = 288
+          Left = 392
           Top = 136
           Width = 93
           Height = 13
@@ -1116,7 +1119,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label48: TSpTBXLabel
-          Left = 288
+          Left = 392
           Top = 152
           Width = 132
           Height = 13
@@ -1128,7 +1131,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label49: TSpTBXLabel
-          Left = 288
+          Left = 392
           Top = 168
           Width = 124
           Height = 13
@@ -1140,7 +1143,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label42: TSpTBXLabel
-          Left = 288
+          Left = 392
           Top = 56
           Width = 281
           Height = 41
@@ -1156,7 +1159,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label41: TSpTBXLabel
-          Left = 288
+          Left = 392
           Top = 32
           Width = 160
           Height = 13
@@ -1192,7 +1195,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object SpTBXLabel8: TSpTBXLabel
-          Left = 288
+          Left = 392
           Top = 184
           Width = 160
           Height = 13
@@ -1204,7 +1207,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object SpTBXLabel9: TSpTBXLabel
-          Left = 288
+          Left = 392
           Top = 200
           Width = 114
           Height = 13
@@ -1228,7 +1231,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object SpTBXLabel16: TSpTBXLabel
-          Left = 288
+          Left = 392
           Top = 216
           Width = 80
           Height = 13
@@ -1243,7 +1246,7 @@
       object SpTBXTabSheet3: TSpTBXTabSheet
         Left = 0
         Top = 23
-        Width = 601
+        Width = 777
         Height = 378
         Caption = 'Page 1'
         ImageIndex = -1
@@ -1985,7 +1988,7 @@
           Transparent = True
         end
         object Image6: TImage
-          Left = 288
+          Left = 400
           Top = 40
           Width = 40
           Height = 86
@@ -2319,7 +2322,7 @@
           Transparent = True
         end
         object Image7: TImage
-          Left = 288
+          Left = 400
           Top = 152
           Width = 16
           Height = 16
@@ -2355,7 +2358,7 @@
           Transparent = True
         end
         object Image9: TImage
-          Left = 288
+          Left = 400
           Top = 168
           Width = 16
           Height = 16
@@ -2391,7 +2394,7 @@
           Transparent = True
         end
         object Image10: TImage
-          Left = 288
+          Left = 400
           Top = 208
           Width = 36
           Height = 16
@@ -2457,7 +2460,7 @@
           Transparent = True
         end
         object Image11: TImage
-          Left = 288
+          Left = 400
           Top = 184
           Width = 17
           Height = 17
@@ -2756,7 +2759,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label59: TSpTBXLabel
-          Left = 288
+          Left = 400
           Top = 16
           Width = 127
           Height = 13
@@ -2768,7 +2771,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label60: TSpTBXLabel
-          Left = 336
+          Left = 448
           Top = 40
           Width = 65
           Height = 13
@@ -2780,7 +2783,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label61: TSpTBXLabel
-          Left = 336
+          Left = 448
           Top = 56
           Width = 136
           Height = 13
@@ -2792,7 +2795,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label62: TSpTBXLabel
-          Left = 336
+          Left = 448
           Top = 72
           Width = 78
           Height = 13
@@ -2804,7 +2807,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label63: TSpTBXLabel
-          Left = 312
+          Left = 424
           Top = 112
           Width = 161
           Height = 13
@@ -2816,7 +2819,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label64: TSpTBXLabel
-          Left = 288
+          Left = 400
           Top = 128
           Width = 89
           Height = 13
@@ -2828,7 +2831,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label65: TSpTBXLabel
-          Left = 312
+          Left = 424
           Top = 152
           Width = 160
           Height = 13
@@ -2840,7 +2843,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label71: TSpTBXLabel
-          Left = 312
+          Left = 424
           Top = 168
           Width = 189
           Height = 13
@@ -2852,7 +2855,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label15: TSpTBXLabel
-          Left = 288
+          Left = 400
           Top = 240
           Width = 94
           Height = 13
@@ -2864,7 +2867,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label16: TSpTBXLabel
-          Left = 288
+          Left = 400
           Top = 264
           Width = 196
           Height = 13
@@ -2876,7 +2879,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label56: TSpTBXLabel
-          Left = 288
+          Left = 400
           Top = 280
           Width = 288
           Height = 13
@@ -2888,7 +2891,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label57: TSpTBXLabel
-          Left = 288
+          Left = 400
           Top = 312
           Width = 191
           Height = 13
@@ -2900,7 +2903,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label17: TSpTBXLabel
-          Left = 288
+          Left = 400
           Top = 328
           Width = 276
           Height = 13
@@ -2912,7 +2915,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object Label43: TSpTBXLabel
-          Left = 328
+          Left = 440
           Top = 208
           Width = 128
           Height = 13
@@ -2936,7 +2939,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object SpTBXLabel3: TSpTBXLabel
-          Left = 312
+          Left = 424
           Top = 184
           Width = 69
           Height = 13
@@ -2948,7 +2951,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object SpTBXLabel5: TSpTBXLabel
-          Left = 288
+          Left = 400
           Top = 344
           Width = 264
           Height = 13
@@ -2960,7 +2963,7 @@
           LinkFont.Style = [fsUnderline]
         end
         object SpTBXLabel17: TSpTBXLabel
-          Left = 288
+          Left = 400
           Top = 296
           Width = 173
           Height = 13
@@ -2974,7 +2977,7 @@
       end
     end
     object Button3: TSpTBXButton
-      Left = 360
+      Left = 444
       Top = 440
       Width = 41
       Height = 25
@@ -2988,7 +2991,7 @@
       LinkFont.Style = [fsUnderline]
     end
     object Button1: TSpTBXButton
-      Left = 272
+      Left = 356
       Top = 440
       Width = 75
       Height = 25
@@ -3004,7 +3007,7 @@
       LinkFont.Style = [fsUnderline]
     end
     object Button2: TSpTBXButton
-      Left = 216
+      Left = 300
       Top = 440
       Width = 43
       Height = 25

Modified: Lobby/TASClient/HostBattleFormUnit.dfm
===================================================================
--- Lobby/TASClient/HostBattleFormUnit.dfm	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/HostBattleFormUnit.dfm	2010-03-10 11:17:09 UTC (rev 7427)
@@ -1,10 +1,10 @@
 object HostBattleForm: THostBattleForm
-  Left = 393
-  Top = 101
+  Left = 778
+  Top = 510
   BorderStyle = bsDialog
   Caption = 'Host battle'
   ClientHeight = 380
-  ClientWidth = 331
+  ClientWidth = 426
   Color = clBtnFace
   Constraints.MaxHeight = 1150
   Constraints.MaxWidth = 1920
@@ -23,7 +23,7 @@
   object SpTBXTitleBar1: TSpTBXTitleBar
     Left = 0
     Top = 0
-    Width = 331
+    Width = 426
     Height = 380
     Caption = 'Host battle'
     FixedSize = True
@@ -55,7 +55,7 @@
       LinkFont.Style = [fsUnderline]
     end
     object Label3: TSpTBXLabel
-      Left = 224
+      Left = 272
       Top = 160
       Width = 49
       Height = 13
@@ -91,7 +91,7 @@
       LinkFont.Style = [fsUnderline]
     end
     object SpeedButton1: TSpTBXSpeedButton
-      Left = 152
+      Left = 202
       Top = 344
       Width = 33
       Height = 25
@@ -104,7 +104,7 @@
       LinkFont.Style = [fsUnderline]
     end
     object Label6: TSpTBXLabel
-      Left = 176
+      Left = 280
       Top = 40
       Width = 49
       Height = 13
@@ -128,7 +128,7 @@
       LinkFont.Style = [fsUnderline]
     end
     object Label8: TSpTBXLabel
-      Left = 224
+      Left = 272
       Top = 200
       Width = 94
       Height = 13
@@ -148,23 +148,23 @@
       Text = '8452'
     end
     object PasswordEdit: TSpTBXEdit
-      Left = 224
+      Left = 272
       Top = 176
-      Width = 89
+      Width = 145
       Height = 21
       TabOrder = 11
     end
     object TitleEdit: TSpTBXEdit
       Left = 16
       Top = 104
-      Width = 297
+      Width = 401
       Height = 21
       TabOrder = 12
     end
     object ModsComboBox: TSpTBXComboBox
       Left = 16
       Top = 176
-      Width = 201
+      Width = 249
       Height = 21
       Style = csDropDownList
       DropDownCount = 32
@@ -172,7 +172,7 @@
       TabOrder = 13
     end
     object RankComboBox: TSpTBXComboBox
-      Left = 176
+      Left = 280
       Top = 56
       Width = 137
       Height = 22
@@ -182,9 +182,9 @@
       OnDrawItem = RankComboBoxDrawItem
     end
     object NATRadioGroup: TSpTBXRadioGroup
-      Left = 160
+      Left = 208
       Top = 224
-      Width = 153
+      Width = 209
       Height = 65
       Caption = 'NAT traversal'
       Color = clNone
@@ -198,12 +198,12 @@
         'Fixed source ports')
     end
     object HostButton: TTBXButton
-      Left = 56
+      Left = 77
       Top = 344
-      Width = 89
+      Width = 114
       Height = 25
       AutoSize = False
-      Caption = 'Host Battle'
+      Caption = 'Host battle'
       DropDownCombo = True
       DropDownMenu = HostPopupMenu
       SmartFocus = False
@@ -211,9 +211,9 @@
       OnClick = HostButtonClick
     end
     object CancelButton: TSpTBXButton
-      Left = 192
+      Left = 246
       Top = 344
-      Width = 73
+      Width = 103
       Height = 25
       Caption = 'Cancel'
       TabOrder = 17
@@ -236,7 +236,7 @@
     object LadderComboBox: TSpTBXComboBox
       Left = 16
       Top = 104
-      Width = 297
+      Width = 401
       Height = 22
       Style = csOwnerDrawFixed
       ItemHeight = 16
@@ -258,9 +258,9 @@
       LinkFont.Style = [fsUnderline]
     end
     object RefreshButton: TSpTBXButton
-      Left = 224
+      Left = 312
       Top = 128
-      Width = 89
+      Width = 105
       Height = 25
       Caption = 'Refresh'
       TabOrder = 21
@@ -314,6 +314,7 @@
     end
   end
   object HostPopupMenu: TPopupMenu
+    AutoHotkeys = maManual
     Left = 88
     Top = 312
     object Host1: TMenuItem

Modified: Lobby/TASClient/HostBattleFormUnit.pas
===================================================================
--- Lobby/TASClient/HostBattleFormUnit.pas	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/HostBattleFormUnit.pas	2010-03-10 11:17:09 UTC (rev 7427)
@@ -557,7 +557,7 @@
   ModsComboBox.ItemIndex := ModsComboBox.Items.IndexOf(s);
 
   (Sender as TMenuItem).Checked := True;
-  HostButton.Caption := 'Host Battle';
+  HostButton.Caption := _('Host battle');
 end;
 
 procedure THostBattleForm.HostReplay1Click(Sender: TObject);
@@ -632,7 +632,7 @@
   BattleReplayInfo.Script := TScript.Create(BattleReplayInfo.Replay.Script);
 
   (Sender as TMenuItem).Checked := True;
-  HostButton.Caption := _('Host Replay');
+  HostButton.Caption := _('Host replay');
 end;
 
 procedure THostBattleForm.NATRadioGroupClick(Sender: TObject);

Modified: Lobby/TASClient/HostInfoUnit.dfm
===================================================================
--- Lobby/TASClient/HostInfoUnit.dfm	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/HostInfoUnit.dfm	2010-03-10 11:17:09 UTC (rev 7427)
@@ -3,11 +3,11 @@
   Top = 289
   BorderStyle = bsDialog
   Caption = 'Help'
-  ClientHeight = 373
-  ClientWidth = 370
+  ClientHeight = 408
+  ClientWidth = 584
   Color = clBtnFace
-  Constraints.MaxHeight = 750
-  Constraints.MaxWidth = 1280
+  Constraints.MaxHeight = 1150
+  Constraints.MaxWidth = 1920
   Font.Charset = DEFAULT_CHARSET
   Font.Color = clWindowText
   Font.Height = -11
@@ -22,8 +22,8 @@
   object SpTBXTitleBar1: TSpTBXTitleBar
     Left = 0
     Top = 0
-    Width = 370
-    Height = 373
+    Width = 584
+    Height = 408
     Caption = 'Help'
     FixedSize = True
     Options.Minimize = False
@@ -50,8 +50,8 @@
     object Label2: TSpTBXLabel
       Left = 16
       Top = 128
-      Width = 337
-      Height = 33
+      Width = 553
+      Height = 49
       Caption = 
         '* If you are behind a router, you must forward the port you spec' +
         'ified in the host battle dialog before hosting a game.'
@@ -71,7 +71,7 @@
     end
     object Label3: TSpTBXLabel
       Left = 16
-      Top = 280
+      Top = 320
       Width = 172
       Height = 13
       Cursor = crHandPoint
@@ -91,9 +91,9 @@
     end
     object Label4: TSpTBXLabel
       Left = 16
-      Top = 176
-      Width = 337
-      Height = 33
+      Top = 192
+      Width = 553
+      Height = 57
       Caption = 
         '* if you are behind a firewall, make sure it doesn'#39't block TASCl' +
         'ient.exe or spring.exe before launching game.'
@@ -113,7 +113,7 @@
     end
     object Label5: TSpTBXLabel
       Left = 16
-      Top = 304
+      Top = 344
       Width = 156
       Height = 13
       Cursor = crHandPoint
@@ -133,9 +133,9 @@
     end
     object Label6: TSpTBXLabel
       Left = 16
-      Top = 224
-      Width = 321
-      Height = 33
+      Top = 248
+      Width = 553
+      Height = 57
       Caption = 
         '* Consider reading FAQ page at official Spring web site if you c' +
         'an'#39't resolve your hosting problems (see link bellow).'
@@ -154,8 +154,8 @@
       LinkFont.Style = [fsUnderline]
     end
     object Button1: TSpTBXButton
-      Left = 144
-      Top = 336
+      Left = 250
+      Top = 368
       Width = 83
       Height = 25
       Caption = 'Close'
@@ -171,8 +171,8 @@
     object SpTBXLabel1: TSpTBXLabel
       Left = 16
       Top = 64
-      Width = 329
-      Height = 41
+      Width = 553
+      Height = 57
       Caption = 
         '* If you can'#39't host because you are behind a rooter and can'#39't fo' +
         'rward the port and NAT traversal doesn'#39't work, you can relay the' +

Modified: Lobby/TASClient/LogonFormUnit.dfm
===================================================================
--- Lobby/TASClient/LogonFormUnit.dfm	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/LogonFormUnit.dfm	2010-03-10 11:17:09 UTC (rev 7427)
@@ -1,13 +1,13 @@
 object LogonForm: TLogonForm
-  Left = 527
-  Top = 376
+  Left = 814
+  Top = 564
   BorderStyle = bsDialog
   Caption = 'Logon'
   ClientHeight = 350
-  ClientWidth = 310
+  ClientWidth = 375
   Color = clBtnFace
-  Constraints.MaxHeight = 750
-  Constraints.MaxWidth = 1280
+  Constraints.MaxHeight = 1150
+  Constraints.MaxWidth = 1920
   Font.Charset = DEFAULT_CHARSET
   Font.Color = clWindowText
   Font.Height = -11
@@ -23,7 +23,7 @@
   object SpTBXTitleBar1: TSpTBXTitleBar
     Left = 0
     Top = 0
-    Width = 310
+    Width = 375
     Height = 350
     Caption = 'Logon'
     FixedSize = True
@@ -31,7 +31,7 @@
     object gbServerSettings: TSpTBXGroupBox
       Left = 16
       Top = 40
-      Width = 281
+      Width = 345
       Height = 81
       Caption = 'Server settings'
       TabOrder = 1
@@ -48,7 +48,7 @@
         LinkFont.Style = [fsUnderline]
       end
       object txtPort: TSpTBXEdit
-        Left = 64
+        Left = 88
         Top = 48
         Width = 57
         Height = 21
@@ -69,12 +69,12 @@
         LinkFont.Style = [fsUnderline]
       end
       object beServer: TSpTBXButtonEdit
-        Left = 64
+        Left = 88
         Top = 24
-        Width = 209
+        Width = 249
         Height = 21
         TabOrder = 3
-        EditButton.Left = 185
+        EditButton.Left = 225
         EditButton.Top = 0
         EditButton.Width = 20
         EditButton.Height = 17
@@ -92,7 +92,7 @@
     object gbAccountDetails: TSpTBXGroupBox
       Left = 16
       Top = 128
-      Width = 281
+      Width = 345
       Height = 121
       Caption = 'Account details'
       TabOrder = 2
@@ -109,17 +109,17 @@
         LinkFont.Style = [fsUnderline]
       end
       object txtLogin: TSpTBXEdit
-        Left = 136
+        Left = 152
         Top = 24
-        Width = 137
+        Width = 185
         Height = 21
         TabOrder = 1
         OnKeyPress = txtLoginKeyPress
       end
       object txtPassword: TSpTBXEdit
-        Left = 136
+        Left = 152
         Top = 48
-        Width = 137
+        Width = 185
         Height = 21
         TabOrder = 2
         OnChange = txtPasswordChange
@@ -152,14 +152,14 @@
         LinkFont.Style = [fsUnderline]
       end
       object beLadderPassword: TSpTBXButtonEdit
-        Left = 136
+        Left = 152
         Top = 72
-        Width = 137
+        Width = 185
         Height = 21
         Enabled = False
         ReadOnly = True
         TabOrder = 5
-        EditButton.Left = 107
+        EditButton.Left = 155
         EditButton.Top = 0
         EditButton.Width = 26
         EditButton.Height = 17
@@ -175,7 +175,7 @@
         PasswordCharW = '*'
       end
       object chkRememberPasswords: TSpTBXCheckBox
-        Left = 136
+        Left = 152
         Top = 96
         Width = 117
         Height = 15
@@ -199,7 +199,7 @@
     object btRegisterLadder: TSpTBXButton
       Left = 16
       Top = 288
-      Width = 105
+      Width = 145
       Height = 25
       Caption = 'Register Ladder'
       Enabled = False
@@ -214,7 +214,7 @@
     object btRegister: TSpTBXButton
       Left = 16
       Top = 256
-      Width = 105
+      Width = 145
       Height = 25
       Caption = 'Register'
       TabOrder = 4
@@ -226,9 +226,9 @@
       LinkFont.Style = [fsUnderline]
     end
     object btLogin: TSpTBXButton
-      Left = 136
+      Left = 168
       Top = 256
-      Width = 161
+      Width = 193
       Height = 57
       Caption = 'Login'
       Font.Charset = DEFAULT_CHARSET

Modified: Lobby/TASClient/MainUnit.dfm
===================================================================
--- Lobby/TASClient/MainUnit.dfm	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/MainUnit.dfm	2010-03-10 11:17:09 UTC (rev 7427)
@@ -1,6 +1,6 @@
 object MainForm: TMainForm
-  Left = 1036
-  Top = 164
+  Left = 951
+  Top = 475
   Width = 847
   Height = 521
   Caption = '.'
@@ -729,7 +729,7 @@
                   146)
                 TabItem = 'SpTBXTabItem1'
                 object FilterList: TVirtualStringTree
-                  Left = 448
+                  Left = 472
                   Top = 8
                   Width = 361
                   Height = 129
@@ -790,7 +790,7 @@
                     end&gt;
                 end
                 object ClearFilterListButton: TSpTBXButton
-                  Left = 408
+                  Left = 432
                   Top = 72
                   Width = 33
                   Height = 25
@@ -804,7 +804,7 @@
                   LinkFont.Style = [fsUnderline]
                 end
                 object RemoveFromFilterListButton: TSpTBXButton
-                  Left = 408
+                  Left = 432
                   Top = 40
                   Width = 33
                   Height = 25
@@ -818,7 +818,7 @@
                   LinkFont.Style = [fsUnderline]
                 end
                 object AddToFilterListButton: TSpTBXButton
-                  Left = 408
+                  Left = 432
                   Top = 8
                   Width = 33
                   Height = 25
@@ -832,7 +832,7 @@
                   LinkFont.Style = [fsUnderline]
                 end
                 object FilterValueTextBox: TSpTBXEdit
-                  Left = 216
+                  Left = 240
                   Top = 8
                   Width = 185
                   Height = 21
@@ -877,9 +877,9 @@
                 end
                 object SpTBXPanel2: TSpTBXPanel
                   Left = 8
-                  Top = 40
-                  Width = 393
-                  Height = 97
+                  Top = 35
+                  Width = 417
+                  Height = 105
                   Caption = 'SpTBXPanel1'
                   ThemeType = thtWindows
                   TabOrder = 8
@@ -931,16 +931,16 @@
                     OnClick = PasswordedFilterClick
                   end
                   object RankLimitFilter: TSpTBXCheckBox
-                    Left = 104
+                    Left = 112
                     Top = 72
-                    Width = 114
+                    Width = 109
                     Height = 15
-                    Caption = 'Rank limit &gt; My rank'
+                    Caption = 'Min rank &gt; My rank'
                     TabOrder = 5
                     OnClick = RankLimitFilterClick
                   end
                   object ReplaysFilter: TSpTBXCheckBox
-                    Left = 104
+                    Left = 112
                     Top = 56
                     Width = 51
                     Height = 15
@@ -949,7 +949,7 @@
                     OnClick = ReplaysFilterClick
                   end
                   object ModsNotAvailableFilter: TSpTBXCheckBox
-                    Left = 104
+                    Left = 112
                     Top = 40
                     Width = 102
                     Height = 15
@@ -958,7 +958,7 @@
                     OnClick = ModsNotAvailableFilterClick
                   end
                   object MapsNotAvailableFilter: TSpTBXCheckBox
-                    Left = 104
+                    Left = 112
                     Top = 24
                     Width = 102
                     Height = 15
@@ -967,7 +967,7 @@
                     OnClick = MapsNotAvailableFilterClick
                   end
                   object NatTraversalFilter: TSpTBXCheckBox
-                    Left = 104
+                    Left = 112
                     Top = 8
                     Width = 78
                     Height = 15
@@ -976,7 +976,7 @@
                     OnClick = NatTraversalFilterClick
                   end
                   object PlayersSignButton: TSpTBXButton
-                    Left = 320
+                    Left = 344
                     Top = 8
                     Width = 25
                     Height = 20
@@ -990,19 +990,19 @@
                     LinkFont.Style = [fsUnderline]
                   end
                   object PlayersValueTextBox: TJvSpinEdit
-                    Left = 344
+                    Left = 368
                     Top = 8
                     Width = 41
                     Height = 20
                     ButtonKind = bkStandard
-                    MaxValue = 16.000000000000000000
+                    MaxValue = 250.000000000000000000
                     Value = 10.000000000000000000
                     TabOrder = 11
                     OnChange = PlayersValueTextBoxChange
                   end
                   object MaxPlayersSignButton: TSpTBXButton
-                    Left = 320
-                    Top = 71
+                    Left = 344
+                    Top = 55
                     Width = 25
                     Height = 20
                     Caption = '&lt;'
@@ -1015,20 +1015,20 @@
                     LinkFont.Style = [fsUnderline]
                   end
                   object MaxPlayersValueTextBox: TJvSpinEdit
-                    Left = 344
-                    Top = 71
+                    Left = 368
+                    Top = 55
                     Width = 41
                     Height = 20
                     ButtonKind = bkStandard
-                    MaxValue = 16.000000000000000000
+                    MaxValue = 250.000000000000000000
                     MinValue = 1.000000000000000000
                     Value = 10.000000000000000000
                     TabOrder = 13
                     OnChange = MaxPlayersValueTextBoxChange
                   end
                   object MaxPlayersFilter: TSpTBXCheckBox
-                    Left = 232
-                    Top = 72
+                    Left = 248
+                    Top = 56
                     Width = 78
                     Height = 15
                     Caption = 'Max Players '
@@ -1036,7 +1036,7 @@
                     OnClick = MaxPlayersFilterClick
                   end
                   object PlayersFilter: TSpTBXCheckBox
-                    Left = 232
+                    Left = 248
                     Top = 10
                     Width = 55
                     Height = 15
@@ -1045,7 +1045,7 @@
                     OnClick = PlayersFilterClick
                   end
                   object Players2Filter: TSpTBXCheckBox
-                    Left = 232
+                    Left = 248
                     Top = 34
                     Width = 55
                     Height = 15
@@ -1054,7 +1054,7 @@
                     OnClick = Players2FilterClick
                   end
                   object Players2SignButton: TSpTBXButton
-                    Left = 320
+                    Left = 344
                     Top = 32
                     Width = 25
                     Height = 20
@@ -1068,21 +1068,56 @@
                     LinkFont.Style = [fsUnderline]
                   end
                   object Players2ValueTextBox: TJvSpinEdit
-                    Left = 344
+                    Left = 368
                     Top = 32
                     Width = 41
                     Height = 20
                     ButtonKind = bkStandard
-                    MaxValue = 16.000000000000000000
+                    MaxValue = 250.000000000000000000
                     Value = 10.000000000000000000
                     TabOrder = 18
                     OnChange = Players2ValueTextBoxChange
                   end
+                  object RankFilter: TSpTBXCheckBox
+                    Left = 248
+                    Top = 80
+                    Width = 66
+                    Height = 15
+                    Caption = 'Avg Rank'
+                    TabOrder = 19
+                    OnClick = RankFilterClick
+                  end
+                  object RankSignButton: TSpTBXButton
+                    Left = 344
+                    Top = 79
+                    Width = 25
+                    Height = 20
+                    Caption = '&lt;'
+                    TabOrder = 20
+                    OnClick = RankSignButtonClick
+                    LinkFont.Charset = DEFAULT_CHARSET
+                    LinkFont.Color = clBlue
+                    LinkFont.Height = -11
+                    LinkFont.Name = 'MS Sans Serif'
+                    LinkFont.Style = [fsUnderline]
+                  end
+                  object RankValueTextBox: TJvSpinEdit
+                    Left = 368
+                    Top = 79
+                    Width = 41
+                    Height = 20
+                    ButtonKind = bkStandard
+                    MaxValue = 9.000000000000000000
+                    MinValue = 1.000000000000000000
+                    Value = 5.000000000000000000
+                    TabOrder = 21
+                    OnChange = RankValueTextBoxChange
+                  end
                 end
               end
             end
             object EnableFilters: TSpTBXCheckBox
-              Left = 713
+              Left = 649
               Top = 154
               Width = 110
               Height = 18
@@ -1213,7 +1248,13 @@
         Top = 8
         Width = 121
         Height = 25
+        Hint = 
+          'To launch TASClient directly in Single player mode use the &quot;-men' +
+          'u&quot; parameter. You can also use &quot;-menumod &quot;modname&quot;&quot; to automatic' +
+          'ally load the corresponding mod.'
         Caption = 'Single Player'
+        ParentShowHint = False
+        ShowHint = True
         TabOrder = 6
         OnClick = SinglePlayerButtonClick
         LinkFont.Charset = DEFAULT_CHARSET
@@ -7272,7 +7313,7 @@
   end
   object AutojoinPopupMenu: TSpTBXPopupMenu
     AutoHotkeys = maManual
-    OnInitPopup = AutojoinPopupMenuInitPopup
+    OnPopup = AutojoinPopupMenuPopup
     Left = 736
     Top = 239
     object SubMenuPlaynow: TSpTBXSubmenuItem
@@ -7322,7 +7363,8 @@
     Top = 239
   end
   object OptionsPopupMenu: TSpTBXPopupMenu
-    OnInitPopup = OptionsPopupMenuInitPopup
+    AutoHotkeys = maManual
+    OnPopup = OptionsPopupMenuPopup
     Left = 496
     Top = 70
     object mnuPreferences: TSpTBXItem

Modified: Lobby/TASClient/MainUnit.pas
===================================================================
--- Lobby/TASClient/MainUnit.pas	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/MainUnit.pas	2010-03-10 11:17:09 UTC (rev 7427)
@@ -405,7 +405,7 @@
   );
 
 const
-  VERSION_NUMBER = '0.68'; // Must be float value! (with a period as a decimal seperator)
+  VERSION_NUMBER = '0.69'; // Must be float value! (with a period as a decimal seperator)
   AUTOUPDATE_URL = '<A HREF="http://tasclient.no-ip.org/TASClient_update_v3.txt">http://tasclient.no-ip.org/TASClient_update_v3.txt</A>';
   PROGRAM_VERSION = 'TASClient ' + VERSION_NUMBER;
   KEEP_ALIVE_INTERVAL = 10000; // in milliseconds. Tells us what should be the maximum &quot;silence&quot; time before we send a ping to the server.
@@ -892,6 +892,7 @@
     procedure RemoveAllBots;
     function GetHighlightColor: TColor;
     procedure NextHighlight;
+    function GetAvgRank: double;
   end;
 
   TTDFParser = class
@@ -965,6 +966,7 @@
     Players: TFilterNumber;
     Players2: TFilterNumber;
     MaxPlayers: TFilterNumber;
+    AvgRank: TFilterNumber;
     TextFilters: TList;
   end;
   PPresetFilters = ^TPresetFilters;
@@ -1226,6 +1228,9 @@
     SubMenuAutospecFirstAvailable: TSpTBXSubmenuItem;
     SubMenuPlaynow: TSpTBXSubmenuItem;
     SubMenuSpecnow: TSpTBXSubmenuItem;
+    RankFilter: TSpTBXCheckBox;
+    RankSignButton: TSpTBXButton;
+    RankValueTextBox: TJvSpinEdit;
     procedure mnuOpenPrivateChatClick(Sender: TObject);
     procedure mnuSelectBattleClick(Sender: TObject);
     procedure mnuPlayWithClick(Sender: TObject);
@@ -1291,12 +1296,6 @@
       Node2: PVirtualNode; Column: TColumnIndex; var Result: Integer);
     procedure FilterListHeaderClick(Sender: TVTHeader;
   HitInfo: TVTHeaderHitInfo);
-    procedure SaveFiltersToFile(Filters: TPresetFilters);
-    procedure LoadFiltersFromFile(var Filters: TPresetFilters);
-    procedure LoadPresets;
-    procedure FiltersUpdated;
-    procedure UpdateFilters(pFilters: TPresetFilters);
-    procedure CopyFilters(srcFilters: TPresetFilters; var dstFilters: TPresetFilters);
     procedure HighlighBattlesTimerTimer(Sender: TObject);
     procedure FormResize(Sender: TObject);
     procedure PlayersFilterClick(Sender: TObject);
@@ -1380,8 +1379,6 @@
     procedure SpTBXButton1Click(Sender: TObject);
     procedure SpTBXItem5Click(Sender: TObject);
     procedure OnDockHandlerRefresh(Sender: TObject);
-    procedure OptionsPopupMenuInitPopup(Sender: TObject;
-      PopupView: TTBView);
     procedure mnuPreferencesClick(Sender: TObject);
     procedure mnuLockViewClick(Sender: TObject);
     procedure mnuResetViewClick(Sender: TObject);
@@ -1401,8 +1398,11 @@
     procedure FilterListNewText(Sender: TBaseVirtualTree;
       Node: PVirtualNode; Column: TColumnIndex; NewText: WideString);
     procedure FilterListClick(Sender: TObject);
-    procedure AutojoinPopupMenuInitPopup(Sender: TObject;
-      PopupView: TTBView);
+    procedure AutojoinPopupMenuPopup(Sender: TObject);
+    procedure RankFilterClick(Sender: TObject);
+    procedure RankSignButtonClick(Sender: TObject);
+    procedure RankValueTextBoxChange(Sender: TObject);
+    procedure OptionsPopupMenuPopup(Sender: TObject);
   published
     MainTitleBar: TSpTBXTitleBar;
     ButtonImageList: TImageList;
@@ -1559,6 +1559,13 @@
     procedure initFiltersPresets;
 
     function getAutojoinBestBattle(autoJoinPresetList:TList):TBattle;
+
+    procedure SaveFiltersToFile(Filters: TPresetFilters);
+    procedure LoadFiltersFromFile(var Filters: TPresetFilters);
+    procedure LoadPresets;
+    procedure FiltersUpdated;
+    procedure UpdateFilters(pFilters: TPresetFilters);
+    procedure CopyFilters(srcFilters: TPresetFilters; var dstFilters: TPresetFilters);
   published
     MainPCH : TPageControlHost;
     procedure ApplicationEvents1ShortCut(var Msg: TWMKey; var Handled: Boolean);
@@ -2086,7 +2093,7 @@
       i := ChatTabs.Count-1
     else
       Dec(i);
-    ShowAndSetFocus(TWinControl(TMyTabSheet(ChatTabs[i]).FindComponent('InputEdit')));
+    //ShowAndSetFocus(TWinControl(TMyTabSheet(ChatTabs[i]).FindComponent('InputEdit')));
     TMyTabSheet(ChatTabs[i]).OnActivate(nil);
     if TMyTabSheet(ChatTabs[i]).Parent is TTabSheet then
       TTabSheet(TMyTabSheet(ChatTabs[i]).Parent).PageControl.OnChange(TTabSheet(TMyTabSheet(ChatTabs[i]).Parent).PageControl);
@@ -2104,7 +2111,7 @@
       i := 0
     else
       Inc(i);
-    ShowAndSetFocus(TWinControl(TMyTabSheet(ChatTabs[i]).FindComponent('InputEdit')));
+    //ShowAndSetFocus(TWinControl(TMyTabSheet(ChatTabs[i]).FindComponent('InputEdit')));
     TMyTabSheet(ChatTabs[i]).OnActivate(nil);
     if TMyTabSheet(ChatTabs[i]).Parent is TTabSheet then
       TTabSheet(TMyTabSheet(ChatTabs[i]).Parent).PageControl.OnChange(TTabSheet(TMyTabSheet(ChatTabs[i]).Parent).PageControl);
@@ -3117,6 +3124,17 @@
     end;
 end;
 
+function TBattle.GetAvgRank: double;
+var
+  i:integer;
+begin
+  Result := 0;
+  if Clients.Count = 0 then Exit;
+  for i:=0 to Clients.Count-1 do
+    Result := Result + TClient(Clients[i]).GetRank;
+  Result := Result / Clients.Count;
+end;
+
 procedure TBattle.NextHighlight;
 var
   GroupList: TList;
@@ -3682,6 +3700,10 @@
 begin
   MainForm.lastActiveTab := Self;
   MainForm.UpdateClientsListBox;
+  try
+    ShowAndSetFocus(TWinControl(Self.FindComponent('InputEdit')));
+  except
+  end;
 end;
 
 
@@ -4484,9 +4506,9 @@
     tmpts.LogFileName := FileName;
     if tmpts.LogFile = nil then
       AddMainLog(_('Error: unable to access file: ') + FileName, Colors.Error)
-    else
+    else if Preferences.ChatLogLoadLoading then
     begin
-      logsLastLines := ReadLastLogFileLines(tmpts.LogFile,30);
+      logsLastLines := ReadLastLogFileLines(tmpts.LogFile,Preferences.ChatLogLoadLines);
       if logsLastLines &lt;&gt; '' then
         AddTextToRichEdit(tmpre,logsLastLines,Colors.OldMsgs,True,0);
     end;
@@ -6953,6 +6975,7 @@
           end;
           if (BattleState.Battle &lt;&gt; nil) and (BattleState.Battle.ID = TBattle(Battles[i]).ID) and (Client.GetInGameStatus) and changed and (not Status.AmIInGame) then
           begin
+            AutojoinTimer.Interval := AutojoinTimer.Interval + 3000;
             PostMessage(BattleForm.Handle, WM_STARTGAME, 0, 0);
             // if founder of the battle we are participating in just went in-game, we must launch the game too!
           end;
@@ -8919,10 +8942,7 @@
       end;
       6: // avg player rank
       begin
-        avgRank := 0;
-        for i:=0 to Battle.Clients.Count-1 do
-          avgRank := avgRank + TClient(Battle.Clients[i]).GetRank;
-        avgRank := avgRank / Battle.Clients.Count;
+        avgRank := Battle.GetAvgRank;
         RanksImageList.Draw(Canvas, R.Left, R.Top, Round(avgRank));
         Inc(R.Left, RanksImageList.Width);
         s := FloatToStrF(RoundTo(avgRank+1,-2),ffFixed,7,2);
@@ -9655,6 +9675,11 @@
       ((Filters.MaxPlayers.filterType = Sup) and (Battle.MaxPlayers &gt; Filters.MaxPlayers.value)) or
       ((Filters.MaxPlayers.filterType = Inf) and (Battle.MaxPlayers &lt; Filters.MaxPlayers.value)) or
       ((Filters.MaxPlayers.filterType = Equal) and (Battle.MaxPlayers = Filters.MaxPlayers.value))
+      ) and
+      (not Filters.AvgRank.enabled or
+      ((Filters.AvgRank.filterType = Sup) and (Round(Battle.GetAvgRank+1) &gt; Filters.AvgRank.value)) or
+      ((Filters.AvgRank.filterType = Inf) and (Round(Battle.GetAvgRank+1) &lt; Filters.AvgRank.value)) or
+      ((Filters.AvgRank.filterType = Equal) and (Round(Battle.GetAvgRank+1) = Filters.AvgRank.value))
       );
 end;
 
@@ -11182,6 +11207,7 @@
     Ini.WriteBool('StaticFilters','Players',Filters.Players.enabled);
     Ini.WriteBool('StaticFilters','Players2',Filters.Players2.enabled);
     Ini.WriteBool('StaticFilters','MaxPlayers',Filters.MaxPlayers.enabled);
+    Ini.WriteBool('StaticFilters','AvgRang',Filters.AvgRank.enabled);
   
     if Filters.Players.filterType = Sup then
       Ini.WriteString('StaticFilters','PlayersSign','sup')
@@ -11206,6 +11232,14 @@
     else
       Ini.WriteString('StaticFilters','MaxPlayersSign','equal');
     Ini.WriteInteger('StaticFilters','MaxPlayersValue',Filters.MaxPlayers.value);
+
+    if Filters.AvgRank.filterType = Sup then
+      Ini.WriteString('StaticFilters','AvgRankSign','sup')
+    else if Filters.AvgRank.filterType = Inf then
+      Ini.WriteString('StaticFilters','AvgRankSign','inf')
+    else
+      Ini.WriteString('StaticFilters','AvgRankSign','equal');
+    Ini.WriteInteger('StaticFilters','AvgRankValue',Filters.AvgRank.value);
   
     for i:=0 to Filters.TextFilters.Count-1 do begin
       with TFilterText(Filters.TextFilters[i]^) do begin
@@ -11256,6 +11290,7 @@
   Filters.Players.enabled := Ini.ReadBool('StaticFilters', 'Players', False);
   Filters.Players2.enabled := Ini.ReadBool('StaticFilters', 'Players2', False);
   Filters.MaxPlayers.enabled := Ini.ReadBool('StaticFilters', 'MaxPlayers', False);
+  Filters.AvgRank.enabled := Ini.ReadBool('StaticFilters', 'AvgRank', False);
 
   tmpStr := Ini.ReadString('StaticFilters', 'PlayersSign', 'sup');
   if tmpStr = 'sup' then
@@ -11284,6 +11319,15 @@
     Filters.MaxPlayers.filterType := Equal;
   Filters.MaxPlayers.value := Ini.ReadInteger('StaticFilters', 'MaxPlayersValue', 1);
 
+  tmpStr := Ini.ReadString('StaticFilters', 'AvgRankSign', 'sup');
+  if tmpStr = 'sup' then
+    Filters.AvgRank.filterType := Sup
+  else if tmpStr = 'inf' then
+    Filters.AvgRank.filterType := Inf
+  else
+    Filters.AvgRank.filterType := Equal;
+  Filters.AvgRank.value := Ini.ReadInteger('StaticFilters', 'AvgRankValue', 4);
+
   Filters.TextFilters.Clear;
   i := 0;
   while Ini.SectionExists('TextFilter'+IntToStr(i)) do begin
@@ -11361,6 +11405,7 @@
   dstFilters.Players.enabled := srcFilters.Players.enabled;
   dstFilters.Players2.enabled := srcFilters.Players2.enabled;
   dstFilters.MaxPlayers.enabled := srcFilters.MaxPlayers.enabled;
+  dstFilters.AvgRank.enabled := srcFilters.AvgRank.enabled;
 
   dstFilters.Players.filterType := srcFilters.Players.filterType;
   dstFilters.Players.value := srcFilters.Players.value;
@@ -11371,6 +11416,9 @@
   dstFilters.MaxPlayers.filterType := srcFilters.MaxPlayers.filterType;
   dstFilters.MaxPlayers.value := srcFilters.MaxPlayers.value;
 
+  dstFilters.AvgRank.filterType := srcFilters.AvgRank.filterType;
+  dstFilters.AvgRank.value := srcFilters.AvgRank.value;
+
   dstFilters.TextFilters.Clear; // possible memory leak too lazy to fix
   for i:=0 to srcFilters.TextFilters.Count -1 do
   begin
@@ -11404,6 +11452,7 @@
   PlayersFilter.Checked := pFilters.Players.enabled;
   Players2Filter.Checked := pFilters.Players2.enabled;
   MaxPlayersFilter.Checked := pFilters.MaxPlayers.enabled;
+  RankFilter.Checked := pFilters.AvgRank.enabled;
 
   if pFilters.Players.filterType = Sup then
     PlayersSignButton.Caption := '&gt;'
@@ -11429,6 +11478,14 @@
     MaxPlayersSignButton.Caption := '=';
   MaxPlayersValueTextBox.Value := pFilters.MaxPlayers.value;
 
+  if pFilters.AvgRank.filterType = Sup then
+    RankSignButton.Caption := '&gt;'
+  else if pFilters.AvgRank.filterType = Inf then
+    RankSignButton.Caption := '&lt;'
+  else
+    RankSignButton.Caption := '=';
+  RankValueTextBox.Value := pFilters.AvgRank.value;
+
   FilterList.Clear;
   for i:=0 to pFilters.TextFilters.Count -1 do
   begin
@@ -12834,32 +12891,6 @@
   end;
 end;
 
-procedure TMainForm.OptionsPopupMenuInitPopup(Sender: TObject;
-  PopupView: TTBView);
-var
-  i: integer;
-  l: TList;
-begin
-  l := TList.Create;
-  DockHandler.AddDockedPanelsToList(l);
-
-  ViewSubMenu.Clear;
-  for i:=0 to l.Count-1 do
-  begin
-    ViewSubMenu.Add(TSpTBXItem.Create(ViewSubMenu));
-    with ViewSubMenu.Items[ViewSubMenu.Count-1] as TSpTBXItem do
-    begin
-      if TObject(l[i]) is TPageControlHost then
-        Caption := TPageControl(l[i]).Name
-      else
-        Caption := TPanel(l[i]).Caption;
-      Checked := TPanel(l[i]).Visible;
-      OnClick := ViewItemClick;
-      Tag := Integer(TControl(l[i]));
-    end;
-  end;
-end;
-
 procedure TMainForm.ViewItemClick(Sender: TObject);
 begin
   TControl(TSpTBXItem(Sender).Tag).Visible := not TControl(TSpTBXItem(Sender).Tag).Visible;
@@ -13353,8 +13384,55 @@
   FilterList.FocusedColumn := ht.HitColumn;
 end;
 
-procedure TMainForm.AutojoinPopupMenuInitPopup(Sender: TObject;
-  PopupView: TTBView);
+procedure TMainForm.AutoSpecFirstAvailablePresetClick(Sender: TObject);
+begin
+  AutoJoinForm.lstPresetList.ItemIndex := TSpTBXItem(Sender).Tag;
+  AutoJoinForm.lstPresetListDblClick(nil);
+  if TSpTBXItem(Sender).Checked then
+  begin
+    mnuAutospecFirstAvailable.Checked := False;
+    mnuAutoplayFirstAvailable.Checked := False;
+  end
+  else
+  begin
+    mnuAutospecFirstAvailable.Checked := True;
+    mnuAutoplayFirstAvailable.Checked := False;
+  end;
+  mnuAutospecFirstAvailable.Tag := TSpTBXItem(Sender).Tag;
+end;
+
+procedure TMainForm.AutoPlayFirstAvailablePresetClick(Sender: TObject);
+begin
+  AutoJoinForm.lstPresetList.ItemIndex := TSpTBXItem(Sender).Tag;
+  AutoJoinForm.lstPresetListDblClick(nil);
+  if TSpTBXItem(Sender).Checked then
+  begin
+    mnuAutospecFirstAvailable.Checked := False;
+    mnuAutoplayFirstAvailable.Checked := False;
+  end
+  else
+  begin
+    mnuAutospecFirstAvailable.Checked := False;
+    mnuAutoplayFirstAvailable.Checked := True;
+  end;
+  mnuAutoplayFirstAvailable.Tag := TSpTBXItem(Sender).Tag;
+end;
+
+procedure TMainForm.PlayNowClick(Sender: TObject);
+begin
+  AutoJoinForm.lstPresetList.ItemIndex := TSpTBXItem(Sender).Tag;
+  AutoJoinForm.lstPresetListDblClick(nil);
+  mnuPlaynowClick(nil);
+end;
+
+procedure TMainForm.SpecNowClick(Sender: TObject);
+begin
+  AutoJoinForm.lstPresetList.ItemIndex := TSpTBXItem(Sender).Tag;
+  AutoJoinForm.lstPresetListDblClick(nil);
+  mnuSpecnowClick(nil);
+end;
+
+procedure TMainForm.AutojoinPopupMenuPopup(Sender: TObject);
 var
   i:integer;
 begin
@@ -13427,52 +13505,63 @@
   MainForm.Refresh;
 end;
 
-procedure TMainForm.AutoSpecFirstAvailablePresetClick(Sender: TObject);
+procedure TMainForm.RankFilterClick(Sender: TObject);
 begin
-  AutoJoinForm.lstPresetList.ItemIndex := TSpTBXItem(Sender).Tag;
-  AutoJoinForm.lstPresetListDblClick(nil);
-  if TSpTBXItem(Sender).Checked then
-  begin
-    mnuAutospecFirstAvailable.Checked := False;
-    mnuAutoplayFirstAvailable.Checked := False;
-  end
-  else
-  begin
-    mnuAutospecFirstAvailable.Checked := True;
-    mnuAutoplayFirstAvailable.Checked := False;
-  end;
-  mnuAutospecFirstAvailable.Tag := TSpTBXItem(Sender).Tag;
+  if not RankFilter.Focused then Exit;
+  CurrentFilters.AvgRank.enabled := RankFilter.Checked;
+  FiltersUpdated;
 end;
 
-procedure TMainForm.AutoPlayFirstAvailablePresetClick(Sender: TObject);
+procedure TMainForm.RankSignButtonClick(Sender: TObject);
 begin
-  AutoJoinForm.lstPresetList.ItemIndex := TSpTBXItem(Sender).Tag;
-  AutoJoinForm.lstPresetListDblClick(nil);
-  if TSpTBXItem(Sender).Checked then
+  if RankSignButton.Caption = '&gt;' then
   begin
-    mnuAutospecFirstAvailable.Checked := False;
-    mnuAutoplayFirstAvailable.Checked := False;
+    RankSignButton.Caption := '&lt;';
+    CurrentFilters.AvgRank.filterType := Inf;
   end
+  else if RankSignButton.Caption = '&lt;' then
+  begin
+    RankSignButton.Caption := '=';
+    CurrentFilters.AvgRank.filterType := Equal;
+  end
   else
   begin
-    mnuAutospecFirstAvailable.Checked := False;
-    mnuAutoplayFirstAvailable.Checked := True;
+    RankSignButton.Caption := '&gt;';
+    CurrentFilters.AvgRank.filterType := Sup;
   end;
-  mnuAutoplayFirstAvailable.Tag := TSpTBXItem(Sender).Tag;
+  FiltersUpdated;
 end;
 
-procedure TMainForm.PlayNowClick(Sender: TObject);
+procedure TMainForm.RankValueTextBoxChange(Sender: TObject);
 begin
-  AutoJoinForm.lstPresetList.ItemIndex := TSpTBXItem(Sender).Tag;
-  AutoJoinForm.lstPresetListDblClick(nil);
-  mnuPlaynowClick(nil);
+  if not RankValueTextBox.Focused then Exit;
+  CurrentFilters.AvgRank.value := RankValueTextBox.AsInteger;
+  FiltersUpdated;
 end;
 
-procedure TMainForm.SpecNowClick(Sender: TObject);
+procedure TMainForm.OptionsPopupMenuPopup(Sender: TObject);
+var
+  i: integer;
+  l: TList;
 begin
-  AutoJoinForm.lstPresetList.ItemIndex := TSpTBXItem(Sender).Tag;
-  AutoJoinForm.lstPresetListDblClick(nil);
-  mnuSpecnowClick(nil);
+  l := TList.Create;
+  DockHandler.AddDockedPanelsToList(l);
+
+  ViewSubMenu.Clear;
+  for i:=0 to l.Count-1 do
+  begin
+    ViewSubMenu.Add(TSpTBXItem.Create(ViewSubMenu));
+    with ViewSubMenu.Items[ViewSubMenu.Count-1] as TSpTBXItem do
+    begin
+      if TObject(l[i]) is TPageControlHost then
+        Caption := TPageControl(l[i]).Name
+      else
+        Caption := TPanel(l[i]).Caption;
+      Checked := TPanel(l[i]).Visible;
+      OnClick := ViewItemClick;
+      Tag := Integer(TControl(l[i]));
+    end;
+  end;
 end;
 
 end.

Modified: Lobby/TASClient/ManageGroups.dfm
===================================================================
--- Lobby/TASClient/ManageGroups.dfm	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/ManageGroups.dfm	2010-03-10 11:17:09 UTC (rev 7427)
@@ -5,10 +5,10 @@
   BorderStyle = bsSingle
   Caption = 'Manage groups'
   ClientHeight = 441
-  ClientWidth = 516
+  ClientWidth = 596
   Color = clBtnFace
-  Constraints.MaxHeight = 1000
-  Constraints.MaxWidth = 1680
+  Constraints.MaxHeight = 1150
+  Constraints.MaxWidth = 1920
   Font.Charset = DEFAULT_CHARSET
   Font.Color = clWindowText
   Font.Height = -11
@@ -26,7 +26,7 @@
   object SpTBXTitleBar1: TSpTBXTitleBar
     Left = 0
     Top = 0
-    Width = 516
+    Width = 596
     Height = 441
     Caption = 'Manage groups'
     FixedSize = True
@@ -65,17 +65,17 @@
     object SpTBXPanel1: TSpTBXPanel
       Left = 8
       Top = 372
-      Width = 497
+      Width = 577
       Height = 41
       Caption = 'SpTBXPanel1'
       TabOrder = 3
       DesignSize = (
-        497
+        577
         41)
       object btRemove: TSpTBXButton
-        Left = 104
+        Left = 128
         Top = 8
-        Width = 89
+        Width = 113
         Height = 25
         Hint = 'Remove selected players from the group'
         Caption = 'Remove players'
@@ -91,9 +91,9 @@
         ThemeType = thtTBX
       end
       object btRemoveGroup: TSpTBXButton
-        Left = 200
+        Left = 248
         Top = 8
-        Width = 89
+        Width = 113
         Height = 25
         Caption = 'Remove group'
         TabOrder = 1
@@ -105,9 +105,9 @@
         LinkFont.Style = [fsUnderline]
       end
       object btClose: TSpTBXButton
-        Left = 417
+        Left = 456
         Top = 8
-        Width = 73
+        Width = 113
         Height = 25
         Caption = 'Close'
         Anchors = [akTop, akRight]
@@ -122,7 +122,7 @@
       object btAddPlayer: TSpTBXButton
         Left = 8
         Top = 8
-        Width = 89
+        Width = 113
         Height = 25
         Caption = 'Add player'
         TabOrder = 3
@@ -137,7 +137,7 @@
     object SpTBXPanel2: TSpTBXPanel
       Left = 240
       Top = 40
-      Width = 265
+      Width = 345
       Height = 321
       Caption = 'SpTBXPanel2'
       ParentShowHint = False
@@ -146,12 +146,14 @@
       object Label1: TLabel
         Left = 8
         Top = 248
-        Width = 70
+        Width = 193
         Height = 13
+        Alignment = taRightJustify
+        AutoSize = False
         Caption = 'Replace rank :'
       end
       object ColorPanel: TPanel
-        Left = 128
+        Left = 208
         Top = 32
         Width = 97
         Height = 21
@@ -163,9 +165,11 @@
       object SpTBXLabel1: TSpTBXLabel
         Left = 8
         Top = 12
-        Width = 34
+        Width = 193
         Height = 13
         Caption = 'Name :'
+        AutoSize = False
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -175,9 +179,11 @@
       object SpTBXLabel2: TSpTBXLabel
         Left = 8
         Top = 36
-        Width = 30
+        Width = 193
         Height = 13
         Caption = 'Color :'
+        AutoSize = False
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -187,9 +193,11 @@
       object SpTBXLabel3: TSpTBXLabel
         Left = 8
         Top = 58
-        Width = 51
+        Width = 193
         Height = 13
         Caption = 'Auto-kick :'
+        AutoSize = False
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -199,9 +207,11 @@
       object SpTBXLabel4: TSpTBXLabel
         Left = 8
         Top = 80
-        Width = 54
+        Width = 193
         Height = 13
         Caption = 'Auto-spec :'
+        AutoSize = False
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -209,7 +219,7 @@
         LinkFont.Style = [fsUnderline]
       end
       object btChooseColor: TSpTBXButton
-        Left = 232
+        Left = 312
         Top = 32
         Width = 25
         Height = 20
@@ -224,7 +234,7 @@
         ThemeType = thtTBX
       end
       object AutoSpecCheckBox: TSpTBXCheckBox
-        Left = 128
+        Left = 208
         Top = 80
         Width = 14
         Height = 15
@@ -232,7 +242,7 @@
         OnClick = AutoSpecCheckBoxClick
       end
       object AutoKickCheckBox: TSpTBXCheckBox
-        Left = 128
+        Left = 208
         Top = 58
         Width = 14
         Height = 15
@@ -240,7 +250,7 @@
         OnClick = AutoKickCheckBoxClick
       end
       object NotifyOnHostCheckBox: TSpTBXCheckBox
-        Left = 128
+        Left = 208
         Top = 104
         Width = 14
         Height = 15
@@ -250,9 +260,11 @@
       object SpTBXLabel5: TSpTBXLabel
         Left = 8
         Top = 104
-        Width = 71
+        Width = 193
         Height = 13
         Caption = 'Notify on host :'
+        AutoSize = False
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -262,9 +274,11 @@
       object SpTBXLabel6: TSpTBXLabel
         Left = 8
         Top = 128
-        Width = 67
+        Width = 193
         Height = 13
         Caption = 'Notify on join :'
+        AutoSize = False
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -272,7 +286,7 @@
         LinkFont.Style = [fsUnderline]
       end
       object NotifyOnJoinCheckBox: TSpTBXCheckBox
-        Left = 128
+        Left = 208
         Top = 128
         Width = 14
         Height = 15
@@ -280,7 +294,7 @@
         OnClick = NotifyOnJoinCheckBoxClick
       end
       object NotifyOnBattlEndCheckBox: TSpTBXCheckBox
-        Left = 128
+        Left = 208
         Top = 152
         Width = 14
         Height = 15
@@ -290,9 +304,11 @@
       object SpTBXLabel7: TSpTBXLabel
         Left = 8
         Top = 152
-        Width = 98
+        Width = 193
         Height = 13
         Caption = 'Notify on battle end :'
+        AutoSize = False
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -302,9 +318,11 @@
       object SpTBXLabel8: TSpTBXLabel
         Left = 8
         Top = 176
-        Width = 90
+        Width = 193
         Height = 13
         Caption = 'Notify on connect :'
+        AutoSize = False
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -312,7 +330,7 @@
         LinkFont.Style = [fsUnderline]
       end
       object NotifyOnConnectCheckBox: TSpTBXCheckBox
-        Left = 128
+        Left = 208
         Top = 176
         Width = 14
         Height = 15
@@ -320,7 +338,7 @@
         OnClick = NotifyOnConnectCheckBoxClick
       end
       object txtName: TSpTBXEdit
-        Left = 128
+        Left = 208
         Top = 10
         Width = 129
         Height = 21
@@ -330,9 +348,11 @@
       object SpTBXLabel9: TSpTBXLabel
         Left = 8
         Top = 200
-        Width = 81
+        Width = 193
         Height = 13
         Caption = 'Highlight battles :'
+        AutoSize = False
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -340,7 +360,7 @@
         LinkFont.Style = [fsUnderline]
       end
       object HighlightBattlesCheckbox: TSpTBXCheckBox
-        Left = 128
+        Left = 208
         Top = 200
         Width = 14
         Height = 15
@@ -350,9 +370,11 @@
       object SpTBXLabel10: TSpTBXLabel
         Left = 8
         Top = 224
-        Width = 54
+        Width = 193
         Height = 13
         Caption = 'Chat color :'
+        AutoSize = False
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -360,7 +382,7 @@
         LinkFont.Style = [fsUnderline]
       end
       object ChatColorPanel: TPanel
-        Left = 152
+        Left = 232
         Top = 222
         Width = 73
         Height = 21
@@ -370,7 +392,7 @@
         TabOrder = 20
       end
       object btChooseChatColor: TSpTBXButton
-        Left = 232
+        Left = 312
         Top = 222
         Width = 25
         Height = 20
@@ -385,7 +407,7 @@
         ThemeType = thtTBX
       end
       object ChatColorCheckBox: TSpTBXCheckBox
-        Left = 128
+        Left = 208
         Top = 224
         Width = 14
         Height = 15
@@ -393,7 +415,7 @@
         OnClick = ChatColorCheckBoxClick
       end
       object ReplaceRankCheckBox: TSpTBXCheckBox
-        Left = 128
+        Left = 208
         Top = 248
         Width = 14
         Height = 15
@@ -401,7 +423,7 @@
         OnClick = ReplaceRankCheckBoxClick
       end
       object ReplaceRankCmb: TSpTBXComboBox
-        Left = 152
+        Left = 232
         Top = 245
         Width = 105
         Height = 22
@@ -414,15 +436,17 @@
       object SpTBXLabel11: TSpTBXLabel
         Left = 8
         Top = 272
-        Width = 110
+        Width = 193
         Height = 13
         Hint = 
           'Act like if all member of the group were in the same clan when b' +
           'alancing teams.'
         Caption = 'Balance in same team :'
+        AutoSize = False
         ParentShowHint = False
         ShowAccelChar = False
         ShowHint = True
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -430,7 +454,7 @@
         LinkFont.Style = [fsUnderline]
       end
       object BalanceInSameTeamCheckBox: TSpTBXCheckBox
-        Left = 128
+        Left = 208
         Top = 272
         Width = 14
         Height = 15
@@ -445,9 +469,11 @@
       object SpTBXLabel12: TSpTBXLabel
         Left = 8
         Top = 296
-        Width = 36
+        Width = 193
         Height = 13
         Caption = 'Ignore :'
+        AutoSize = False
+        Alignment = taRightJustify
         LinkFont.Charset = DEFAULT_CHARSET
         LinkFont.Color = clBlue
         LinkFont.Height = -11
@@ -455,7 +481,7 @@
         LinkFont.Style = [fsUnderline]
       end
       object IgnoreCheckBox: TSpTBXCheckBox
-        Left = 128
+        Left = 208
         Top = 296
         Width = 14
         Height = 15

Modified: Lobby/TASClient/Misc.pas
===================================================================
--- Lobby/TASClient/Misc.pas	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/Misc.pas	2010-03-10 11:17:09 UTC (rev 7427)
@@ -13,7 +13,7 @@
   SpTBXTabs,SpTBXItem,JvSpin,Dialogs, Classes, ComCtrls, Windows, Graphics, MMSystem,
   Controls, Registry, SysUtils,RichEdit2, ExRichEdit, WSocket, Winsock,
   ESBDates, GpTimeZone, JvColorCombo, Forms,StdCtrls,HttpProt,TntComCtrls,
-  JclUnicode,TntSysUtils,PreferencesFormUnit,Variants,typinfo, OpenIL;
+  JclUnicode,TntSysUtils,PreferencesFormUnit,Variants,typinfo, OpenIL, DockPanel;
 
 type
   TColorData = Array[0..128000] Of TRGBTriple;
@@ -2583,13 +2583,16 @@
       TTabSheet(controlList[i]).PageControl.ActivePage := TTabSheet(controlList[i])
     else if (TWinControl(controlList[i]).ClassType = TSpTBXTabSheet) then
       TSpTBXTabSheet(controlList[i]).TabControl.ActivePage := TSpTBXTabSheet(controlList[i])
-    else if (TWinControl(controlList[i]).ClassParent = TForm) then
+    else if (TWinControl(controlList[i]) is TCustomForm) then
     begin
-      TForm(controlList[i]).Show;
-      while not TForm(controlList[i]).Visible do;
+      TCustomForm(controlList[i]).Show;
+      while not TCustomForm(controlList[i]).Visible do;
     end;
 
-  c.SetFocus;
+  try
+    c.SetFocus;
+  except
+  end;
 end;
 
 function PackedShortString(Value: PShortstring; 

Modified: Lobby/TASClient/PreferencesFormUnit.dfm
===================================================================
--- Lobby/TASClient/PreferencesFormUnit.dfm	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/PreferencesFormUnit.dfm	2010-03-10 11:17:09 UTC (rev 7427)
@@ -1,6 +1,6 @@
 object PreferencesForm: TPreferencesForm
-  Left = 872
-  Top = 198
+  Left = 791
+  Top = 444
   BorderStyle = bsDialog
   Caption = 'Preferences'
   ClientHeight = 526
@@ -37,7 +37,7 @@
       Width = 553
       Height = 417
       Color = clBtnFace
-      ActiveTabIndex = 2
+      ActiveTabIndex = 3
       TabAutofit = True
       HiddenItems = &lt;&gt;
       object SpTBXTabItem6: TSpTBXTabItem
@@ -54,12 +54,12 @@
       object SpTBXTabItem4: TSpTBXTabItem
         Caption = 'Program'
         Wrapping = twWrap
-        Checked = True
         CustomWidth = 78
       end
       object SpTBXTabItem3: TSpTBXTabItem
         Caption = 'Interface'
         Wrapping = twWrap
+        Checked = True
         CustomWidth = 78
       end
       object SpTBXTabItem2: TSpTBXTabItem
@@ -359,202 +359,6 @@
           end
         end
       end
-      object SpTBXTabSheet3: TSpTBXTabSheet
-        Left = 0
-        Top = 44
-        Width = 553
-        Height = 373
-        Caption = 'Interface'
-        ImageIndex = -1
-        Item = SpTBXTabItem3
-        TabControl = SpTBXTabControl1
-        TabItem = 'SpTBXTabItem3'
-        object GroupBox4: TSpTBXGroupBox
-          Left = 16
-          Top = 8
-          Width = 529
-          Height = 345
-          Caption = 'Interface preferences'
-          Color = clNone
-          ParentColor = False
-          TabOrder = 0
-          object CheckBox1: TSpTBXCheckBox
-            Left = 24
-            Top = 24
-            Width = 104
-            Height = 15
-            Caption = 'Timestamp events'
-            TabOrder = 0
-            Checked = True
-            State = cbChecked
-          end
-          object CheckBox3: TSpTBXCheckBox
-            Left = 24
-            Top = 40
-            Width = 128
-            Height = 15
-            Caption = 'Filter join/left messages'
-            TabOrder = 1
-          end
-          object CheckBox4: TSpTBXCheckBox
-            Left = 24
-            Top = 72
-            Width = 108
-            Height = 15
-            Caption = 'Show country flags'
-            TabOrder = 2
-            Checked = True
-            State = cbChecked
-          end
-          object CheckBox5: TSpTBXCheckBox
-            Left = 24
-            Top = 88
-            Width = 147
-            Height = 15
-            Caption = 'Mark unknown maps/mods'
-            TabOrder = 3
-            Checked = True
-            State = cbChecked
-          end
-          object CheckBox6: TSpTBXCheckBox
-            Left = 24
-            Top = 104
-            Width = 251
-            Height = 15
-            Caption = 'Use taskbar button for each form (requires restart)'
-            TabOrder = 4
-          end
-          object WarnNATCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 120
-            Width = 271
-            Height = 15
-            Caption = 'Display warning icons on battles using NAT traversing'
-            TabOrder = 5
-            Checked = True
-            State = cbChecked
-          end
-          object AutoFocusOnPMCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 136
-            Width = 262
-            Height = 15
-            Caption = 'Automatically switch focus to new private messages'
-            TabOrder = 6
-            Checked = True
-            State = cbChecked
-          end
-          object DisableAllSoundsCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 152
-            Width = 103
-            Height = 15
-            Caption = 'Disable all sounds'
-            TabOrder = 7
-          end
-          object UploadReplayCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 248
-            Width = 227
-            Height = 15
-            Caption = 'Ask what to do with replays after each battle'
-            TabOrder = 8
-          end
-          object SortLocalCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 168
-            Width = 132
-            Height = 15
-            Caption = 'Sort the $local player list'
-            TabOrder = 9
-          end
-          object DisplayQuickJoinPanelCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 184
-            Width = 131
-            Height = 15
-            Caption = 'Display Quick join panel'
-            TabOrder = 10
-          end
-          object FilterBattleJoinLeftCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 56
-            Width = 157
-            Height = 15
-            Caption = 'Filter battle join/left messages'
-            TabOrder = 11
-          end
-          object AutoCompletionCurrentChannelCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 200
-            Width = 252
-            Height = 15
-            Caption = 'Auto-completion from current channel'#39's players list'
-            TabOrder = 12
-          end
-          object ChatLogsLimitCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 216
-            Width = 145
-            Height = 15
-            Caption = 'Limit chat logs to 800 lines '
-            TabOrder = 13
-          end
-          object ChatLogsLimitTracker: TSpTBXTrackBar
-            Left = 400
-            Top = 216
-            Width = 121
-            Height = 17
-            Max = 3000
-            Min = 50
-            Frequency = 100
-            Position = 800
-            TabOrder = 14
-            ThumbLength = 10
-            OnChange = ChatLogsLimitTrackerChange
-          end
-          object DisplayUnitsIconsAndNamesCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 232
-            Width = 251
-            Height = 15
-            Caption = 'Load units icons and names when joining (slower)'
-            TabOrder = 15
-          end
-          object DisableNewsCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 264
-            Width = 159
-            Height = 15
-            Caption = 'Disable news (requires restart)'
-            TabOrder = 16
-          end
-          object DoNotLoadMapInfos: TSpTBXCheckBox
-            Left = 24
-            Top = 280
-            Width = 240
-            Height = 15
-            Caption = 'Disable minimaps and maps info loading at start'
-            TabOrder = 17
-          end
-          object LoadMetalHeightMaps: TSpTBXCheckBox
-            Left = 24
-            Top = 296
-            Width = 295
-            Height = 15
-            Caption = 'Load metal and height minimaps (enables 3D map preview)'
-            TabOrder = 18
-          end
-          object DisplayAutoHostInterfaceCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 312
-            Width = 158
-            Height = 15
-            Caption = 'Display the autohost interface'
-            TabOrder = 19
-          end
-        end
-      end
       object SpTBXTabSheet5: TSpTBXTabSheet
         Left = 0
         Top = 44
@@ -1045,6 +849,223 @@
           end
         end
       end
+      object SpTBXTabSheet3: TSpTBXTabSheet
+        Left = 0
+        Top = 44
+        Width = 553
+        Height = 373
+        Caption = 'Interface'
+        ImageIndex = -1
+        Item = SpTBXTabItem3
+        TabControl = SpTBXTabControl1
+        TabItem = 'SpTBXTabItem3'
+        object GroupBox4: TSpTBXGroupBox
+          Left = 16
+          Top = 8
+          Width = 529
+          Height = 345
+          Caption = 'Interface preferences'
+          Color = clNone
+          ParentColor = False
+          TabOrder = 0
+          object CheckBox1: TSpTBXCheckBox
+            Left = 24
+            Top = 16
+            Width = 104
+            Height = 15
+            Caption = 'Timestamp events'
+            TabOrder = 0
+            Checked = True
+            State = cbChecked
+          end
+          object CheckBox3: TSpTBXCheckBox
+            Left = 24
+            Top = 32
+            Width = 128
+            Height = 15
+            Caption = 'Filter join/left messages'
+            TabOrder = 1
+          end
+          object CheckBox4: TSpTBXCheckBox
+            Left = 24
+            Top = 64
+            Width = 108
+            Height = 15
+            Caption = 'Show country flags'
+            TabOrder = 2
+            Checked = True
+            State = cbChecked
+          end
+          object CheckBox5: TSpTBXCheckBox
+            Left = 24
+            Top = 80
+            Width = 147
+            Height = 15
+            Caption = 'Mark unknown maps/mods'
+            TabOrder = 3
+            Checked = True
+            State = cbChecked
+          end
+          object CheckBox6: TSpTBXCheckBox
+            Left = 24
+            Top = 96
+            Width = 251
+            Height = 15
+            Caption = 'Use taskbar button for each form (requires restart)'
+            TabOrder = 4
+          end
+          object WarnNATCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 112
+            Width = 271
+            Height = 15
+            Caption = 'Display warning icons on battles using NAT traversing'
+            TabOrder = 5
+            Checked = True
+            State = cbChecked
+          end
+          object AutoFocusOnPMCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 128
+            Width = 262
+            Height = 15
+            Caption = 'Automatically switch focus to new private messages'
+            TabOrder = 6
+            Checked = True
+            State = cbChecked
+          end
+          object DisableAllSoundsCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 144
+            Width = 103
+            Height = 15
+            Caption = 'Disable all sounds'
+            TabOrder = 7
+          end
+          object UploadReplayCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 240
+            Width = 227
+            Height = 15
+            Caption = 'Ask what to do with replays after each battle'
+            TabOrder = 8
+          end
+          object SortLocalCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 160
+            Width = 132
+            Height = 15
+            Caption = 'Sort the $local player list'
+            TabOrder = 9
+          end
+          object DisplayQuickJoinPanelCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 176
+            Width = 131
+            Height = 15
+            Caption = 'Display Quick join panel'
+            TabOrder = 10
+          end
+          object FilterBattleJoinLeftCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 48
+            Width = 157
+            Height = 15
+            Caption = 'Filter battle join/left messages'
+            TabOrder = 11
+          end
+          object AutoCompletionCurrentChannelCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 192
+            Width = 252
+            Height = 15
+            Caption = 'Auto-completion from current channel'#39's players list'
+            TabOrder = 12
+          end
+          object ChatLogsLimitCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 208
+            Width = 145
+            Height = 15
+            Caption = 'Limit chat logs to 800 lines '
+            TabOrder = 13
+          end
+          object ChatLogsLimitTracker: TSpTBXTrackBar
+            Left = 400
+            Top = 208
+            Width = 121
+            Height = 17
+            Max = 3000
+            Min = 50
+            Frequency = 100
+            Position = 800
+            TabOrder = 14
+            ThumbLength = 10
+            OnChange = ChatLogsLimitTrackerChange
+          end
+          object DisplayUnitsIconsAndNamesCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 224
+            Width = 251
+            Height = 15
+            Caption = 'Load units icons and names when joining (slower)'
+            TabOrder = 15
+          end
+          object DisableNewsCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 256
+            Width = 159
+            Height = 15
+            Caption = 'Disable news (requires restart)'
+            TabOrder = 16
+          end
+          object DoNotLoadMapInfos: TSpTBXCheckBox
+            Left = 24
+            Top = 272
+            Width = 240
+            Height = 15
+            Caption = 'Disable minimaps and maps info loading at start'
+            TabOrder = 17
+          end
+          object LoadMetalHeightMaps: TSpTBXCheckBox
+            Left = 24
+            Top = 288
+            Width = 295
+            Height = 15
+            Caption = 'Load metal and height minimaps (enables 3D map preview)'
+            TabOrder = 18
+          end
+          object DisplayAutoHostInterfaceCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 304
+            Width = 158
+            Height = 15
+            Caption = 'Display the autohost interface'
+            TabOrder = 19
+          end
+          object ChatLogLoadingTracker: TSpTBXTrackBar
+            Left = 400
+            Top = 320
+            Width = 121
+            Height = 17
+            Max = 1000
+            Min = 2
+            Frequency = 50
+            Position = 30
+            TabOrder = 20
+            ThumbLength = 10
+            OnChange = ChatLogLoadingTrackerChange
+          end
+          object ChatLogLoadingCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 320
+            Width = 162
+            Height = 15
+            Caption = 'Load the last 30 chat log lines '
+            TabOrder = 21
+          end
+        end
+      end
     end
     object ApplyAndCloseButton: TSpTBXButton
       Left = 119

Modified: Lobby/TASClient/PreferencesFormUnit.pas
===================================================================
--- Lobby/TASClient/PreferencesFormUnit.pas	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/PreferencesFormUnit.pas	2010-03-10 11:17:09 UTC (rev 7427)
@@ -78,6 +78,8 @@
 
     LimitChatLogs: Boolean;
     ChatLogsLimit: integer;
+    ChatLogLoadLoading: Boolean;
+    ChatLogLoadLines: integer;
 
     SPSkin: string;
 
@@ -203,6 +205,8 @@
     LoadMetalHeightMaps: TSpTBXCheckBox;
     LayoutDefault: TTntEdit;
     DisplayAutoHostInterfaceCheckBox: TSpTBXCheckBox;
+    ChatLogLoadingTracker: TSpTBXTrackBar;
+    ChatLogLoadingCheckBox: TSpTBXCheckBox;
 
     function BattleSortStyleToColumn(SortStyle: Integer): Integer;
     function ColumnToBattleSortStyle(Column: Integer): Integer;
@@ -255,6 +259,7 @@
     procedure SpringSettingsProfilesButtonClick(Sender: TObject);
     procedure ApplyAfterTranslate;
     procedure ResetDockingLayoutButtonClick(Sender: TObject);
+    procedure ChatLogLoadingTrackerChange(Sender: TObject);
   private
     { Private declarations }
   public
@@ -313,7 +318,7 @@
                                         UseSoundNotifications: True;AutoCompletionFromCurrentChannel: False; AutoUpdateToBeta: False;DisplayUnitsIconsAndNames: False;
                                         DisplayAutohostInterface: True; UseProxy: False; HighlightColor: 'Green'; UseNotificationsForHighlights: True; UseIgnoreList: False;
                                         WarnIfUsingNATTraversing: True; AutoFocusOnPM: True; MapSortStyle: 1; ThemeType: thtTBX; Theme: 'Miranda'; DisableAllSounds: False;
-                                        SortLocal: False; DisplayQuickJoinPanel : True; LimitChatLogs: False; ChatLogsLimit: 800; SPSkin: 'default.ssk'; ScriptsDisabled : False;
+                                        SortLocal: False; DisplayQuickJoinPanel : True; LimitChatLogs: False; ChatLogsLimit: 800;ChatLogLoadLoading: True; ChatLogLoadLines: 30; SPSkin: 'default.ssk'; ScriptsDisabled : False;
                                         EnableScripts : True;ScriptWarningMsgShown: False; EnableSpringDownloader : True; UseLogonForm : True; DisableNews : False;
                                         DisableMapDetailsLoading: False; LoadMetalHeightMinimaps: True);
 
@@ -419,6 +424,11 @@
       Preferences.ChatLogsLimit := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ChatLogsLimit');
       Preferences.ChatLogsLimit := max(ChatLogsLimitTracker.Min,min(ChatLogsLimitTracker.Max,Preferences.ChatLogsLimit));
     except end;
+    try Preferences.ChatLogLoadLoading := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ChatLogLoadLoading'); except end;
+    try
+      Preferences.ChatLogLoadLines := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ChatLogLoadLines');
+      Preferences.ChatLogLoadLines := max(ChatLogLoadingTracker.Min,min(ChatLogLoadingTracker.Max,Preferences.ChatLogLoadLines));
+    except end;
     try Preferences.SPSkin := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'SPTheme'); except end;
     try Preferences.DisableNews := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisableNews3'); except end;
     try Preferences.DisableMapDetailsLoading := Misc.GetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisableMapDetailsLoading'); except end;
@@ -738,6 +748,8 @@
     Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ScriptWarningMsgShown', rdInteger, Preferences.ScriptWarningMsgShown);
     Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LimitChatLogs', rdInteger, Preferences.LimitChatLogs);
     Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ChatLogsLimit', rdInteger, Preferences.ChatLogsLimit);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ChatLogLoadLoading', rdInteger, Preferences.ChatLogLoadLoading);
+    Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'ChatLogLoadLines', rdInteger, Preferences.ChatLogLoadLines);
     Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'SPTheme', rdString, Preferences.SPSkin);
     Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'DisableNews3', rdInteger, Preferences.DisableNews);
     Misc.SetRegistryData(HKEY_CURRENT_USER, TASCLIENT_REGISTRY_KEY+'\Preferences', 'LanguageCode', rdString, Preferences.LanguageCode);
@@ -933,6 +945,8 @@
 
   p.LimitChatLogs := ChatLogsLimitCheckBox.Checked;
   p.ChatLogsLimit := ChatLogsLimitTracker.Position;
+  p.ChatLogLoadLoading := ChatLogLoadingCheckBox.Checked;
+  p.ChatLogLoadLines := ChatLogLoadingTracker.Position;
 
   p.EnableScripts := EnableScriptsCheckBox.Checked;
   p.DisableNews := DisableNewsCheckBox.Checked;
@@ -1035,6 +1049,9 @@
   ChatLogsLimitCheckBox.Checked := p.LimitChatLogs;
   ChatLogsLimitTracker.Position := p.ChatLogsLimit;
   ChatLogsLimitTrackerChange(nil);
+  ChatLogLoadingCheckBox.Checked := p.ChatLogLoadLoading;
+  ChatLogLoadingTracker.Position := p.ChatLogLoadLines;
+  ChatLogLoadingTrackerChange(nil);
 
   DisableNewsCheckBox.Checked := p.DisableNews;
   DoNotLoadMapInfos.Checked := p.DisableMapDetailsLoading;
@@ -1733,4 +1750,8 @@
   SaveLayoutOnClose := False;
 end;
 
-end.
+procedure TPreferencesForm.ChatLogLoadingTrackerChange(Sender: TObject);
+begin
+  ChatLogLoadingCheckBox.Caption := Format(_('Load the last %d chat log lines'),[ChatLogLoadingTracker.Position]);
+end;
+ end.

Modified: Lobby/TASClient/ReplaysUnit.dfm
===================================================================
--- Lobby/TASClient/ReplaysUnit.dfm	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/ReplaysUnit.dfm	2010-03-10 11:17:09 UTC (rev 7427)
@@ -147,7 +147,7 @@
       object GradeComboBox: TSpTBXComboBox
         Left = 0
         Top = 192
-        Width = 97
+        Width = 129
         Height = 21
         Style = csDropDownList
         Enabled = False
@@ -168,9 +168,9 @@
           '10 - A must-see')
       end
       object PageControl1: TSpTBXTabControl
-        Left = 104
+        Left = 136
         Top = 0
-        Width = 667
+        Width = 635
         Height = 193
         Anchors = [akLeft, akTop, akRight, akBottom]
         Color = clBtnFace
@@ -192,7 +192,7 @@
         object SpTBXTabSheet2: TSpTBXTabSheet
           Left = 0
           Top = 23
-          Width = 667
+          Width = 635
           Height = 170
           Caption = 'Comments'
           ImageIndex = -1
@@ -202,7 +202,7 @@
           object CommentsRichEdit: TRichEdit
             Left = 2
             Top = 0
-            Width = 663
+            Width = 631
             Height = 168
             Align = alClient
             ScrollBars = ssBoth
@@ -214,7 +214,7 @@
         object SpTBXTabSheet1: TSpTBXTabSheet
           Left = 0
           Top = 23
-          Width = 667
+          Width = 635
           Height = 170
           Caption = 'Script'
           ImageIndex = -1
@@ -224,7 +224,7 @@
           object ScriptRichEdit: TRichEdit
             Left = 2
             Top = 0
-            Width = 663
+            Width = 631
             Height = 168
             Align = alClient
             ReadOnly = True
@@ -236,14 +236,14 @@
         object SpTBXTabSheet4: TSpTBXTabSheet
           Left = 0
           Top = 23
-          Width = 667
+          Width = 635
           Height = 170
           Caption = 'Game settings'
           ImageIndex = -1
           Item = SpTBXTabItem3
           TabControl = PageControl1
           DesignSize = (
-            667
+            635
             170)
           TabItem = 'SpTBXTabItem3'
           object frmGameOptions: TSpTBXGroupBox
@@ -404,7 +404,7 @@
           object SpTBXGroupBox1: TSpTBXGroupBox
             Left = 472
             Top = 8
-            Width = 183
+            Width = 151
             Height = 153
             Caption = 'Map/Mod options'
             Anchors = [akLeft, akTop, akRight, akBottom]
@@ -412,7 +412,7 @@
             object lstLuaOptions: TSpTBXListBox
               Left = 3
               Top = 16
-              Width = 177
+              Width = 145
               Height = 134
               Align = alClient
               BorderStyle = bsNone
@@ -425,7 +425,7 @@
         object SpTBXTabSheet3: TSpTBXTabSheet
           Left = 0
           Top = 23
-          Width = 667
+          Width = 635
           Height = 170
           Caption = 'Players'
           ImageIndex = -1
@@ -435,7 +435,7 @@
           object VDTPlayers: TVirtualDrawTree
             Left = 2
             Top = 0
-            Width = 663
+            Width = 631
             Height = 168
             Align = alClient
             Header.AutoSizeIndex = 7
@@ -497,7 +497,7 @@
               end
               item
                 Position = 7
-                Width = 129
+                Width = 97
                 WideText = 'ACS'
                 WideHint = 'Averange commands size (units affected per command)'
               end&gt;
@@ -505,9 +505,9 @@
         end
       end
       object HostReplayButton: TSpTBXButton
-        Left = 616
+        Left = 536
         Top = 200
-        Width = 75
+        Width = 115
         Height = 25
         Caption = 'Host replay'
         Anchors = [akRight, akBottom]
@@ -521,9 +521,9 @@
         LinkFont.Style = [fsUnderline]
       end
       object WatchButton: TSpTBXButton
-        Left = 608
+        Left = 536
         Top = 200
-        Width = 75
+        Width = 115
         Height = 25
         Caption = 'Watch'
         Anchors = [akRight, akBottom]
@@ -536,9 +536,9 @@
         LinkFont.Style = [fsUnderline]
       end
       object CloseButton: TSpTBXButton
-        Left = 696
+        Left = 656
         Top = 200
-        Width = 75
+        Width = 115
         Height = 25
         Caption = 'Close'
         Anchors = [akRight, akBottom]
@@ -554,7 +554,7 @@
       object DownloadButton: TSpTBXButton
         Left = 0
         Top = 150
-        Width = 97
+        Width = 129
         Height = 22
         Caption = 'Dowload replays'
         TabOrder = 6
@@ -568,7 +568,7 @@
       object UploadButton: TSpTBXButton
         Left = 0
         Top = 126
-        Width = 97
+        Width = 129
         Height = 22
         Caption = 'Upload'
         Enabled = False
@@ -583,7 +583,7 @@
       object SaveButton: TSpTBXSpeedButton
         Left = 0
         Top = 51
-        Width = 97
+        Width = 129
         Height = 22
         Caption = 'Save'
         Enabled = False
@@ -597,7 +597,7 @@
       object RenameButton: TSpTBXSpeedButton
         Left = 0
         Top = 27
-        Width = 97
+        Width = 129
         Height = 22
         Caption = 'Rename'
         Enabled = False
@@ -611,7 +611,7 @@
       object DeleteButton: TSpTBXSpeedButton
         Left = 0
         Top = 75
-        Width = 97
+        Width = 129
         Height = 22
         Caption = 'Delete'
         Enabled = False
@@ -625,7 +625,7 @@
       object ReloadButton: TSpTBXSpeedButton
         Left = 0
         Top = 3
-        Width = 97
+        Width = 129
         Height = 22
         Caption = 'Refresh list'
         Enabled = False
@@ -639,7 +639,7 @@
       object DeleteAllVisibleButton: TSpTBXButton
         Left = 0
         Top = 99
-        Width = 97
+        Width = 129
         Height = 25
         Caption = 'Delete all visible'
         TabOrder = 12
@@ -694,15 +694,118 @@
         Height = 225
         Align = alTop
         Color = clBtnFace
-        ActiveTabIndex = 1
+        ActiveTabIndex = 0
         HiddenItems = &lt;&gt;
         object FiltersTab: TSpTBXTabItem
           Caption = 'Filters'
+          Checked = True
         end
         object PresetsTab: TSpTBXTabItem
           Caption = 'Presets'
-          Checked = True
         end
+        object SpTBXTabSheet6: TSpTBXTabSheet
+          Left = 0
+          Top = 23
+          Width = 774
+          Height = 202
+          Caption = 'Presets'
+          ImageIndex = -1
+          Item = PresetsTab
+          TabControl = FiltersTabs
+          DesignSize = (
+            774
+            202)
+          TabItem = 'PresetsTab'
+          object SpTBXGroupBox2: TSpTBXGroupBox
+            Left = 8
+            Top = 8
+            Width = 137
+            Height = 185
+            Caption = 'Options'
+            TabOrder = 0
+            object btDeletePreset: TSpTBXButton
+              Left = 8
+              Top = 72
+              Width = 121
+              Height = 25
+              Caption = 'Delete'
+              TabOrder = 1
+              OnClick = btDeletePresetClick
+              LinkFont.Charset = DEFAULT_CHARSET
+              LinkFont.Color = clBlue
+              LinkFont.Height = -11
+              LinkFont.Name = 'MS Sans Serif'
+              LinkFont.Style = [fsUnderline]
+            end
+            object btSavePreset: TSpTBXButton
+              Left = 8
+              Top = 40
+              Width = 121
+              Height = 25
+              Caption = 'Save'
+              TabOrder = 2
+              OnClick = btSavePresetClick
+              LinkFont.Charset = DEFAULT_CHARSET
+              LinkFont.Color = clBlue
+              LinkFont.Height = -11
+              LinkFont.Name = 'MS Sans Serif'
+              LinkFont.Style = [fsUnderline]
+            end
+            object PresetNameTextbox: TSpTBXEdit
+              Left = 8
+              Top = 18
+              Width = 121
+              Height = 21
+              TabOrder = 3
+              Text = 'Preset name'
+            end
+            object btClearPreset: TSpTBXButton
+              Left = 8
+              Top = 96
+              Width = 121
+              Height = 25
+              Caption = 'Clear'
+              TabOrder = 0
+              OnClick = btClearPresetClick
+              LinkFont.Charset = DEFAULT_CHARSET
+              LinkFont.Color = clBlue
+              LinkFont.Height = -11
+              LinkFont.Name = 'MS Sans Serif'
+              LinkFont.Style = [fsUnderline]
+            end
+          end
+          object SpTBXLabel5: TSpTBXLabel
+            Left = 152
+            Top = 8
+            Width = 64
+            Height = 16
+            Caption = 'Preset list :'
+            Font.Charset = DEFAULT_CHARSET
+            Font.Color = clWindowText
+            Font.Height = -13
+            Font.Name = 'MS Sans Serif'
+            Font.Style = []
+            ParentFont = False
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
+          object PresetListbox: TSpTBXListBox
+            Left = 152
+            Top = 26
+            Width = 614
+            Height = 167
+            Anchors = [akLeft, akTop, akRight]
+            ItemHeight = 16
+            Items.Strings = (
+              'current')
+            TabOrder = 2
+            OnClick = PresetListboxClick
+            OnDblClick = PresetListboxDblClick
+          end
+        end
         object SpTBXTabSheet5: TSpTBXTabSheet
           Left = 0
           Top = 23
@@ -716,7 +819,7 @@
           object SpTBXGroupBox4: TSpTBXGroupBox
             Left = 8
             Top = 0
-            Width = 241
+            Width = 257
             Height = 89
             Caption = 'Game end condition'
             TabOrder = 0
@@ -758,13 +861,13 @@
           object SpTBXPanel1: TSpTBXPanel
             Left = 8
             Top = 94
-            Width = 241
+            Width = 257
             Height = 66
             Caption = 'SpTBXPanel1'
             TabOrder = 1
             TBXStyleBackground = True
             object chkFilterLimitDGunFilter: TSpTBXCheckBox
-              Left = 11
+              Left = 4
               Top = 8
               Width = 46
               Height = 15
@@ -773,7 +876,7 @@
               OnClick = chkFilterLimitDGunFilterClick
             end
             object chkFilterGhostedFilter: TSpTBXCheckBox
-              Left = 11
+              Left = 4
               Top = 24
               Width = 46
               Height = 15
@@ -782,7 +885,7 @@
               OnClick = chkFilterGhostedFilterClick
             end
             object chkFilterDiminishingFilter: TSpTBXCheckBox
-              Left = 11
+              Left = 4
               Top = 40
               Width = 46
               Height = 15
@@ -791,7 +894,7 @@
               OnClick = chkFilterDiminishingFilterClick
             end
             object chkFilterGhosted: TSpTBXCheckBox
-              Left = 65
+              Left = 57
               Top = 24
               Width = 102
               Height = 15
@@ -800,7 +903,7 @@
               OnClick = chkFilterGhostedClick
             end
             object chkFilterLimitDGun: TSpTBXCheckBox
-              Left = 65
+              Left = 57
               Top = 8
               Width = 128
               Height = 15
@@ -809,7 +912,7 @@
               OnClick = chkFilterLimitDGunClick
             end
             object chkFilterDiminishing: TSpTBXCheckBox
-              Left = 65
+              Left = 57
               Top = 40
               Width = 166
               Height = 15
@@ -819,9 +922,9 @@
             end
           end
           object SpTBXGroupBox5: TSpTBXGroupBox
-            Left = 256
+            Left = 272
             Top = 6
-            Width = 169
+            Width = 201
             Height = 187
             TabOrder = 2
             TBXStyleBackground = True
@@ -853,7 +956,7 @@
               OnClick = chkFilterUnitsClick
             end
             object btFilterUnits: TSpTBXButton
-              Left = 88
+              Left = 120
               Top = 56
               Width = 17
               Height = 20
@@ -867,7 +970,7 @@
               LinkFont.Style = [fsUnderline]
             end
             object btFilterEnergy: TSpTBXButton
-              Left = 88
+              Left = 120
               Top = 32
               Width = 17
               Height = 20
@@ -881,7 +984,7 @@
               LinkFont.Style = [fsUnderline]
             end
             object btFilterMetal: TSpTBXButton
-              Left = 88
+              Left = 120
               Top = 8
               Width = 17
               Height = 20
@@ -895,7 +998,7 @@
               LinkFont.Style = [fsUnderline]
             end
             object speFilterMetal: TJvSpinEdit
-              Left = 104
+              Left = 136
               Top = 8
               Width = 57
               Height = 20
@@ -906,7 +1009,7 @@
               OnChange = speFilterMetalChange
             end
             object speFilterEnergy: TJvSpinEdit
-              Left = 104
+              Left = 136
               Top = 32
               Width = 57
               Height = 20
@@ -917,7 +1020,7 @@
               OnChange = speFilterEnergyChange
             end
             object speFilterUnits: TJvSpinEdit
-              Left = 104
+              Left = 136
               Top = 56
               Width = 57
               Height = 20
@@ -937,7 +1040,7 @@
               OnClick = chkFilterPlayersClick
             end
             object btFilterPlayers: TSpTBXButton
-              Left = 88
+              Left = 120
               Top = 80
               Width = 17
               Height = 20
@@ -951,7 +1054,7 @@
               LinkFont.Style = [fsUnderline]
             end
             object speFilterPlayers: TJvSpinEdit
-              Left = 104
+              Left = 136
               Top = 80
               Width = 57
               Height = 20
@@ -972,7 +1075,7 @@
               OnClick = chkFilterLengthClick
             end
             object btFilterLength: TSpTBXButton
-              Left = 88
+              Left = 120
               Top = 104
               Width = 17
               Height = 20
@@ -986,7 +1089,7 @@
               LinkFont.Style = [fsUnderline]
             end
             object speFilterLength: TJvSpinEdit
-              Left = 104
+              Left = 136
               Top = 104
               Width = 57
               Height = 20
@@ -997,7 +1100,7 @@
               OnChange = speFilterLengthChange
             end
             object speFilterFileSize: TJvSpinEdit
-              Left = 104
+              Left = 136
               Top = 128
               Width = 57
               Height = 20
@@ -1008,7 +1111,7 @@
               OnChange = speFilterFileSizeChange
             end
             object btFilterFileSize: TSpTBXButton
-              Left = 88
+              Left = 120
               Top = 128
               Width = 17
               Height = 20
@@ -1040,7 +1143,7 @@
               OnClick = chkFilterGradeClick
             end
             object btFilterGrade: TSpTBXButton
-              Left = 88
+              Left = 120
               Top = 152
               Width = 17
               Height = 20
@@ -1054,7 +1157,7 @@
               LinkFont.Style = [fsUnderline]
             end
             object speFilterGrade: TJvSpinEdit
-              Left = 104
+              Left = 136
               Top = 152
               Width = 57
               Height = 20
@@ -1067,9 +1170,9 @@
             end
           end
           object SpTBXGroupBox3: TSpTBXGroupBox
-            Left = 432
+            Left = 480
             Top = 0
-            Width = 161
+            Width = 185
             Height = 73
             Caption = 'Start position'
             TabOrder = 3
@@ -1109,9 +1212,9 @@
             end
           end
           object SpTBXPanel2: TSpTBXPanel
-            Left = 432
+            Left = 480
             Top = 88
-            Width = 161
+            Width = 185
             Height = 105
             Caption = 'SpTBXPanel2'
             TabOrder = 4
@@ -1119,7 +1222,7 @@
             object FilterListCombo: TSpTBXComboBox
               Left = 8
               Top = 8
-              Width = 105
+              Width = 121
               Height = 19
               Style = csOwnerDrawFixed
               ItemHeight = 13
@@ -1135,7 +1238,7 @@
                 'Map/Mod option')
             end
             object ContainsRadio: TSpTBXRadioButton
-              Left = 15
+              Left = 8
               Top = 36
               Width = 58
               Height = 15
@@ -1143,7 +1246,7 @@
               TabOrder = 1
             end
             object DoNotContainsRadio: TSpTBXRadioButton
-              Left = 16
+              Left = 8
               Top = 52
               Width = 97
               Height = 15
@@ -1155,7 +1258,7 @@
             object FilterValueTextBox: TSpTBXEdit
               Left = 8
               Top = 72
-              Width = 105
+              Width = 121
               Height = 21
               Hint = 
                 'For map/mod option type '#39'key=value'#39' or just '#39'key'#39' or just '#39'value' +
@@ -1165,9 +1268,9 @@
               TabOrder = 3
             end
             object AddToFilterListButton: TSpTBXButton
-              Left = 120
+              Left = 136
               Top = 8
-              Width = 33
+              Width = 41
               Height = 25
               Caption = '-&gt;'
               TabOrder = 4
@@ -1179,9 +1282,9 @@
               LinkFont.Style = [fsUnderline]
             end
             object RemoveFromFilterListButton: TSpTBXButton
-              Left = 120
+              Left = 136
               Top = 40
-              Width = 33
+              Width = 41
               Height = 25
               Caption = '&lt;-'
               TabOrder = 5
@@ -1193,9 +1296,9 @@
               LinkFont.Style = [fsUnderline]
             end
             object ClearFilterListButton: TSpTBXButton
-              Left = 120
+              Left = 136
               Top = 72
-              Width = 33
+              Width = 41
               Height = 25
               Caption = 'Clear'
               TabOrder = 6
@@ -1208,9 +1311,9 @@
             end
           end
           object FilterList: TVirtualStringTree
-            Left = 601
+            Left = 672
             Top = 8
-            Width = 165
+            Width = 94
             Height = 185
             Align = alCustom
             Anchors = [akLeft, akTop, akRight]
@@ -1269,112 +1372,9 @@
               end&gt;
           end
         end
-        object SpTBXTabSheet6: TSpTBXTabSheet
-          Left = 0
-          Top = 23
-          Width = 774
-          Height = 202
-          Caption = 'Presets'
-          ImageIndex = -1
-          Item = PresetsTab
-          TabControl = FiltersTabs
-          DesignSize = (
-            774
-            202)
-          TabItem = 'PresetsTab'
-          object SpTBXGroupBox2: TSpTBXGroupBox
-            Left = 8
-            Top = 8
-            Width = 137
-            Height = 185
-            Caption = 'Options'
-            TabOrder = 0
-            object btDeletePreset: TSpTBXButton
-              Left = 8
-              Top = 72
-              Width = 121
-              Height = 25
-              Caption = 'Delete'
-              TabOrder = 1
-              OnClick = btDeletePresetClick
-              LinkFont.Charset = DEFAULT_CHARSET
-              LinkFont.Color = clBlue
-              LinkFont.Height = -11
-              LinkFont.Name = 'MS Sans Serif'
-              LinkFont.Style = [fsUnderline]
-            end
-            object btSavePreset: TSpTBXButton
-              Left = 8
-              Top = 40
-              Width = 121
-              Height = 25
-              Caption = 'Save'
-              TabOrder = 2
-              OnClick = btSavePresetClick
-              LinkFont.Charset = DEFAULT_CHARSET
-              LinkFont.Color = clBlue
-              LinkFont.Height = -11
-              LinkFont.Name = 'MS Sans Serif'
-              LinkFont.Style = [fsUnderline]
-            end
-            object PresetNameTextbox: TSpTBXEdit
-              Left = 8
-              Top = 18
-              Width = 121
-              Height = 21
-              TabOrder = 3
-              Text = 'Preset name'
-            end
-            object btClearPreset: TSpTBXButton
-              Left = 8
-              Top = 96
-              Width = 121
-              Height = 25
-              Caption = 'Clear'
-              TabOrder = 0
-              OnClick = btClearPresetClick
-              LinkFont.Charset = DEFAULT_CHARSET
-              LinkFont.Color = clBlue
-              LinkFont.Height = -11
-              LinkFont.Name = 'MS Sans Serif'
-              LinkFont.Style = [fsUnderline]
-            end
-          end
-          object SpTBXLabel5: TSpTBXLabel
-            Left = 152
-            Top = 8
-            Width = 64
-            Height = 16
-            Caption = 'Preset list :'
-            Font.Charset = DEFAULT_CHARSET
-            Font.Color = clWindowText
-            Font.Height = -13
-            Font.Name = 'MS Sans Serif'
-            Font.Style = []
-            ParentFont = False
-            LinkFont.Charset = DEFAULT_CHARSET
-            LinkFont.Color = clBlue
-            LinkFont.Height = -11
-            LinkFont.Name = 'MS Sans Serif'
-            LinkFont.Style = [fsUnderline]
-          end
-          object PresetListbox: TSpTBXListBox
-            Left = 152
-            Top = 26
-            Width = 614
-            Height = 167
-            Anchors = [akLeft, akTop, akRight]
-            ItemHeight = 16
-            Items.Strings = (
-              'current')
-            TabOrder = 2
-            OnClick = PresetListboxClick
-            OnDblClick = PresetListboxDblClick
-          end
-        end
       end
       object chkEnableFilters: TSpTBXCheckBox
-        Left = 661
+        Left = 613
         Top = 2
         Width = 110
         Height = 18

Modified: Lobby/TASClient/TASClient.dof
===================================================================
--- Lobby/TASClient/TASClient.dof	2010-03-07 00:04:29 UTC (rev 7426)
+++ Lobby/TASClient/TASClient.dof	2010-03-10 11:17:09 UTC (rev 7427)
@@ -113,9 +113,9 @@
 IncludeVerInfo=1
 AutoIncBuild=1
 MajorVer=0
-MinorVer=68
+MinorVer=69
 Release=0
-Build=816
+Build=819
 Debug=0
 PreRelease=0
 Special=0
@@ -126,7 +126,7 @@
 [Version Info Keys]
 CompanyName=
 FileDescription=Spring RTS Engine lobby client
-FileVersion=0.68.0.816
+FileVersion=0.69.0.819
 InternalName=
 LegalCopyright=
 LegalTrademarks=

Modified: Lobby/TASClient/TASClient.res
===================================================================
(Binary files differ)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002196.html">[Taspring-linux-commit] r7426 - Lobby/TASClient
</A></li>
	<LI>Next message: <A HREF="002198.html">[Taspring-linux-commit] r7428 - Lobby/TASClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2197">[ date ]</a>
              <a href="thread.html#2197">[ thread ]</a>
              <a href="subject.html#2197">[ subject ]</a>
              <a href="author.html#2197">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
