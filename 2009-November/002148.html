<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r7378 - in Lobby/TASClient: . Interface
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2009-November/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7378%20-%20in%20Lobby/TASClient%3A%20.%20Interface&In-Reply-To=%3C20091122124057.81E1025879%40it-l.eu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002147.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r7378 - in Lobby/TASClient: . Interface</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r7378%20-%20in%20Lobby/TASClient%3A%20.%20Interface&In-Reply-To=%3C20091122124057.81E1025879%40it-l.eu%3E"
       TITLE="[Taspring-linux-commit] r7378 - in Lobby/TASClient: . Interface">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Sun Nov 22 13:40:57 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002147.html">[Taspring-linux-commit] r7377 - Lobby/TASClient
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2148">[ date ]</a>
              <a href="thread.html#2148">[ thread ]</a>
              <a href="subject.html#2148">[ subject ]</a>
              <a href="author.html#2148">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: satirik
Date: 2009-11-22 13:40:57 +0100 (Sun, 22 Nov 2009)
New Revision: 7378

Modified:
   Lobby/TASClient/Interface/campaigns.html
   Lobby/TASClient/Interface/main.html
   Lobby/TASClient/Interface/missions.html
   Lobby/TASClient/Interface/modMain.html
   Lobby/TASClient/Interface/modsettings.html
   Lobby/TASClient/Interface/settings.html
   Lobby/TASClient/Interface/skirmish.html
   Lobby/TASClient/MenuFormUnit.dfm
   Lobby/TASClient/MenuFormUnit.pas
   Lobby/TASClient/TASClient.dof
   Lobby/TASClient/TASClient.res
Log:
* SP start pos selection improved
* sp default html skin update (didn't commit them for a while)

Modified: Lobby/TASClient/Interface/campaigns.html
===================================================================
--- Lobby/TASClient/Interface/campaigns.html	2009-11-15 18:55:45 UTC (rev 7377)
+++ Lobby/TASClient/Interface/campaigns.html	2009-11-22 12:40:57 UTC (rev 7378)
@@ -16,14 +16,15 @@
 		}
 
 		function fadeOff(){
-			currentOpacityFadeOff = currentOpacityFadeOff - 25;
+			sendData('modmain');
+			/*currentOpacityFadeOff = currentOpacityFadeOff - 25;
 			document.getElementById('contentBlock').style.filter = &quot;alpha(opacity=&quot;+currentOpacityFadeOff+&quot;)&quot;;
 			if (currentOpacityFadeOff &gt; 0) {
 				setTimeout(&quot;fadeOff()&quot;,40);
 			}else{
 				document.getElementById('contentBlock').style.visibility = 'hidden';
 				resizeBar();
-			}
+			}*/
 		}
 	&lt;/script&gt;
 	&lt;style type=&quot;text/css&quot;&gt;

Modified: Lobby/TASClient/Interface/main.html
===================================================================
--- Lobby/TASClient/Interface/main.html	2009-11-15 18:55:45 UTC (rev 7377)
+++ Lobby/TASClient/Interface/main.html	2009-11-22 12:40:57 UTC (rev 7378)
@@ -8,7 +8,8 @@
 		goPage = '';
 
 		function fadeOff(){
-			currentOpacityFadeOff = currentOpacityFadeOff - 25;
+			sendData(goPage);
+			/*currentOpacityFadeOff = currentOpacityFadeOff - 25;
 			document.getElementById('menu').style.filter = &quot;alpha(opacity=&quot;+currentOpacityFadeOff+&quot;)&quot;;
 			document.getElementById('title').style.filter = &quot;alpha(opacity=&quot;+currentOpacityFadeOff+&quot;)&quot;;
 			document.getElementById('springVersion').style.filter = &quot;alpha(opacity=&quot;+currentOpacityFadeOff+&quot;)&quot;;
@@ -19,7 +20,7 @@
 				document.getElementById('title').style.visibility = 'hidden';
 				document.getElementById('springVersion').style.visibility = 'hidden';
 				resizeBar();
-			}
+			}*/
 		}
 
 		function resizeBar(){

Modified: Lobby/TASClient/Interface/missions.html
===================================================================
--- Lobby/TASClient/Interface/missions.html	2009-11-15 18:55:45 UTC (rev 7377)
+++ Lobby/TASClient/Interface/missions.html	2009-11-22 12:40:57 UTC (rev 7378)
@@ -16,14 +16,15 @@
 		}
 
 		function fadeOff(){
-			currentOpacityFadeOff = currentOpacityFadeOff - 25;
+			sendData('back');
+			/*currentOpacityFadeOff = currentOpacityFadeOff - 25;
 			document.getElementById('contentBlock').style.filter = &quot;alpha(opacity=&quot;+currentOpacityFadeOff+&quot;)&quot;;
 			if (currentOpacityFadeOff &gt; 0) {
 				setTimeout(&quot;fadeOff()&quot;,40);
 			}else{
 				document.getElementById('contentBlock').style.visibility = 'hidden';
 				resizeBar();
-			}
+			}*/
 		}
 	&lt;/script&gt;
 	&lt;style type=&quot;text/css&quot;&gt;

Modified: Lobby/TASClient/Interface/modMain.html
===================================================================
--- Lobby/TASClient/Interface/modMain.html	2009-11-15 18:55:45 UTC (rev 7377)
+++ Lobby/TASClient/Interface/modMain.html	2009-11-22 12:40:57 UTC (rev 7378)
@@ -8,7 +8,8 @@
 		goPage = '';
 
 		function fadeOff(){
-			currentOpacityFadeOff = currentOpacityFadeOff - 25;
+			sendData(goPage);
+			/*currentOpacityFadeOff = currentOpacityFadeOff - 25;
 			document.getElementById('menu').style.filter = &quot;alpha(opacity=&quot;+currentOpacityFadeOff+&quot;)&quot;;
 			document.getElementById('title').style.filter = &quot;alpha(opacity=&quot;+currentOpacityFadeOff+&quot;)&quot;;
 			document.getElementById('springVersion').style.filter = &quot;alpha(opacity=&quot;+currentOpacityFadeOff+&quot;)&quot;;
@@ -20,7 +21,7 @@
 				document.getElementById('title').style.visibility = 'hidden';
 				document.getElementById('springVersion').style.visibility = 'hidden';
 				resizeBar();
-			}
+			}*/
 		}
 
 		function resizeBar(){

Modified: Lobby/TASClient/Interface/modsettings.html
===================================================================
--- Lobby/TASClient/Interface/modsettings.html	2009-11-15 18:55:45 UTC (rev 7377)
+++ Lobby/TASClient/Interface/modsettings.html	2009-11-22 12:40:57 UTC (rev 7378)
@@ -16,14 +16,15 @@
 		}
 
 		function fadeOff(){
-			currentOpacityFadeOff = currentOpacityFadeOff - 25;
+			sendData('back');
+			/*currentOpacityFadeOff = currentOpacityFadeOff - 25;
 			document.getElementById('contentBlock').style.filter = &quot;alpha(opacity=&quot;+currentOpacityFadeOff+&quot;)&quot;;
 			if (currentOpacityFadeOff &gt; 0) {
 				setTimeout(&quot;fadeOff()&quot;,40);
 			}else{
 				document.getElementById('contentBlock').style.visibility = 'hidden';
 				resizeBar();
-			}
+			}*/
 		}
 	&lt;/script&gt;
 	&lt;style type=&quot;text/css&quot;&gt;

Modified: Lobby/TASClient/Interface/settings.html
===================================================================
--- Lobby/TASClient/Interface/settings.html	2009-11-15 18:55:45 UTC (rev 7377)
+++ Lobby/TASClient/Interface/settings.html	2009-11-22 12:40:57 UTC (rev 7378)
@@ -16,14 +16,15 @@
 		}
 
 		function fadeOff(){
-			currentOpacityFadeOff = currentOpacityFadeOff - 25;
+			sendData('back');
+			/*currentOpacityFadeOff = currentOpacityFadeOff - 25;
 			document.getElementById('contentBlock').style.filter = &quot;alpha(opacity=&quot;+currentOpacityFadeOff+&quot;)&quot;;
 			if (currentOpacityFadeOff &gt; 0) {
 				setTimeout(&quot;fadeOff()&quot;,40);
 			}else{
 				document.getElementById('contentBlock').style.visibility = 'hidden';
 				resizeBar();
-			}
+			}*/
 		}
 	&lt;/script&gt;
 	&lt;style type=&quot;text/css&quot;&gt;

Modified: Lobby/TASClient/Interface/skirmish.html
===================================================================
--- Lobby/TASClient/Interface/skirmish.html	2009-11-15 18:55:45 UTC (rev 7377)
+++ Lobby/TASClient/Interface/skirmish.html	2009-11-22 12:40:57 UTC (rev 7378)
@@ -98,14 +98,15 @@
 	}
 
 	function fadeOff(){
-		currentOpacityFadeOff = currentOpacityFadeOff - 25;
+		sendData('modmain');
+		/*currentOpacityFadeOff = currentOpacityFadeOff - 25;
 		document.getElementById('tableId').style.filter = &quot;alpha(opacity=&quot;+currentOpacityFadeOff+&quot;)&quot;;
 		if (currentOpacityFadeOff &gt; 0) {
 			setTimeout(&quot;fadeOff()&quot;,40);
 		}else{
 			document.getElementById('tableId').style.visibility = 'hidden';
 			resizeBar();
-		}
+		}*/
 	}
 
 	movingBox = null;
@@ -269,6 +270,10 @@
 	}
 
 	function afterLoading(){
+		if('[LOBBY:LOADPARAM:gamemode0:0:firstload]'=='firstload'){
+			sendData('changegamemode:3'); // default start pos : choose
+		}
+		
 		checkBoxes();
 		selectSides();
 		//selectIds();
@@ -358,9 +363,9 @@
 									&lt;div style=&quot;float:left;&quot;&gt;
 										&lt;form method=&quot;POST&quot; action=&quot;&quot;&gt;
 											Start pos : &lt;br/&gt;
-											&lt;input type=&quot;radio&quot; name=&quot;gamemode&quot; value=&quot;0&quot; style=&quot;border: 0&quot; onclick=&quot;saveParam('gamemode0:checked');saveParam('gamemode1:');saveParam('gamemode2:');sendData('changegamemode:0');showBoxes();&quot; [LOBBY:LOADPARAM:gamemode0:0:checked] /&gt; Choose &lt;br/&gt;
+											&lt;input type=&quot;radio&quot; name=&quot;gamemode&quot; value=&quot;0&quot; style=&quot;border: 0&quot; onclick=&quot;saveParam('gamemode0:checked');saveParam('gamemode1:');saveParam('gamemode2:');sendData('changegamemode:3');showBoxes();&quot; [LOBBY:LOADPARAM:gamemode0:0:checked] /&gt; Choose &lt;br/&gt;
 											&lt;input type=&quot;radio&quot; name=&quot;gamemode&quot; value=&quot;1&quot; style=&quot;border: 0&quot; onclick=&quot;saveParam('gamemode0:');saveParam('gamemode1:checked');saveParam('gamemode2:');sendData('changegamemode:1');hideBoxes();&quot; [LOBBY:LOADPARAM:gamemode1:0] /&gt; Random &lt;br/&gt;
-											&lt;input type=&quot;radio&quot; name=&quot;gamemode&quot; value=&quot;2&quot; style=&quot;border: 0&quot; onclick=&quot;saveParam('gamemode0:');saveParam('gamemode1:');saveParam('gamemode2:checked');sendData('changegamemode:2');hideBoxes();&quot; [LOBBY:LOADPARAM:gamemode2:0] /&gt; Fixed &lt;br/&gt;
+											&lt;input type=&quot;radio&quot; name=&quot;gamemode&quot; value=&quot;2&quot; style=&quot;border: 0&quot; onclick=&quot;saveParam('gamemode0:');saveParam('gamemode1:');saveParam('gamemode2:checked');sendData('changegamemode:0');hideBoxes();&quot; [LOBBY:LOADPARAM:gamemode2:0] /&gt; Fixed &lt;br/&gt;
 											Game type : &lt;br/&gt;
 											[GameEndCond]
 										&lt;/form&gt;

Modified: Lobby/TASClient/MenuFormUnit.dfm
===================================================================
--- Lobby/TASClient/MenuFormUnit.dfm	2009-11-15 18:55:45 UTC (rev 7377)
+++ Lobby/TASClient/MenuFormUnit.dfm	2009-11-22 12:40:57 UTC (rev 7378)
@@ -1,6 +1,6 @@
 object MenuForm: TMenuForm
-  Left = 365
-  Top = 52
+  Left = 939
+  Top = 218
   BorderStyle = bsNone
   Caption = 'TASClient SP'
   ClientHeight = 671

Modified: Lobby/TASClient/MenuFormUnit.pas
===================================================================
--- Lobby/TASClient/MenuFormUnit.pas	2009-11-15 18:55:45 UTC (rev 7377)
+++ Lobby/TASClient/MenuFormUnit.pas	2009-11-22 12:40:57 UTC (rev 7378)
@@ -502,6 +502,8 @@
   skinList := TStringList.Create;
   MenuLoaded := False;
 
+  GameMode := -1;
+
   GetColorValues(ColorCallBack);
 
   SaveIERegistry;
@@ -1240,10 +1242,7 @@
   script.AddOrChangeKeyValue('GAME/ModHash',IntToStr(Utility.GetModHash(BattleForm.CurrentModName)));
   if BattleForm.GameEndRadioGroup.Visible then
     script.AddOrChangeKeyValue('GAME/modoptions/gamemode',IntToStr(GameType));
-  if GameMode = 0 then
-    script.AddOrChangeKeyValue('GAME/startpostype','3')
-  else
-    script.AddOrChangeKeyValue('GAME/startpostype',IntToStr(GameMode));
+  script.AddOrChangeKeyValue('GAME/startpostype',IntToStr(GameMode));
   if BattleForm.UnitsTracker.Visible then
     script.AddOrChangeKeyValue('GAME/modoptions/maxunits',IntToStr(MaxUnits));
   if BattleForm.EnergyTracker.Visible then
@@ -1310,11 +1309,11 @@
   Colors.Delete(tmpInt);
   script.AddOrChangeKeyValue('GAME/TEAM0/Side',Utility.SideList[MePlayer.Side]);
   script.AddOrChangeKeyValue('GAME/TEAM0/Handicap',IntToStr(MePlayer.Handicap));
-  if GameMode = 0 then
-  begin
+  //if GameMode = 3 then
+  //begin
     script.AddOrChangeKeyValue('GAME/TEAM0/StartPosX',IntToStr(Round(MePlayer.StartPosX*TMapItem(MapListForm.Maps[BattleForm.CurrentMapIndex]).MapInfo.Width*8)));
     script.AddOrChangeKeyValue('GAME/TEAM0/StartPosZ',IntToStr(Round(MePlayer.StartPosY*TMapItem(MapListForm.Maps[BattleForm.CurrentMapIndex]).MapInfo.Height*8)));
-  end;
+  //end;
 
   TeamAllyCounter.Items[MePlayer.Id] := 1;
 
@@ -1335,11 +1334,11 @@
       script.AddOrChangeKeyValue('GAME/TEAM'+IntToStr(i+1)+'/Side',Utility.SideList[TSPAIItem(AIPlayerList[i]^).Side]);
       script.AddOrChangeKeyValue('GAME/TEAM'+IntToStr(i+1)+'/Handicap',IntToStr(TSPAIItem(AIPlayerList[i]^).Handicap));
 
-      if GameMode = 0 then
-      begin
+      //if GameMode = 3 then
+      //begin
         script.AddOrChangeKeyValue('GAME/TEAM'+IntToStr(i+1)+'/StartPosX',IntToStr(Round(TSPAIItem(AIPlayerList[i]^).StartPosX*TMapItem(MapListForm.Maps[BattleForm.CurrentMapIndex]).MapInfo.Width*8)));
         script.AddOrChangeKeyValue('GAME/TEAM'+IntToStr(i+1)+'/StartPosZ',IntToStr(Round(TSPAIItem(AIPlayerList[i]^).StartPosY*TMapItem(MapListForm.Maps[BattleForm.CurrentMapIndex]).MapInfo.Height*8)));
-      end;
+      //end;
 
       TeamAllyCounter.Items[TSPAIItem(AIPlayerList[i]^).Team] := TeamAllyCounter.Items[TSPAIItem(AIPlayerList[i]^).Team]+1;
     end;

Modified: Lobby/TASClient/TASClient.dof
===================================================================
--- Lobby/TASClient/TASClient.dof	2009-11-15 18:55:45 UTC (rev 7377)
+++ Lobby/TASClient/TASClient.dof	2009-11-22 12:40:57 UTC (rev 7378)
@@ -115,7 +115,7 @@
 MajorVer=0
 MinorVer=55
 Release=0
-Build=729
+Build=731
 Debug=0
 PreRelease=0
 Special=0
@@ -126,7 +126,7 @@
 [Version Info Keys]
 CompanyName=
 FileDescription=Spring RTS Engine lobby client
-FileVersion=0.55.0.729
+FileVersion=0.55.0.731
 InternalName=
 LegalCopyright=
 LegalTrademarks=

Modified: Lobby/TASClient/TASClient.res
===================================================================
(Binary files differ)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002147.html">[Taspring-linux-commit] r7377 - Lobby/TASClient
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2148">[ date ]</a>
              <a href="thread.html#2148">[ thread ]</a>
              <a href="subject.html#2148">[ subject ]</a>
              <a href="author.html#2148">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
