<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r5324 - in trunk/Lobby/AFLobby/src: aflobby	aflobby/UI aflobby/UI/battle images/UI
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-January/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r5324%20-%20in%20trunk/Lobby/AFLobby/src%3A%20aflobby%0A%09aflobby/UI%20aflobby/UI/battle%20images/UI&In-Reply-To=%3CE1JEVtx-0007Jh-QW%40proserver.fnord.lan%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000130.html">
   <LINK REL="Next"  HREF="000132.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r5324 - in trunk/Lobby/AFLobby/src: aflobby	aflobby/UI aflobby/UI/battle images/UI</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r5324%20-%20in%20trunk/Lobby/AFLobby/src%3A%20aflobby%0A%09aflobby/UI%20aflobby/UI/battle%20images/UI&In-Reply-To=%3CE1JEVtx-0007Jh-QW%40proserver.fnord.lan%3E"
       TITLE="[Taspring-linux-commit] r5324 - in trunk/Lobby/AFLobby/src: aflobby	aflobby/UI aflobby/UI/battle images/UI">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Mon Jan 14 21:27:21 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000130.html">[Taspring-linux-commit] r5323 - trunk/rts/Game
</A></li>
        <LI>Next message: <A HREF="000132.html">[Taspring-linux-commit] r5325 - trunk/Lobby/TASClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#131">[ date ]</a>
              <a href="thread.html#131">[ thread ]</a>
              <a href="subject.html#131">[ subject ]</a>
              <a href="author.html#131">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: tnowell
Date: 2008-01-14 21:27:21 +0100 (Mon, 14 Jan 2008)
New Revision: 5324

Added:
   trunk/Lobby/AFLobby/src/aflobby/UI/DocumentSizeFilter.java
   trunk/Lobby/AFLobby/src/aflobby/UI/battle/
   trunk/Lobby/AFLobby/src/aflobby/UI/battle/CBooleanOptionsPanel.form
   trunk/Lobby/AFLobby/src/aflobby/UI/battle/CBooleanOptionsPanel.java
   trunk/Lobby/AFLobby/src/aflobby/UI/battle/CListOptionsPanel.form
   trunk/Lobby/AFLobby/src/aflobby/UI/battle/CListOptionsPanel.java
   trunk/Lobby/AFLobby/src/aflobby/UI/battle/CSliderOptionsPanel.form
   trunk/Lobby/AFLobby/src/aflobby/UI/battle/CSliderOptionsPanel.java
   trunk/Lobby/AFLobby/src/aflobby/UI/battle/CStringOptionsPanel.form
   trunk/Lobby/AFLobby/src/aflobby/UI/battle/CStringOptionsPanel.java
   trunk/Lobby/AFLobby/src/aflobby/UI/battle/ListItem.java
   trunk/Lobby/AFLobby/src/images/UI/dice.png
   trunk/Lobby/AFLobby/src/images/UI/map.png
   trunk/Lobby/AFLobby/src/images/UI/optionflag.png
Modified:
   trunk/Lobby/AFLobby/src/aflobby/CBattleInfo.java
   trunk/Lobby/AFLobby/src/aflobby/CBattleList.form
   trunk/Lobby/AFLobby/src/aflobby/CBattleList.java
   trunk/Lobby/AFLobby/src/aflobby/CBattleModel.java
   trunk/Lobby/AFLobby/src/aflobby/CBattleWindow.form
   trunk/Lobby/AFLobby/src/aflobby/CBattleWindow.java
   trunk/Lobby/AFLobby/src/aflobby/CChannel.java
   trunk/Lobby/AFLobby/src/aflobby/CChannelView.form
   trunk/Lobby/AFLobby/src/aflobby/CChannelView.java
   trunk/Lobby/AFLobby/src/aflobby/CUnitSyncJNIBindings.java
   trunk/Lobby/AFLobby/src/aflobby/JTraffic.form
   trunk/Lobby/AFLobby/src/aflobby/JTraffic.java
   trunk/Lobby/AFLobby/src/aflobby/LMain.form
   trunk/Lobby/AFLobby/src/aflobby/LMain.java
   trunk/Lobby/AFLobby/src/aflobby/languages.properties
Log:
huge commit

- moved all the game options into the new option panel UI
- added option panels for each type of game/mod/map option
- added option icons for game and map icons
- added a dice icon for the battle list random join button
- added full support for lua mod options
- various fixes
- fixed channel topics not ending in a new line
- added a window icon tot he traffic window
- fixed array type casting errors
- removed unnecessary items from the battleinfo class
- removed the old code handling game options and their GUI components
- added a document filter to implement maximum string length in textfields
- numerous lines of code where reformatted into multi-line statements for improved readability

- TODO:
  - finish parsing and adding options when joining as is done when hosting
  - map options
  - add a lock speed option
  - investigate over-usage of UPDATEBATTLEDETAILS/info
  - sort out the player list in channels and ordering
  - change the final two rank images

Modified: trunk/Lobby/AFLobby/src/aflobby/CBattleInfo.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/CBattleInfo.java	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/CBattleInfo.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -61,17 +61,9 @@
     public int port = 8452;
     public int type=0;
     
-    public int maxunits = 500;//new Integer (500); // max. units
     
-    public boolean limitDGun;
-    public boolean diminishingMMs;
-    public boolean ghostedBuildings;
+    //public int startPos; // 0 = fixed, 1 = random, 2 = choose in game
     
-    public int metal = 1000;//new Integer (1000); // starting metal
-    public int energy = 1000; // starting energy
-    public int startPos; // 0 = fixed, 1 = random, 2 = choose in game
-    public int gameEndCondition; // 0 = game continues if commander dies, 1 = game ends if commander dies
-    
     private String engine = &quot;spring&quot;; // assume the engine is spring for now
 
     public boolean isJoinable(){

Modified: trunk/Lobby/AFLobby/src/aflobby/CBattleList.form
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/CBattleList.form	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/CBattleList.form	2008-01-14 20:27:21 UTC (rev 5324)
@@ -297,6 +297,9 @@
     &lt;/Component&gt;
     &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;SurpriseMeButton&quot;&gt;
       &lt;Properties&gt;
+        &lt;Property name=&quot;icon&quot; type=&quot;javax.swing.Icon&quot; editor=&quot;org.netbeans.modules.form.editors2.IconEditor&quot;&gt;
+          &lt;Image iconType=&quot;3&quot; name=&quot;/images/UI/dice.png&quot;/&gt;
+        &lt;/Property&gt;
         &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Join Random Battle&quot;/&gt;
         &lt;Property name=&quot;margin&quot; type=&quot;java.awt.Insets&quot; editor=&quot;org.netbeans.beaninfo.editors.InsetsEditor&quot;&gt;
           &lt;Insets value=&quot;[2, 6, 2, 6]&quot;/&gt;

Modified: trunk/Lobby/AFLobby/src/aflobby/CBattleList.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/CBattleList.java	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/CBattleList.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -371,6 +371,7 @@
         battleCountLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
         battleCountLabel.setText(&quot;0 Battles Listed&quot;);
 
+        SurpriseMeButton.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/images/UI/dice.png&quot;))); // NOI18N
         SurpriseMeButton.setText(&quot;Join Random Battle&quot;);
         SurpriseMeButton.setMargin(new java.awt.Insets(2, 6, 2, 6));
         SurpriseMeButton.addActionListener(new java.awt.event.ActionListener() {

Modified: trunk/Lobby/AFLobby/src/aflobby/CBattleModel.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/CBattleModel.java	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/CBattleModel.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -310,34 +310,20 @@
 //                b.AddPlayer(e.data[2]);
             }
             
-        } else if (e.IsEvent(&quot;UPDATEBATTLEDETAILS&quot;)) {
-            // update the battle details
-            // * UPDATEBATTLEDETAILS startingmetal startingenergy maxunits startpos gameendcondition limitdgun diminishingMMs ghostedBuildings
-            
-            battlewindow.setStartingMetal(Integer.parseInt(e.data[1]));
-            battlewindow.setStartingEnergy(Integer.parseInt(e.data[2]));
-            
-            battlewindow.setMaxUnits(Integer.parseInt(e.data[3]));
-            battlewindow.setStartPosType(Integer.parseInt(e.data[4]));
-            
-            battlewindow.setGameEnd(Integer.parseInt(e.data[5]));
-            battlewindow.setLimitDGUN(Integer.parseInt(e.data[6])==1);
-            battlewindow.setDiminMM(Integer.parseInt(e.data[7])==1);
-            battlewindow.setGhostedBuildings(Integer.parseInt(e.data[8])==1);
-            
         } else if (e.IsEvent(&quot;SETSCRIPTTAGS&quot;)){
             
-            RemoveAllOptions();
+            options.clear();
             String[] pairs = e.parameters.split(&quot;\t&quot;);
             
             for(int i = 0; i&lt; pairs.length; i++){
                 
-                String[] pair = pairs[i].split(&quot; &quot;);
+                String[] pair = pairs[i].split(&quot;=&quot;);
                 
                 String key = pair[0];
-                String value = pairs[i].substring(key.length());
+                key = key.replaceAll(&quot;\\\\&quot;, &quot;/&quot;);
+                String value = pair[1];
                 
-                if(key.equalsIgnoreCase(&quot;GAME/StartMetal&quot;)){
+                /*if(key.equalsIgnoreCase(&quot;GAME/StartMetal&quot;)){
                     battlewindow.setStartingMetal(Integer.parseInt(value));
                     
                 } else if(key.equalsIgnoreCase(&quot;GAME/StartEnergy&quot;)){
@@ -361,13 +347,13 @@
                 } else if(key.equalsIgnoreCase(&quot;GAME/GhostedBuildings&quot;)){
                     battlewindow.setGhostedBuildings(Integer.parseInt(value)==1);
                     
-                } else {
+                } else {*/
                     this.PutOption(key, value);
                     /*LM.Toasts.AddMessage(
                             &quot;Error:: Custom mod/ma options where used, this &quot;+
                             &quot;build of AFLobby does not support custom mod/&quot;+
                             &quot;map options, your game will not sync&quot;);*/
-                }
+                //}
                 
             }
         }
@@ -664,14 +650,17 @@
 
     public void PutOption(String option, Object value) {
         options.put(option, value);
+        battlewindow.UpdateBattleClients();
     }
 
     public void RemoveOption(String option) {
         options.remove(option);
+        battlewindow.UpdateBattleClients();
     }
 
     public void RemoveAllOptions() {
         options.clear();
+        battlewindow.UpdateBattleClients();
     }
     //
 }

Modified: trunk/Lobby/AFLobby/src/aflobby/CBattleWindow.form
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/CBattleWindow.form	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/CBattleWindow.form	2008-01-14 20:27:21 UTC (rev 5324)
@@ -397,21 +397,18 @@
           &lt;Layout&gt;
             &lt;DimensionLayout dim=&quot;0&quot;&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
+                          &lt;Component id=&quot;ColourPanel&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;Component id=&quot;ColourButton&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                               &lt;Component id=&quot;MyTeamCombo&quot; min=&quot;-2&quot; pref=&quot;184&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                               &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;Component id=&quot;MyAllyTeamCombo&quot; min=&quot;-2&quot; pref=&quot;230&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;Component id=&quot;RaceCombo&quot; min=&quot;-2&quot; pref=&quot;184&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                           &lt;/Group&gt;
-                          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;1&quot;&gt;
-                              &lt;Component id=&quot;ColourButton&quot; min=&quot;-2&quot; pref=&quot;163&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;Component id=&quot;ColourPanel&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;/Group&gt;
                       &lt;/Group&gt;
                       &lt;EmptySpace pref=&quot;242&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
@@ -427,11 +424,10 @@
                           &lt;Component id=&quot;RaceCombo&quot; linkSize=&quot;2&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;ColourPanel&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                          &lt;Component id=&quot;ColourButton&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                      &lt;/Group&gt;
-                      &lt;EmptySpace pref=&quot;433&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;ColourButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;ColourPanel&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;382&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
@@ -542,7 +538,7 @@
               &lt;Layout&gt;
                 &lt;DimensionLayout dim=&quot;0&quot;&gt;
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;EmptySpace min=&quot;0&quot; pref=&quot;439&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace min=&quot;0&quot; pref=&quot;608&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
                 &lt;/DimensionLayout&gt;
                 &lt;DimensionLayout dim=&quot;1&quot;&gt;
@@ -681,64 +677,16 @@
           &lt;Layout&gt;
             &lt;DimensionLayout dim=&quot;0&quot;&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                                  &lt;Group type=&quot;103&quot; alignment=&quot;0&quot; groupAlignment=&quot;1&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
-                                      &lt;Component id=&quot;LimitDGunCheck&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;Component id=&quot;GameSpeedLockCheck&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;Component id=&quot;GhostedCheck&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;Component id=&quot;DiminMMCheck&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                                  &lt;/Group&gt;
-                                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                          &lt;Component id=&quot;jLabel3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                          &lt;Component id=&quot;jLabel2&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;/Group&gt;
-                                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;40&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
-                                          &lt;Component id=&quot;StartPosCombo&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                                          &lt;Component id=&quot;GameEndCombo&quot; alignment=&quot;0&quot; pref=&quot;275&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                                      &lt;/Group&gt;
-                                  &lt;/Group&gt;
-                              &lt;/Group&gt;
-                              &lt;EmptySpace pref=&quot;441&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;/Group&gt;
+                          &lt;Component id=&quot;jScrollPane1&quot; alignment=&quot;0&quot; pref=&quot;842&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                              &lt;EmptySpace min=&quot;-2&quot; pref=&quot;240&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;Component id=&quot;HostButtonsPanel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;EmptySpace pref=&quot;624&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                           &lt;/Group&gt;
-                          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
-                                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                                      &lt;Component id=&quot;jLabel4&quot; linkSize=&quot;5&quot; min=&quot;-2&quot; pref=&quot;121&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;Component id=&quot;StartingMetalSlider&quot; linkSize=&quot;10&quot; pref=&quot;647&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;Component id=&quot;StartingMetalSpinner&quot; linkSize=&quot;9&quot; min=&quot;-2&quot; pref=&quot;64&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                                  &lt;/Group&gt;
-                                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
-                                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                          &lt;Component id=&quot;jLabel5&quot; linkSize=&quot;5&quot; alignment=&quot;0&quot; pref=&quot;121&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                                          &lt;Component id=&quot;jLabel6&quot; linkSize=&quot;5&quot; min=&quot;-2&quot; pref=&quot;121&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                                      &lt;/Group&gt;
-                                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
-                                          &lt;Component id=&quot;MaxUnitsSlider&quot; linkSize=&quot;10&quot; min=&quot;0&quot; pref=&quot;647&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                                          &lt;Component id=&quot;StartingEnergySlider&quot; linkSize=&quot;10&quot; alignment=&quot;0&quot; min=&quot;0&quot; pref=&quot;647&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                                      &lt;/Group&gt;
-                                      &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                          &lt;Component id=&quot;MaxUnitsSpinner&quot; linkSize=&quot;9&quot; alignment=&quot;0&quot; min=&quot;-2&quot; pref=&quot;64&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                          &lt;Component id=&quot;StartingEnergySpinner&quot; linkSize=&quot;9&quot; min=&quot;-2&quot; pref=&quot;64&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                                      &lt;/Group&gt;
-                                  &lt;/Group&gt;
-                              &lt;/Group&gt;
-                              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;/Group&gt;
                       &lt;/Group&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
@@ -746,173 +694,15 @@
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                   &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
                       &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;StartPosCombo&quot; alignment=&quot;3&quot; min=&quot;-2&quot; pref=&quot;23&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;jLabel2&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;/Group&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;GameEndCombo&quot; alignment=&quot;3&quot; min=&quot;-2&quot; pref=&quot;23&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;jLabel3&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;/Group&gt;
-                      &lt;EmptySpace type=&quot;unrelated&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;HostButtonsPanel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;45&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;DiminMMCheck&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;GhostedCheck&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;GameSpeedLockCheck&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;LimitDGunCheck&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace type=&quot;separate&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;StartingMetalSlider&quot; linkSize=&quot;8&quot; pref=&quot;23&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                          &lt;Component id=&quot;jLabel4&quot; linkSize=&quot;6&quot; alignment=&quot;0&quot; pref=&quot;23&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                          &lt;Component id=&quot;StartingMetalSpinner&quot; linkSize=&quot;8&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                      &lt;/Group&gt;
+                      &lt;Component id=&quot;jScrollPane1&quot; pref=&quot;447&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;StartingEnergySpinner&quot; linkSize=&quot;8&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                          &lt;Component id=&quot;StartingEnergySlider&quot; linkSize=&quot;8&quot; pref=&quot;23&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                          &lt;Component id=&quot;jLabel5&quot; linkSize=&quot;6&quot; alignment=&quot;1&quot; pref=&quot;23&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                      &lt;/Group&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;jLabel6&quot; linkSize=&quot;6&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                          &lt;Component id=&quot;MaxUnitsSpinner&quot; linkSize=&quot;8&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                          &lt;Component id=&quot;MaxUnitsSlider&quot; linkSize=&quot;8&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                      &lt;/Group&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;182&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
           &lt;/Layout&gt;
           &lt;SubComponents&gt;
-            &lt;Component class=&quot;javax.swing.JComboBox&quot; name=&quot;StartPosCombo&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;model&quot; type=&quot;javax.swing.ComboBoxModel&quot; editor=&quot;org.netbeans.modules.form.editors2.ComboBoxModelEditor&quot;&gt;
-                  &lt;StringArray count=&quot;3&quot;&gt;
-                    &lt;StringItem index=&quot;0&quot; value=&quot;Fixed&quot;/&gt;
-                    &lt;StringItem index=&quot;1&quot; value=&quot;Random&quot;/&gt;
-                    &lt;StringItem index=&quot;2&quot; value=&quot;Choose ingame&quot;/&gt;
-                  &lt;/StringArray&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;mousePressed&quot; listener=&quot;java.awt.event.MouseListener&quot; parameters=&quot;java.awt.event.MouseEvent&quot; handler=&quot;StartPosComboMousePressed&quot;/&gt;
-                &lt;EventHandler event=&quot;itemStateChanged&quot; listener=&quot;java.awt.event.ItemListener&quot; parameters=&quot;java.awt.event.ItemEvent&quot; handler=&quot;StartPosComboItemStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel2&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;font&quot; type=&quot;java.awt.Font&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;CUISettings.GetFont(12,false)&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;labelFor&quot; type=&quot;java.awt.Component&quot; editor=&quot;org.netbeans.modules.form.ComponentChooserEditor&quot;&gt;
-                  &lt;ComponentRef name=&quot;StartPosCombo&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.i18n.form.FormI18nStringEditor&quot;&gt;
-                  &lt;ResourceString bundle=&quot;aflobby/languages.properties&quot; key=&quot;CBattleWindow.Starting_Positions&quot; replaceFormat=&quot;java.util.ResourceBundle.getBundle(&quot;{bundleNameSlashes}&quot;).getString(&quot;{key}&quot;)&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel3&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;font&quot; type=&quot;java.awt.Font&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;CUISettings.GetFont(12,false)&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;labelFor&quot; type=&quot;java.awt.Component&quot; editor=&quot;org.netbeans.modules.form.ComponentChooserEditor&quot;&gt;
-                  &lt;ComponentRef name=&quot;GameEndCombo&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.i18n.form.FormI18nStringEditor&quot;&gt;
-                  &lt;ResourceString bundle=&quot;aflobby/languages.properties&quot; key=&quot;CBattleWindow.Game_End_Condition&quot; replaceFormat=&quot;java.util.ResourceBundle.getBundle(&quot;{bundleNameSlashes}&quot;).getString(&quot;{key}&quot;)&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JComboBox&quot; name=&quot;GameEndCombo&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;model&quot; type=&quot;javax.swing.ComboBoxModel&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;new javax.swing.DefaultComboBoxModel(new String[] { bundle.getString(&quot;CBattleWindow.Destroy_All&quot;), bundle.getString(&quot;CBattleWindow.Destroy_Commander&quot;), bundle.getString(&quot;CBattleWindow.Lineage&quot;)})&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;mousePressed&quot; listener=&quot;java.awt.event.MouseListener&quot; parameters=&quot;java.awt.event.MouseEvent&quot; handler=&quot;GameEndComboMousePressed&quot;/&gt;
-                &lt;EventHandler event=&quot;itemStateChanged&quot; listener=&quot;java.awt.event.ItemListener&quot; parameters=&quot;java.awt.event.ItemEvent&quot; handler=&quot;GameEndComboItemStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JCheckBox&quot; name=&quot;DiminMMCheck&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.i18n.form.FormI18nStringEditor&quot;&gt;
-                  &lt;ResourceString bundle=&quot;aflobby/languages.properties&quot; key=&quot;CBattleWindow.Diminishing_Metal_Maker_Returns&quot; replaceFormat=&quot;java.util.ResourceBundle.getBundle(&quot;{bundleNameSlashes}&quot;).getString(&quot;{key}&quot;)&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
-                  &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.EmptyBorderInfo&quot;&gt;
-                    &lt;EmptyBorder bottom=&quot;0&quot; left=&quot;0&quot; right=&quot;0&quot; top=&quot;0&quot;/&gt;
-                  &lt;/Border&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;margin&quot; type=&quot;java.awt.Insets&quot; editor=&quot;org.netbeans.beaninfo.editors.InsetsEditor&quot;&gt;
-                  &lt;Insets value=&quot;[0, 0, 0, 0]&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;DiminMMCheckStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JCheckBox&quot; name=&quot;GhostedCheck&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.i18n.form.FormI18nStringEditor&quot;&gt;
-                  &lt;ResourceString bundle=&quot;aflobby/languages.properties&quot; key=&quot;CBattleWindow.Ghosted_Buildings&quot; replaceFormat=&quot;java.util.ResourceBundle.getBundle(&quot;{bundleNameSlashes}&quot;).getString(&quot;{key}&quot;)&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
-                  &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.EmptyBorderInfo&quot;&gt;
-                    &lt;EmptyBorder bottom=&quot;0&quot; left=&quot;0&quot; right=&quot;0&quot; top=&quot;0&quot;/&gt;
-                  &lt;/Border&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;margin&quot; type=&quot;java.awt.Insets&quot; editor=&quot;org.netbeans.beaninfo.editors.InsetsEditor&quot;&gt;
-                  &lt;Insets value=&quot;[0, 0, 0, 0]&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;GhostedCheckStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JCheckBox&quot; name=&quot;GameSpeedLockCheck&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.i18n.form.FormI18nStringEditor&quot;&gt;
-                  &lt;ResourceString bundle=&quot;aflobby/languages.properties&quot; key=&quot;CBattleWindow.&quot; replaceFormat=&quot;java.util.ResourceBundle.getBundle(&quot;{bundleNameSlashes}&quot;).getString(&quot;{key}&quot;)&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
-                  &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.EmptyBorderInfo&quot;&gt;
-                    &lt;EmptyBorder bottom=&quot;0&quot; left=&quot;0&quot; right=&quot;0&quot; top=&quot;0&quot;/&gt;
-                  &lt;/Border&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;margin&quot; type=&quot;java.awt.Insets&quot; editor=&quot;org.netbeans.beaninfo.editors.InsetsEditor&quot;&gt;
-                  &lt;Insets value=&quot;[0, 0, 0, 0]&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;GameSpeedLockCheckStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JCheckBox&quot; name=&quot;LimitDGunCheck&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.i18n.form.FormI18nStringEditor&quot;&gt;
-                  &lt;ResourceString bundle=&quot;aflobby/languages.properties&quot; key=&quot;CBattleWindow.Limit_DGun_To_Start_Pos&quot; replaceFormat=&quot;java.util.ResourceBundle.getBundle(&quot;{bundleNameSlashes}&quot;).getString(&quot;{key}&quot;)&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
-                  &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.EmptyBorderInfo&quot;&gt;
-                    &lt;EmptyBorder bottom=&quot;0&quot; left=&quot;0&quot; right=&quot;0&quot; top=&quot;0&quot;/&gt;
-                  &lt;/Border&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;margin&quot; type=&quot;java.awt.Insets&quot; editor=&quot;org.netbeans.beaninfo.editors.InsetsEditor&quot;&gt;
-                  &lt;Insets value=&quot;[0, 0, 0, 0]&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;LimitDGunCheckStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
             &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;HostButtonsPanel&quot;&gt;
               &lt;Properties&gt;
                 &lt;Property name=&quot;opaque&quot; type=&quot;boolean&quot; value=&quot;false&quot;/&gt;
@@ -926,7 +716,9 @@
                           &lt;Component id=&quot;jButton1&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Component id=&quot;jButton2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;EmptySpace pref=&quot;50&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;GameSpeedLockCheck&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;EmptySpace pref=&quot;70&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
                   &lt;/Group&gt;
                 &lt;/DimensionLayout&gt;
@@ -937,6 +729,7 @@
                           &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
                               &lt;Component id=&quot;jButton1&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;Component id=&quot;jButton2&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;GameSpeedLockCheck&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;/Group&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
@@ -960,95 +753,42 @@
                     &lt;EventHandler event=&quot;actionPerformed&quot; listener=&quot;java.awt.event.ActionListener&quot; parameters=&quot;java.awt.event.ActionEvent&quot; handler=&quot;jButton2ActionPerformed&quot;/&gt;
                   &lt;/Events&gt;
                 &lt;/Component&gt;
+                &lt;Component class=&quot;javax.swing.JCheckBox&quot; name=&quot;GameSpeedLockCheck&quot;&gt;
+                  &lt;Properties&gt;
+                    &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.i18n.form.FormI18nStringEditor&quot;&gt;
+                      &lt;ResourceString bundle=&quot;aflobby/languages.properties&quot; key=&quot;CBattleWindow.&quot; replaceFormat=&quot;java.util.ResourceBundle.getBundle(&quot;{bundleNameSlashes}&quot;).getString(&quot;{key}&quot;)&quot;/&gt;
+                    &lt;/Property&gt;
+                    &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
+                      &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.EmptyBorderInfo&quot;&gt;
+                        &lt;EmptyBorder bottom=&quot;0&quot; left=&quot;0&quot; right=&quot;0&quot; top=&quot;0&quot;/&gt;
+                      &lt;/Border&gt;
+                    &lt;/Property&gt;
+                    &lt;Property name=&quot;margin&quot; type=&quot;java.awt.Insets&quot; editor=&quot;org.netbeans.beaninfo.editors.InsetsEditor&quot;&gt;
+                      &lt;Insets value=&quot;[0, 0, 0, 0]&quot;/&gt;
+                    &lt;/Property&gt;
+                  &lt;/Properties&gt;
+                  &lt;Events&gt;
+                    &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;GameSpeedLockCheckStateChanged&quot;/&gt;
+                  &lt;/Events&gt;
+                &lt;/Component&gt;
               &lt;/SubComponents&gt;
             &lt;/Container&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel4&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;labelFor&quot; type=&quot;java.awt.Component&quot; editor=&quot;org.netbeans.modules.form.ComponentChooserEditor&quot;&gt;
-                  &lt;ComponentRef name=&quot;StartingMetalSlider&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.i18n.form.FormI18nStringEditor&quot;&gt;
-                  &lt;ResourceString bundle=&quot;aflobby/languages.properties&quot; key=&quot;CBattleWindow.Starting_Metal&quot; replaceFormat=&quot;java.util.ResourceBundle.getBundle(&quot;{bundleNameSlashes}&quot;).getString(&quot;{key}&quot;)&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JSlider&quot; name=&quot;StartingMetalSlider&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;majorTickSpacing&quot; type=&quot;int&quot; value=&quot;500&quot;/&gt;
-                &lt;Property name=&quot;maximum&quot; type=&quot;int&quot; value=&quot;10000&quot;/&gt;
-                &lt;Property name=&quot;snapToTicks&quot; type=&quot;boolean&quot; value=&quot;true&quot;/&gt;
-                &lt;Property name=&quot;value&quot; type=&quot;int&quot; value=&quot;1000&quot;/&gt;
-                &lt;Property name=&quot;opaque&quot; type=&quot;boolean&quot; value=&quot;false&quot;/&gt;
-              &lt;/Properties&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;StartingMetalSliderStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JSpinner&quot; name=&quot;StartingMetalSpinner&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;value&quot; type=&quot;java.lang.Object&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;1000&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;StartingMetalSpinnerStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel5&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;labelFor&quot; type=&quot;java.awt.Component&quot; editor=&quot;org.netbeans.modules.form.ComponentChooserEditor&quot;&gt;
-                  &lt;ComponentRef name=&quot;StartingEnergySlider&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.i18n.form.FormI18nStringEditor&quot;&gt;
-                  &lt;ResourceString bundle=&quot;aflobby/languages.properties&quot; key=&quot;CBattleWindow.Starting_Energy&quot; replaceFormat=&quot;java.util.ResourceBundle.getBundle(&quot;{bundleNameSlashes}&quot;).getString(&quot;{key}&quot;)&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JSlider&quot; name=&quot;StartingEnergySlider&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;majorTickSpacing&quot; type=&quot;int&quot; value=&quot;500&quot;/&gt;
-                &lt;Property name=&quot;maximum&quot; type=&quot;int&quot; value=&quot;10000&quot;/&gt;
-                &lt;Property name=&quot;minorTickSpacing&quot; type=&quot;int&quot; value=&quot;500&quot;/&gt;
-                &lt;Property name=&quot;snapToTicks&quot; type=&quot;boolean&quot; value=&quot;true&quot;/&gt;
-                &lt;Property name=&quot;value&quot; type=&quot;int&quot; value=&quot;1000&quot;/&gt;
-                &lt;Property name=&quot;opaque&quot; type=&quot;boolean&quot; value=&quot;false&quot;/&gt;
-              &lt;/Properties&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;StartingEnergySliderStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JSpinner&quot; name=&quot;StartingEnergySpinner&quot;&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;StartingEnergySpinnerStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JSpinner&quot; name=&quot;MaxUnitsSpinner&quot;&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;MaxUnitsSpinnerStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JSlider&quot; name=&quot;MaxUnitsSlider&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;maximum&quot; type=&quot;int&quot; value=&quot;5000&quot;/&gt;
-                &lt;Property name=&quot;minorTickSpacing&quot; type=&quot;int&quot; value=&quot;100&quot;/&gt;
-                &lt;Property name=&quot;snapToTicks&quot; type=&quot;boolean&quot; value=&quot;true&quot;/&gt;
-                &lt;Property name=&quot;value&quot; type=&quot;int&quot; value=&quot;500&quot;/&gt;
-                &lt;Property name=&quot;opaque&quot; type=&quot;boolean&quot; value=&quot;false&quot;/&gt;
-              &lt;/Properties&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;MaxUnitsSliderStateChanged&quot;/&gt;
-              &lt;/Events&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel6&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;labelFor&quot; type=&quot;java.awt.Component&quot; editor=&quot;org.netbeans.modules.form.ComponentChooserEditor&quot;&gt;
-                  &lt;ComponentRef name=&quot;MaxUnitsSlider&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.i18n.form.FormI18nStringEditor&quot;&gt;
-                  &lt;ResourceString bundle=&quot;aflobby/languages.properties&quot; key=&quot;CBattleWindow.Max_Units&quot; replaceFormat=&quot;java.util.ResourceBundle.getBundle(&quot;{bundleNameSlashes}&quot;).getString(&quot;{key}&quot;)&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
+            &lt;Container class=&quot;javax.swing.JScrollPane&quot; name=&quot;jScrollPane1&quot;&gt;
+
+              &lt;Layout class=&quot;org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout&quot;/&gt;
+              &lt;SubComponents&gt;
+                &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;OptionsPanel&quot;&gt;
+
+                  &lt;Layout class=&quot;org.netbeans.modules.form.compat2.layouts.DesignBoxLayout&quot;&gt;
+                    &lt;Property name=&quot;axis&quot; type=&quot;int&quot; value=&quot;3&quot;/&gt;
+                  &lt;/Layout&gt;
+                  &lt;SubComponents&gt;
+                    &lt;Component class=&quot;javax.swing.JSeparator&quot; name=&quot;jSeparator2&quot;&gt;
+                    &lt;/Component&gt;
+                  &lt;/SubComponents&gt;
+                &lt;/Container&gt;
+              &lt;/SubComponents&gt;
+            &lt;/Container&gt;
           &lt;/SubComponents&gt;
         &lt;/Container&gt;
         &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;AITab&quot;&gt;
@@ -1551,28 +1291,28 @@
             &lt;DimensionLayout dim=&quot;0&quot;&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;jScrollPane12&quot; alignment=&quot;0&quot; pref=&quot;842&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Component id=&quot;jLabel8&quot; min=&quot;-2&quot; pref=&quot;529&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;EmptySpace pref=&quot;148&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;Component id=&quot;jButton4&quot; min=&quot;-2&quot; pref=&quot;165&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                          &lt;Component id=&quot;jScrollPane12&quot; alignment=&quot;1&quot; pref=&quot;842&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                              &lt;Component id=&quot;jLabel8&quot; pref=&quot;572&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;jButton4&quot; min=&quot;-2&quot; pref=&quot;266&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;/Group&gt;
                       &lt;/Group&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
             &lt;DimensionLayout dim=&quot;1&quot;&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jScrollPane12&quot; pref=&quot;464&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;jScrollPane12&quot; pref=&quot;419&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace type=&quot;unrelated&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;jButton4&quot; pref=&quot;68&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                          &lt;Component id=&quot;jLabel8&quot; alignment=&quot;1&quot; min=&quot;-2&quot; pref=&quot;68&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;Component id=&quot;jButton4&quot; min=&quot;-2&quot; pref=&quot;28&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;Component id=&quot;jLabel8&quot; min=&quot;-2&quot; pref=&quot;28&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                       &lt;/Group&gt;
                       &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
@@ -1596,9 +1336,7 @@
                     &lt;/Property&gt;
                     &lt;Property name=&quot;lineWrap&quot; type=&quot;boolean&quot; value=&quot;true&quot;/&gt;
                     &lt;Property name=&quot;rows&quot; type=&quot;int&quot; value=&quot;5&quot;/&gt;
-                    &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                      &lt;Connection code=&quot;GetScript()&quot; type=&quot;code&quot;/&gt;
-                    &lt;/Property&gt;
+                    &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Please press refresh below&quot;/&gt;
                     &lt;Property name=&quot;wrapStyleWord&quot; type=&quot;boolean&quot; value=&quot;true&quot;/&gt;
                   &lt;/Properties&gt;
                 &lt;/Component&gt;

Modified: trunk/Lobby/AFLobby/src/aflobby/CBattleWindow.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/CBattleWindow.java	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/CBattleWindow.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -6,15 +6,22 @@
 
 package aflobby;
 
+import aflobby.IGUIBattleModel;
 import aflobby.protocol.tasserver.RectHandler;
 import aflobby.protocol.tasserver.RectEntry;
 import aflobby.UI.CUISettings;
 import aflobby.UI.CUserSettings;
+import aflobby.UI.battle.CBooleanOptionsPanel;
+import aflobby.UI.battle.CListOptionsPanel;
+import aflobby.UI.battle.CSliderOptionsPanel;
+import aflobby.UI.battle.CStringOptionsPanel;
+import aflobby.UI.battle.ListItem;
 import aflobby.protocol.tasserver.TeamEntry;
 import aflobby.protocol.tasserver.TeamData;
 import aflobby.helpers.AlphanumComparator;
 import aflobby.framework.IModule;
 import java.awt.Color;
+import java.awt.Component;
 import java.awt.Graphics2D;
 import java.awt.Image;
 import java.awt.event.KeyEvent;
@@ -29,7 +36,6 @@
 import java.util.TreeMap;
 import java.util.concurrent.ExecutionException;
 import javax.swing.ImageIcon;
-import javax.swing.SpinnerNumberModel;
 import javax.swing.SwingUtilities;
 import javax.swing.SwingWorker;
 
@@ -74,6 +80,7 @@
     CVectorListModel RestrictedUnits = new CVectorListModel();
     public CStartRectangleDrawer startrect;
     
+    
     CBattlePlayerTableModel playertablemodel = null;
 
     /**
@@ -88,9 +95,16 @@
         playertablemodel = new CBattlePlayerTableModel(LM);
         
         
-        initComponents();
+        Runnable doWorkRunnable = new Runnable() {
+
+            public void run() {
+                initComponents();
+                Chat.LM = LM;
+            }
+        };
+        SwingUtilities.invokeLater(doWorkRunnable);
         
-        Chat.LM = L;
+        
         jbt = new CBattleTask(this);
         tjb = new Timer();
         
@@ -99,7 +113,7 @@
         cmdhandler = new CBattleCommandHandler(LM, this, LM.command_handler);
         //jas = new JAutoDownScroll (BattleMessages);
         //jast = new Timer ();
-        Runnable doWorkRunnable = new Runnable() {
+        Runnable doWorkRunnable2 = new Runnable() {
 
             public void run() {
                 Color c = sidepane.getBackground();
@@ -120,7 +134,7 @@
                 requestFocusInWindow();
             }
         };
-        SwingUtilities.invokeLater(doWorkRunnable);
+        SwingUtilities.invokeLater(doWorkRunnable2);
 
         //this.ColourWheel.getSelectionModel().addChangeListener(this);
     }
@@ -171,8 +185,85 @@
     
     public void JoinBattle(CBattleInfo jinfo) {
         battlemodel = (IGUIBattleModel) LM.battleModel;
+        
         active = true;
         info = jinfo;
+        
+        final CBooleanOptionsPanel b = new CBooleanOptionsPanel(
+                battlemodel,
+                &quot;GAME/DiminishingMMs&quot;,
+                false,
+                &quot;Diminishing metal maker returns&quot;,
+                &quot; As you build more&quot; +
+                &quot; metalmakers, their metal output drops. Metal maker&quot; +
+                &quot; efficiency drops over time as a result as more &quot; +
+                &quot;metalmakers are built.&quot;,
+                false
+                );
+        final CBooleanOptionsPanel b2 = new CBooleanOptionsPanel(
+                battlemodel,
+                &quot;GAME/LimitDGun&quot;,
+                false,
+                &quot;Limited Dgun range&quot;,
+                &quot;Limits the dgunning to within a certain radius around your&quot; +
+                &quot; starting position to prevent offensive commander pushes.&quot;,
+                false
+                );
+        final CBooleanOptionsPanel b3 = new CBooleanOptionsPanel(
+                battlemodel,
+                &quot;GAME/GhostedBuildings&quot;,
+                true,
+                &quot;Ghosted Buildings&quot;,
+                &quot;When an enemy building goes out of view, a ghost appears&quot; +
+                &quot; showing its location and unit type afterwards.&quot;,
+                false
+                );
+        LM.core.AddModule(b);
+        LM.core.AddModule(b2);
+        LM.core.AddModule(b3);
+        
+        final CSliderOptionsPanel sp1 = new CSliderOptionsPanel(
+                battlemodel,
+                &quot;GAME/StartEnergy&quot;,
+                1000,
+                500,
+                10000,
+                500,
+                &quot;Initial Starting Energy&quot;,
+                &quot;The amount of energy given to your commander at the start of&quot; +
+                &quot; the game to build things with.&quot;,
+                false
+                );
+        
+        final CSliderOptionsPanel sp2 = new CSliderOptionsPanel(
+                battlemodel,
+                &quot;GAME/StartMetal&quot;,
+                1000,
+                500,
+                10000,
+                500,
+                &quot;Initial Starting Metal&quot;,
+                &quot;The amount of metal given to your commander at the start of&quot; +
+                &quot; the game to build things with.&quot;,
+                false
+                );
+        
+        final CSliderOptionsPanel sp3 = new CSliderOptionsPanel(
+                battlemodel,
+                &quot;GAME/MaxUnits&quot;,
+                1000,
+                500,
+                10000,
+                500,
+                &quot;Unit Limit&quot;,
+                &quot;The maximum number of units that can be built in a single&quot; +
+                &quot; game.&quot;,
+                false
+                );
+        
+        LM.core.AddModule(sp1);
+        LM.core.AddModule(sp2);
+        LM.core.AddModule(sp3);
 
         CSync.SetWorkingMod(info.GetMod());
         for (String s : info.GetPlayerNames()) {
@@ -235,6 +326,16 @@
                     //
                     SetupLadderControls();
                 }
+                
+                
+                OptionsPanel.add(b);
+                OptionsPanel.add(b2);
+                OptionsPanel.add(b3);
+                
+                OptionsPanel.add(sp1);
+                OptionsPanel.add(sp2);
+                OptionsPanel.add(sp3);
+                
             }
         };
         SwingUtilities.invokeLater(doWorkRunnable);
@@ -270,7 +371,7 @@
         MyAllyTeamCombo.removeAllItems();
         MyAllyTeamCombo.addItem(&quot;Ally Team 1&quot;);
         MyAllyTeamCombo.addItem(&quot;Ally Team 2&quot;);
-        if(lp.startpos != -1){
+        /*if(lp.startpos != -1){
             StartPosCombo.setSelectedIndex(lp.startpos);
             StartPosCombo.setEnabled(false);
         }
@@ -318,8 +419,8 @@
             //MaxUnitsSlider.setEnabled(false);
         }
         MaxUnitsSpinner.setModel(new SpinnerNumberModel(Math.max(min, 500),min,max,500));
-
-        if(lp.dgun != -1){
+*/
+        /*if(lp.dgun != -1){
             LimitDGunCheck.setSelected(lp.dgun == 1);
             LimitDGunCheck.setEnabled(false);
         }
@@ -330,7 +431,7 @@
         if(lp.ghost != -1){
             GhostedCheck.setSelected(lp.ghost == 1);
             GhostedCheck.setEnabled(false);
-        }
+        }*/
     }
     
     public void LeaveBattle() {
@@ -364,8 +465,258 @@
         battlemodel = (IGUIBattleModel) LM.battleModel;
         active = true;
         info = jinfo;
+        final ArrayList&lt;Object&gt; options = new ArrayList&lt;Object&gt;();
+        
+        final CBooleanOptionsPanel b1 = new CBooleanOptionsPanel(
+                battlemodel,
+                &quot;GAME/DiminishingMMs&quot;,
+                false,
+                &quot;Diminishing metal maker returns&quot;,
+                &quot; As you build more&quot; +
+                &quot; metalmakers, their metal output drops. Metal maker&quot; +
+                &quot; efficiency drops over time as a result as more &quot; +
+                &quot;metalmakers are built.&quot;,
+                false
+                );
+        final CBooleanOptionsPanel b2 = new CBooleanOptionsPanel(
+                battlemodel,
+                &quot;GAME/LimitDGun&quot;,
+                false,
+                &quot;Limited Dgun range&quot;,
+                &quot;Limits the dgunning to within a certain radius around your&quot; +
+                &quot; starting position to prevent offensive commander pushes.&quot;,
+                false
+                );
+        final CBooleanOptionsPanel b3 = new CBooleanOptionsPanel(
+                battlemodel,
+                &quot;GAME/GhostedBuildings&quot;,
+                true,
+                &quot;Ghosted Buildings&quot;,
+                &quot;When an enemy building goes out of view, a ghost appears&quot; +
+                &quot; showing its location and unit type afterwards.&quot;,
+                false
+                );
+        options.add(b1);
+        options.add(b2);
+        options.add(b3);
+        
+        final CSliderOptionsPanel sp1 = new CSliderOptionsPanel(
+                battlemodel,
+                &quot;GAME/StartEnergy&quot;,
+                1000,
+                500,
+                10000,
+                500,
+                &quot;Initial Starting Energy&quot;,
+                &quot;The amount of energy given to your commander at the start of&quot; +
+                &quot; the game to build things with.&quot;,
+                false
+                );
+        
+        final CSliderOptionsPanel sp2 = new CSliderOptionsPanel(
+                battlemodel,
+                &quot;GAME/StartMetal&quot;,
+                1000,
+                500,
+                10000,
+                500,
+                &quot;Initial Starting Metal&quot;,
+                &quot;The amount of metal given to your commander at the start of&quot; +
+                &quot; the game to build things with.&quot;,
+                false
+                );
+        
+        final CSliderOptionsPanel sp3 = new CSliderOptionsPanel(
+                battlemodel,
+                &quot;GAME/MaxUnits&quot;,
+                1000,
+                500,
+                10000,
+                500,
+                &quot;Unit Limit&quot;,
+                &quot;The maximum number of units that can be built in a single&quot; +
+                &quot; game.&quot;,
+                false
+                );
+        
+        options.add(sp1);
+        options.add(sp2);
+        options.add(sp3);
+        
+        {
+            ArrayList&lt;ListItem&gt; items =
+                    new ArrayList&lt;ListItem&gt;();
+            
+            ListItem y = new ListItem();
+            y.key = &quot;0&quot;;
+            y.name = &quot;Destroy All&quot;;
+            y.description = &quot;Annihilate all enemy units to win.&quot;;
+            
+            items.add(y);
+            
+            ListItem y1 = new ListItem();
+            y1.key = &quot;1&quot;;
+            y1.name = &quot;Commander Ends&quot;;
+            y1.description = &quot;A deathmatch where players kill eachother off by&quot; +
+                    &quot; destroying their commanders.. Loosing your commander&quot; +
+                    &quot; looses you the game.&quot;;
+            
+            items.add(y1);
+            
+            ListItem y2 = new ListItem();
+            y2.key = &quot;1&quot;;
+            y2.name = &quot;Lineage&quot;;
+            y2.description = &quot;Loosing your commander&quot; +
+                    &quot; looses you the game. The difference here is that when&quot; +
+                    &quot; your stuff dies so does everything you gave to your&quot; +
+                    &quot; allies, and anything built with those shared units.&quot;;
+            
+            items.add(y2);
+            
+            
+            final CListOptionsPanel lo = new CListOptionsPanel(
+                    battlemodel,
+                    &quot;GAME/GameMode&quot;,
+                    &quot;0&quot;,
+                    items,
+                    &quot;Victory Condition&quot;,
+                    &quot;Determines how the game is to be won.&quot;,
+                    false
+                    );
+            options.add(lo);
+        }
+        
+        {
+            ArrayList&lt;ListItem&gt; items =
+                    new ArrayList&lt;ListItem&gt;();
+            
+            ListItem y = new ListItem();
+            y.key = &quot;0&quot;;
+            y.name = &quot;Fixed&quot;;
+            y.description = &quot;Places players at predefined starting positions&quot; +
+                    &quot; based on their ordering.&quot;;
+            
+            items.add(y);
+            
+            ListItem y1 = new ListItem();
+            y1.key = &quot;1&quot;;
+            y1.name = &quot;Random&quot;;
+            y1.description = &quot;Randomly places you on a predefined start &quot; +
+                    &quot;position.&quot;;
+            
+            items.add(y1);
+            
+            ListItem y2 = new ListItem();
+            y2.key = &quot;2&quot;;
+            y2.name = &quot;Choose Ingame&quot;;
+            y2.description = &quot;When ingame you can choose where on the map you&quot; +
+                    &quot; want to start by placing markers. This can be confine to&quot; +
+                    &quot; a startign rectangle/box&quot;;
+            
+            items.add(y2);
+            
+            
+            final CListOptionsPanel lo = new CListOptionsPanel(
+                    battlemodel,
+                    &quot;GAME/StartPosType&quot;,
+                    &quot;0&quot;,
+                    items,
+                    &quot;Starting Positions&quot;,
+                    &quot;Determines where and how on the map your units start the game.&quot;,
+                    false
+                    );
+            options.add(lo);
+        }
+        
 
         CSync.SetWorkingMod(info.GetMod());
+        
+        int modoptioncount = CUnitSyncJNIBindings.GetModOptionCount();
+        for(int i = 0; i &lt; modoptioncount; i++){
+            int type = CUnitSyncJNIBindings.GetOptionType(i);
+            String key = &quot;game/modoptions/&quot;+CUnitSyncJNIBindings.GetOptionKey(i);
+            String description = CUnitSyncJNIBindings.GetOptionDesc(i);
+            String name = CUnitSyncJNIBindings.GetOptionName(i);
+            if(type == OptionType.opt_bool){
+                //
+                boolean defValue = CUnitSyncJNIBindings.GetOptionBoolDef(i) == 1;
+                final CBooleanOptionsPanel o = new CBooleanOptionsPanel(
+                    battlemodel,
+                    key,
+                    defValue,
+                    name,
+                    description,
+                    false);
+                options.add(o);
+            } else if (type == OptionType.opt_list){
+                ArrayList&lt;ListItem&gt; items  = new ArrayList&lt;ListItem&gt;();
+                
+                int listoptcount = CUnitSyncJNIBindings.GetOptionListCount(i);
+                for(int n = 0; n &lt; listoptcount; n++){
+                    //
+                    ListItem lim = new ListItem();
+                    lim.key = CUnitSyncJNIBindings.GetOptionListItemKey(i, n);
+                    lim.name = CUnitSyncJNIBindings.GetOptionListItemName(i, n);
+                    lim.description = CUnitSyncJNIBindings.GetOptionListItemDesc(i, n);
+                    
+                    items.add(lim);
+                }
+                
+                String defValue = CUnitSyncJNIBindings.GetOptionListDef(i);
+                
+                CListOptionsPanel o = new CListOptionsPanel(
+                        battlemodel,
+                        key,
+                        defValue,
+                        items,
+                        name,
+                        description,
+                        false
+                        );
+                
+                options.add(o);
+                
+            } else if (type == OptionType.opt_number){
+                //
+                int defValue = (int) CUnitSyncJNIBindings.GetOptionNumberDef(i);
+                int min = (int) CUnitSyncJNIBindings.GetOptionNumberMin(i);
+                int max = (int) CUnitSyncJNIBindings.GetOptionNumberMax(i);
+                int step = (int) CUnitSyncJNIBindings.GetOptionNumberMin(i);
+                CSliderOptionsPanel o = new CSliderOptionsPanel(
+                    battlemodel,
+                    key,
+                    defValue,
+                    min,
+                    max,
+                    step,
+                    name,
+                    description,
+                    false
+                    );
+                
+                options.add(o);
+            } else if (type == OptionType.opt_string){
+                //
+                String defValue = CUnitSyncJNIBindings.GetOptionStringDef(i);
+                int maxlength = CUnitSyncJNIBindings.GetOptionStringMaxLen(i);
+                CStringOptionsPanel o = new CStringOptionsPanel(
+                        battlemodel,
+                        key,
+                        defValue,
+                        maxlength,
+                        name,
+                        description,
+                        false
+                        );
+            } else if (type == OptionType.opt_error){
+                // bah
+            }
+        }
+        
+        for(Object i : options){
+            LM.core.AddModule((IModule)i);
+        }
+        
         String sk;
         
         if (Misc.isWindows()) {
@@ -410,6 +761,10 @@
                     //
                     SetupLadderControls();
                 }
+                
+                for(Object i : options){
+                    OptionsPanel.add((Component)i);
+                }
             }
         };
         
@@ -468,17 +823,17 @@
                 setVisible(true);
                 SetBattleTitle(info.GetDescription() + &quot;::&quot; + info.GetMod());
                 LockToggle.setEnabled(host);
-                StartingEnergySlider.setEnabled(host);
+                /*StartingEnergySlider.setEnabled(host);
                 StartingEnergySpinner.setEnabled(host);
                 StartingMetalSlider.setEnabled(host);
                 StartingMetalSpinner.setEnabled(host);
                 MaxUnitsSlider.setEnabled(host);
-                MaxUnitsSpinner.setEnabled(host);
-                StartPosCombo.setEnabled(host);
-                GameEndCombo.setEnabled(host);
-                LimitDGunCheck.setEnabled(host);
-                DiminMMCheck.setEnabled(host);
-                GhostedCheck.setEnabled(host);
+                MaxUnitsSpinner.setEnabled(host);*/
+                //StartPosCombo.setEnabled(host);
+                //GameEndCombo.setEnabled(host);
+                //LimitDGunCheck.setEnabled(host);
+                //DiminMMCheck.setEnabled(host);
+                //GhostedCheck.setEnabled(host);
                 GameStartButton.setEnabled(host);
                 UnRestrictAllUnitsButton.setEnabled(host);
                 UnRestrictUnitButton.setEnabled(host);
@@ -499,24 +854,24 @@
             me.setSpectator(false); //mybattlestatus = Misc.setModeOfBattleStatus (mybattlestatus,1);
             me.setReady(false); //mybattlestatus = Misc.setReadyStatusOfBattleStatus (mybattlestatus,0);
         }
-        Runnable doWorkRunnable = new Runnable() {
+        /*Runnable doWorkRunnable = new Runnable() {
 
             public void run() {
 
-                StartingEnergySlider.getModel().setValue(info.energy);
+                /*StartingEnergySlider.getModel().setValue(info.energy);
                 StartingEnergySpinner.getModel().setValue(info.energy);
                 StartingMetalSlider.getModel().setValue(info.metal);
                 StartingMetalSpinner.getModel().setValue(info.metal);
                 MaxUnitsSlider.getModel().setValue(info.maxunits);
-                MaxUnitsSpinner.getModel().setValue(info.maxunits);
-                StartPosCombo.setSelectedIndex(i.startPos);
-                GameEndCombo.setSelectedIndex(i.gameEndCondition);
-                LimitDGunCheck.setSelected(info.limitDGun);
-                DiminMMCheck.setSelected(info.diminishingMMs);
-                GhostedCheck.setSelected(info.ghostedBuildings);
-            }
+                MaxUnitsSpinner.getModel().setValue(info.maxunits);*/
+                //StartPosCombo.setSelectedIndex(i.startPos);
+                //GameEndCombo.setSelectedIndex(i.gameEndCondition);
+                //LimitDGunCheck.setSelected(info.limitDGun);
+                //DiminMMCheck.setSelected(info.diminishingMMs);
+                //GhostedCheck.setSelected(info.ghostedBuildings);
+            /*}
         };
-        SwingUtilities.invokeLater(doWorkRunnable);
+        SwingUtilities.invokeLater(doWorkRunnable);*/
     }
 
     public int GetSpectatorCount() {
@@ -535,7 +890,7 @@
         battlemodel.GetMe().setColor(c); //mycolour = c;
     }
 
-    public void setStartingMetal(final int m) {
+    /*public void setStartingMetal(final int m) {
         info.metal = m;
         Runnable doWorkRunnable = new Runnable() {
 
@@ -569,9 +924,9 @@
             }
         };
         SwingUtilities.invokeLater(doWorkRunnable);
-    }
+    }*/
 
-    public void setStartPosType(final int s) {
+    /*public void setStartPosType(final int s) {
         info.startPos = s;
         Runnable doWorkRunnable = new Runnable() {
 
@@ -624,7 +979,7 @@
             }
         };
         SwingUtilities.invokeLater(doWorkRunnable);
-    }
+    }*/
 
     int BooltoInt(boolean b) {
         if (b == true) {
@@ -846,11 +1201,11 @@
                 //GroupData(Orderedplayers);
                 s = &quot;[GAME]\n&quot; + &quot;{\n&quot;;
                 s += &quot;\tMapname=&quot; + info.GetMap() + &quot;;\n&quot;;
-                s += &quot;\tStartMetal=&quot; + info.metal + &quot;;\n&quot;;
-                s += &quot;\tStartEnergy=&quot; + info.energy + &quot;;\n&quot;;
-                s += &quot;\tMaxUnits=&quot; + info.maxunits + &quot;;\n&quot;;
-                s += &quot;\tStartPosType=&quot; + info.startPos + &quot;;\n&quot;;
-                s += &quot;\tGameMode=&quot; + info.gameEndCondition + &quot;;\n&quot;;
+                //s += &quot;\tStartMetal=&quot; + info.metal + &quot;;\n&quot;;
+                //s += &quot;\tStartEnergy=&quot; + info.energy + &quot;;\n&quot;;
+                //s += &quot;\tMaxUnits=&quot; + info.maxunits + &quot;;\n&quot;;
+                //s += &quot;\tStartPosType=&quot; + info.startPos + &quot;;\n&quot;;
+
                 String m = info.GetMod();
                 if(m == null){
                     throw new NullPointerException();
@@ -863,9 +1218,9 @@
                 }
                 
                 s += &quot;\tGameType=&quot; + an + &quot;;\n&quot;;
-                s += &quot;\tLimitDGun=&quot; + BooltoInt(info.limitDGun) + &quot;;\n&quot;;
-                s += &quot;\tDiminishingMMs=&quot; + BooltoInt(info.diminishingMMs) + &quot;;\n&quot;;
-                s += &quot;\tGhostedBuildings=&quot; + BooltoInt(info.ghostedBuildings) + &quot;;\n\n&quot;;
+                //s += &quot;\tLimitDGun=&quot; + BooltoInt(info.limitDGun) + &quot;;\n&quot;;
+                //s += &quot;\tDiminishingMMs=&quot; + BooltoInt(info.diminishingMMs) + &quot;;\n&quot;;
+                //s += &quot;\tGhostedBuildings=&quot; + BooltoInt(info.ghostedBuildings) + &quot;;\n\n&quot;;
                 //+/**/&quot;
                 
                 if (this.info.GetHost().equalsIgnoreCase(LM.protocol.GetUsername())) {
@@ -897,13 +1252,22 @@
                     } else if(k.startsWith(&quot;game/&quot;)){
                         //
                         generalOptions.put(k.substring(5), options.get(k2));
+                    } else {
+                        generalOptions.put(k+&quot;erm&quot;, options.get(k2));
                     }
                 }
                 
                 if(!generalOptions.isEmpty()){
                     //
                     for(String k : generalOptions.keySet()){
-                        s += &quot;\t&quot; + k + &quot;=&quot; + generalOptions.get(k) + &quot;;\n&quot;;
+                        Object v = generalOptions.get(k);
+                        String value = &quot;&quot;;
+                        if((v.getClass() == boolean.class)||(v.getClass() == Boolean.class)){
+                            value = &quot;&quot;+((v.toString().equals(&quot;true&quot;))? 1 : 0);
+                        }else{
+                            value = v.toString();
+                        }
+                        s += &quot;\t&quot; + k + &quot;=&quot; + value + &quot;;\n&quot;;
                     }
                 }
                 
@@ -1167,26 +1531,13 @@
         reload_maplist = new javax.swing.JButton();
         MapPickerLabel = new javax.swing.JLabel();
         jPanel6 = new javax.swing.JPanel();
-        StartPosCombo = new javax.swing.JComboBox();
-        jLabel2 = new javax.swing.JLabel();
-        jLabel3 = new javax.swing.JLabel();
-        GameEndCombo = new javax.swing.JComboBox();
-        DiminMMCheck = new javax.swing.JCheckBox();
-        GhostedCheck = new javax.swing.JCheckBox();
-        GameSpeedLockCheck = new javax.swing.JCheckBox();
-        LimitDGunCheck = new javax.swing.JCheckBox();
         HostButtonsPanel = new javax.swing.JPanel();
         jButton1 = new javax.swing.JButton();
         jButton2 = new javax.swing.JButton();
-        jLabel4 = new javax.swing.JLabel();
-        StartingMetalSlider = new javax.swing.JSlider();
-        StartingMetalSpinner = new javax.swing.JSpinner();
-        jLabel5 = new javax.swing.JLabel();
-        StartingEnergySlider = new javax.swing.JSlider();
-        StartingEnergySpinner = new javax.swing.JSpinner();
-        MaxUnitsSpinner = new javax.swing.JSpinner();
-        MaxUnitsSlider = new javax.swing.JSlider();
-        jLabel6 = new javax.swing.JLabel();
+        GameSpeedLockCheck = new javax.swing.JCheckBox();
+        jScrollPane1 = new javax.swing.JScrollPane();
+        OptionsPanel = new javax.swing.JPanel();
+        jSeparator2 = new javax.swing.JSeparator();
         AITab = new javax.swing.JPanel();
         AICombo = new javax.swing.JComboBox();
         AddAIButton = new javax.swing.JButton();
@@ -1464,7 +1815,7 @@
         ColourPanel.setLayout(ColourPanelLayout);
         ColourPanelLayout.setHorizontalGroup(
             ColourPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-            .addGap(0, 439, Short.MAX_VALUE)
+            .addGap(0, 608, Short.MAX_VALUE)
         );
         ColourPanelLayout.setVerticalGroup(
             ColourPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
@@ -1477,17 +1828,15 @@
             TeamTabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(TeamTabLayout.createSequentialGroup()
                 .addContainerGap()
-                .addGroup(TeamTabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
-                    .addGroup(TeamTabLayout.createSequentialGroup()
+                .addGroup(TeamTabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
+                    .addComponent(ColourPanel, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                    .addComponent(ColourButton, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, TeamTabLayout.createSequentialGroup()
                         .addComponent(MyTeamCombo, javax.swing.GroupLayout.PREFERRED_SIZE, 184, javax.swing.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                         .addComponent(MyAllyTeamCombo, javax.swing.GroupLayout.PREFERRED_SIZE, 230, javax.swing.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                        .addComponent(RaceCombo, javax.swing.GroupLayout.PREFERRED_SIZE, 184, javax.swing.GroupLayout.PREFERRED_SIZE))
-                    .addGroup(TeamTabLayout.createSequentialGroup()
-                        .addComponent(ColourButton, javax.swing.GroupLayout.PREFERRED_SIZE, 163, javax.swing.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                        .addComponent(ColourPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
+                        .addComponent(RaceCombo, javax.swing.GroupLayout.PREFERRED_SIZE, 184, javax.swing.GroupLayout.PREFERRED_SIZE)))
                 .addContainerGap(242, Short.MAX_VALUE))
         );
         TeamTabLayout.setVerticalGroup(
@@ -1499,10 +1848,10 @@
                     .addComponent(MyTeamCombo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                     .addComponent(RaceCombo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                .addGroup(TeamTabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-                    .addComponent(ColourPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                    .addComponent(ColourButton))
-                .addContainerGap(433, Short.MAX_VALUE))
+                .addComponent(ColourButton)
+                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                .addComponent(ColourPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                .addGap(382, 382, 382))
         );
 
         TeamTabLayout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {MyAllyTeamCombo, MyTeamCombo, RaceCombo});
@@ -1574,56 +1923,22 @@
 
         GameOptionsPane.addTab(&quot;Maps&quot;, MapTab);
 
-        StartPosCombo.setModel(new javax.swing.DefaultComboBoxModel(new String[] { &quot;Fixed&quot;, &quot;Random&quot;, &quot;Choose ingame&quot; }));
-        StartPosCombo.addMouseListener(new java.awt.event.MouseAdapter() {
-            public void mousePressed(java.awt.event.MouseEvent evt) {
-                StartPosComboMousePressed(evt);
-            }
-        });
-        StartPosCombo.addItemListener(new java.awt.event.ItemListener() {
-            public void itemStateChanged(java.awt.event.ItemEvent evt) {
-                StartPosComboItemStateChanged(evt);
-            }
-        });
+        HostButtonsPanel.setOpaque(false);
 
-        jLabel2.setFont(CUISettings.GetFont(12,false));
-        jLabel2.setLabelFor(StartPosCombo);
-        jLabel2.setText(bundle.getString(&quot;CBattleWindow.Starting_Positions&quot;)); // NOI18N
-
-        jLabel3.setFont(CUISettings.GetFont(12,false));
-        jLabel3.setLabelFor(GameEndCombo);
-        jLabel3.setText(bundle.getString(&quot;CBattleWindow.Game_End_Condition&quot;)); // NOI18N
-
-        GameEndCombo.setModel(new javax.swing.DefaultComboBoxModel(new String[] { bundle.getString(&quot;CBattleWindow.Destroy_All&quot;), bundle.getString(&quot;CBattleWindow.Destroy_Commander&quot;), bundle.getString(&quot;CBattleWindow.Lineage&quot;)}));
-        GameEndCombo.addMouseListener(new java.awt.event.MouseAdapter() {
-            public void mousePressed(java.awt.event.MouseEvent evt) {
-                GameEndComboMousePressed(evt);
+        jButton1.setText(&quot;Fix Teams&quot;);
+        jButton1.addActionListener(new java.awt.event.ActionListener() {
+            public void actionPerformed(java.awt.event.ActionEvent evt) {
+                jButton1ActionPerformed(evt);
             }
         });
-        GameEndCombo.addItemListener(new java.awt.event.ItemListener() {
-            public void itemStateChanged(java.awt.event.ItemEvent evt) {
-                GameEndComboItemStateChanged(evt);
-            }
-        });
 
-        DiminMMCheck.setText(bundle.getString(&quot;CBattleWindow.Diminishing_Metal_Maker_Returns&quot;)); // NOI18N
-        DiminMMCheck.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
-        DiminMMCheck.setMargin(new java.awt.Insets(0, 0, 0, 0));
-        DiminMMCheck.addChangeListener(new javax.swing.event.ChangeListener() {
-            public void stateChanged(javax.swing.event.ChangeEvent evt) {
-                DiminMMCheckStateChanged(evt);
+        jButton2.setText(&quot;Force FFA&quot;);
+        jButton2.addActionListener(new java.awt.event.ActionListener() {
+            public void actionPerformed(java.awt.event.ActionEvent evt) {
+                jButton2ActionPerformed(evt);
             }
         });
 
-        GhostedCheck.setText(bundle.getString(&quot;CBattleWindow.Ghosted_Buildings&quot;)); // NOI18N
-        GhostedCheck.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
-        GhostedCheck.setMargin(new java.awt.Insets(0, 0, 0, 0));
-        GhostedCheck.addChangeListener(new javax.swing.event.ChangeListener() {
-            public void stateChanged(javax.swing.event.ChangeEvent evt) {
-                GhostedCheckStateChanged(evt);
-            }
-        });
-
         GameSpeedLockCheck.setText(bundle.getString(&quot;CBattleWindow.&quot;)); // NOI18N
         GameSpeedLockCheck.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
         GameSpeedLockCheck.setMargin(new java.awt.Insets(0, 0, 0, 0));
@@ -1633,31 +1948,6 @@
             }
         });
 
-        LimitDGunCheck.setText(bundle.getString(&quot;CBattleWindow.Limit_DGun_To_Start_Pos&quot;)); // NOI18N
-        LimitDGunCheck.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
-        LimitDGunCheck.setMargin(new java.awt.Insets(0, 0, 0, 0));
-        LimitDGunCheck.addChangeListener(new javax.swing.event.ChangeListener() {
-            public void stateChanged(javax.swing.event.ChangeEvent evt) {
-                LimitDGunCheckStateChanged(evt);
-            }
-        });
-
-        HostButtonsPanel.setOpaque(false);
-
-        jButton1.setText(&quot;Fix Teams&quot;);
-        jButton1.addActionListener(new java.awt.event.ActionListener() {
-            public void actionPerformed(java.awt.event.ActionEvent evt) {
-                jButton1ActionPerformed(evt);
-            }
-        });
-
-        jButton2.setText(&quot;Force FFA&quot;);
-        jButton2.addActionListener(new java.awt.event.ActionListener() {
-            public void actionPerformed(java.awt.event.ActionEvent evt) {
-                jButton2ActionPerformed(evt);
-            }
-        });
-
         javax.swing.GroupLayout HostButtonsPanelLayout = new javax.swing.GroupLayout(HostButtonsPanel);
         HostButtonsPanel.setLayout(HostButtonsPanelLayout);
         HostButtonsPanelLayout.setHorizontalGroup(
@@ -1667,7 +1957,9 @@
                 .addComponent(jButton1)
                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                 .addComponent(jButton2)
-                .addContainerGap(50, Short.MAX_VALUE))
+                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                .addComponent(GameSpeedLockCheck)
+                .addContainerGap(70, Short.MAX_VALUE))
         );
         HostButtonsPanelLayout.setVerticalGroup(
             HostButtonsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
@@ -1675,72 +1967,16 @@
                 .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .addGroup(HostButtonsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                     .addComponent(jButton1)
-                    .addComponent(jButton2))
+                    .addComponent(jButton2)
+                    .addComponent(GameSpeedLockCheck))
                 .addContainerGap())
         );
 
-        jLabel4.setLabelFor(StartingMetalSlider);
-        jLabel4.setText(bundle.getString(&quot;CBattleWindow.Starting_Metal&quot;)); // NOI18N
+        OptionsPanel.setLayout(new javax.swing.BoxLayout(OptionsPanel, javax.swing.BoxLayout.PAGE_AXIS));
+        OptionsPanel.add(jSeparator2);
 
-        StartingMetalSlider.setMajorTickSpacing(500);
-        StartingMetalSlider.setMaximum(10000);
-        StartingMetalSlider.setSnapToTicks(true);
-        StartingMetalSlider.setValue(1000);
-        StartingMetalSlider.setOpaque(false);
-        StartingMetalSlider.addChangeListener(new javax.swing.event.ChangeListener() {
-            public void stateChanged(javax.swing.event.ChangeEvent evt) {
-                StartingMetalSliderStateChanged(evt);
-            }
-        });
+        jScrollPane1.setViewportView(OptionsPanel);
 
-        StartingMetalSpinner.setValue(1000);
-        StartingMetalSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
-            public void stateChanged(javax.swing.event.ChangeEvent evt) {
-                StartingMetalSpinnerStateChanged(evt);
-            }
-        });
-
-        jLabel5.setLabelFor(StartingEnergySlider);
-        jLabel5.setText(bundle.getString(&quot;CBattleWindow.Starting_Energy&quot;)); // NOI18N
-
-        StartingEnergySlider.setMajorTickSpacing(500);
-        StartingEnergySlider.setMaximum(10000);
-        StartingEnergySlider.setMinorTickSpacing(500);
-        StartingEnergySlider.setSnapToTicks(true);
-        StartingEnergySlider.setValue(1000);
-        StartingEnergySlider.setOpaque(false);
-        StartingEnergySlider.addChangeListener(new javax.swing.event.ChangeListener() {
-            public void stateChanged(javax.swing.event.ChangeEvent evt) {
-                StartingEnergySliderStateChanged(evt);
-            }
-        });
-
-        StartingEnergySpinner.addChangeListener(new javax.swing.event.ChangeListener() {
-            public void stateChanged(javax.swing.event.ChangeEvent evt) {
-                StartingEnergySpinnerStateChanged(evt);
-            }
-        });
-
-        MaxUnitsSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
-            public void stateChanged(javax.swing.event.ChangeEvent evt) {
-                MaxUnitsSpinnerStateChanged(evt);
-            }
-        });
-
-        MaxUnitsSlider.setMaximum(5000);
-        MaxUnitsSlider.setMinorTickSpacing(100);
-        MaxUnitsSlider.setSnapToTicks(true);
-        MaxUnitsSlider.setValue(500);
-        MaxUnitsSlider.setOpaque(false);
-        MaxUnitsSlider.addChangeListener(new javax.swing.event.ChangeListener() {
-            public void stateChanged(javax.swing.event.ChangeEvent evt) {
-                MaxUnitsSliderStateChanged(evt);
-            }
-        });
-
-        jLabel6.setLabelFor(MaxUnitsSlider);
-        jLabel6.setText(bundle.getString(&quot;CBattleWindow.Max_Units&quot;)); // NOI18N
-
         javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
         jPanel6.setLayout(jPanel6Layout);
         jPanel6Layout.setHorizontalGroup(
@@ -1748,97 +1984,22 @@
             .addGroup(jPanel6Layout.createSequentialGroup()
                 .addContainerGap()
                 .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
-                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
-                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
-                                .addComponent(LimitDGunCheck, javax.swing.GroupLayout.Alignment.LEADING)
-                                .addComponent(GameSpeedLockCheck, javax.swing.GroupLayout.Alignment.LEADING)
-                                .addComponent(GhostedCheck, javax.swing.GroupLayout.Alignment.LEADING)
-                                .addComponent(DiminMMCheck, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
-                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel6Layout.createSequentialGroup()
-                                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-                                    .addComponent(jLabel3)
-                                    .addComponent(jLabel2))
-                                .addGap(40, 40, 40)
-                                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
-                                    .addComponent(StartPosCombo, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                                    .addComponent(GameEndCombo, 0, 275, Short.MAX_VALUE))))
-                        .addContainerGap(441, Short.MAX_VALUE))
+                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 842, Short.MAX_VALUE)
                     .addGroup(jPanel6Layout.createSequentialGroup()
-                        .addComponent(HostButtonsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
-                        .addContainerGap(624, Short.MAX_VALUE))
-                    .addGroup(jPanel6Layout.createSequentialGroup()
-                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
-                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
-                                .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE)
-                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                                .addComponent(StartingMetalSlider, javax.swing.GroupLayout.DEFAULT_SIZE, 647, Short.MAX_VALUE)
-                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                                .addComponent(StartingMetalSpinner, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE))
-                            .addGroup(jPanel6Layout.createSequentialGroup()
-                                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-                                    .addComponent(jLabel5, javax.swing.GroupLayout.DEFAULT_SIZE, 121, Short.MAX_VALUE)
-                                    .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE))
-                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
-                                    .addComponent(MaxUnitsSlider, 0, 647, Short.MAX_VALUE)
-                                    .addComponent(StartingEnergySlider, javax.swing.GroupLayout.Alignment.LEADING, 0, 647, Short.MAX_VALUE))
-                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-                                    .addComponent(MaxUnitsSpinner, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
-                                    .addComponent(StartingEnergySpinner, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE))))
-                        .addContainerGap())))
+                        .addGap(240, 240, 240)
+                        .addComponent(HostButtonsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
+                .addContainerGap())
         );
-
-        jPanel6Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {jLabel4, jLabel5, jLabel6});
-
-        jPanel6Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {MaxUnitsSpinner, StartingEnergySpinner, StartingMetalSpinner});
-
-        jPanel6Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {MaxUnitsSlider, StartingEnergySlider, StartingMetalSlider});
-
         jPanel6Layout.setVerticalGroup(
             jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(jPanel6Layout.createSequentialGroup()
                 .addContainerGap()
-                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
-                    .addComponent(StartPosCombo, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
-                    .addComponent(jLabel2))
-                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
-                    .addComponent(GameEndCombo, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
-                    .addComponent(jLabel3))
-                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                 .addComponent(HostButtonsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
-                .addGap(45, 45, 45)
-                .addComponent(DiminMMCheck)
                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                .addComponent(GhostedCheck)
-                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                .addComponent(GameSpeedLockCheck)
-                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                .addComponent(LimitDGunCheck)
-                .addGap(18, 18, 18)
-                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-                    .addComponent(StartingMetalSlider, javax.swing.GroupLayout.DEFAULT_SIZE, 23, Short.MAX_VALUE)
-                    .addComponent(jLabel4, javax.swing.GroupLayout.DEFAULT_SIZE, 23, Short.MAX_VALUE)
-                    .addComponent(StartingMetalSpinner, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
-                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-                    .addComponent(StartingEnergySpinner, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
-                    .addComponent(StartingEnergySlider, javax.swing.GroupLayout.DEFAULT_SIZE, 23, Short.MAX_VALUE)
-                    .addComponent(jLabel5, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 23, Short.MAX_VALUE))
-                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
-                    .addComponent(jLabel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                    .addComponent(MaxUnitsSpinner)
-                    .addComponent(MaxUnitsSlider, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
-                .addGap(182, 182, 182))
+                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 447, Short.MAX_VALUE)
+                .addContainerGap())
         );
 
-        jPanel6Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {jLabel4, jLabel5, jLabel6});
-
-        jPanel6Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {MaxUnitsSlider, MaxUnitsSpinner, StartingEnergySlider, StartingEnergySpinner, StartingMetalSlider, StartingMetalSpinner});
-
         GameOptionsPane.addTab(&quot;Game Options&quot;, jPanel6);
 
         AddAIButton.setText(&quot;Add AI&quot;);
@@ -2128,7 +2289,7 @@
         ScriptPreview.setFont(new java.awt.Font(&quot;Arial&quot;, 0, 13));
         ScriptPreview.setLineWrap(true);
         ScriptPreview.setRows(5);
-        ScriptPreview.setText(GetScript());
+        ScriptPreview.setText(&quot;Please press refresh below&quot;);
         ScriptPreview.setWrapStyleWord(true);
         jScrollPane12.setViewportView(ScriptPreview);
 
@@ -2150,23 +2311,23 @@
             jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                 .addContainerGap()
-                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
-                    .addComponent(jScrollPane12, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 842, Short.MAX_VALUE)
-                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel2Layout.createSequentialGroup()
-                        .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 529, javax.swing.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 148, Short.MAX_VALUE)
-                        .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, 165, javax.swing.GroupLayout.PREFERRED_SIZE)))
+                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+                    .addComponent(jScrollPane12, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 842, Short.MAX_VALUE)
+                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
+                        .addComponent(jLabel8, javax.swing.GroupLayout.DEFAULT_SIZE, 572, Short.MAX_VALUE)
+                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                        .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, 266, javax.swing.GroupLayout.PREFERRED_SIZE)))
                 .addContainerGap())
         );
         jPanel2Layout.setVerticalGroup(
             jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                 .addContainerGap()
-                .addComponent(jScrollPane12, javax.swing.GroupLayout.DEFAULT_SIZE, 419, Short.MAX_VALUE)
-                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
+                .addComponent(jScrollPane12, javax.swing.GroupLayout.DEFAULT_SIZE, 464, Short.MAX_VALUE)
+                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                 .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
-                    .addComponent(jButton4, javax.swing.GroupLayout.DEFAULT_SIZE, 68, Short.MAX_VALUE)
-                    .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 68, javax.swing.GroupLayout.PREFERRED_SIZE))
+                    .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
+                    .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                 .addContainerGap())
         );
 
@@ -2287,13 +2448,6 @@
     }
     }
     }*/
-    private void LimitDGunCheckStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_LimitDGunCheckStateChanged
-        if (battlemodel.AmIHost()) {
-            info.limitDGun = LimitDGunCheck.isSelected();
-            UpdateBattleClients();
-        }
-    }//GEN-LAST:event_LimitDGunCheckStateChanged
-
     private void GameSpeedLockCheckStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_GameSpeedLockCheckStateChanged
         if (battlemodel.AmIHost()) {
             //info. = GameSpeedLockCheck.isSelected();
@@ -2301,88 +2455,6 @@
         }
     }//GEN-LAST:event_GameSpeedLockCheckStateChanged
 
-    private void GhostedCheckStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_GhostedCheckStateChanged
-        if (battlemodel.AmIHost()) {
-            info.ghostedBuildings = GhostedCheck.isSelected();
-            UpdateBattleClients();
-        }
-    }//GEN-LAST:event_GhostedCheckStateChanged
-
-    private void DiminMMCheckStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_DiminMMCheckStateChanged
-        if (battlemodel.AmIHost()) {
-            info.diminishingMMs = DiminMMCheck.isSelected();
-            UpdateBattleClients();
-        }
-    }//GEN-LAST:event_DiminMMCheckStateChanged
-
-    private void MaxUnitsSpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_MaxUnitsSpinnerStateChanged
-        if (battlemodel.AmIHost()) {
-            info.maxunits = (Integer) MaxUnitsSpinner.getValue ();
-            MaxUnitsSlider.setValue(info.maxunits);
-            UpdateBattleClients();
-        }
-    }//GEN-LAST:event_MaxUnitsSpinnerStateChanged
-
-    private void MaxUnitsSliderStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_MaxUnitsSliderStateChanged
-        if (battlemodel.AmIHost()) {
-            info.maxunits = MaxUnitsSlider.getValue();
-            MaxUnitsSpinner.setValue(info.maxunits);
-            UpdateBattleClients();
-        }
-    }//GEN-LAST:event_MaxUnitsSliderStateChanged
-
-    private void StartingEnergySpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_StartingEnergySpinnerStateChanged
-        if (battlemodel.AmIHost()) {
-            info.energy = (Integer) StartingEnergySpinner.getValue ();
-            StartingEnergySlider.setValue(info.energy);
-            UpdateBattleClients();
-        }
-    }//GEN-LAST:event_StartingEnergySpinnerStateChanged
-
-    private void StartingEnergySliderStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_StartingEnergySliderStateChanged
-        if (battlemodel.AmIHost()) {
-            info.energy = StartingEnergySlider.getValue();
-            StartingEnergySpinner.setValue(info.energy);
-            UpdateBattleClients();
-        }
-    }//GEN-LAST:event_StartingEnergySliderStateChanged
-
-    private void StartingMetalSpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_StartingMetalSpinnerStateChanged
-        if (battlemodel.AmIHost()) {
-            info.metal = (Integer) StartingMetalSpinner.getValue ();
-            StartingMetalSlider.setValue(info.metal);
-            UpdateBattleClients();
-        }
-    }//GEN-LAST:event_StartingMetalSpinnerStateChanged
-
-    private void StartPosComboItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_StartPosComboItemStateChanged
-        if (battlemodel.AmIHost()) {
-            info.startPos = StartPosCombo.getSelectedIndex();
-            UpdateBattleClients();
-        }
-    }//GEN-LAST:event_StartPosComboItemStateChanged
-
-    private void GameEndComboItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_GameEndComboItemStateChanged
-        if (battlemodel.AmIHost()) {
-            info.gameEndCondition = GameEndCombo.getSelectedIndex();
-            UpdateBattleClients();
-        }
-    }//GEN-LAST:event_GameEndComboItemStateChanged
-
-    private void StartingMetalSliderStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_StartingMetalSliderStateChanged
-        if (battlemodel.AmIHost()) {
-            info.metal = StartingMetalSlider.getValue();
-            StartingMetalSpinner.setValue(info.metal);
-            UpdateBattleClients();
-        }
-    }//GEN-LAST:event_StartingMetalSliderStateChanged
-
-    private void GameEndComboMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_GameEndComboMousePressed
-                                                                                                                                                    }//GEN-LAST:event_GameEndComboMousePressed
-
-    private void StartPosComboMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_StartPosComboMousePressed
-                                                                                                                                                    }//GEN-LAST:event_StartPosComboMousePressed
-
     //private boolean wipenext=false;
     private void ExitButtonMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ExitButtonMousePressed
     }//GEN-LAST:event_ExitButtonMousePressed
@@ -2854,35 +2926,53 @@
         s +=  + &quot; &quot;;
         s += ;*/
         
-        String pair = &quot;GAME/StartMetal &quot;+info.metal;
-        s = pair+&quot;\t&quot;;
+        /*String pair = &quot;GAME/StartMetal=&quot;+info.metal;
+        s = pair;
         
-        pair = &quot;GAME/StartEnergy &quot;+info.energy;
-        s += pair+&quot;\t&quot;;
+        pair = &quot;\tGAME/StartEnergy=&quot;+info.energy;
+        s += pair;
         
-        pair = &quot;GAME/MaxUnits &quot;+info.maxunits;
-        s += pair+&quot;\t&quot;;
+        pair = &quot;\tGAME/MaxUnits=&quot;+info.maxunits;
+        s += pair;*/
         
-        pair = &quot;GAME/StartPosType &quot;+info.startPos;
-        s += pair+&quot;\t&quot;;
+        //pair = &quot;\tGAME/StartPosType=&quot;+info.startPos;
+        //s += pair;
         
-        pair = &quot;GAME/GameMode &quot;+info.gameEndCondition;
-        s += pair+&quot;\t&quot;;
         
-        pair = &quot;GAME/LimitDGun &quot;+BooltoInt(info.limitDGun);
-        s += pair+&quot;\t&quot;;
+        /*pair = &quot;\tGAME/LimitDGun=&quot;+BooltoInt(info.limitDGun);
+        s += pair;
         
-        pair = &quot;GAME/DiminishingMMs &quot;+BooltoInt(info.diminishingMMs);
-        s += pair+&quot;\t&quot;;
-        
-        pair = &quot;GAME/GhostedBuildings &quot;+BooltoInt(info.ghostedBuildings);
+        pair = &quot;\tGAME/DiminishingMMs=&quot;+BooltoInt(info.diminishingMMs);
         s += pair;
         
+        pair = &quot;\tGAME/GhostedBuildings=&quot;+BooltoInt(info.ghostedBuildings);
+        s += pair;*/
+        
+        Map&lt;String,Object&gt; options = battlemodel.GetOptions();
+        
+        for(String key : options.keySet()){
+            //
+            Object v = options.get(key);
+            
+            String value = &quot;&quot;;
+            if((v.getClass() == boolean.class)||(v.getClass() == Boolean.class)){
+                value = &quot;&quot;+((v.toString().equals(&quot;true&quot;))? 1 : 0);
+            }else{
+                value = v.toString();
+            }
+            
+            String pair = &quot;\t&quot;+key+&quot;=&quot;+value;
+            s += pair;
+        }
+        
+        
+        
 
         //s += pair+&quot;\t&quot;;
         
 
         LM.protocol.SendTraffic(s);
+        UpdateClientsNeeded = false;
     }
 
     @SuppressWarnings(value = &quot;unchecked&quot;)
@@ -2901,7 +2991,7 @@
         } else if (e.IsEvent(CEvent.CONTENTREFRESH)) {
         
             MapList.removeAll();
-            String[] m = (String[]) CSync.map_names.values().toArray().clone();
+            Object[] m = CSync.map_names.values().toArray().clone();
             Arrays.sort(m, new AlphanumComparator());
             MapList.setListData(m);
             battlemodel.CheckSync();
@@ -3093,29 +3183,24 @@
     private aflobby.CChatPanel Chat;
     private javax.swing.JButton ColourButton;
     private javax.swing.JPanel ColourPanel;
-    private javax.swing.JCheckBox DiminMMCheck;
     private javax.swing.JList DisabledUnitsList;
     private javax.swing.JComboBox EditAIAllyCombo;
     private javax.swing.JComboBox EditAIRaceCombo;
     private javax.swing.JButton ExitButton;
-    private javax.swing.JComboBox GameEndCombo;
     private javax.swing.JTabbedPane GameOptionsPane;
     private javax.swing.JCheckBox GameSpeedLockCheck;
     public javax.swing.JButton GameStartButton;
-    private javax.swing.JCheckBox GhostedCheck;
     private javax.swing.JPanel HostButtonsPanel;
     private javax.swing.JToggleButton JAutoScrollToggle;
-    private javax.swing.JCheckBox LimitDGunCheck;
     private javax.swing.JToggleButton LockToggle;
     private javax.swing.JList MapList;
     private javax.swing.JLabel MapPickerLabel;
     private javax.swing.JPanel MapTab;
-    private javax.swing.JSlider MaxUnitsSlider;
-    private javax.swing.JSpinner MaxUnitsSpinner;
     private javax.swing.JComboBox MyAIsCombo;
     private javax.swing.JComboBox MyAllyTeamCombo;
     private javax.swing.JComboBox MyTeamCombo;
     private javax.swing.JTextField NewAIName;
+    private javax.swing.JPanel OptionsPanel;
     private javax.swing.JComboBox RaceCombo;
     public javax.swing.JToggleButton ReadyToggle;
     private javax.swing.JButton RemoveAIButton;
@@ -3123,11 +3208,6 @@
     private javax.swing.JComboBox RestrictedUnitsCombo;
     private javax.swing.JTextArea ScriptPreview;
     private javax.swing.JToggleButton SpectatorToggle;
-    private javax.swing.JComboBox StartPosCombo;
-    private javax.swing.JSlider StartingEnergySlider;
-    private javax.swing.JSpinner StartingEnergySpinner;
-    private javax.swing.JSlider StartingMetalSlider;
-    private javax.swing.JSpinner StartingMetalSpinner;
     private javax.swing.JPanel TeamTab;
     private javax.swing.JButton UnRestrictAllUnitsButton;
     private javax.swing.JButton UnRestrictUnitButton;
@@ -3150,11 +3230,6 @@
     private javax.swing.JLabel jLabel16;
     private javax.swing.JLabel jLabel17;
     private javax.swing.JLabel jLabel18;
-    private javax.swing.JLabel jLabel2;
-    private javax.swing.JLabel jLabel3;
-    private javax.swing.JLabel jLabel4;
-    private javax.swing.JLabel jLabel5;
-    private javax.swing.JLabel jLabel6;
     private javax.swing.JLabel jLabel7;
     private javax.swing.JLabel jLabel8;
     private javax.swing.JLabel jLabel9;
@@ -3163,12 +3238,14 @@
     private javax.swing.JPanel jPanel6;
     private javax.swing.JPanel jPanel7;
     private javax.swing.JPopupMenu jPopupMenu1;
+    private javax.swing.JScrollPane jScrollPane1;
     private javax.swing.JScrollPane jScrollPane12;
     private javax.swing.JScrollPane jScrollPane2;
     private javax.swing.JScrollPane jScrollPane3;
     private javax.swing.JScrollPane jScrollPane4;
     private javax.swing.JScrollPane jScrollPane6;
     private javax.swing.JSeparator jSeparator1;
+    private javax.swing.JSeparator jSeparator2;
     private javax.swing.JSplitPane jSplitPane1;
     private javax.swing.JToggleButton jToggleButton3;
     private javax.swing.JToolBar jToolBar2;

Modified: trunk/Lobby/AFLobby/src/aflobby/CChannel.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/CChannel.java	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/CChannel.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -67,7 +67,8 @@
             ImageIcon i = flags.get(flag);
             return i;
         }else{
-            String path = Misc.GetAbsoluteLobbyFolderPath() + &quot;images/flags/&quot; + flag + &quot;.png&quot;;
+            String path = Misc.GetAbsoluteLobbyFolderPath() + &quot;images/flags/&quot;
+                    + flag + &quot;.png&quot;;
             ImageIcon i = new ImageIcon(path);
             flags.put(flag, i);
             return i;
@@ -82,14 +83,16 @@
             // load rank images
             ranks = new ImageIcon[7];
             for (int i = 0; i &lt; 7; i++) {
-                String path = Misc.GetAbsoluteLobbyFolderPath() + &quot;images/ranks/&quot; + i + &quot;.png&quot;;
+                String path = Misc.GetAbsoluteLobbyFolderPath() +
+                        &quot;images/ranks/&quot; + i + &quot;.png&quot;;
                 ranks[i] = new ImageIcon(path); //createImageIcon(path);//contents[i].toURI ().toString ());
             }
             
             // load the smaller rank images
             smallranks = new ImageIcon[7];
             for (int i = 0; i &lt; 7; i++) {
-                String path = Misc.GetAbsoluteLobbyFolderPath() + &quot;images/ranks_small/&quot; + i + &quot;.png&quot;;
+                String path = Misc.GetAbsoluteLobbyFolderPath() +
+                        &quot;images/ranks_small/&quot; + i + &quot;.png&quot;;
                 smallranks[i] = new ImageIcon(path); //createImageIcon(path);//contents[i].toURI ().toString ());
             }
             
@@ -134,7 +137,8 @@
             if (!log.canRead()) {
                 log.mkdir();
             }
-            txtLog = new FileHandler(Misc.GetAbsoluteLobbyFolderPath() + &quot;logs/&quot; + channel + &quot;.txt&quot;, true);
+            txtLog = new FileHandler(Misc.GetAbsoluteLobbyFolderPath() +
+                    &quot;logs/&quot; + channel + &quot;.txt&quot;, true);
             txtLog.setFormatter(new CChatLogFormatter());
             logger = Logger.getLogger(&quot;channel.&quot; + channel);
             logger.setLevel(Level.INFO);
@@ -180,7 +184,8 @@
             }
             if(CChannel.botimg == null){
                 URL h = this.getClass().getResource(&quot;/images/bot/32.png&quot;);
-                CChannel.botimg = new ImageIcon(new ImageIcon(h).getImage().getScaledInstance(20, 20, 0));
+                CChannel.botimg = new ImageIcon(
+                        new ImageIcon(h).getImage().getScaledInstance(20, 20, 0));
             }
         }
 
@@ -189,7 +194,8 @@
          * to the selected value and returns the label, set up
          * to display the text and image.
          */
-        public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
+        public Component getListCellRendererComponent(JList list, Object value,
+                int index, boolean isSelected, boolean cellHasFocus) {
             //Get the selected index. (The index param isn't
             //always valid, so just use the value.)
             String selectedValue = (String) value; //((Integer)value).intValue ();
@@ -254,7 +260,8 @@
         if (path == null) {
             return null;
         }
-        return new ImageIcon(new ImageIcon(path).getImage().getScaledInstance(18, 18, Image.SCALE_REPLICATE));
+        return new ImageIcon(new ImageIcon(path).getImage().getScaledInstance(
+                18, 18, Image.SCALE_REPLICATE));
 //        if (imgURL != null) {
 //            ImageIcon i =
 //            return i;
@@ -316,7 +323,9 @@
             }
             String[] command = k.split(&quot; &quot;);
             if (k.length() &gt; 1020) {
-                LM.Toasts.AddMessage(&quot;error: a message cannot contain in excess of 1,024 characters, the message was blocked to prevent a server ban&quot;);
+                LM.Toasts.AddMessage(&quot;error: a message cannot contain in&quot; +
+                        &quot; excess of 1,024 characters, the message was blocked&quot; +
+                        &quot; to prevent a server ban&quot;);
             }
             if (command[0].equalsIgnoreCase(&quot;/me&quot;)) {
                 LM.protocol.SendTraffic(&quot;SAYEX &quot; + Channel + &quot; &quot; + Misc.makeSentence(command, 1));
@@ -385,7 +394,8 @@
                 final String time = CStringHelper.getHTMLTimestamp();
                 final String Msg = CStringHelper.getChatHTML(Misc.makeSentence(e.data, 3),false);
                 final String User = CStringHelper.getUserChatHTML(e.data[2]);
-                logger.info(CStringHelper.getTimestamp()+&quot;&lt;&quot; + e.data[2] + &quot;&gt; &quot; + Misc.makeSentence(e.data, 3));
+                logger.info(CStringHelper.getTimestamp()+&quot;&lt;&quot; + e.data[2] + &quot;&gt; &quot;
+                        + Misc.makeSentence(e.data, 3));
 
 
                 Runnable doWorkRunnable = new Runnable() {
@@ -402,7 +412,8 @@
                             AddMessage(time + User + Msg);
                         }
                         if (!isShowing()) {
-                            CEvent e2 = new CEvent(CEvent.CHANNELUNREAD + &quot; &quot; + Channel);
+                            CEvent e2 = new CEvent(CEvent.CHANNELUNREAD + &quot; &quot;
+                                    + Channel);
                             LM.core.NewGUIEvent(e2);
                         }
                     }
@@ -413,9 +424,11 @@
             if (e.data[1].equalsIgnoreCase(Channel)) {
                 // Add!!!!! SAIDEX main w00t heheh
                 String time = CStringHelper.getHTMLTimestamp();
-                final String msg = CStringHelper.getChatHTML(e.data[2] + &quot; &quot; + Misc.makeSentence(e.data, 3),true);
+                final String msg = CStringHelper.getChatHTML(e.data[2] + &quot; &quot; + 
+                        Misc.makeSentence(e.data, 3),true);
                 AddMessage(time + msg);
-                logger.info(CStringHelper.getTimestamp()+&quot;*&quot; + e.data[2] + &quot; &quot; + Misc.makeSentence(e.data, 3));
+                logger.info(CStringHelper.getTimestamp()+&quot;*&quot; + e.data[2] + &quot; &quot; + 
+                        Misc.makeSentence(e.data, 3));
                 lastsent = e.data[2];
                 Runnable doWorkRunnable = new Runnable() {
 
@@ -435,7 +448,8 @@
                     logger.info(&quot;Logging Ended&quot;);
                     logger.info(&quot;\n&quot;);
                 } else {
-                    logger.info(e.data[2] + &quot; left channel: &quot; + Misc.makeSentence(e.data, 3));
+                    logger.info(e.data[2] + &quot; left channel: &quot; + 
+                            Misc.makeSentence(e.data, 3));
                     lastsent = &quot;&quot;;
                 }
                 RemovePlayer(e.data[2], Misc.makeSentence(e.data, 3));
@@ -466,7 +480,11 @@
                 String topic = Misc.toHTML(Misc.makeSentence(e.data, 4));
                 topic = topic.replaceAll(&quot;\\\\n&quot;, &quot;&lt;br&gt;&quot;);
                 topic = aflobby.CChatPanel.ParseChatText(topic);
-                topic = &quot;&lt;font face=\&quot;Bitstream Vera Sans Mono, Andale Mono,Consolas, Courier New, Courier, Monospace\&quot; size=\&quot;3\&quot;&gt;&lt;b&gt;Topic : &lt;br&gt;&quot; + topic + &quot; set by :&quot; + e.data[2] + &quot; on &quot; + topicset.toString() + &quot;&lt;/b&gt;&lt;/font&gt;&quot;;
+                topic = &quot;&lt;font face=\&quot;Bitstream Vera Sans Mono, Andale Mono, &quot; +
+                        &quot;Consolas, Courier New, Courier, Monospace\&quot; size=\&quot;3\&quot;&gt;&quot; +
+                        &quot;&lt;b&gt;Topic : &lt;br&gt;&quot; + topic + &quot; set by :&quot; + e.data[2] + 
+                        &quot; on &quot; + topicset.toString() + &quot;&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&quot;;
+                
                 if (chatpanel != null) {
                     chatpanel.AddRawHTML(topic);
                 }
@@ -478,14 +496,19 @@
             // Add!!!!!
             if (e.data[1].equalsIgnoreCase(Channel)) {
                 logger.info(&quot;ChannelMessage : &quot; + Misc.makeSentence(e.data, 2));
-                AddMessage(&quot;&lt;font face=\&quot;Arial, Helvetica, sans-serif\&quot; size=\&quot;3\&quot; color=\&quot;&quot; + ColourHelper.ColourToHex(Color.BLUE) + &quot;\&quot;&gt;&lt;b&gt;ChannelMessage : &quot; + Misc.toHTML(Misc.makeSentence(e.data, 2)) + &quot;&lt;/b&gt;&lt;/font&gt;&quot;);
+                AddMessage(&quot;&lt;font face=\&quot;Arial, Helvetica, sans-serif\&quot; &quot; +
+                        &quot;size=\&quot;3\&quot; color=\&quot;&quot; + ColourHelper.ColourToHex(Color.BLUE)
+                        + &quot;\&quot;&gt;&lt;b&gt;ChannelMessage : &quot; + Misc.toHTML(Misc.makeSentence(e.data, 2))
+                        + &quot;&lt;/b&gt;&lt;/font&gt;&quot;);
             }
         } else if (e.data[0].equalsIgnoreCase(&quot;FORCELEAVECHANNEL&quot;)) {
             if (e.data[1].equalsIgnoreCase(Channel)) {
                 //if(e.data[2].equalsIgnoreCase (e.connection.username)){
                 // We've been kicked, oh noes!!!!! Close the window and show a message in the message window!!!!'
-                logger.info(&quot;You got kicked from &quot; + this.Channel + &quot; reason:: &quot; + Misc.makeSentence(e.data, 3));
-                LM.Toasts.AddMessage(&quot;You got kicked from &quot; + this.Channel + &quot; reason:: &quot; + Misc.makeSentence(e.data, 3));
+                logger.info(&quot;You got kicked from &quot; + this.Channel + &quot; reason:: &quot;
+                        + Misc.makeSentence(e.data, 3));
+                LM.Toasts.AddMessage(&quot;You got kicked from &quot; + this.Channel + 
+                        &quot; reason:: &quot; + Misc.makeSentence(e.data, 3));
                 ExitChannel();
                 logger.info(&quot;Logging Ended&quot;);
                 logger.info(&quot;\n&quot;);
@@ -509,7 +532,9 @@
                     if (reason.equalsIgnoreCase(&quot;&quot;) == false) {
                         r = &quot; reason: &quot; + reason;
                     }
-                    AddMessage(&quot;&lt;font face=\&quot;Arial, Helvetica, sans-serif\&quot; size=\&quot;3\&quot; color=\&quot;996699\&quot;&gt;&lt;b&gt; &quot; + player + &quot; has Left #&quot; + Channel + &quot; &quot; + r + &quot;&lt;/b&gt;&lt;/font&gt;&quot;);
+                    AddMessage(&quot;&lt;font face=\&quot;Arial, Helvetica, sans-serif\&quot; &quot; +
+                            &quot;size=\&quot;3\&quot; color=\&quot;996699\&quot;&gt;&lt;b&gt; &quot; + player + &quot; has&quot; +
+                            &quot; Left #&quot; + Channel + &quot; &quot; + r + &quot;&lt;/b&gt;&lt;/font&gt;&quot;);
                 }
                 int i = vmodel.getSize();
                 playerCountLabel.setText(i +&quot; Players in Channel&quot;);
@@ -557,7 +582,10 @@
                             if(Boolean.valueOf(CUserSettings.GetValue(&quot;ui.channelview.userjoinranks&quot;, &quot;false&quot;))){
                                 flag += p.GetRankHTML();
                             }
-                            AddMessage(&quot;&lt;font face=\&quot;Arial, Helvetica, sans-serif\&quot; size=\&quot;3\&quot; color=\&quot;00AA22\&quot;&gt;&lt;b&gt; &quot; + flag + &quot; &quot; + player + &quot; has Joined #&quot; + Channel + &quot;&lt;/b&gt;&lt;/font&gt;&quot;);
+                            AddMessage(&quot;&lt;font face=\&quot;Arial, Helvetica, &quot; +
+                                    &quot;sans-serif\&quot; size=\&quot;3\&quot; color=\&quot;00AA22\&quot;&gt;&quot; +
+                                    &quot;&lt;b&gt; &quot; + flag + &quot; &quot; + player + &quot; has Joined&quot; +
+                                    &quot; #&quot; + Channel + &quot;&lt;/b&gt;&lt;/font&gt;&quot;);
                         }
                     }
                 }
@@ -876,7 +904,8 @@
         s += &quot;/join &quot;;
         s += Channel;
         aflobby.UI.CUserSettings.SaveStartScript(s);
-        AddMessage(&quot;&lt;font face=\&quot;Arial, Helvetica, sans-serif\&quot; size=\&quot;3\&quot; color=\&quot;00AA22\&quot;&gt;&lt;b&gt; channel added to startup list&lt;/b&gt;&lt;/font&gt;&quot;);
+        AddMessage(&quot;&lt;font face=\&quot;Arial, Helvetica, sans-serif\&quot; size=\&quot;3\&quot; &quot; +
+                &quot;color=\&quot;00AA22\&quot;&gt;&lt;b&gt; channel added to startup list&lt;/b&gt;&lt;/font&gt;&quot;);
 
         CEvent e = new CEvent(CEvent.LOGONSCRIPTCHANGE);
         LM.core.NewGUIEvent(e);
@@ -897,7 +926,8 @@
 // TODO add your handling code here:
         if (evt.getClickCount() &gt; 1) {
             String n = (String) ChannelPlayerList.getSelectedValue ();
-            aflobby.CPlayerDataWindow p = new CPlayerDataWindow(LM, LM.playermanager.GetPlayer(n));
+            aflobby.CPlayerDataWindow p = new CPlayerDataWindow(
+                    LM, LM.playermanager.GetPlayer(n));
             p.setVisible(true);
         }
     }//GEN-LAST:event_ChannelPlayerListMousePressed
@@ -943,7 +973,8 @@
     }//GEN-LAST:event_ClearChatMenuItemActionPerformed
 
     private void MultiLineMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_MultiLineMenuItemActionPerformed
-        CUserSettings.PutValue(&quot;ui.chat.multiline&quot;, String.valueOf(MultiLineMenuItem.isSelected()));
+        CUserSettings.PutValue(&quot;ui.chat.multiline&quot;,
+                String.valueOf(MultiLineMenuItem.isSelected()));
     }//GEN-LAST:event_MultiLineMenuItemActionPerformed
 
     // Variables declaration - do not modify//GEN-BEGIN:variables

Modified: trunk/Lobby/AFLobby/src/aflobby/CChannelView.form
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/CChannelView.form	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/CChannelView.form	2008-01-14 20:27:21 UTC (rev 5324)
@@ -198,7 +198,7 @@
                       &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
                           &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Component id=&quot;WelcomeLabel&quot; min=&quot;-2&quot; pref=&quot;34&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
                               &lt;Component id=&quot;jButton8&quot; linkSize=&quot;1&quot; min=&quot;-2&quot; pref=&quot;41&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;Component id=&quot;jButton4&quot; linkSize=&quot;1&quot; pref=&quot;41&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
@@ -206,7 +206,7 @@
                               &lt;Component id=&quot;LogOutButton&quot; linkSize=&quot;1&quot; alignment=&quot;0&quot; pref=&quot;41&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
                               &lt;Component id=&quot;jButton5&quot; linkSize=&quot;1&quot; alignment=&quot;0&quot; pref=&quot;41&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
                           &lt;/Group&gt;
-                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                               &lt;Component id=&quot;number_of_battles&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;Component id=&quot;ladderLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -225,9 +225,9 @@
                               &lt;Component id=&quot;jButton14&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;Component id=&quot;jButton15&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;/Group&gt;
-                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;jScrollPane4&quot; min=&quot;-2&quot; pref=&quot;312&quot; max=&quot;-2&quot; attributes=&quot;2&quot;/&gt;
-                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;jScrollPane4&quot; pref=&quot;312&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;13&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
                   &lt;/Group&gt;
                 &lt;/DimensionLayout&gt;

Modified: trunk/Lobby/AFLobby/src/aflobby/CChannelView.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/CChannelView.java	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/CChannelView.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -483,8 +483,8 @@
                     .addComponent(jButton14)
                     .addComponent(jButton15))
                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 312, javax.swing.GroupLayout.PREFERRED_SIZE)
-                .addContainerGap())
+                .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 312, Short.MAX_VALUE)
+                .addGap(13, 13, 13))
         );
 
         jPanel7Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {LogOutButton, StatusCombo, jButton4, jButton5, jButton8});

Modified: trunk/Lobby/AFLobby/src/aflobby/CUnitSyncJNIBindings.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/CUnitSyncJNIBindings.java	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/CUnitSyncJNIBindings.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -21,6 +21,14 @@
  * @author AF
  */
 
+class OptionType {
+	public static int opt_error  = 0;
+	public static int opt_bool   = 1;
+	public static int opt_list   = 2;
+	public static int opt_number = 3;
+	public static int opt_string = 4;
+};
+
 //CUnitSyncJNIBindings
 public class CUnitSyncJNIBindings {
 

Modified: trunk/Lobby/AFLobby/src/aflobby/JTraffic.form
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/JTraffic.form	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/JTraffic.form	2008-01-14 20:27:21 UTC (rev 5324)
@@ -3,6 +3,9 @@
 &lt;Form version=&quot;1.4&quot; maxVersion=&quot;1.4&quot; type=&quot;org.netbeans.modules.form.forminfo.JFrameFormInfo&quot;&gt;
   &lt;Properties&gt;
     &lt;Property name=&quot;title&quot; type=&quot;java.lang.String&quot; value=&quot;Raw Traffic&quot;/&gt;
+    &lt;Property name=&quot;iconImage&quot; type=&quot;java.awt.Image&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+      &lt;Connection code=&quot;CUISettings.GetWindowIcon()&quot; type=&quot;code&quot;/&gt;
+    &lt;/Property&gt;
   &lt;/Properties&gt;
   &lt;SyntheticProperties&gt;
     &lt;SyntheticProperty name=&quot;formSizePolicy&quot; type=&quot;int&quot; value=&quot;1&quot;/&gt;
@@ -22,7 +25,7 @@
           &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Component id=&quot;jScrollPane1&quot; alignment=&quot;0&quot; pref=&quot;597&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;jScrollPane1&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                           &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
@@ -30,7 +33,7 @@
                               &lt;EmptySpace min=&quot;-2&quot; pref=&quot;415&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;/Group&gt;
                           &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Component id=&quot;jTextField1&quot; pref=&quot;531&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;jTextField1&quot; pref=&quot;548&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;/Group&gt;
                       &lt;/Group&gt;
@@ -66,7 +69,7 @@
             &lt;Font bold=&quot;true&quot; component=&quot;jLabel1&quot; property=&quot;font&quot; relativeSize=&quot;true&quot; size=&quot;3&quot;/&gt;
           &lt;/FontInfo&gt;
         &lt;/Property&gt;
-        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Raw Traffic&quot;/&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Raw Protocol Traffic&quot;/&gt;
       &lt;/Properties&gt;
     &lt;/Component&gt;
     &lt;Container class=&quot;javax.swing.JScrollPane&quot; name=&quot;jScrollPane1&quot;&gt;

Modified: trunk/Lobby/AFLobby/src/aflobby/JTraffic.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/JTraffic.java	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/JTraffic.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -6,6 +6,7 @@
 
 package aflobby;
 
+import aflobby.UI.CUISettings;
 import javax.swing.SwingUtilities;
 
 /**
@@ -52,9 +53,10 @@
         jButton1 = new javax.swing.JButton();
 
         setTitle(&quot;Raw Traffic&quot;);
+        setIconImage(CUISettings.GetWindowIcon());
 
         jLabel1.setFont(jLabel1.getFont().deriveFont(jLabel1.getFont().getStyle() | java.awt.Font.BOLD, jLabel1.getFont().getSize()+3));
-        jLabel1.setText(&quot;Raw Traffic&quot;);
+        jLabel1.setText(&quot;Raw Protocol Traffic&quot;);
 
         jTextArea1.setEditable(false);
         jTextArea1.setLineWrap(true);
@@ -77,14 +79,14 @@
             .addGroup(layout.createSequentialGroup()
                 .addContainerGap()
                 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 597, Short.MAX_VALUE)
+                    .addComponent(jScrollPane1)
                     .addGroup(layout.createSequentialGroup()
                         .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                             .addGroup(layout.createSequentialGroup()
                                 .addComponent(jLabel1)
                                 .addGap(415, 415, 415))
                             .addGroup(layout.createSequentialGroup()
-                                .addComponent(jTextField1, javax.swing.GroupLayout.DEFAULT_SIZE, 531, Short.MAX_VALUE)
+                                .addComponent(jTextField1, javax.swing.GroupLayout.DEFAULT_SIZE, 548, Short.MAX_VALUE)
                                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)))
                         .addComponent(jButton1)))
                 .addContainerGap())

Modified: trunk/Lobby/AFLobby/src/aflobby/LMain.form
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/LMain.form	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/LMain.form	2008-01-14 20:27:21 UTC (rev 5324)
@@ -3,6 +3,9 @@
 &lt;Form version=&quot;1.3&quot; maxVersion=&quot;1.5&quot; type=&quot;org.netbeans.modules.form.forminfo.JFrameFormInfo&quot;&gt;
   &lt;Properties&gt;
     &lt;Property name=&quot;defaultCloseOperation&quot; type=&quot;int&quot; value=&quot;2&quot;/&gt;
+    &lt;Property name=&quot;title&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+      &lt;Connection code=&quot;CUpdateChecker.AFLobbyVersion&quot; type=&quot;code&quot;/&gt;
+    &lt;/Property&gt;
     &lt;Property name=&quot;iconImage&quot; type=&quot;java.awt.Image&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
       &lt;Connection code=&quot;CUISettings.GetWindowIcon()&quot; type=&quot;code&quot;/&gt;
     &lt;/Property&gt;

Modified: trunk/Lobby/AFLobby/src/aflobby/LMain.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/LMain.java	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/LMain.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -150,6 +150,7 @@
     private void initComponents() {
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
+        setTitle(CUpdateChecker.AFLobbyVersion);
         setIconImage(CUISettings.GetWindowIcon());
         setMinimumSize(new java.awt.Dimension(600, 500));
         addWindowListener(new java.awt.event.WindowAdapter() {

Added: trunk/Lobby/AFLobby/src/aflobby/UI/DocumentSizeFilter.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/UI/DocumentSizeFilter.java	                        (rev 0)
+++ trunk/Lobby/AFLobby/src/aflobby/UI/DocumentSizeFilter.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -0,0 +1,58 @@
+/*
+ * <A HREF="http://java.sun.com/docs/books/tutorial/uiswing/examples/components/TextComponentDemoProject/src/components/DocumentSizeFilter.java">http://java.sun.com/docs/books/tutorial/uiswing/examples/components/TextComponentDemoProject/src/components/DocumentSizeFilter.java</A>
+ */
+
+package aflobby.UI;
+
+import java.awt.Toolkit;
+import javax.swing.text.AttributeSet;
+import javax.swing.text.BadLocationException;
+import javax.swing.text.DocumentFilter;
+import javax.swing.text.DocumentFilter.FilterBypass;
+
+public class DocumentSizeFilter extends DocumentFilter {
+    int maxCharacters;
+    boolean DEBUG = false;
+
+    public DocumentSizeFilter(int maxChars) {
+        maxCharacters = maxChars;
+    }
+
+    @Override
+    public void insertString(FilterBypass fb, int offs,
+                             String str, AttributeSet a)
+        throws BadLocationException {
+        if (DEBUG) {
+            System.out.println(&quot;in DocumentSizeFilter's insertString method&quot;);
+        }
+
+        //This rejects the entire insertion if it would make
+        //the contents too long. Another option would be
+        //to truncate the inserted string so the contents
+        //would be exactly maxCharacters in length.
+        if ((fb.getDocument().getLength() + str.length()) &lt;= maxCharacters)
+            super.insertString(fb, offs, str, a);
+        else
+            Toolkit.getDefaultToolkit().beep();
+    }
+    
+    @Override
+    public void replace(FilterBypass fb, int offs,
+                        int length, 
+                        String str, AttributeSet a)
+        throws BadLocationException {
+        if (DEBUG) {
+            System.out.println(&quot;in DocumentSizeFilter's replace method&quot;);
+        }
+        //This rejects the entire replacement if it would make
+        //the contents too long. Another option would be
+        //to truncate the replacement string so the contents
+        //would be exactly maxCharacters in length.
+        if ((fb.getDocument().getLength() + str.length()
+             - length) &lt;= maxCharacters)
+            super.replace(fb, offs, length, str, a);
+        else
+            Toolkit.getDefaultToolkit().beep();
+    }
+
+}
\ No newline at end of file

Added: trunk/Lobby/AFLobby/src/aflobby/UI/battle/CBooleanOptionsPanel.form
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/UI/battle/CBooleanOptionsPanel.form	                        (rev 0)
+++ trunk/Lobby/AFLobby/src/aflobby/UI/battle/CBooleanOptionsPanel.form	2008-01-14 20:27:21 UTC (rev 5324)
@@ -0,0 +1,116 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
+
+&lt;Form version=&quot;1.5&quot; maxVersion=&quot;1.5&quot; type=&quot;org.netbeans.modules.form.forminfo.JPanelFormInfo&quot;&gt;
+  &lt;AuxValues&gt;
+    &lt;AuxValue name=&quot;FormSettings_autoResourcing&quot; type=&quot;java.lang.Integer&quot; value=&quot;0&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_autoSetComponentName&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_generateMnemonicsCode&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_i18nAutoMode&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_layoutCodeTarget&quot; type=&quot;java.lang.Integer&quot; value=&quot;1&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_listenerGenerationStyle&quot; type=&quot;java.lang.Integer&quot; value=&quot;0&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesLocal&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;2&quot;/&gt;
+  &lt;/AuxValues&gt;
+
+  &lt;Layout&gt;
+    &lt;DimensionLayout dim=&quot;0&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;jLabel2&quot; alignment=&quot;1&quot; pref=&quot;380&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;1&quot;&gt;
+                      &lt;Component id=&quot;CheckBox&quot; min=&quot;-2&quot; pref=&quot;147&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;142&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jButton2&quot; min=&quot;-2&quot; pref=&quot;91&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jLabel1&quot; pref=&quot;308&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace type=&quot;unrelated&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jLabel3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+    &lt;DimensionLayout dim=&quot;1&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;jLabel3&quot; pref=&quot;36&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                  &lt;Component id=&quot;jLabel1&quot; min=&quot;-2&quot; pref=&quot;36&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;jLabel2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;CheckBox&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;jButton2&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace pref=&quot;13&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+  &lt;/Layout&gt;
+  &lt;SubComponents&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel1&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;font&quot; type=&quot;java.awt.Font&quot; editor=&quot;org.netbeans.modules.form.editors2.FontEditor&quot;&gt;
+          &lt;FontInfo relative=&quot;true&quot;&gt;
+            &lt;Font component=&quot;jLabel1&quot; property=&quot;font&quot; relativeSize=&quot;true&quot; size=&quot;5&quot;/&gt;
+          &lt;/FontInfo&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;title&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JCheckBox&quot; name=&quot;CheckBox&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;selected&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;defValue&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;enabled&quot;/&gt;
+        &lt;Property name=&quot;enabled&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;host&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;Events&gt;
+        &lt;EventHandler event=&quot;actionPerformed&quot; listener=&quot;java.awt.event.ActionListener&quot; parameters=&quot;java.awt.event.ActionEvent&quot; handler=&quot;CheckBoxActionPerformed&quot;/&gt;
+      &lt;/Events&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel2&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;description&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;jButton2&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Reset&quot;/&gt;
+        &lt;Property name=&quot;enabled&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;host&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;Events&gt;
+        &lt;EventHandler event=&quot;actionPerformed&quot; listener=&quot;java.awt.event.ActionListener&quot; parameters=&quot;java.awt.event.ActionEvent&quot; handler=&quot;jButton2ActionPerformed&quot;/&gt;
+      &lt;/Events&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel3&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;icon&quot; type=&quot;javax.swing.Icon&quot; editor=&quot;org.netbeans.modules.form.editors2.IconEditor&quot;&gt;
+          &lt;Image iconType=&quot;3&quot; name=&quot;/images/UI/map.png&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;disabledIcon&quot; type=&quot;javax.swing.Icon&quot; editor=&quot;org.netbeans.modules.form.editors2.IconEditor&quot;&gt;
+          &lt;Image iconType=&quot;3&quot; name=&quot;/images/UI/optionflag.png&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;enabled&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;map&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+  &lt;/SubComponents&gt;
+&lt;/Form&gt;

Added: trunk/Lobby/AFLobby/src/aflobby/UI/battle/CBooleanOptionsPanel.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/UI/battle/CBooleanOptionsPanel.java	                        (rev 0)
+++ trunk/Lobby/AFLobby/src/aflobby/UI/battle/CBooleanOptionsPanel.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -0,0 +1,183 @@
+/*
+ * CBooleanOptionsPanel.java
+ *
+ * Created on 11 January 2008, 21:25
+ */
+
+package aflobby.UI.battle;
+
+import aflobby.CEvent;
+import aflobby.IBattleModel;
+import aflobby.LMain;
+import aflobby.framework.IModule;
+
+/**
+ *
+ * @author  tarendai-std
+ */
+public class CBooleanOptionsPanel extends javax.swing.JPanel implements IModule{
+    
+    int optionType;
+    boolean defValue;
+    String title;
+    String description;
+    String key;
+    IBattleModel battlemodel;
+    boolean host;
+    boolean map;
+    
+    /** Creates new form CBooleanOptionsPanel
+     * @param battlemodel 
+     * @param key
+     * @param defValue
+     * @param title
+     * @param description
+     * @param map 
+     */
+    public CBooleanOptionsPanel(
+            IBattleModel battlemodel, String key, boolean defValue, String title, String description, boolean map) {
+        
+        this.host = battlemodel.AmIHost();
+        this.defValue = defValue;
+        this.title = new String(title);
+        this.key = new String(key);
+        this.description = new String(description);
+        this.battlemodel = battlemodel;
+        this.map = map;
+        
+        battlemodel.PutOption(key, defValue);
+        
+        initComponents();
+    }
+    
+    /** This method is called from within the constructor to
+     * initialize the form.
+     * WARNING: Do NOT modify this code. The content of this method is
+     * always regenerated by the Form Editor.
+     */
+    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;Generated Code&quot;&gt;//GEN-BEGIN:initComponents
+    private void initComponents() {
+
+        jLabel1 = new javax.swing.JLabel();
+        CheckBox = new javax.swing.JCheckBox();
+        jLabel2 = new javax.swing.JLabel();
+        jButton2 = new javax.swing.JButton();
+        jLabel3 = new javax.swing.JLabel();
+
+        jLabel1.setFont(jLabel1.getFont().deriveFont(jLabel1.getFont().getSize()+5f));
+        jLabel1.setText(title);
+
+        CheckBox.setSelected(defValue);
+        CheckBox.setText(&quot;enabled&quot;);
+        CheckBox.setEnabled(host);
+        CheckBox.addActionListener(new java.awt.event.ActionListener() {
+            public void actionPerformed(java.awt.event.ActionEvent evt) {
+                CheckBoxActionPerformed(evt);
+            }
+        });
+
+        jLabel2.setText(description);
+
+        jButton2.setText(&quot;Reset&quot;);
+        jButton2.setEnabled(host);
+        jButton2.addActionListener(new java.awt.event.ActionListener() {
+            public void actionPerformed(java.awt.event.ActionEvent evt) {
+                jButton2ActionPerformed(evt);
+            }
+        });
+
+        jLabel3.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/images/UI/map.png&quot;))); // NOI18N
+        jLabel3.setDisabledIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/images/UI/optionflag.png&quot;))); // NOI18N
+        jLabel3.setEnabled(map);
+
+        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
+        this.setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
+                .addContainerGap()
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
+                    .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
+                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
+                        .addComponent(CheckBox, javax.swing.GroupLayout.PREFERRED_SIZE, 147, javax.swing.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 142, Short.MAX_VALUE)
+                        .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 91, javax.swing.GroupLayout.PREFERRED_SIZE))
+                    .addGroup(layout.createSequentialGroup()
+                        .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, 308, Short.MAX_VALUE)
+                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
+                        .addComponent(jLabel3)))
+                .addContainerGap())
+        );
+        layout.setVerticalGroup(
+            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+            .addGroup(layout.createSequentialGroup()
+                .addContainerGap()
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+                    .addComponent(jLabel3, javax.swing.GroupLayout.DEFAULT_SIZE, 36, Short.MAX_VALUE)
+                    .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE))
+                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                .addComponent(jLabel2)
+                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
+                    .addComponent(CheckBox)
+                    .addComponent(jButton2))
+                .addContainerGap(13, Short.MAX_VALUE))
+        );
+    }// &lt;/editor-fold&gt;//GEN-END:initComponents
+
+    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
+        CheckBox.setSelected(defValue);
+        battlemodel.PutOption(key, CheckBox.isSelected());
+    }//GEN-LAST:event_jButton2ActionPerformed
+
+    private void CheckBoxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CheckBoxActionPerformed
+        battlemodel.PutOption(key, CheckBox.isSelected());
+    }//GEN-LAST:event_CheckBoxActionPerformed
+    
+    
+    // Variables declaration - do not modify//GEN-BEGIN:variables
+    private javax.swing.JCheckBox CheckBox;
+    private javax.swing.JButton jButton2;
+    private javax.swing.JLabel jLabel1;
+    private javax.swing.JLabel jLabel2;
+    private javax.swing.JLabel jLabel3;
+    // End of variables declaration//GEN-END:variables
+
+    public void Init(LMain L) {
+        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);
+    }
+
+    public void Update() {
+        
+    }
+
+    public void NewEvent(CEvent e) {
+        if(e.IsEvent(&quot;SETSCRIPTTAGS&quot;)){
+            //
+            String[] pairs = e.parameters.split(&quot;\t&quot;);
+            
+            for(int i = 0; i&lt; pairs.length; i++){
+                
+                String[] pair = pairs[i].split(&quot;=&quot;);
+                
+                String k = pair[0];
+                k = k.replaceAll(&quot;\\\\&quot;, &quot;/&quot;);
+                String value = pair[1];
+                
+                if(k.equalsIgnoreCase(key)){
+                    CheckBox.setSelected(Integer.parseInt(value) == 1);
+                }
+                
+            }
+        }
+    }
+
+    public void NewGUIEvent(CEvent e) {
+
+    }
+
+    public void OnRemove() {
+        battlemodel = null;
+    }
+    
+}

Added: trunk/Lobby/AFLobby/src/aflobby/UI/battle/CListOptionsPanel.form
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/UI/battle/CListOptionsPanel.form	                        (rev 0)
+++ trunk/Lobby/AFLobby/src/aflobby/UI/battle/CListOptionsPanel.form	2008-01-14 20:27:21 UTC (rev 5324)
@@ -0,0 +1,117 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
+
+&lt;Form version=&quot;1.5&quot; maxVersion=&quot;1.5&quot; type=&quot;org.netbeans.modules.form.forminfo.JPanelFormInfo&quot;&gt;
+  &lt;AuxValues&gt;
+    &lt;AuxValue name=&quot;FormSettings_autoResourcing&quot; type=&quot;java.lang.Integer&quot; value=&quot;0&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_autoSetComponentName&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_generateMnemonicsCode&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_i18nAutoMode&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_layoutCodeTarget&quot; type=&quot;java.lang.Integer&quot; value=&quot;1&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_listenerGenerationStyle&quot; type=&quot;java.lang.Integer&quot; value=&quot;0&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesLocal&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;2&quot;/&gt;
+  &lt;/AuxValues&gt;
+
+  &lt;Layout&gt;
+    &lt;DimensionLayout dim=&quot;0&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;jLabel2&quot; alignment=&quot;1&quot; pref=&quot;380&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;ComboBox&quot; pref=&quot;283&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jButton2&quot; min=&quot;-2&quot; pref=&quot;91&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jLabel1&quot; pref=&quot;308&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace type=&quot;unrelated&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jLabel3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+    &lt;DimensionLayout dim=&quot;1&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jLabel3&quot; pref=&quot;36&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;7&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jLabel1&quot; min=&quot;-2&quot; pref=&quot;36&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+              &lt;/Group&gt;
+              &lt;Component id=&quot;jLabel2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;jButton2&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;ComboBox&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace pref=&quot;12&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+  &lt;/Layout&gt;
+  &lt;SubComponents&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel1&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;font&quot; type=&quot;java.awt.Font&quot; editor=&quot;org.netbeans.modules.form.editors2.FontEditor&quot;&gt;
+          &lt;FontInfo relative=&quot;true&quot;&gt;
+            &lt;Font component=&quot;jLabel1&quot; property=&quot;font&quot; relativeSize=&quot;true&quot; size=&quot;5&quot;/&gt;
+          &lt;/FontInfo&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;title&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel2&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;description&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;jButton2&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Reset&quot;/&gt;
+        &lt;Property name=&quot;enabled&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;host&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;Events&gt;
+        &lt;EventHandler event=&quot;actionPerformed&quot; listener=&quot;java.awt.event.ActionListener&quot; parameters=&quot;java.awt.event.ActionEvent&quot; handler=&quot;jButton2ActionPerformed&quot;/&gt;
+      &lt;/Events&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JComboBox&quot; name=&quot;ComboBox&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;model&quot; type=&quot;javax.swing.ComboBoxModel&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;GetComboModel()&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;Events&gt;
+        &lt;EventHandler event=&quot;actionPerformed&quot; listener=&quot;java.awt.event.ActionListener&quot; parameters=&quot;java.awt.event.ActionEvent&quot; handler=&quot;ComboBoxActionPerformed&quot;/&gt;
+      &lt;/Events&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel3&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;icon&quot; type=&quot;javax.swing.Icon&quot; editor=&quot;org.netbeans.modules.form.editors2.IconEditor&quot;&gt;
+          &lt;Image iconType=&quot;3&quot; name=&quot;/images/UI/map.png&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;disabledIcon&quot; type=&quot;javax.swing.Icon&quot; editor=&quot;org.netbeans.modules.form.editors2.IconEditor&quot;&gt;
+          &lt;Image iconType=&quot;3&quot; name=&quot;/images/UI/optionflag.png&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;enabled&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;map&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+  &lt;/SubComponents&gt;
+&lt;/Form&gt;

Added: trunk/Lobby/AFLobby/src/aflobby/UI/battle/CListOptionsPanel.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/UI/battle/CListOptionsPanel.java	                        (rev 0)
+++ trunk/Lobby/AFLobby/src/aflobby/UI/battle/CListOptionsPanel.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -0,0 +1,223 @@
+/*
+ * CBooleanOptionsPanel.java
+ *
+ * Created on 11 January 2008, 21:25
+ */
+
+package aflobby.UI.battle;
+
+import aflobby.CEvent;
+import aflobby.IBattleModel;
+import aflobby.LMain;
+import aflobby.framework.IModule;
+import java.util.List;
+import javax.swing.DefaultComboBoxModel;
+
+
+/**
+ *
+ * @author  tarendai-std
+ */
+public class CListOptionsPanel extends javax.swing.JPanel implements IModule{
+    
+    
+    boolean map;
+    List&lt;ListItem&gt; items;
+    int optionType;
+    String defValue;
+    int maxlength;
+    String title;
+    String description;
+    String key;
+    IBattleModel battlemodel;
+    boolean host;
+    
+    /** Creates new form CBooleanOptionsPanel
+     * @param battlemodel 
+     * @param key
+     * @param defValue
+     * @param items 
+     * @param title
+     * @param description
+     * @param map 
+     */
+    public CListOptionsPanel(
+            IBattleModel battlemodel, String key, String defValue, List&lt;ListItem&gt; items, String title, String description, boolean map) {
+        
+        this.items = items;
+        
+        this.map = map; 
+        
+        this.host = battlemodel.AmIHost();
+        this.defValue = defValue;
+
+        this.title = new String(title);
+        this.key = new String(key);
+        this.description = new String(description);
+        this.battlemodel = battlemodel;
+        battlemodel.PutOption(key, defValue);
+        
+        initComponents();
+    }
+    
+    /**
+     * 
+     * @return
+     */
+    public DefaultComboBoxModel GetComboModel(){
+        DefaultComboBoxModel c = new DefaultComboBoxModel(items.toArray().clone());
+        return c;
+    }
+    
+    public String GetItemName(String key){
+        for(ListItem i : items){
+            if(i.key.equalsIgnoreCase(key)){
+                return i.name;
+            }
+        }
+        return &quot;moo&quot;;
+    }
+    
+    public String GetItemKey(String name){
+        for(ListItem i : items){
+            if(i.name.equalsIgnoreCase(name)){
+                return i.key;
+            }
+        }
+        return &quot;moo&quot;;
+    }
+    
+    /** This method is called from within the constructor to
+     * initialize the form.
+     * WARNING: Do NOT modify this code. The content of this method is
+     * always regenerated by the Form Editor.
+     */
+    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;Generated Code&quot;&gt;//GEN-BEGIN:initComponents
+    private void initComponents() {
+
+        jLabel1 = new javax.swing.JLabel();
+        jLabel2 = new javax.swing.JLabel();
+        jButton2 = new javax.swing.JButton();
+        ComboBox = new javax.swing.JComboBox();
+        jLabel3 = new javax.swing.JLabel();
+
+        jLabel1.setFont(jLabel1.getFont().deriveFont(jLabel1.getFont().getSize()+5f));
+        jLabel1.setText(title);
+
+        jLabel2.setText(description);
+
+        jButton2.setText(&quot;Reset&quot;);
+        jButton2.setEnabled(host);
+        jButton2.addActionListener(new java.awt.event.ActionListener() {
+            public void actionPerformed(java.awt.event.ActionEvent evt) {
+                jButton2ActionPerformed(evt);
+            }
+        });
+
+        ComboBox.setModel(GetComboModel());
+        ComboBox.addActionListener(new java.awt.event.ActionListener() {
+            public void actionPerformed(java.awt.event.ActionEvent evt) {
+                ComboBoxActionPerformed(evt);
+            }
+        });
+
+        jLabel3.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/images/UI/map.png&quot;))); // NOI18N
+        jLabel3.setDisabledIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/images/UI/optionflag.png&quot;))); // NOI18N
+        jLabel3.setEnabled(map);
+
+        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
+        this.setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
+                .addContainerGap()
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
+                    .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
+                    .addGroup(layout.createSequentialGroup()
+                        .addComponent(ComboBox, 0, 283, Short.MAX_VALUE)
+                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                        .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 91, javax.swing.GroupLayout.PREFERRED_SIZE))
+                    .addGroup(layout.createSequentialGroup()
+                        .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, 308, Short.MAX_VALUE)
+                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
+                        .addComponent(jLabel3)))
+                .addContainerGap())
+        );
+        layout.setVerticalGroup(
+            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+            .addGroup(layout.createSequentialGroup()
+                .addContainerGap()
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+                    .addGroup(layout.createSequentialGroup()
+                        .addComponent(jLabel3, javax.swing.GroupLayout.DEFAULT_SIZE, 36, Short.MAX_VALUE)
+                        .addGap(7, 7, 7))
+                    .addGroup(layout.createSequentialGroup()
+                        .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)))
+                .addComponent(jLabel2)
+                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
+                    .addComponent(jButton2)
+                    .addComponent(ComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
+                .addContainerGap(12, Short.MAX_VALUE))
+        );
+    }// &lt;/editor-fold&gt;//GEN-END:initComponents
+
+    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
+        String v = GetItemName(defValue);
+        ComboBox.setSelectedItem(v);
+        battlemodel.PutOption(key, defValue);
+    }//GEN-LAST:event_jButton2ActionPerformed
+
+    private void ComboBoxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ComboBoxActionPerformed
+        ListItem i = (ListItem) ComboBox.getSelectedItem();
+        battlemodel.PutOption(key, i.key);
+    }//GEN-LAST:event_ComboBoxActionPerformed
+    
+    
+    // Variables declaration - do not modify//GEN-BEGIN:variables
+    private javax.swing.JComboBox ComboBox;
+    private javax.swing.JButton jButton2;
+    private javax.swing.JLabel jLabel1;
+    private javax.swing.JLabel jLabel2;
+    private javax.swing.JLabel jLabel3;
+    // End of variables declaration//GEN-END:variables
+
+    public void Init(LMain L) {
+        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);
+    }
+
+    public void Update() {
+        
+    }
+
+    public void NewEvent(CEvent e) {
+        if(e.IsEvent(&quot;SETSCRIPTTAGS&quot;)){
+            //
+            String[] pairs = e.parameters.split(&quot;\t&quot;);
+            
+            for(int i = 0; i&lt; pairs.length; i++){
+                
+                String[] pair = pairs[i].split(&quot;=&quot;);
+                
+                String k = pair[0];
+                k = k.replaceAll(&quot;\\\\&quot;, &quot;/&quot;);
+                String value = pair[1];
+                
+                if(k.equalsIgnoreCase(key)){
+                    ComboBox.setSelectedItem(this.GetItemName(value));
+                }
+                
+            }
+        }
+    }
+
+    public void NewGUIEvent(CEvent e) {
+
+    }
+
+    public void OnRemove() {
+        battlemodel = null;
+    }
+    
+}

Added: trunk/Lobby/AFLobby/src/aflobby/UI/battle/CSliderOptionsPanel.form
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/UI/battle/CSliderOptionsPanel.form	                        (rev 0)
+++ trunk/Lobby/AFLobby/src/aflobby/UI/battle/CSliderOptionsPanel.form	2008-01-14 20:27:21 UTC (rev 5324)
@@ -0,0 +1,150 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
+
+&lt;Form version=&quot;1.5&quot; maxVersion=&quot;1.5&quot; type=&quot;org.netbeans.modules.form.forminfo.JPanelFormInfo&quot;&gt;
+  &lt;AuxValues&gt;
+    &lt;AuxValue name=&quot;FormSettings_autoResourcing&quot; type=&quot;java.lang.Integer&quot; value=&quot;0&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_autoSetComponentName&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_generateMnemonicsCode&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_i18nAutoMode&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_layoutCodeTarget&quot; type=&quot;java.lang.Integer&quot; value=&quot;1&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_listenerGenerationStyle&quot; type=&quot;java.lang.Integer&quot; value=&quot;0&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesLocal&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;2&quot;/&gt;
+  &lt;/AuxValues&gt;
+
+  &lt;Layout&gt;
+    &lt;DimensionLayout dim=&quot;0&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;jLabel2&quot; alignment=&quot;0&quot; pref=&quot;429&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;Slider&quot; pref=&quot;273&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;Spinner&quot; min=&quot;-2&quot; pref=&quot;53&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jButton1&quot; min=&quot;-2&quot; pref=&quot;91&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jLabel1&quot; pref=&quot;361&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jLabel3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+    &lt;DimensionLayout dim=&quot;1&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;8&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jLabel1&quot; min=&quot;-2&quot; pref=&quot;36&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jLabel3&quot; pref=&quot;36&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                  &lt;/Group&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;jLabel2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jButton1&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;Spinner&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;Component id=&quot;Slider&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace pref=&quot;16&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+  &lt;/Layout&gt;
+  &lt;SubComponents&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel2&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;description&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel1&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;font&quot; type=&quot;java.awt.Font&quot; editor=&quot;org.netbeans.modules.form.editors2.FontEditor&quot;&gt;
+          &lt;FontInfo relative=&quot;true&quot;&gt;
+            &lt;Font component=&quot;jLabel1&quot; property=&quot;font&quot; relativeSize=&quot;true&quot; size=&quot;5&quot;/&gt;
+          &lt;/FontInfo&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;title&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JSlider&quot; name=&quot;Slider&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;majorTickSpacing&quot; type=&quot;int&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;step&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;maximum&quot; type=&quot;int&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;max&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;minimum&quot; type=&quot;int&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;min&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;value&quot; type=&quot;int&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;defValue&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;enabled&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;host&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;Events&gt;
+        &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;SliderStateChanged&quot;/&gt;
+      &lt;/Events&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;jButton1&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Reset&quot;/&gt;
+        &lt;Property name=&quot;enabled&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;host&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;Events&gt;
+        &lt;EventHandler event=&quot;actionPerformed&quot; listener=&quot;java.awt.event.ActionListener&quot; parameters=&quot;java.awt.event.ActionEvent&quot; handler=&quot;jButton1ActionPerformed&quot;/&gt;
+      &lt;/Events&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JSpinner&quot; name=&quot;Spinner&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;model&quot; type=&quot;javax.swing.SpinnerModel&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;new javax.swing.SpinnerNumberModel(defValue, min, max, step)&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;enabled&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;host&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;value&quot; type=&quot;java.lang.Object&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;defValue&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;Events&gt;
+        &lt;EventHandler event=&quot;stateChanged&quot; listener=&quot;javax.swing.event.ChangeListener&quot; parameters=&quot;javax.swing.event.ChangeEvent&quot; handler=&quot;SpinnerStateChanged&quot;/&gt;
+      &lt;/Events&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel3&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;icon&quot; type=&quot;javax.swing.Icon&quot; editor=&quot;org.netbeans.modules.form.editors2.IconEditor&quot;&gt;
+          &lt;Image iconType=&quot;3&quot; name=&quot;/images/UI/map.png&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;disabledIcon&quot; type=&quot;javax.swing.Icon&quot; editor=&quot;org.netbeans.modules.form.editors2.IconEditor&quot;&gt;
+          &lt;Image iconType=&quot;3&quot; name=&quot;/images/UI/optionflag.png&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;enabled&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;map&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+  &lt;/SubComponents&gt;
+&lt;/Form&gt;

Added: trunk/Lobby/AFLobby/src/aflobby/UI/battle/CSliderOptionsPanel.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/UI/battle/CSliderOptionsPanel.java	                        (rev 0)
+++ trunk/Lobby/AFLobby/src/aflobby/UI/battle/CSliderOptionsPanel.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -0,0 +1,222 @@
+/*
+ * CSliderOptionsPanel.java
+ *
+ * Created on 12 January 2008, 13:39
+ */
+
+package aflobby.UI.battle;
+
+import aflobby.CEvent;
+import aflobby.IBattleModel;
+import aflobby.LMain;
+import aflobby.framework.IModule;
+
+/**
+ *
+ * @author  tarendai-std
+ */
+public class CSliderOptionsPanel extends javax.swing.JPanel implements IModule{
+    
+    int defValue;
+    String title;
+    String description;
+    String key;
+    IBattleModel battlemodel;
+    boolean host;
+    boolean map;
+    int min;
+    int max;
+    int step;
+    
+    /** Creates new form CSliderOptionsPanel
+     * @param battlemodel
+     * @param key 
+     * @param defValue
+     * @param min 
+     * @param max 
+     * @param step 
+     * @param title
+     * @param description
+     * @param map 
+     */
+    public CSliderOptionsPanel(
+            IBattleModel battlemodel, String key, float defValue, float min, float max, float step, String title, String description, boolean map) {
+        
+        this.host = battlemodel.AmIHost();
+        this.defValue = (int) defValue;
+        this.title = new String(title);
+        this.key = new String(key);
+        this.description = new String(description);
+        this.battlemodel = battlemodel;
+        this.min = (int) min;
+        this.max = (int) max;
+        this.step = (int) step;
+        this.map = map;
+        
+        battlemodel.PutOption(key, defValue);
+        
+        initComponents();
+    }
+    
+    /** This method is called from within the constructor to
+     * initialize the form.
+     * WARNING: Do NOT modify this code. The content of this method is
+     * always regenerated by the Form Editor.
+     */
+    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;Generated Code&quot;&gt;//GEN-BEGIN:initComponents
+    private void initComponents() {
+
+        jLabel2 = new javax.swing.JLabel();
+        jLabel1 = new javax.swing.JLabel();
+        Slider = new javax.swing.JSlider();
+        jButton1 = new javax.swing.JButton();
+        Spinner = new javax.swing.JSpinner();
+        jLabel3 = new javax.swing.JLabel();
+
+        jLabel2.setText(description);
+
+        jLabel1.setFont(jLabel1.getFont().deriveFont(jLabel1.getFont().getSize()+5f));
+        jLabel1.setText(title);
+
+        Slider.setMajorTickSpacing(step);
+        Slider.setMaximum(max);
+        Slider.setMinimum(min);
+        Slider.setValue(defValue);
+        Slider.setEnabled(host);
+        Slider.addChangeListener(new javax.swing.event.ChangeListener() {
+            public void stateChanged(javax.swing.event.ChangeEvent evt) {
+                SliderStateChanged(evt);
+            }
+        });
+
+        jButton1.setText(&quot;Reset&quot;);
+        jButton1.setEnabled(host);
+        jButton1.addActionListener(new java.awt.event.ActionListener() {
+            public void actionPerformed(java.awt.event.ActionEvent evt) {
+                jButton1ActionPerformed(evt);
+            }
+        });
+
+        Spinner.setModel(new javax.swing.SpinnerNumberModel(defValue, min, max, step));
+        Spinner.setEnabled(host);
+        Spinner.setValue(defValue);
+        Spinner.addChangeListener(new javax.swing.event.ChangeListener() {
+            public void stateChanged(javax.swing.event.ChangeEvent evt) {
+                SpinnerStateChanged(evt);
+            }
+        });
+
+        jLabel3.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/images/UI/map.png&quot;))); // NOI18N
+        jLabel3.setDisabledIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/images/UI/optionflag.png&quot;))); // NOI18N
+        jLabel3.setEnabled(map);
+
+        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
+        this.setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+            .addGroup(layout.createSequentialGroup()
+                .addContainerGap()
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+                    .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, 429, Short.MAX_VALUE)
+                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
+                        .addComponent(Slider, javax.swing.GroupLayout.DEFAULT_SIZE, 273, Short.MAX_VALUE)
+                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                        .addComponent(Spinner, javax.swing.GroupLayout.PREFERRED_SIZE, 53, javax.swing.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                        .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 91, javax.swing.GroupLayout.PREFERRED_SIZE))
+                    .addGroup(layout.createSequentialGroup()
+                        .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, 361, Short.MAX_VALUE)
+                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                        .addComponent(jLabel3)))
+                .addContainerGap())
+        );
+        layout.setVerticalGroup(
+            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+            .addGroup(layout.createSequentialGroup()
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
+                    .addGroup(layout.createSequentialGroup()
+                        .addGap(8, 8, 8)
+                        .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE))
+                    .addGroup(layout.createSequentialGroup()
+                        .addContainerGap()
+                        .addComponent(jLabel3, javax.swing.GroupLayout.DEFAULT_SIZE, 36, Short.MAX_VALUE)))
+                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                .addComponent(jLabel2)
+                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
+                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
+                        .addComponent(jButton1)
+                        .addComponent(Spinner, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
+                    .addComponent(Slider, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
+                .addContainerGap(16, Short.MAX_VALUE))
+        );
+    }// &lt;/editor-fold&gt;//GEN-END:initComponents
+
+    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
+        Slider.setValue(defValue);
+        Spinner.setValue(defValue);
+        battlemodel.PutOption(key, defValue);
+    }//GEN-LAST:event_jButton1ActionPerformed
+
+    private void SliderStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_SliderStateChanged
+        int value = Slider.getValue();
+        Spinner.setValue(value);
+        battlemodel.PutOption(key, value);
+    }//GEN-LAST:event_SliderStateChanged
+
+    private void SpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_SpinnerStateChanged
+        Integer value = (Integer) Spinner.getValue();
+        Slider.setValue(value);
+        battlemodel.PutOption(key, value);
+    }//GEN-LAST:event_SpinnerStateChanged
+    
+    
+    // Variables declaration - do not modify//GEN-BEGIN:variables
+    private javax.swing.JSlider Slider;
+    private javax.swing.JSpinner Spinner;
+    private javax.swing.JButton jButton1;
+    private javax.swing.JLabel jLabel1;
+    private javax.swing.JLabel jLabel2;
+    private javax.swing.JLabel jLabel3;
+    // End of variables declaration//GEN-END:variables
+
+    public void Init(LMain L) {
+        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);
+    }
+
+    public void Update() {
+        
+    }
+
+    public void NewEvent(CEvent e) {
+        if(e.IsEvent(&quot;SETSCRIPTTAGS&quot;)){
+            //
+            String[] pairs = e.parameters.split(&quot;\t&quot;);
+            
+            for(int i = 0; i&lt; pairs.length; i++){
+                
+                String[] pair = pairs[i].split(&quot;=&quot;);
+                
+                String k = pair[0];
+                k = k.replaceAll(&quot;\\\\&quot;, &quot;/&quot;);
+                String value = pair[1];
+                
+                if(k.equalsIgnoreCase(key)){
+                    Integer iv = Float.valueOf(value).intValue();
+                    Slider.setValue(iv);
+                    Spinner.setValue(iv);
+                }
+                
+            }
+        }
+    }
+
+    public void NewGUIEvent(CEvent e) {
+
+    }
+
+    public void OnRemove() {
+        battlemodel = null;
+    }
+    
+}

Added: trunk/Lobby/AFLobby/src/aflobby/UI/battle/CStringOptionsPanel.form
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/UI/battle/CStringOptionsPanel.form	                        (rev 0)
+++ trunk/Lobby/AFLobby/src/aflobby/UI/battle/CStringOptionsPanel.form	2008-01-14 20:27:21 UTC (rev 5324)
@@ -0,0 +1,112 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
+
+&lt;Form version=&quot;1.5&quot; maxVersion=&quot;1.5&quot; type=&quot;org.netbeans.modules.form.forminfo.JPanelFormInfo&quot;&gt;
+  &lt;AuxValues&gt;
+    &lt;AuxValue name=&quot;FormSettings_autoResourcing&quot; type=&quot;java.lang.Integer&quot; value=&quot;0&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_autoSetComponentName&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_generateMnemonicsCode&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_i18nAutoMode&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_layoutCodeTarget&quot; type=&quot;java.lang.Integer&quot; value=&quot;1&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_listenerGenerationStyle&quot; type=&quot;java.lang.Integer&quot; value=&quot;0&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesLocal&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;2&quot;/&gt;
+  &lt;/AuxValues&gt;
+
+  &lt;Layout&gt;
+    &lt;DimensionLayout dim=&quot;0&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;jLabel2&quot; alignment=&quot;1&quot; pref=&quot;380&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;TextField&quot; pref=&quot;283&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jButton2&quot; min=&quot;-2&quot; pref=&quot;91&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jLabel1&quot; pref=&quot;308&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace type=&quot;unrelated&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jLabel3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+    &lt;DimensionLayout dim=&quot;1&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;jLabel3&quot; pref=&quot;36&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                  &lt;Component id=&quot;jLabel1&quot; min=&quot;-2&quot; pref=&quot;36&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;jLabel2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;jButton2&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;TextField&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace pref=&quot;13&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+  &lt;/Layout&gt;
+  &lt;SubComponents&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel1&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;font&quot; type=&quot;java.awt.Font&quot; editor=&quot;org.netbeans.modules.form.editors2.FontEditor&quot;&gt;
+          &lt;FontInfo relative=&quot;true&quot;&gt;
+            &lt;Font component=&quot;jLabel1&quot; property=&quot;font&quot; relativeSize=&quot;true&quot; size=&quot;5&quot;/&gt;
+          &lt;/FontInfo&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;title&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel2&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;description&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;jButton2&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Reset&quot;/&gt;
+        &lt;Property name=&quot;enabled&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;host&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;Events&gt;
+        &lt;EventHandler event=&quot;actionPerformed&quot; listener=&quot;java.awt.event.ActionListener&quot; parameters=&quot;java.awt.event.ActionEvent&quot; handler=&quot;jButton2ActionPerformed&quot;/&gt;
+      &lt;/Events&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JTextField&quot; name=&quot;TextField&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;nextFocusableComponent&quot; type=&quot;java.awt.Component&quot; editor=&quot;org.netbeans.modules.form.ComponentChooserEditor&quot;&gt;
+          &lt;ComponentRef name=&quot;jButton2&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;AuxValues&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;AbstractDocument doc = (AbstractDocument)TextField.getDocument();&amp;#xd;&amp;#xa;doc.setDocumentFilter(new DocumentSizeFilter(3));&quot;/&gt;
+      &lt;/AuxValues&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel3&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;icon&quot; type=&quot;javax.swing.Icon&quot; editor=&quot;org.netbeans.modules.form.editors2.IconEditor&quot;&gt;
+          &lt;Image iconType=&quot;3&quot; name=&quot;/images/UI/map.png&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;disabledIcon&quot; type=&quot;javax.swing.Icon&quot; editor=&quot;org.netbeans.modules.form.editors2.IconEditor&quot;&gt;
+          &lt;Image iconType=&quot;3&quot; name=&quot;/images/UI/optionflag.png&quot;/&gt;
+        &lt;/Property&gt;
+        &lt;Property name=&quot;enabled&quot; type=&quot;boolean&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;map&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+    &lt;/Component&gt;
+  &lt;/SubComponents&gt;
+&lt;/Form&gt;

Added: trunk/Lobby/AFLobby/src/aflobby/UI/battle/CStringOptionsPanel.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/UI/battle/CStringOptionsPanel.java	                        (rev 0)
+++ trunk/Lobby/AFLobby/src/aflobby/UI/battle/CStringOptionsPanel.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -0,0 +1,179 @@
+/*
+ * CBooleanOptionsPanel.java
+ *
+ * Created on 11 January 2008, 21:25
+ */
+
+package aflobby.UI.battle;
+
+import aflobby.CEvent;
+import aflobby.IBattleModel;
+import aflobby.LMain;
+import aflobby.UI.DocumentSizeFilter;
+import aflobby.framework.IModule;
+import javax.swing.text.AbstractDocument;
+
+/**
+ *
+ * @author  tarendai-std
+ */
+public class CStringOptionsPanel extends javax.swing.JPanel implements IModule{
+    
+    int optionType;
+    String defValue;
+    int maxlength;
+    String title;
+    String description;
+    String key;
+    IBattleModel battlemodel;
+    boolean map;
+    boolean host;
+    
+    /** Creates new form CBooleanOptionsPanel
+     * @param battlemodel 
+     * @param key
+     * @param defValue
+     * @param maxlength 
+     * @param title
+     * @param description
+     * @param map 
+     */
+    public CStringOptionsPanel(
+            IBattleModel battlemodel, String key, String defValue, int maxlength, String title, String description, boolean map) {
+        
+        this.host = battlemodel.AmIHost();
+        this.defValue = defValue;
+        this.maxlength = maxlength;
+        this.title = new String(title);
+        this.key = new String(key);
+        this.description = new String(description);
+        this.battlemodel = battlemodel;
+        this.map = map;
+        
+        battlemodel.PutOption(key, defValue);
+        
+        initComponents();
+    }
+    
+    /** This method is called from within the constructor to
+     * initialize the form.
+     * WARNING: Do NOT modify this code. The content of this method is
+     * always regenerated by the Form Editor.
+     */
+    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;Generated Code&quot;&gt;//GEN-BEGIN:initComponents
+    private void initComponents() {
+
+        jLabel1 = new javax.swing.JLabel();
+        jLabel2 = new javax.swing.JLabel();
+        jButton2 = new javax.swing.JButton();
+        TextField = new javax.swing.JTextField();
+        jLabel3 = new javax.swing.JLabel();
+
+        jLabel1.setFont(jLabel1.getFont().deriveFont(jLabel1.getFont().getSize()+5f));
+        jLabel1.setText(title);
+
+        jLabel2.setText(description);
+
+        jButton2.setText(&quot;Reset&quot;);
+        jButton2.setEnabled(host);
+        jButton2.addActionListener(new java.awt.event.ActionListener() {
+            public void actionPerformed(java.awt.event.ActionEvent evt) {
+                jButton2ActionPerformed(evt);
+            }
+        });
+
+        TextField.setNextFocusableComponent(jButton2);
+        AbstractDocument doc = (AbstractDocument)TextField.getDocument();
+        doc.setDocumentFilter(new DocumentSizeFilter(3));
+
+        jLabel3.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/images/UI/map.png&quot;))); // NOI18N
+        jLabel3.setDisabledIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/images/UI/optionflag.png&quot;))); // NOI18N
+        jLabel3.setEnabled(map);
+
+        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
+        this.setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
+                .addContainerGap()
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
+                    .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
+                    .addGroup(layout.createSequentialGroup()
+                        .addComponent(TextField, javax.swing.GroupLayout.DEFAULT_SIZE, 283, Short.MAX_VALUE)
+                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                        .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 91, javax.swing.GroupLayout.PREFERRED_SIZE))
+                    .addGroup(layout.createSequentialGroup()
+                        .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, 308, Short.MAX_VALUE)
+                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
+                        .addComponent(jLabel3)))
+                .addContainerGap())
+        );
+        layout.setVerticalGroup(
+            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
+            .addGroup(layout.createSequentialGroup()
+                .addContainerGap()
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
+                    .addComponent(jLabel3, javax.swing.GroupLayout.DEFAULT_SIZE, 36, Short.MAX_VALUE)
+                    .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE))
+                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                .addComponent(jLabel2)
+                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
+                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
+                    .addComponent(jButton2)
+                    .addComponent(TextField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
+                .addContainerGap(13, Short.MAX_VALUE))
+        );
+    }// &lt;/editor-fold&gt;//GEN-END:initComponents
+
+    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
+        TextField.setText(defValue);
+        battlemodel.PutOption(key, TextField.getText());
+    }//GEN-LAST:event_jButton2ActionPerformed
+    
+    
+    // Variables declaration - do not modify//GEN-BEGIN:variables
+    private javax.swing.JTextField TextField;
+    private javax.swing.JButton jButton2;
+    private javax.swing.JLabel jLabel1;
+    private javax.swing.JLabel jLabel2;
+    private javax.swing.JLabel jLabel3;
+    // End of variables declaration//GEN-END:variables
+
+    public void Init(LMain L) {
+        throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);
+    }
+
+    public void Update() {
+        
+    }
+
+    public void NewEvent(CEvent e) {
+        if(e.IsEvent(&quot;SETSCRIPTTAGS&quot;)){
+            //
+            String[] pairs = e.parameters.split(&quot;\t&quot;);
+            
+            for(int i = 0; i&lt; pairs.length; i++){
+                
+                String[] pair = pairs[i].split(&quot;=&quot;);
+                
+                String k = pair[0];
+                k = k.replaceAll(&quot;\\\\&quot;, &quot;/&quot;);
+                String value = pair[1];
+                
+                if(k.equalsIgnoreCase(key)){
+                    TextField.setText(value);
+                }
+                
+            }
+        }
+    }
+
+    public void NewGUIEvent(CEvent e) {
+
+    }
+
+    public void OnRemove() {
+        battlemodel = null;
+    }
+    
+}

Added: trunk/Lobby/AFLobby/src/aflobby/UI/battle/ListItem.java
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/UI/battle/ListItem.java	                        (rev 0)
+++ trunk/Lobby/AFLobby/src/aflobby/UI/battle/ListItem.java	2008-01-14 20:27:21 UTC (rev 5324)
@@ -0,0 +1,28 @@
+/*
+ * To change this template, choose Tools | Templates
+ * and open the template in the editor.
+ */
+
+package aflobby.UI.battle;
+
+/**
+ * An object to hold data about an item in a lua list option
+ */
+public class ListItem {
+
+    /**
+     * 
+     */
+    public ListItem(){
+        //
+    }
+
+    public String key;
+    public String name;
+    public String description;
+    
+    @Override
+    public String toString(){
+        return name;
+    }
+}
\ No newline at end of file

Modified: trunk/Lobby/AFLobby/src/aflobby/languages.properties
===================================================================
--- trunk/Lobby/AFLobby/src/aflobby/languages.properties	2008-01-14 20:04:17 UTC (rev 5323)
+++ trunk/Lobby/AFLobby/src/aflobby/languages.properties	2008-01-14 20:27:21 UTC (rev 5324)
@@ -108,7 +108,7 @@
 CBattleWindow.UnRestrict_All_Units=UnRestrict All Units
 
 CBattleWindow.refresh_debug_script=refresh debug script
-CBattleWindow.debugScriptNote=&lt;html&gt;This will be the gamescript generated by this battle that is fed to Spring to start and configure the game.&lt;br&gt;&lt;br&gt;It cannot be manually edited, and serves as a debugging/learning tool.
+CBattleWindow.debugScriptNote=&lt;html&gt;This will be the gamescript generated by this battle that is fed to Spring to start and configure the game.It cannot be manually edited, and serves as a debugging/learning tool.
 
 CBattleWindow.suggests_this_map\:_=suggests this map\: 
 

Added: trunk/Lobby/AFLobby/src/images/UI/dice.png
===================================================================
(Binary files differ)


Property changes on: trunk/Lobby/AFLobby/src/images/UI/dice.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/Lobby/AFLobby/src/images/UI/map.png
===================================================================
(Binary files differ)


Property changes on: trunk/Lobby/AFLobby/src/images/UI/map.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/Lobby/AFLobby/src/images/UI/optionflag.png
===================================================================
(Binary files differ)


Property changes on: trunk/Lobby/AFLobby/src/images/UI/optionflag.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000130.html">[Taspring-linux-commit] r5323 - trunk/rts/Game
</A></li>
	<LI>Next message: <A HREF="000132.html">[Taspring-linux-commit] r5325 - trunk/Lobby/TASClient
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#131">[ date ]</a>
              <a href="thread.html#131">[ thread ]</a>
              <a href="subject.html#131">[ subject ]</a>
              <a href="author.html#131">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
