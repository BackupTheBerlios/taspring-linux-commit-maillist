<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r5256 - trunk/Lobby/TASClient
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-January/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r5256%20-%20trunk/Lobby/TASClient&In-Reply-To=%3CE1JAnnD-0000vA-Q7%40proserver.fnord.lan%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000063.html">
   <LINK REL="Next"  HREF="000067.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r5256 - trunk/Lobby/TASClient</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r5256%20-%20trunk/Lobby/TASClient&In-Reply-To=%3CE1JAnnD-0000vA-Q7%40proserver.fnord.lan%3E"
       TITLE="[Taspring-linux-commit] r5256 - trunk/Lobby/TASClient">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Fri Jan  4 15:45:03 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000063.html">[Taspring-linux-commit] r5255 - in trunk/rts: Game System	System/Net System/Net/Test
</A></li>
        <LI>Next message: <A HREF="000067.html">[Taspring-linux-commit] r5257 - trunk/rts/System/Net
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66">[ date ]</a>
              <a href="thread.html#66">[ thread ]</a>
              <a href="subject.html#66">[ subject ]</a>
              <a href="author.html#66">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: satirik
Date: 2008-01-04 15:45:03 +0100 (Fri, 04 Jan 2008)
New Revision: 5256

Modified:
   trunk/Lobby/TASClient/MainUnit.dfm
   trunk/Lobby/TASClient/MainUnit.pas
Log:
- players and maxplayers filters now have their own checkbox

Modified: trunk/Lobby/TASClient/MainUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/MainUnit.dfm	2008-01-04 14:42:13 UTC (rev 5255)
+++ trunk/Lobby/TASClient/MainUnit.dfm	2008-01-04 14:45:03 UTC (rev 5256)
@@ -244,7 +244,7 @@
           object FilterValueTextBox: TSpTBXEdit
             Left = 216
             Top = 16
-            Width = 137
+            Width = 161
             Height = 21
             TabOrder = 0
           end
@@ -267,7 +267,7 @@
             Checked = True
           end
           object AddToFilterListButton: TSpTBXButton
-            Left = 360
+            Left = 384
             Top = 16
             Width = 33
             Height = 25
@@ -297,7 +297,7 @@
               'Description')
           end
           object RemoveFromFilterListButton: TSpTBXButton
-            Left = 360
+            Left = 384
             Top = 48
             Width = 33
             Height = 25
@@ -311,7 +311,7 @@
             LinkFont.Style = [fsUnderline]
           end
           object ClearFilterListButton: TSpTBXButton
-            Left = 360
+            Left = 384
             Top = 80
             Width = 33
             Height = 25
@@ -340,9 +340,9 @@
             OnClick = EnableFiltersClick
           end
           object FilterList: TVirtualStringTree
-            Left = 400
+            Left = 424
             Top = 16
-            Width = 201
+            Width = 177
             Height = 145
             Anchors = [akLeft, akTop, akRight]
             ClipboardFormats.Strings = (
@@ -379,14 +379,14 @@
               end
               item
                 Position = 2
-                Width = 67
+                Width = 43
                 WideText = 'Value'
               end&gt;
           end
           object SpTBXPanel1: TSpTBXPanel
             Left = 8
             Top = 48
-            Width = 345
+            Width = 369
             Height = 97
             Caption = 'SpTBXPanel1'
             ThemeType = thtWindows
@@ -483,25 +483,13 @@
               TabOrder = 9
               OnClick = NatTraversalFilterClick
             end
-            object SpTBXLabel1: TSpTBXLabel
-              Left = 208
-              Top = 12
-              Width = 37
-              Height = 13
-              Caption = 'Players '
-              LinkFont.Charset = DEFAULT_CHARSET
-              LinkFont.Color = clBlue
-              LinkFont.Height = -11
-              LinkFont.Name = 'MS Sans Serif'
-              LinkFont.Style = [fsUnderline]
-            end
             object PlayersSignButton: TSpTBXButton
-              Left = 272
+              Left = 296
               Top = 8
               Width = 25
               Height = 20
               Caption = '&lt;'
-              TabOrder = 11
+              TabOrder = 10
               OnClick = PlayersSignButtonClick
               LinkFont.Charset = DEFAULT_CHARSET
               LinkFont.Color = clBlue
@@ -510,35 +498,23 @@
               LinkFont.Style = [fsUnderline]
             end
             object PlayersValueTextBox: TJvSpinEdit
-              Left = 296
+              Left = 320
               Top = 8
               Width = 41
               Height = 20
               ButtonKind = bkStandard
               MaxValue = 16.000000000000000000
               Value = 10.000000000000000000
-              TabOrder = 12
+              TabOrder = 11
               OnChange = PlayersValueTextBoxChange
             end
-            object SpTBXLabel2: TSpTBXLabel
-              Left = 208
-              Top = 40
-              Width = 60
-              Height = 13
-              Caption = 'Max Players '
-              LinkFont.Charset = DEFAULT_CHARSET
-              LinkFont.Color = clBlue
-              LinkFont.Height = -11
-              LinkFont.Name = 'MS Sans Serif'
-              LinkFont.Style = [fsUnderline]
-            end
             object MaxPlayersSignButton: TSpTBXButton
-              Left = 272
+              Left = 296
               Top = 39
               Width = 25
               Height = 20
               Caption = '&lt;'
-              TabOrder = 14
+              TabOrder = 12
               OnClick = MaxPlayersSignButtonClick
               LinkFont.Charset = DEFAULT_CHARSET
               LinkFont.Color = clBlue
@@ -547,7 +523,7 @@
               LinkFont.Style = [fsUnderline]
             end
             object MaxPlayersValueTextBox: TJvSpinEdit
-              Left = 296
+              Left = 320
               Top = 39
               Width = 41
               Height = 20
@@ -555,9 +531,27 @@
               MaxValue = 16.000000000000000000
               MinValue = 1.000000000000000000
               Value = 10.000000000000000000
-              TabOrder = 15
+              TabOrder = 13
               OnChange = MaxPlayersValueTextBoxChange
             end
+            object MaxPlayersFilter: TSpTBXCheckBox
+              Left = 216
+              Top = 40
+              Width = 78
+              Height = 15
+              Caption = 'Max Players '
+              TabOrder = 14
+              OnClick = MaxPlayersFilterClick
+            end
+            object PlayersFilter: TSpTBXCheckBox
+              Left = 216
+              Top = 10
+              Width = 55
+              Height = 15
+              Caption = 'Players '
+              TabOrder = 15
+              OnClick = PlayersFilterClick
+            end
           end
         end
         object FiltersButton: TSpTBXButton

Modified: trunk/Lobby/TASClient/MainUnit.pas
===================================================================
--- trunk/Lobby/TASClient/MainUnit.pas	2008-01-04 14:42:13 UTC (rev 5255)
+++ trunk/Lobby/TASClient/MainUnit.pas	2008-01-04 14:45:03 UTC (rev 5256)
@@ -903,14 +903,14 @@
     ModsNotAvailableFilter: TSpTBXCheckBox;
     MapsNotAvailableFilter: TSpTBXCheckBox;
     NatTraversalFilter: TSpTBXCheckBox;
-    SpTBXLabel1: TSpTBXLabel;
     PlayersSignButton: TSpTBXButton;
     PlayersValueTextBox: TJvSpinEdit;
-    SpTBXLabel2: TSpTBXLabel;
     MaxPlayersSignButton: TSpTBXButton;
     MaxPlayersValueTextBox: TJvSpinEdit;
     Sortbygroup1: TMenuItem;
     HighlighBattlesTimer: TTimer;
+    MaxPlayersFilter: TSpTBXCheckBox;
+    PlayersFilter: TSpTBXCheckBox;
     procedure mnuOpenPrivateChatClick(Sender: TObject);
     procedure mnuSelectBattleClick(Sender: TObject);
     procedure SpTBXItem1Click(Sender: TObject);
@@ -983,6 +983,8 @@
     procedure UpdateFilters;
     procedure HighlighBattlesTimerTimer(Sender: TObject);
     procedure FormResize(Sender: TObject);
+    procedure PlayersFilterClick(Sender: TObject);
+    procedure MaxPlayersFilterClick(Sender: TObject);
 
   published
     MainTitleBar: TSpTBXTitleBar;
@@ -1268,7 +1270,9 @@
     MapNotAvailable: Boolean;
     ModNotAvailable: Boolean;
     Replays: Boolean;
+    PlayersEnabled: Boolean;
     Players: TFilterNumber;
+    MaxPlayersEnabled: Boolean;
     MaxPlayers: TFilterNumber;
     TextFilters: TList;
   end;
@@ -7118,10 +7122,12 @@
       (not Filters.RankLimitSupEqMine or (Status.Me.GetRank &gt;= Battle.RankLimit)) and
       (
       (Filters.Replays and (Battle.BattleType = 1)) or
+      not Filters.PlayersEnabled or
       ((Filters.Players.filterType = Sup) and ((Battle.Clients.Count-Battle.SpectatorCount) &gt; Filters.Players.value)) or
       ((Filters.Players.filterType = Inf) and ((Battle.Clients.Count-Battle.SpectatorCount) &lt; Filters.Players.value)) or
       ((Filters.Players.filterType = Equal) and ((Battle.Clients.Count-Battle.SpectatorCount) = Filters.Players.value))
       ) and (
+      not Filters.MaxPlayersEnabled or
       ((Filters.MaxPlayers.filterType = Sup) and (Battle.MaxPlayers &gt; Filters.MaxPlayers.value)) or
       ((Filters.MaxPlayers.filterType = Inf) and (Battle.MaxPlayers &lt; Filters.MaxPlayers.value)) or
       ((Filters.MaxPlayers.filterType = Equal) and (Battle.MaxPlayers = Filters.MaxPlayers.value))
@@ -8404,6 +8410,8 @@
     Ini.WriteBool('StaticFilters','MapNotAvailable',Filters.MapNotAvailable);
     Ini.WriteBool('StaticFilters','ModNotAvailable',Filters.ModNotAvailable);
     Ini.WriteBool('StaticFilters','Replays',Filters.Replays);
+    Ini.WriteBool('StaticFilters','Players',Filters.PlayersEnabled);
+    Ini.WriteBool('StaticFilters','MaxPlayers',Filters.MaxPlayersEnabled);
   
     if Filters.Players.filterType = Sup then
       Ini.WriteString('StaticFilters','PlayersSign','sup')
@@ -8464,6 +8472,8 @@
   Filters.MapNotAvailable := Ini.ReadBool('StaticFilters', 'MapNotAvailable', True);
   Filters.ModNotAvailable := Ini.ReadBool('StaticFilters', 'ModNotAvailable', True);
   Filters.Replays := Ini.ReadBool('StaticFilters', 'Replays', True);
+  Filters.PlayersEnabled := Ini.ReadBool('StaticFilters', 'Players', False);
+  Filters.MaxPlayersEnabled := Ini.ReadBool('StaticFilters', 'MaxPlayers', False);
 
   tmpStr := Ini.ReadString('StaticFilters', 'PlayersSign', 'sup');
   if tmpStr = 'sup' then
@@ -8523,6 +8533,8 @@
   ModsNotAvailableFilter.Checked := Filters.ModNotAvailable;
   ReplaysFilter.Checked := Filters.Replays;
   RankLimitFilter.Checked := Filters.RankLimitSupEqMine;
+  PlayersFilter.Checked := Filters.PlayersEnabled;
+  MaxPlayersFilter.Checked := Filters.MaxPlayersEnabled;
 
   if Filters.Players.filterType = Sup then
     PlayersSignButton.Caption := '&gt;'
@@ -8559,4 +8571,16 @@
   FixFormSizeConstraints(MainForm);
 end;
 
+procedure TMainForm.PlayersFilterClick(Sender: TObject);
+begin
+  Filters.PlayersEnabled := PlayersFilter.Checked;
+  RefreshBattleList;
+end;
+
+procedure TMainForm.MaxPlayersFilterClick(Sender: TObject);
+begin
+  Filters.MaxPlayersEnabled := MaxPlayersFilter.Checked;
+  RefreshBattleList;
+end;
+
 end.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000063.html">[Taspring-linux-commit] r5255 - in trunk/rts: Game System	System/Net System/Net/Test
</A></li>
	<LI>Next message: <A HREF="000067.html">[Taspring-linux-commit] r5257 - trunk/rts/System/Net
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66">[ date ]</a>
              <a href="thread.html#66">[ thread ]</a>
              <a href="subject.html#66">[ subject ]</a>
              <a href="author.html#66">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
