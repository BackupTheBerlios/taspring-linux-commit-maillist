<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r6497 - branches/caiinterface/tools/unitsync
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-October/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r6497%20-%20branches/caiinterface/tools/unitsync&In-Reply-To=%3C20081001212030.3F0A24A43%40progate.clan-sy.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001266.html">
   <LINK REL="Next"  HREF="001268.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r6497 - branches/caiinterface/tools/unitsync</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r6497%20-%20branches/caiinterface/tools/unitsync&In-Reply-To=%3C20081001212030.3F0A24A43%40progate.clan-sy.com%3E"
       TITLE="[Taspring-linux-commit] r6497 - branches/caiinterface/tools/unitsync">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Wed Oct  1 23:20:29 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001266.html">[Taspring-linux-commit] r6496 - in branches/caiinterface/game/AI: .	Interfaces Skirmish
</A></li>
        <LI>Next message: <A HREF="001268.html">[Taspring-linux-commit] r6498 - trunk/rts/Map/SMF
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1267">[ date ]</a>
              <a href="thread.html#1267">[ thread ]</a>
              <a href="subject.html#1267">[ subject ]</a>
              <a href="author.html#1267">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: hoijui
Date: 2008-10-01 23:20:29 +0200 (Wed, 01 Oct 2008)
New Revision: 6497

Modified:
   branches/caiinterface/tools/unitsync/unitsync.cpp
   branches/caiinterface/tools/unitsync/unitsync.h
   branches/caiinterface/tools/unitsync/unitsync_api.h
Log:
making unitsync use exportdefines.h (eg replacing DLL_EXPORT with Export)

Modified: branches/caiinterface/tools/unitsync/unitsync.cpp
===================================================================
--- branches/caiinterface/tools/unitsync/unitsync.cpp	2008-10-01 18:24:14 UTC (rev 6496)
+++ branches/caiinterface/tools/unitsync/unitsync.cpp	2008-10-01 21:20:29 UTC (rev 6497)
@@ -90,7 +90,7 @@
 
 
 #ifdef WIN32
-BOOL DllMain(HINSTANCE hInst,
+BOOL CALLING_CONV DllMain(HINSTANCE hInst,
                        DWORD dwReason,
                        LPVOID lpReserved) {
 	logOutput.Print(&quot;----\nunitsync loaded\n&quot;);
@@ -130,17 +130,17 @@
 };
 
 
-const char* GetSpringVersion()
+Export(const char*) GetSpringVersion()
 {
 	return VERSION_STRING;
 }
 
-void Message(const char* p_szMessage)
+Export(void) Message(const char* p_szMessage)
 {
 	MessageBox(NULL, p_szMessage, &quot;Message from DLL&quot;, MB_OK);
 }
 
-void UnInit()
+Export(void) UnInit()
 {
 	lpClose();
 
@@ -156,7 +156,7 @@
 	ConfigHandler::Deallocate();
 }
 
-int Init(bool isServer, int id)
+Export(int) Init(bool isServer, int id)
 {
 	UnInit();
 	logOutput.Print(&quot;unitsync initialized\n&quot;);
@@ -181,19 +181,19 @@
 	return 1;
 }
 
-int ProcessUnits(void)
+Export(int) ProcessUnits(void)
 {
 	logOutput.Print(&quot;syncer: process units\n&quot;);
 	return syncer-&gt;ProcessUnits();
 }
 
-int ProcessUnitsNoChecksum(void)
+Export(int) ProcessUnitsNoChecksum(void)
 {
 	logOutput.Print(&quot;syncer: process units\n&quot;);
 	return syncer-&gt;ProcessUnits(false);
 }
 
-const char* GetCurrentList()
+Export(const char*) GetCurrentList()
 {
 	logOutput.Print(&quot;syncer: get current list\n&quot;);
 	string tmp = syncer-&gt;GetCurrentList();
@@ -213,52 +213,52 @@
 	return GetStr(tmp);
 }
 
-void AddClient(int id, const char *unitList)
+Export(void) AddClient(int id, const char *unitList)
 {
 	logOutput.Print(&quot;syncer: add client\n&quot;);
 	((CSyncServer *)syncer)-&gt;AddClient(id, unitList);
 }
 
-void RemoveClient(int id)
+Export(void) RemoveClient(int id)
 {
 	logOutput.Print(&quot;syncer: remove client\n&quot;);
 	((CSyncServer *)syncer)-&gt;RemoveClient(id);
 }
 
-const char* GetClientDiff(int id)
+Export(const char*) GetClientDiff(int id)
 {
 	logOutput.Print(&quot;syncer: get client diff\n&quot;);
 	string tmp = ((CSyncServer *)syncer)-&gt;GetClientDiff(id);
 	return GetStr(tmp);
 }
 
-void InstallClientDiff(const char *diff)
+Export(void) InstallClientDiff(const char *diff)
 {
 	logOutput.Print(&quot;syncer: install client diff\n&quot;);
 	syncer-&gt;InstallClientDiff(diff);
 }
 
-int GetUnitCount()
+Export(int) GetUnitCount()
 {
 	logOutput.Print(&quot;syncer: get unit count\n&quot;);
 	return syncer-&gt;GetUnitCount();
 }
 
-const char* GetUnitName(int unit)
+Export(const char*) GetUnitName(int unit)
 {
 	logOutput.Print(&quot;syncer: get unit %d name\n&quot;, unit);
 	string tmp = syncer-&gt;GetUnitName(unit);
 	return GetStr(tmp);
 }
 
-const char* GetFullUnitName(int unit)
+Export(const char*) GetFullUnitName(int unit)
 {
 	logOutput.Print(&quot;syncer: get full unit %d name\n&quot;, unit);
 	string tmp = syncer-&gt;GetFullUnitName(unit);
 	return GetStr(tmp);
 }
 
-int IsUnitDisabled(int unit)
+Export(int) IsUnitDisabled(int unit)
 {
 	logOutput.Print(&quot;syncer: is unit %d disabled\n&quot;, unit);
 	if (syncer-&gt;IsUnitDisabled(unit))
@@ -267,7 +267,7 @@
 		return 0;
 }
 
-int IsUnitDisabledByClient(int unit, int clientId)
+Export(int) IsUnitDisabledByClient(int unit, int clientId)
 {
 	logOutput.Print(&quot;syncer: is unit %d disabled by client %d\n&quot;, unit, clientId);
 	if (syncer-&gt;IsUnitDisabledByClient(unit, clientId))
@@ -279,14 +279,14 @@
 //////////////////////////
 //////////////////////////
 
-void AddArchive(const char* name)
+Export(void) AddArchive(const char* name)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before AddArchive.&quot;);
 	ASSERT(name &amp;&amp; *name, &quot;Don't pass a NULL pointer or an empty string to AddArchive.&quot;);
 	vfsHandler-&gt;AddArchive(name, false);
 }
 
-void AddAllArchives(const char* root)
+Export(void) AddAllArchives(const char* root)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before AddAllArchives.&quot;);
 	ASSERT(root &amp;&amp; *root, &quot;Don't pass a NULL pointer or an empty string to AddAllArchives.&quot;);
@@ -298,7 +298,7 @@
 	}
 }
 
-unsigned int GetArchiveChecksum(const char* arname)
+Export(unsigned int) GetArchiveChecksum(const char* arname)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetArchiveChecksum.&quot;);
 	ASSERT(arname &amp;&amp; *arname, &quot;Don't pass a NULL pointer or an empty string to GetArchiveChecksum.&quot;);
@@ -306,7 +306,7 @@
 	return archiveScanner-&gt;GetArchiveChecksum(arname);
 }
 
-const char* GetArchivePath(const char* arname)
+Export(const char*) GetArchivePath(const char* arname)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetArchivePath.&quot;);
 	ASSERT(arname &amp;&amp; *arname, &quot;Don't pass a NULL pointer or an empty string to GetArchivePath.&quot;);
@@ -317,7 +317,7 @@
 // Updated on every call to GetMapCount
 static vector&lt;string&gt; mapNames;
 
-int GetMapCount()
+Export(int) GetMapCount()
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetMapCount.&quot;);
 	//vector&lt;string&gt; files = CFileHandler::FindFiles(&quot;{maps/*.smf,maps/*.sm3}&quot;);
@@ -341,7 +341,7 @@
 	return mapNames.size();
 }
 
-const char* GetMapName(int index)
+Export(const char*) GetMapName(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetMapName.&quot;);
 	ASSERT((unsigned)index &lt; mapNames.size(), &quot;Array index out of bounds. Call GetMapCount before GetMapName.&quot;);
@@ -349,7 +349,7 @@
 }
 
 
-int GetMapInfoEx(const char* name, MapInfo* outInfo, int version)
+Export(int) GetMapInfoEx(const char* name, MapInfo* outInfo, int version)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetMapInfo.&quot;);
 	ASSERT(name &amp;&amp; *name &amp;&amp; outInfo, &quot;Don't pass a NULL pointer or an empty string to GetMapInfo.&quot;);
@@ -447,35 +447,35 @@
 }
 
 
-int GetMapInfo(const char* name, MapInfo* outInfo)
+Export(int) GetMapInfo(const char* name, MapInfo* outInfo)
 {
 	return GetMapInfoEx(name, outInfo, 0);
 }
 
 static vector&lt;string&gt; mapArchives;
 
-int GetMapArchiveCount(const char* mapName)
+Export(int) GetMapArchiveCount(const char* mapName)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetMapArchiveCount.&quot;);
 	mapArchives = archiveScanner-&gt;GetArchivesForMap(mapName);
 	return mapArchives.size();
 }
 
-const char* GetMapArchiveName(int index)
+Export(const char*) GetMapArchiveName(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetMapArchiveName.&quot;);
 	ASSERT((unsigned)index &lt; mapArchives.size(), &quot;Array index out of bounds. Call GetMapArchiveCount before GetMapArchiveName.&quot;);
 	return GetStr(mapArchives[index]);
 }
 
-unsigned int GetMapChecksum(int index)
+Export(unsigned int) GetMapChecksum(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetMapChecksum.&quot;);
 	ASSERT((unsigned)index &lt; mapNames.size(), &quot;Array index out of bounds. Call GetMapCount before GetMapChecksum.&quot;);
 	return archiveScanner-&gt;GetMapChecksum(mapNames[index]);
 }
 
-unsigned int GetMapChecksumFromName(const char* mapName)
+Export(unsigned int) GetMapChecksumFromName(const char* mapName)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetMapChecksumFromName.&quot;);
 	return archiveScanner-&gt;GetMapChecksum(mapName);
@@ -645,7 +645,7 @@
 	return (void*)ret;
 }
 
-void* GetMinimap(const char* filename, int miplevel)
+Export(void*) GetMinimap(const char* filename, int miplevel)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetMinimap.&quot;);
 	ASSERT(filename &amp;&amp; *filename, &quot;Don't pass a NULL pointer or an empty string to GetMinimap.&quot;);
@@ -674,7 +674,7 @@
 vector&lt;CArchiveScanner::ModData&gt; modData;
 
 
-int GetPrimaryModCount()
+Export(int) GetPrimaryModCount()
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModCount.&quot;);
 	modData = archiveScanner-&gt;GetPrimaryMods();
@@ -682,7 +682,7 @@
 }
 
 
-const char* GetPrimaryModName(int index)
+Export(const char*) GetPrimaryModName(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModName.&quot;);
 	ASSERT((unsigned)index &lt; modData.size(), &quot;Array index out of bounds. Call GetPrimaryModCount before GetPrimaryModName.&quot;);
@@ -691,7 +691,7 @@
 }
 
 
-const char* GetPrimaryModShortName(int index)
+Export(const char*) GetPrimaryModShortName(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModShortName.&quot;);
 	ASSERT((unsigned)index &lt; modData.size(), &quot;Array index out of bounds. Call GetPrimaryModCount before GetPrimaryModShortName.&quot;);
@@ -700,7 +700,7 @@
 }
 
 
-const char* GetPrimaryModVersion(int index)
+Export(const char*) GetPrimaryModVersion(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModVersion.&quot;);
 	ASSERT((unsigned)index &lt; modData.size(), &quot;Array index out of bounds. Call GetPrimaryModCount before GetPrimaryModMutator.&quot;);
@@ -709,7 +709,7 @@
 }
 
 
-const char* GetPrimaryModMutator(int index)
+Export(const char*) GetPrimaryModMutator(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModMutator.&quot;);
 	ASSERT((unsigned)index &lt; modData.size(), &quot;Array index out of bounds. Call GetPrimaryModCount before GetPrimaryModMutator.&quot;);
@@ -718,7 +718,7 @@
 }
 
 
-const char* GetPrimaryModGame(int index)
+Export(const char*) GetPrimaryModGame(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModName.&quot;);
 	ASSERT((unsigned)index &lt; modData.size(), &quot;Array index out of bounds. Call GetPrimaryModCount before GetPrimaryModName.&quot;);
@@ -727,7 +727,7 @@
 }
 
 
-const char* GetPrimaryModShortGame(int index)
+Export(const char*) GetPrimaryModShortGame(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModShortGame.&quot;);
 	ASSERT((unsigned)index &lt; modData.size(), &quot;Array index out of bounds. Call GetPrimaryModCount before GetPrimaryModShortGame.&quot;);
@@ -736,7 +736,7 @@
 }
 
 
-const char* GetPrimaryModDescription(int index)
+Export(const char*) GetPrimaryModDescription(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModDescription.&quot;);
 	ASSERT((unsigned)index &lt; modData.size(), &quot;Array index out of bounds. Call GetPrimaryModCount before GetPrimaryModDescription.&quot;);
@@ -745,7 +745,7 @@
 }
 
 
-const char* GetPrimaryModArchive(int index)
+Export(const char*) GetPrimaryModArchive(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModArchive.&quot;);
 	ASSERT((unsigned)index &lt; modData.size(), &quot;Array index out of bounds. Call GetPrimaryModCount before GetPrimaryModArchive.&quot;);
@@ -755,7 +755,7 @@
 
 vector&lt;string&gt; primaryArchives;
 
-int GetPrimaryModArchiveCount(int index)
+Export(int) GetPrimaryModArchiveCount(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModArchiveCount.&quot;);
 	ASSERT((unsigned)index &lt; modData.size(), &quot;Array index out of bounds. Call GetPrimaryModCount before GetPrimaryModArchiveCount.&quot;);
@@ -763,7 +763,7 @@
 	return primaryArchives.size();
 }
 
-const char* GetPrimaryModArchiveList(int archiveNr)
+Export(const char*) GetPrimaryModArchiveList(int archiveNr)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModArchiveList.&quot;);
 	ASSERT((unsigned)archiveNr &lt; primaryArchives.size(), &quot;Array index out of bounds. Call GetPrimaryModArchiveCount before GetPrimaryModArchiveList.&quot;);
@@ -771,7 +771,7 @@
 	return GetStr(primaryArchives[archiveNr]);
 }
 
-int GetPrimaryModIndex(const char* name)
+Export(int) GetPrimaryModIndex(const char* name)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModIndex.&quot;);
 	string n(name);
@@ -783,14 +783,14 @@
 	return -1;
 }
 
-unsigned int GetPrimaryModChecksum(int index)
+Export(unsigned int) GetPrimaryModChecksum(int index)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModChecksum.&quot;);
 	ASSERT((unsigned)index &lt; modData.size(), &quot;Array index out of bounds. Call GetPrimaryModCount before GetPrimaryModChecksum.&quot;);
 	return archiveScanner-&gt;GetModChecksum(GetPrimaryModArchive(index));
 }
 
-unsigned int GetPrimaryModChecksumFromName(const char* name)
+Export(unsigned int) GetPrimaryModChecksumFromName(const char* name)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetPrimaryModChecksumFromName.&quot;);
 	return archiveScanner-&gt;GetModChecksum(archiveScanner-&gt;ModNameToModArchive(name));
@@ -800,7 +800,7 @@
 //////////////////////////
 //////////////////////////
 
-int GetSideCount()
+Export(int) GetSideCount()
 {
 	if (!sideParser.Load()) {
 		logOutput.Print(&quot;failed: %s\n&quot;, sideParser.GetErrorLog().c_str());
@@ -810,7 +810,7 @@
 }
 
 
-const char* GetSideName(int side)
+Export(const char*) GetSideName(int side)
 {
 	ASSERT((unsigned int)side &lt; sideParser.GetCount(),
 	       &quot;Array index out of bounds. Call GetSideCount before GetSideName.&quot;);
@@ -819,7 +819,7 @@
 }
 
 
-const char* GetSideStartUnit(int side)
+Export(const char*) GetSideStartUnit(int side)
 {
 	ASSERT((unsigned int)side &lt; sideParser.GetCount(),
 	       &quot;Array index out of bounds. Call GetSideCount before GetSideStartUnit.&quot;);
@@ -881,14 +881,14 @@
 }
 
 
-int GetLuaAICount()
+Export(int) GetLuaAICount()
 {
 	GetLuaAIOptions();
 	return luaAIOptions.size();
 }
 
 
-const char* GetLuaAIName(int aiIndex)
+Export(const char*) GetLuaAIName(int aiIndex)
 {
 	if ((aiIndex &lt; 0) || (aiIndex &gt;= (int)luaAIOptions.size())) {
 		return NULL;
@@ -897,7 +897,7 @@
 }
 
 
-const char* GetLuaAIDesc(int aiIndex)
+Export(const char*) GetLuaAIDesc(int aiIndex)
 {
 	if ((aiIndex &lt; 0) || (aiIndex &gt;= (int)luaAIOptions.size())) {
 		return NULL;
@@ -909,208 +909,9 @@
 //////////////////////////
 //////////////////////////
 
-//static const char* badKeyChars = &quot; =;\r\n\t&quot;;
 
-
-/*
-struct ListItem {
-	string key;
-	string name;
-	string desc;
-};
-
-
-struct Option {
-	Option() : typeCode(opt_error) {}
-
-	string key;
-	string name;
-	string desc;
-
-	string type; // &quot;bool&quot;, &quot;number&quot;, &quot;string&quot;, &quot;list&quot;
-
-	OptionType typeCode;
-
-	bool   boolDef;
-
-	float  numberDef;
-	float  numberMin;
-	float  numberMax;
-	float  numberStep; // aligned to numberDef
-
-	string stringDef;
-	int    stringMaxLen;
-
-	string listDef;
-	vector&lt;ListItem&gt; list;
-};
-*/
-
-
 static vector&lt;Option&gt; options;
 
-/*
-
-static bool ParseOption(const LuaTable&amp; root, int index, Option&amp; opt)
-{
-	const LuaTable&amp; optTbl = root.SubTable(index);
-	if (!optTbl.IsValid()) {
-		return false;
-	}
-
-	// common options properties
-	string opt_key = optTbl.GetString(&quot;key&quot;, &quot;&quot;);
-	if (opt_key.empty() ||
-	    (opt_key.find_first_of(badKeyChars) != string::npos)) {
-		return false;
-	}
-	opt_key = StringToLower(opt_key);
-	if (optionsSet.find(opt_key) != optionsSet.end()) {
-		return false;
-	}
-	opt.key = opt_key.c_str();
-	string opt_name = optTbl.GetString(&quot;name&quot;, opt_key);
-	if (opt_name.empty()) {
-		return false;
-	}
-	opt.name = opt_name.c_str();
-	string opt_desc = optTbl.GetString(&quot;desc&quot;, opt_name);
-	opt.desc = opt_desc.c_str();
-	
-
-	string opt_type = optTbl.GetString(&quot;type&quot;, &quot;&quot;);
-	opt_type = StringToLower(opt_type);
-	opt.type = opt_type.c_str();
-
-	// option type specific properties
-	if (opt_type == &quot;bool&quot;) {
-		opt.typeCode = opt_bool;
-		opt.boolDef = optTbl.GetBool(&quot;def&quot;, false);
-	}
-	else if (opt_type == &quot;number&quot;) {
-		opt.typeCode = opt_number;
-		opt.numberDef  = optTbl.GetFloat(&quot;def&quot;,  0.0f);
-		opt.numberMin  = optTbl.GetFloat(&quot;min&quot;,  -1.0e30f);
-		opt.numberMax  = optTbl.GetFloat(&quot;max&quot;,  +1.0e30f);
-		opt.numberStep = optTbl.GetFloat(&quot;step&quot;, 0.0f);
-	}
-	else if (opt_type == &quot;string&quot;) {
-		opt.typeCode = opt_string;
-		opt.stringDef    = optTbl.GetString(&quot;def&quot;, &quot;&quot;).c_str();
-		opt.stringMaxLen = optTbl.GetInt(&quot;maxlen&quot;, 0);
-	}
-	else if (opt_type == &quot;list&quot;) {
-		opt.typeCode = opt_list;
-
-		const LuaTable&amp; listTbl = optTbl.SubTable(&quot;items&quot;);
-		if (!listTbl.IsValid()) {
-			return false;
-		}
-
-		vector&lt;OptionListItem&gt; opt_list;
-		for (int i = 1; listTbl.KeyExists(i); i++) {
-			OptionListItem item;
-
-			// string format
-			string item_key = listTbl.GetString(i, &quot;&quot;);
-			if (!item_key.empty() &amp;&amp;
-			    (item_key.find_first_of(badKeyChars) == string::npos)) {
-				item.key = item_key.c_str();
-				item.name = item.key;
-				item.desc = item.name;
-				opt_list.push_back(item);
-				continue;
-			}
-
-			// table format  (name &amp; desc)
-			const LuaTable&amp; itemTbl = listTbl.SubTable(i);
-			if (!itemTbl.IsValid()) {
-				break;
-			}
-			item_key = itemTbl.GetString(&quot;key&quot;, &quot;&quot;);
-			if (item_key.empty() ||
-			    (item_key.find_first_of(badKeyChars) != string::npos)) {
-				return false;
-			}
-			item_key = StringToLower(item_key);
-			item.key = item_key.c_str();
-			string item_name = itemTbl.GetString(&quot;name&quot;, item_key);
-			if (item_name.empty()) {
-				return false;
-			}
-			item.name = item_name.c_str();
-			string item_desc = itemTbl.GetString(&quot;desc&quot;, item_name);
-			item.desc = item_desc.c_str();
-			opt_list.push_back(item);
-		}
-
-		if (opt_list.size() &lt;= 0) {
-			return false; // no empty lists
-		}
-		
-		opt.numListItems = opt_list.size();
-		opt.list = (OptionListItem*) calloc(sizeof(OptionListItem), opt.numListItems);
-        for (int i=0; i &lt; opt.numListItems; ++i) {
-            opt.list[i] = opt_list.at(i);
-        }
-
-		opt.listDef = optTbl.GetString(&quot;def&quot;, opt.list[0].name).c_str();
-	}
-	else {
-		return false; // unknown type
-	}
-
-	optionsSet.insert(opt.key);
-
-	return true;
-}
-
-
-static void ParseOptions(const string&amp; fileName,
-                         const string&amp; fileModes,
-                         const string&amp; accessModes,
-                         const string&amp; mapName = &quot;&quot;)
-{
-	options.clear();
-	optionsSet.clear();
-
-	LuaParser luaParser(fileName, fileModes, accessModes);
-
-	const string configName = MapParser::GetMapConfigName(mapName);
-
-	if (!mapName.empty() &amp;&amp; !configName.empty()) {
-		luaParser.GetTable(&quot;Map&quot;);
-		luaParser.AddString(&quot;fileName&quot;, mapName);
-		luaParser.AddString(&quot;fullName&quot;, &quot;maps/&quot; + mapName);
-		luaParser.AddString(&quot;configFile&quot;, configName);
-		luaParser.EndTable();
-	}
-		
-	if (!luaParser.Execute()) {
-		printf(&quot;ParseOptions(%s) ERROR: %s\n&quot;,
-		       fileName.c_str(), luaParser.GetErrorLog().c_str());
-		return;
-	}
-
-	const LuaTable root = luaParser.GetRoot();
-	if (!root.IsValid()) {
-		return;
-	}
-
-	for (int index = 1; root.KeyExists(index); index++) {
-		Option opt;
-		if (ParseOption(root, index, opt)) {
-			options.push_back(opt);
-		}
-	}
-
-	optionsSet.clear();
-
-	return;
-}
-
-*/
-
 static bool InvalidOptionIndex(int optIndex)
 {
 	if ((optIndex &lt; 0) || (optIndex &gt;= (int)options.size())) {
@@ -1134,68 +935,7 @@
 
 vector&lt;InfoItem&gt; infos;
 set&lt;string&gt; infosSet;
-/*
-static bool ParseInfo(const LuaTable&amp; root, int index, InfoItem&amp; info)
-{
-	const LuaTable&amp; infoTbl = root.SubTable(index);
-	if (!infoTbl.IsValid()) {
-		return false;
-	}
 
-	// info properties
-	info.key = infoTbl.GetString(&quot;key&quot;, &quot;&quot;);
-	if (info.key.empty() ||
-	    (info.key.find_first_of(badKeyChars) != string::npos)) {
-		return false;
-	}
-	string keyLower = StringToLower(info.key);
-	if (infosSet.find(keyLower) != infosSet.end()) {
-		return false;
-	}
-	
-	info.value = infoTbl.GetString(&quot;value&quot;, &quot;&quot;);
-	if (info.value.empty()) {
-		return false;
-	}
-	
-	info.desc = infoTbl.GetString(&quot;desc&quot;, &quot;&quot;);
-
-	infosSet.insert(keyLower);
-
-	return true;
-}
-
-static void ParseInfos(const string&amp; fileName,
-                         const string&amp; fileModes,
-                         const string&amp; accessModes)
-{
-	infos.clear();
-	
-	LuaParser luaParser(fileName, fileModes, accessModes);
-		
-	if (!luaParser.Execute()) {
-		printf(&quot;ParseInfos(%s) ERROR: %s\n&quot;,
-		       fileName.c_str(), luaParser.GetErrorLog().c_str());
-		return;
-	}
-
-	const LuaTable root = luaParser.GetRoot();
-	if (!root.IsValid()) {
-		return;
-	}
-
-	infosSet.clear();
-	for (int index = 1; root.KeyExists(index); index++) {
-		InfoItem info;
-		if (ParseInfo(root, index, info)) {
-			infos.push_back(info);
-		}
-	}
-	infosSet.clear();
-}
-*/
-
-
 std::vector&lt;Option&gt; ParseOptions(
 		const std::string&amp; fileName,
 		const std::string&amp; fileModes,
@@ -1210,12 +950,12 @@
 			accessModes.c_str(), mapName.c_str(), tmpOptions, MAX_OPTIONS);
 	for (unsigned int i=0; i &lt; num; ++i) {
 		options.push_back(tmpOptions[i]);
-    }
+	}
 	
 	return options;
 }
 
-int GetMapOptionCount(const char* name)
+Export(int) GetMapOptionCount(const char* name)
 {
 	ASSERT(archiveScanner &amp;&amp; vfsHandler,
 	       &quot;Call InitArchiveScanner before GetMapOptionCount.&quot;);
@@ -1230,7 +970,7 @@
 }
 
 
-int GetModOptionCount()
+Export(int) GetModOptionCount()
 {
 	options = ParseOptions(&quot;ModOptions.lua&quot;, SPRING_VFS_MOD, SPRING_VFS_MOD);
 	return (int)options.size();
@@ -1240,7 +980,7 @@
 // Updated on every call to GetSkirmishAICount
 static vector&lt;string&gt; skirmishAIDataDirs;
 
-int GetSkirmishAICount() {
+Export(int) GetSkirmishAICount() {
 	
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetSkirmishAICount.&quot;);
 	
@@ -1260,7 +1000,7 @@
 	return skirmishAIDataDirs.size();
 }
 
-struct SSAISpecifyer GetSkirmishAISpecifyer(int index) {
+Export(struct SSAISpecifyer) GetSkirmishAISpecifyer(int index) {
 	
 	SSAISpecifyer spec = {NULL, NULL};
 	
@@ -1295,42 +1035,39 @@
 	return infos;
 }
 
-int GetSkirmishAIInfoCount(int index) {
+Export(int) GetSkirmishAIInfoCount(int index) {
 	
 	ASSERT(archiveScanner &amp;&amp; vfsHandler, &quot;Call InitArchiveScanner before GetSkirmishAIInfoCount.&quot;);
 	infos = ParseInfos(skirmishAIDataDirs[index] + &quot;/AIInfo.lua&quot;, SPRING_VFS_RAW, SPRING_VFS_RAW);
 	return (int)infos.size();
 }
-const char* GetInfoKey(int index) {
+Export(const char*) GetInfoKey(int index) {
 	
 	ASSERT(!infos.empty(), &quot;Call GetSkirmishAIInfoCount before GetInfoKey.&quot;);
 	return infos.at(index).key;
 }
-const char* GetInfoValue(int index) {
+Export(const char*) GetInfoValue(int index) {
 	
 	ASSERT(!infos.empty(), &quot;Call GetSkirmishAIInfoCount before GetInfoValue.&quot;);
 	return infos.at(index).value;
 }
-const char* GetInfoDescription(int index) {
+Export(const char*) GetInfoDescription(int index) {
 	
 	ASSERT(!infos.empty(), &quot;Call GetSkirmishAIInfoCount before GetInfoDescription.&quot;);
 	return infos.at(index).desc;
 }
-//struct LevelOfSupport GetSkirmishAILevelOfSupport(int index, const char* engineVersionString, int engineVersionNumber, const char* aiInterfaceShortName, const char* aiInterfaceVersion) {}
 
 
 
-int GetSkirmishAIOptionCount(int index) {
-//int GetSkirmishAIOptionCount(const char* shortName, const char* version = NULL) {
+Export(int) GetSkirmishAIOptionCount(int index) {
 	
 	ASSERT(!skirmishAIDataDirs.empty(), &quot;Call GetSkirmishAICount before GetSkirmishAIOptionCount.&quot;);
-	//SSAISpecifyer spec = {shortName, version};
 	options = ParseOptions(skirmishAIDataDirs[index] + &quot;/AIOptions.lua&quot;, SPRING_VFS_RAW, SPRING_VFS_RAW);
 	return (int)options.size();
 }
 
 
-const char* GetOptionKey(int optIndex)
+Export(const char*) GetOptionKey(int optIndex)
 {
 	if (InvalidOptionIndex(optIndex)) {
 		return NULL;
@@ -1348,7 +1085,7 @@
 }
 
 
-const char* GetOptionDesc(int optIndex)
+Export(const char*) GetOptionDesc(int optIndex)
 {
 	if (InvalidOptionIndex(optIndex)) {
 		return NULL;
@@ -1357,7 +1094,7 @@
 }
 
 
-int GetOptionType(int optIndex)
+Export(int) GetOptionType(int optIndex)
 {
 	if (InvalidOptionIndex(optIndex)) {
 		return 0;
@@ -1366,7 +1103,7 @@
 }
 
 
-int GetOptionBoolDef(int optIndex)
+Export(int) GetOptionBoolDef(int optIndex)
 {
 	if (WrongOptionType(optIndex, opt_bool)) {
 		return 0;
@@ -1375,7 +1112,7 @@
 }
 
 
-float GetOptionNumberDef(int optIndex)
+Export(float) GetOptionNumberDef(int optIndex)
 {
 	if (WrongOptionType(optIndex, opt_number)) {
 		return 0.0f;
@@ -1384,7 +1121,7 @@
 }
 
 
-float GetOptionNumberMin(int optIndex)
+Export(float) GetOptionNumberMin(int optIndex)
 {
 	if (WrongOptionType(optIndex, opt_number)) {
 		return -1.0e30f; // FIXME ?
@@ -1402,7 +1139,7 @@
 }
 
 
-float GetOptionNumberStep(int optIndex)
+Export(float) GetOptionNumberStep(int optIndex)
 {
 	if (WrongOptionType(optIndex, opt_number)) {
 		return 0.0f;
@@ -1411,7 +1148,7 @@
 }
 
 
-const char* GetOptionStringDef(int optIndex)
+Export(const char*) GetOptionStringDef(int optIndex)
 {
 	if (WrongOptionType(optIndex, opt_string)) {
 		return NULL;
@@ -1420,7 +1157,7 @@
 }
 
 
-int GetOptionStringMaxLen(int optIndex)
+Export(int) GetOptionStringMaxLen(int optIndex)
 {
 	if (WrongOptionType(optIndex, opt_string)) {
 		return 0;
@@ -1438,7 +1175,7 @@
 }
 
 
-const char* GetOptionListDef(int optIndex)
+Export(const char*) GetOptionListDef(int optIndex)
 {
 	if (WrongOptionType(optIndex, opt_list)) {
 		return 0;
@@ -1447,7 +1184,7 @@
 }
 
 
-const char* GetOptionListItemKey(int optIndex, int itemIndex)
+Export(const char*) GetOptionListItemKey(int optIndex, int itemIndex)
 {
 	if (WrongOptionType(optIndex, opt_list)) {
 		return NULL;
@@ -1460,7 +1197,7 @@
 }
 
 
-const char* GetOptionListItemName(int optIndex, int itemIndex)
+Export(const char*) GetOptionListItemName(int optIndex, int itemIndex)
 {
 	if (WrongOptionType(optIndex, opt_list)) {
 		return NULL;
@@ -1473,7 +1210,7 @@
 }
 
 
-const char* GetOptionListItemDesc(int optIndex, int itemIndex)
+Export(const char*) GetOptionListItemDesc(int optIndex, int itemIndex)
 {
 	if (WrongOptionType(optIndex, opt_list)) {
 		return NULL;
@@ -1567,7 +1304,7 @@
 }
 
 
-int GetModValidMapCount()
+Export(int) GetModValidMapCount()
 {
 	modValidMaps.clear();
 
@@ -1596,7 +1333,7 @@
 }
 
 
-const char* GetModValidMap(int index)
+Export(const char*) GetModValidMap(int index)
 {
 	if ((index &lt; 0) || (index &gt;= (int)modValidMaps.size())) {
 		return NULL;
@@ -1613,7 +1350,7 @@
 static int nextFile = 0;
 static vector&lt;string&gt; curFindFiles;
 
-int OpenFileVFS(const char* name)
+Export(int) OpenFileVFS(const char* name)
 {
 	ASSERT(name &amp;&amp; *name, &quot;Don't pass a NULL pointer or an empty string to OpenFileVFS.&quot;);
 	logOutput.Print(&quot;openfilevfs: %s\n&quot;, name);
@@ -1630,7 +1367,7 @@
 	return nextFile;
 }
 
-void CloseFileVFS(int handle)
+Export(void) CloseFileVFS(int handle)
 {
 	ASSERT(openFiles.find(handle) != openFiles.end(), &quot;Unregistered handle. Pass the handle returned by OpenFileVFS to CloseFileVFS.&quot;);
 	logOutput.Print(&quot;closefilevfs: %d\n&quot;, handle);
@@ -1638,7 +1375,7 @@
 	openFiles.erase(handle);
 }
 
-void ReadFileVFS(int handle, void* buf, int length)
+Export(void) ReadFileVFS(int handle, void* buf, int length)
 {
 	ASSERT(openFiles.find(handle) != openFiles.end(), &quot;Unregistered handle. Pass the handle returned by OpenFileVFS to ReadFileVFS.&quot;);
 	ASSERT(buf, &quot;Don't pass a NULL pointer to ReadFileVFS.&quot;);
@@ -1647,7 +1384,7 @@
 	fh-&gt;Read(buf, length);
 }
 
-int FileSizeVFS(int handle)
+Export(int) FileSizeVFS(int handle)
 {
 	ASSERT(openFiles.find(handle) != openFiles.end(), &quot;Unregistered handle. Pass the handle returned by OpenFileVFS to FileSizeVFS.&quot;);
 	logOutput.Print(&quot;filesizevfs: %d\n&quot;, handle);
@@ -1656,7 +1393,7 @@
 }
 
 
-int InitFindVFS(const char* pattern)
+Export(int) InitFindVFS(const char* pattern)
 {
 	string path = filesystem.GetDirectory(pattern);
 	string patt = filesystem.GetFilename(pattern);
@@ -1665,7 +1402,7 @@
 	return 0;
 }
 
-int InitDirListVFS(const char* path, const char* pattern, const char* modes)
+Export(int) InitDirListVFS(const char* path, const char* pattern, const char* modes)
 {
 	if (path    == NULL) { path = &quot;&quot;;              }
 	if (modes   == NULL) { modes = SPRING_VFS_ALL; }
@@ -1675,7 +1412,7 @@
 	return 0;
 }
 
-int InitSubDirsVFS(const char* path, const char* pattern, const char* modes)
+Export(int) InitSubDirsVFS(const char* path, const char* pattern, const char* modes)
 {
 	if (path    == NULL) { path = &quot;&quot;;              }
 	if (modes   == NULL) { modes = SPRING_VFS_ALL; }
@@ -1685,7 +1422,7 @@
 	return 0;
 }
 
-int FindFilesVFS(int handle, char* nameBuf, int size)
+Export(int) FindFilesVFS(int handle, char* nameBuf, int size)
 {
 	ASSERT(nameBuf, &quot;Don't pass a NULL pointer to FindFilesVFS.&quot;);
 	ASSERT(size &gt; 0, &quot;Negative or zero buffer length doesn't make sense.&quot;);
@@ -1703,7 +1440,7 @@
 static map&lt;int, CArchiveBase*&gt; openArchives;
 static int nextArchive = 0;
 
-int OpenArchive(const char* name)
+Export(int) OpenArchive(const char* name)
 {
 	ASSERT(name &amp;&amp; *name, &quot;Don't pass a NULL pointer or an empty string to OpenArchive.&quot;);
 	CArchiveBase* a = CArchiveFactory::OpenArchive(name);
@@ -1717,7 +1454,7 @@
 	}
 }
 
-int OpenArchiveType(const char* name, const char* type)
+Export(int) OpenArchiveType(const char* name, const char* type)
 {
 	ASSERT(name &amp;&amp; *name &amp;&amp; type &amp;&amp; *type,
 	       &quot;Don't pass a NULL pointer or an empty string to OpenArchiveType.&quot;);
@@ -1732,14 +1469,14 @@
 	}
 }
 
-void CloseArchive(int archive)
+Export(void) CloseArchive(int archive)
 {
 	ASSERT(openArchives.find(archive) != openArchives.end(), &quot;Unregistered archive. Pass the handle returned by OpenArchive to CloseArchive.&quot;);
 	delete openArchives[archive];
 	openArchives.erase(archive);
 }
 
-int FindFilesArchive(int archive, int cur, char* nameBuf, int* size)
+Export(int) FindFilesArchive(int archive, int cur, char* nameBuf, int* size)
 {
 	ASSERT(openArchives.find(archive) != openArchives.end(), &quot;Unregistered archive. Pass the handle returned by OpenArchive to FindFilesArchive.&quot;);
 	ASSERT(nameBuf &amp;&amp; size, &quot;Don't pass a NULL pointer to FindFilesArchive.&quot;);
@@ -1757,7 +1494,7 @@
 	return ret;
 }
 
-int OpenArchiveFile(int archive, const char* name)
+Export(int) OpenArchiveFile(int archive, const char* name)
 {
 	ASSERT(openArchives.find(archive) != openArchives.end(), &quot;Unregistered archive. Pass the handle returned by OpenArchive to OpenArchiveFile.&quot;);
 	ASSERT(name &amp;&amp; *name, &quot;Don't pass a NULL pointer or an empty string to OpenArchiveFile.&quot;);
@@ -1765,7 +1502,7 @@
 	return a-&gt;OpenFile(name);
 }
 
-int ReadArchiveFile(int archive, int handle, void* buffer, int numBytes)
+Export(int) ReadArchiveFile(int archive, int handle, void* buffer, int numBytes)
 {
 	ASSERT(openArchives.find(archive) != openArchives.end(), &quot;Unregistered archive. Pass the handle returned by OpenArchive to ReadArchiveFile.&quot;);
 	ASSERT(buffer, &quot;Don't pass a NULL pointer to ReadArchiveFile.&quot;);
@@ -1773,14 +1510,14 @@
 	return a-&gt;ReadFile(handle, buffer, numBytes);
 }
 
-void CloseArchiveFile(int archive, int handle)
+Export(void) CloseArchiveFile(int archive, int handle)
 {
 	ASSERT(openArchives.find(archive) != openArchives.end(), &quot;Unregistered archive. Pass the handle returned by OpenArchive to CloseArchiveFile.&quot;);
 	CArchiveBase* a = openArchives[archive];
 	return a-&gt;CloseFile(handle);
 }
 
-int SizeArchiveFile(int archive, int handle)
+Export(int) SizeArchiveFile(int archive, int handle)
 {
 	ASSERT(openArchives.find(archive) != openArchives.end(), &quot;Unregistered archive. Pass the handle returned by OpenArchive to SizeArchiveFile.&quot;);
 	CArchiveBase* a = openArchives[archive];
@@ -1815,33 +1552,33 @@
 //////////////////////////
 //////////////////////////
 
-const char* GetSpringConfigString( const char* name, const char* defValue )
+Export(const char*) GetSpringConfigString( const char* name, const char* defValue )
 {
 	string res = configHandler.GetString( name, defValue );
 	return GetStr(res);
 }
 
-int GetSpringConfigInt( const char* name, const int defValue )
+Export(int) GetSpringConfigInt( const char* name, const int defValue )
 {
 	return configHandler.GetInt( name, defValue );
 }
 
-float GetSpringConfigFloat( const char* name, const float defValue)
+Export(float) GetSpringConfigFloat( const char* name, const float defValue)
 {
 	return configHandler.GetFloat( name, defValue );
 }
 
-void SetSpringConfigString(const char* name, const char* value)
+Export(void) SetSpringConfigString(const char* name, const char* value)
 {
 	configHandler.SetString( name, value );
 }
 
-void SetSpringConfigInt(const char* name, const int value)
+Export(void) SetSpringConfigInt(const char* name, const int value)
 {
 	configHandler.SetInt( name, value );
 }
 
-void SetSpringConfigFloat(const char* name, const float value)
+Export(void) SetSpringConfigFloat(const char* name, const float value)
 {
 	configHandler.SetFloat( name, value );
 }

Modified: branches/caiinterface/tools/unitsync/unitsync.h
===================================================================
--- branches/caiinterface/tools/unitsync/unitsync.h	2008-10-01 18:24:14 UTC (rev 6496)
+++ branches/caiinterface/tools/unitsync/unitsync.h	2008-10-01 21:20:29 UTC (rev 6497)
@@ -38,25 +38,13 @@
 };
 
 
-//enum OptionType {
-//	opt_error  = 0,
-//	opt_bool   = 1,
-//	opt_list   = 2,
-//	opt_number = 3,
-//	opt_string = 4
-//};
-
-
 const char *GetStr(std::string str);
 
 
 #ifdef WIN32
-//	#define DLL_EXPORT extern &quot;C&quot; __declspec(dllexport)
 	#include &lt;windows.h&gt;
 #else
 	#include &lt;iostream&gt;
-//	#define DLL_EXPORT extern &quot;C&quot; __attribute__ ((visibility(&quot;default&quot;)))
-//	#define __stdcall
 	#define MB_OK 0
 	static inline void MessageBox(void*, const char* msg, const char* capt, unsigned int)
 	{
@@ -65,7 +53,7 @@
 #endif	/* WIN32 */
 
 /**
- * @brief returns the version fo spring this was compiled with
+ * @brief returns the version of spring this was compiled with
  *
  * Returns a const char* string specifying the version of spring used to build this library with.
  * It was added to aid in lobby creation, where checks for updates to spring occur.

Modified: branches/caiinterface/tools/unitsync/unitsync_api.h
===================================================================
--- branches/caiinterface/tools/unitsync/unitsync_api.h	2008-10-01 18:24:14 UTC (rev 6496)
+++ branches/caiinterface/tools/unitsync/unitsync_api.h	2008-10-01 21:20:29 UTC (rev 6497)
@@ -7,153 +7,153 @@
 /******************************************************************************/
 /******************************************************************************/
 
-DLL_EXPORT const char*  __stdcall GetSpringVersion();
+Export(const char*) GetSpringVersion();
 
-DLL_EXPORT void         __stdcall Message(const char* p_szMessage);
+Export(void) Message(const char* p_szMessage);
 
-DLL_EXPORT int          __stdcall Init(bool isServer, int id);
-DLL_EXPORT void         __stdcall UnInit();
+Export(int) Init(bool isServer, int id);
+Export(void) UnInit();
 
-DLL_EXPORT int          __stdcall ProcessUnits(void);
-DLL_EXPORT int          __stdcall ProcessUnitsNoChecksum(void);
-DLL_EXPORT const char*  __stdcall GetCurrentList();
+Export(int) ProcessUnits(void);
+Export(int) ProcessUnitsNoChecksum(void);
+Export(const char*) GetCurrentList();
 
-DLL_EXPORT void         __stdcall AddClient(int id, const char *unitList);
-DLL_EXPORT void         __stdcall RemoveClient(int id);
+Export(void) AddClient(int id, const char *unitList);
+Export(void) RemoveClient(int id);
 
-DLL_EXPORT const char*  __stdcall GetClientDiff(int id);
-DLL_EXPORT void         __stdcall InstallClientDiff(const char *diff);
+Export(const char*) GetClientDiff(int id);
+Export(void) InstallClientDiff(const char *diff);
 
-DLL_EXPORT int          __stdcall GetUnitCount();
-DLL_EXPORT const char*  __stdcall GetUnitName(int unit);
-DLL_EXPORT const char*  __stdcall GetFullUnitName(int unit);
-DLL_EXPORT int          __stdcall IsUnitDisabled(int unit);
-DLL_EXPORT int          __stdcall IsUnitDisabledByClient(int unit, int clientId);
+Export(int) GetUnitCount();
+Export(const char*) GetUnitName(int unit);
+Export(const char*) GetFullUnitName(int unit);
+Export(int) IsUnitDisabled(int unit);
+Export(int) IsUnitDisabledByClient(int unit, int clientId);
 
-DLL_EXPORT void         __stdcall AddArchive(const char* name);
-DLL_EXPORT void         __stdcall AddAllArchives(const char* root);
-DLL_EXPORT unsigned int __stdcall GetArchiveChecksum(const char* arname);
+Export(void) AddArchive(const char* name);
+Export(void) AddAllArchives(const char* root);
+Export(unsigned int) GetArchiveChecksum(const char* arname);
 
-DLL_EXPORT int          __stdcall GetMapCount();
-DLL_EXPORT const char*  __stdcall GetMapName(int index);
-DLL_EXPORT int          __stdcall GetMapInfoEx(const char* name, MapInfo* outInfo, int version);
-DLL_EXPORT int          __stdcall GetMapInfo(const char* name, MapInfo* outInfo);
-DLL_EXPORT int          __stdcall GetMapArchiveCount(const char* mapName);
-DLL_EXPORT const char*  __stdcall GetMapArchiveName(int index);
-DLL_EXPORT unsigned int __stdcall GetMapChecksum(int index);
-DLL_EXPORT void*        __stdcall GetMinimap(const char* filename, int miplevel);
+Export(int) GetMapCount();
+Export(const char*) GetMapName(int index);
+Export(int) GetMapInfoEx(const char* name, MapInfo* outInfo, int version);
+Export(int) GetMapInfo(const char* name, MapInfo* outInfo);
+Export(int) GetMapArchiveCount(const char* mapName);
+Export(const char*) GetMapArchiveName(int index);
+Export(unsigned int) GetMapChecksum(int index);
+Export(void*) GetMinimap(const char* filename, int miplevel);
 
-DLL_EXPORT int          __stdcall GetPrimaryModCount();
-DLL_EXPORT const char*  __stdcall GetPrimaryModName(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModShortName(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModVersion(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModMutator(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModArchive(int index);
-DLL_EXPORT int          __stdcall GetPrimaryModArchiveCount(int index);
-DLL_EXPORT const char*  __stdcall GetPrimaryModArchiveList(int arnr);
-DLL_EXPORT int          __stdcall GetPrimaryModIndex(const char* name);
-DLL_EXPORT unsigned int __stdcall GetPrimaryModChecksum(int index);
+Export(int) GetPrimaryModCount();
+Export(const char*) GetPrimaryModName(int index);
+Export(const char*) GetPrimaryModShortName(int index);
+Export(const char*) GetPrimaryModVersion(int index);
+Export(const char*) GetPrimaryModMutator(int index);
+Export(const char*) GetPrimaryModArchive(int index);
+Export(int) GetPrimaryModArchiveCount(int index);
+Export(const char*) GetPrimaryModArchiveList(int arnr);
+Export(int) GetPrimaryModIndex(const char* name);
+Export(unsigned int) GetPrimaryModChecksum(int index);
 
-DLL_EXPORT int          __stdcall GetSideCount();
-DLL_EXPORT const char*  __stdcall GetSideName(int side);
-DLL_EXPORT const char*  __stdcall GetSideStartUnit(int side);
+Export(int) GetSideCount();
+Export(const char*) GetSideName(int side);
+Export(const char*) GetSideStartUnit(int side);
 
-DLL_EXPORT int          __stdcall GetLuaAICount();
-DLL_EXPORT const char*  __stdcall GetLuaAIName(int aiIndex);
-DLL_EXPORT const char*  __stdcall GetLuaAIDesc(int aiIndex);
+Export(int) GetLuaAICount();
+Export(const char*) GetLuaAIName(int aiIndex);
+Export(const char*) GetLuaAIDesc(int aiIndex);
 
-DLL_EXPORT int          __stdcall GetMapOptionCount(const char* name);
-DLL_EXPORT int          __stdcall GetModOptionCount();
-DLL_EXPORT const char*  __stdcall GetOptionKey(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionName(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionDesc(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionType(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionBoolDef(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberDef(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberMin(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberMax(int optIndex);
-DLL_EXPORT float        __stdcall GetOptionNumberStep(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionStringDef(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionStringMaxLen(int optIndex);
-DLL_EXPORT int          __stdcall GetOptionListCount(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListDef(int optIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemKey(int optIndex, int itemIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemName(int optIndex, int itemIndex);
-DLL_EXPORT const char*  __stdcall GetOptionListItemDesc(int optIndex, int itemIndex);
+Export(int) GetMapOptionCount(const char* name);
+Export(int) GetModOptionCount();
+Export(const char*) GetOptionKey(int optIndex);
+Export(const char*) GetOptionName(int optIndex);
+Export(const char*) GetOptionDesc(int optIndex);
+Export(int) GetOptionType(int optIndex);
+Export(int) GetOptionBoolDef(int optIndex);
+Export(float) GetOptionNumberDef(int optIndex);
+Export(float) GetOptionNumberMin(int optIndex);
+Export(float) GetOptionNumberMax(int optIndex);
+Export(float) GetOptionNumberStep(int optIndex);
+Export(const char*) GetOptionStringDef(int optIndex);
+Export(int) GetOptionStringMaxLen(int optIndex);
+Export(int) GetOptionListCount(int optIndex);
+Export(const char*) GetOptionListDef(int optIndex);
+Export(const char*) GetOptionListItemKey(int optIndex, int itemIndex);
+Export(const char*) GetOptionListItemName(int optIndex, int itemIndex);
+Export(const char*) GetOptionListItemDesc(int optIndex, int itemIndex);
 
-DLL_EXPORT int          __stdcall GetModValidMapCount();
-DLL_EXPORT const char*  __stdcall GetModValidMap(int index);
+Export(int) GetModValidMapCount();
+Export(const char*) GetModValidMap(int index);
 
-DLL_EXPORT int          __stdcall OpenFileVFS(const char* name);
-DLL_EXPORT void         __stdcall CloseFileVFS(int handle);
-DLL_EXPORT void         __stdcall ReadFileVFS(int handle, void* buf, int length);
-DLL_EXPORT int          __stdcall FileSizeVFS(int handle);
+Export(int) OpenFileVFS(const char* name);
+Export(void) CloseFileVFS(int handle);
+Export(void) ReadFileVFS(int handle, void* buf, int length);
+Export(int) FileSizeVFS(int handle);
 
-DLL_EXPORT int          __stdcall InitFindVFS(const char* pattern);
-DLL_EXPORT int          __stdcall InitDirListVFS(const char* path,
+Export(int) InitFindVFS(const char* pattern);
+Export(int) InitDirListVFS(const char* path,
                                                  const char* pattern,
                                                  const char* modes);
-DLL_EXPORT int          __stdcall InitSubDirsVFS(const char* path,
+Export(int) InitSubDirsVFS(const char* path,
                                                  const char* pattern,
                                                  const char* modes);
-DLL_EXPORT int          __stdcall FindFilesVFS(int handle, char* nameBuf, int size);
+Export(int) FindFilesVFS(int handle, char* nameBuf, int size);
 
-DLL_EXPORT int          __stdcall OpenArchive(const char* name);
-DLL_EXPORT int          __stdcall OpenArchiveType(const char* name, const char* type);
-DLL_EXPORT void         __stdcall CloseArchive(int archive);
-DLL_EXPORT int          __stdcall FindFilesArchive(int archive, int cur, char* nameBuf, int* size);
-DLL_EXPORT int          __stdcall OpenArchiveFile(int archive, const char* name);
-DLL_EXPORT int          __stdcall ReadArchiveFile(int archive, int handle, void* buffer, int numBytes);
-DLL_EXPORT void         __stdcall CloseArchiveFile(int archive, int handle);
-DLL_EXPORT int          __stdcall SizeArchiveFile(int archive, int handle);
+Export(int) OpenArchive(const char* name);
+Export(int) OpenArchiveType(const char* name, const char* type);
+Export(void) CloseArchive(int archive);
+Export(int) FindFilesArchive(int archive, int cur, char* nameBuf, int* size);
+Export(int) OpenArchiveFile(int archive, const char* name);
+Export(int) ReadArchiveFile(int archive, int handle, void* buffer, int numBytes);
+Export(void) CloseArchiveFile(int archive, int handle);
+Export(int) SizeArchiveFile(int archive, int handle);
 
-DLL_EXPORT void        __stdcall lpClose();
-DLL_EXPORT int         __stdcall lpOpenFile(const char* filename,
+Export(void) lpClose();
+Export(int) lpOpenFile(const char* filename,
                                             const char* fileModes,
                                             const char* accessModes);
-DLL_EXPORT int         __stdcall lpOpenSource(const char* source,
+Export(int) lpOpenSource(const char* source,
                                               const char* accessModes);
-DLL_EXPORT int         __stdcall lpExecute();
-DLL_EXPORT const char* __stdcall lpErrorLog();
+Export(int) lpExecute();
+Export(const char*) lpErrorLog();
 
-DLL_EXPORT void        __stdcall lpAddTableInt(int key, int override);
-DLL_EXPORT void        __stdcall lpAddTableStr(const char* key, int override);
-DLL_EXPORT void        __stdcall lpEndTable();
-DLL_EXPORT void        __stdcall lpAddIntKeyIntVal(int key, int val);
-DLL_EXPORT void        __stdcall lpAddStrKeyIntVal(const char* key, int val);
-DLL_EXPORT void        __stdcall lpAddIntKeyBoolVal(int key, int val);
-DLL_EXPORT void        __stdcall lpAddStrKeyBoolVal(const char* key, int val);
-DLL_EXPORT void        __stdcall lpAddIntKeyFloatVal(int key, float val);
-DLL_EXPORT void        __stdcall lpAddStrKeyFloatVal(const char* key, float val);
-DLL_EXPORT void        __stdcall lpAddIntKeyStrVal(int key, const char* val);
-DLL_EXPORT void        __stdcall lpAddStrKeyStrVal(const char* key, const char* val);
+Export(void) lpAddTableInt(int key, int override);
+Export(void) lpAddTableStr(const char* key, int override);
+Export(void) lpEndTable();
+Export(void) lpAddIntKeyIntVal(int key, int val);
+Export(void) lpAddStrKeyIntVal(const char* key, int val);
+Export(void) lpAddIntKeyBoolVal(int key, int val);
+Export(void) lpAddStrKeyBoolVal(const char* key, int val);
+Export(void) lpAddIntKeyFloatVal(int key, float val);
+Export(void) lpAddStrKeyFloatVal(const char* key, float val);
+Export(void) lpAddIntKeyStrVal(int key, const char* val);
+Export(void) lpAddStrKeyStrVal(const char* key, const char* val);
 
-DLL_EXPORT int         __stdcall lpRootTable();
-DLL_EXPORT int         __stdcall lpRootTableExpr(const char* expr);
-DLL_EXPORT int         __stdcall lpSubTableInt(int key);
-DLL_EXPORT int         __stdcall lpSubTableStr(const char* key);
-DLL_EXPORT int         __stdcall lpSubTableExpr(const char* expr);
-DLL_EXPORT void        __stdcall lpPopTable();
+Export(int) lpRootTable();
+Export(int) lpRootTableExpr(const char* expr);
+Export(int) lpSubTableInt(int key);
+Export(int) lpSubTableStr(const char* key);
+Export(int) lpSubTableExpr(const char* expr);
+Export(void) lpPopTable();
 
-DLL_EXPORT int         __stdcall lpGetKeyExistsInt(int key);
-DLL_EXPORT int         __stdcall lpGetKeyExistsStr(const char* key);
+Export(int) lpGetKeyExistsInt(int key);
+Export(int) lpGetKeyExistsStr(const char* key);
 
-DLL_EXPORT int         __stdcall lpGetIntKeyType(int key);
-DLL_EXPORT int         __stdcall lpGetStrKeyType(const char* key);
+Export(int) lpGetIntKeyType(int key);
+Export(int) lpGetStrKeyType(const char* key);
 
-DLL_EXPORT int         __stdcall lpGetIntKeyListCount();
-DLL_EXPORT int         __stdcall lpGetIntKeyListEntry(int index);
-DLL_EXPORT int         __stdcall lpGetStrKeyListCount();
-DLL_EXPORT const char* __stdcall lpGetStrKeyListEntry(int index);
+Export(int) lpGetIntKeyListCount();
+Export(int) lpGetIntKeyListEntry(int index);
+Export(int) lpGetStrKeyListCount();
+Export(const char*) lpGetStrKeyListEntry(int index);
 
-DLL_EXPORT int         __stdcall lpGetIntKeyIntVal(int key, int defVal);
-DLL_EXPORT int         __stdcall lpGetStrKeyIntVal(const char* key, int defVal);
-DLL_EXPORT int         __stdcall lpGetIntKeyBoolVal(int key, int defVal);
-DLL_EXPORT int         __stdcall lpGetStrKeyBoolVal(const char* key, int defVal);
-DLL_EXPORT float       __stdcall lpGetIntKeyFloatVal(int key, float defVal);
-DLL_EXPORT float       __stdcall lpGetStrKeyFloatVal(const char* key, float defVal);
-DLL_EXPORT const char* __stdcall lpGetIntKeyStrVal(int key, const char* defVal);
-DLL_EXPORT const char* __stdcall lpGetStrKeyStrVal(const char* key, const char* defVal);
+Export(int) lpGetIntKeyIntVal(int key, int defVal);
+Export(int) lpGetStrKeyIntVal(const char* key, int defVal);
+Export(int) lpGetIntKeyBoolVal(int key, int defVal);
+Export(int) lpGetStrKeyBoolVal(const char* key, int defVal);
+Export(float) lpGetIntKeyFloatVal(int key, float defVal);
+Export(float) lpGetStrKeyFloatVal(const char* key, float defVal);
+Export(const char*) lpGetIntKeyStrVal(int key, const char* defVal);
+Export(const char*) lpGetStrKeyStrVal(const char* key, const char* defVal);
 
 
 #endif // UNITSYNC_API_H


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001266.html">[Taspring-linux-commit] r6496 - in branches/caiinterface/game/AI: .	Interfaces Skirmish
</A></li>
	<LI>Next message: <A HREF="001268.html">[Taspring-linux-commit] r6498 - trunk/rts/Map/SMF
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1267">[ date ]</a>
              <a href="thread.html#1267">[ thread ]</a>
              <a href="subject.html#1267">[ subject ]</a>
              <a href="author.html#1267">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
