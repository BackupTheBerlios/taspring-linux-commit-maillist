<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r6518 - in trunk: AI/Group/CentralBuildAI	rts/ExternalAI rts/Game rts/Game/StartScripts rts/Game/UI	rts/Lua rts/Map rts/Map/SM3 rts/Map/SM3/terrain rts/Map/SMF	rts/Rendering rts/Rendering/Env rts/Rendering/GL	rts/Rendering/Textures rts/Rendering/UnitModels rts/Sim	rts/Sim/Features rts/Sim/Misc rts/Sim/MoveTypes rts/Sim/Path	rts/Sim/Projectiles rts/Sim/Projectiles/Unsynced	rts/Sim/Projectiles/WeaponProjectiles rts/Sim/Units	rts/Sim/Units/COB rts/Sim/Units/CommandAI rts/Sim/Weapons	rts/System rts/System/FileSystem rts/System/Platform	rts/System/Platform/Linux rts/System/Script rts/System/Sync	rts/System/creg tools/unitsync
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-October/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r6518%20-%20in%20trunk%3A%20AI/Group/CentralBuildAI%0A%09rts/ExternalAI%20rts/Game%20rts/Game/StartScripts%20rts/Game/UI%0A%09rts/Lua%20rts/Map%20rts/Map/SM3%20rts/Map/SM3/terrain%20rts/Map/SMF%0A%09rts/Rendering%20rts/Rendering/Env%20rts/Rendering/GL%0A%09rts/Rendering/Textures%20rts/Rendering/UnitModels%20rts/Sim%0A%09rts/Sim/Features%20rts/Sim/Misc%20rts/Sim/MoveTypes%20rts/Sim/Path%0A%09rts/Sim/Projectiles%20rts/Sim/Projectiles/Unsynced%0A%09rts/Sim/Projectiles/WeaponProjectiles%20rts/Sim/Units%0A%09rts/Sim/Units/COB%20rts/Sim/Units/CommandAI%20rts/Sim/Weapons%0A%09rts/System%20rts/System/FileSystem%20rts/System/Platform%0A%09rts/System/Platform/Linux%20rts/System/Script%20rts/System/Sync%0A%09rts/System/creg%20tools/unitsync&In-Reply-To=%3C20081004132858.881444184%40progate.clan-sy.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001287.html">
   <LINK REL="Next"  HREF="001289.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r6518 - in trunk: AI/Group/CentralBuildAI	rts/ExternalAI rts/Game rts/Game/StartScripts rts/Game/UI	rts/Lua rts/Map rts/Map/SM3 rts/Map/SM3/terrain rts/Map/SMF	rts/Rendering rts/Rendering/Env rts/Rendering/GL	rts/Rendering/Textures rts/Rendering/UnitModels rts/Sim	rts/Sim/Features rts/Sim/Misc rts/Sim/MoveTypes rts/Sim/Path	rts/Sim/Projectiles rts/Sim/Projectiles/Unsynced	rts/Sim/Projectiles/WeaponProjectiles rts/Sim/Units	rts/Sim/Units/COB rts/Sim/Units/CommandAI rts/Sim/Weapons	rts/System rts/System/FileSystem rts/System/Platform	rts/System/Platform/Linux rts/System/Script rts/System/Sync	rts/System/creg tools/unitsync</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r6518%20-%20in%20trunk%3A%20AI/Group/CentralBuildAI%0A%09rts/ExternalAI%20rts/Game%20rts/Game/StartScripts%20rts/Game/UI%0A%09rts/Lua%20rts/Map%20rts/Map/SM3%20rts/Map/SM3/terrain%20rts/Map/SMF%0A%09rts/Rendering%20rts/Rendering/Env%20rts/Rendering/GL%0A%09rts/Rendering/Textures%20rts/Rendering/UnitModels%20rts/Sim%0A%09rts/Sim/Features%20rts/Sim/Misc%20rts/Sim/MoveTypes%20rts/Sim/Path%0A%09rts/Sim/Projectiles%20rts/Sim/Projectiles/Unsynced%0A%09rts/Sim/Projectiles/WeaponProjectiles%20rts/Sim/Units%0A%09rts/Sim/Units/COB%20rts/Sim/Units/CommandAI%20rts/Sim/Weapons%0A%09rts/System%20rts/System/FileSystem%20rts/System/Platform%0A%09rts/System/Platform/Linux%20rts/System/Script%20rts/System/Sync%0A%09rts/System/creg%20tools/unitsync&In-Reply-To=%3C20081004132858.881444184%40progate.clan-sy.com%3E"
       TITLE="[Taspring-linux-commit] r6518 - in trunk: AI/Group/CentralBuildAI	rts/ExternalAI rts/Game rts/Game/StartScripts rts/Game/UI	rts/Lua rts/Map rts/Map/SM3 rts/Map/SM3/terrain rts/Map/SMF	rts/Rendering rts/Rendering/Env rts/Rendering/GL	rts/Rendering/Textures rts/Rendering/UnitModels rts/Sim	rts/Sim/Features rts/Sim/Misc rts/Sim/MoveTypes rts/Sim/Path	rts/Sim/Projectiles rts/Sim/Projectiles/Unsynced	rts/Sim/Projectiles/WeaponProjectiles rts/Sim/Units	rts/Sim/Units/COB rts/Sim/Units/CommandAI rts/Sim/Weapons	rts/System rts/System/FileSystem rts/System/Platform	rts/System/Platform/Linux rts/System/Script rts/System/Sync	rts/System/creg tools/unitsync">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Sat Oct  4 15:28:58 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001287.html">[Taspring-linux-commit] r6517 - trunk/rts/System/Platform
</A></li>
        <LI>Next message: <A HREF="001289.html">[Taspring-linux-commit] r6519 - trunk/rts/System
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1288">[ date ]</a>
              <a href="thread.html#1288">[ thread ]</a>
              <a href="subject.html#1288">[ subject ]</a>
              <a href="author.html#1288">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: Auswaschbar
Date: 2008-10-04 15:28:55 +0200 (Sat, 04 Oct 2008)
New Revision: 6518

Added:
   trunk/rts/System/Exceptions.h
   trunk/rts/System/Util.h
Modified:
   trunk/AI/Group/CentralBuildAI/GroupAI.cpp
   trunk/rts/ExternalAI/GlobalAI.cpp
   trunk/rts/ExternalAI/GlobalAIHandler.h
   trunk/rts/ExternalAI/GroupHandler.h
   trunk/rts/ExternalAI/aikey.h
   trunk/rts/Game/Camera.cpp
   trunk/rts/Game/Game.cpp
   trunk/rts/Game/Game.h
   trunk/rts/Game/GameServer.cpp
   trunk/rts/Game/GameSetup.cpp
   trunk/rts/Game/PlayerRoster.cpp
   trunk/rts/Game/PreGame.cpp
   trunk/rts/Game/SelectedUnits.cpp
   trunk/rts/Game/StartScripts/AirScript.h
   trunk/rts/Game/StartScripts/CommanderScript.cpp
   trunk/rts/Game/StartScripts/CommanderScript2.cpp
   trunk/rts/Game/StartScripts/GlobalAITestScript.cpp
   trunk/rts/Game/StartScripts/ScriptHandler.cpp
   trunk/rts/Game/StartScripts/SpawnScript.h
   trunk/rts/Game/UI/CommandColors.cpp
   trunk/rts/Game/UI/EndGameBox.cpp
   trunk/rts/Game/UI/GuiHandler.cpp
   trunk/rts/Game/UI/KeyAutoBinder.cpp
   trunk/rts/Game/UI/KeyBindings.cpp
   trunk/rts/Game/UI/KeyCodes.cpp
   trunk/rts/Game/UI/KeySet.cpp
   trunk/rts/Game/UI/LuaUI.cpp
   trunk/rts/Game/UI/MiniMap.cpp
   trunk/rts/Game/UI/MouseCursor.cpp
   trunk/rts/Game/UI/TooltipConsole.cpp
   trunk/rts/Game/WaitCommandsAI.cpp
   trunk/rts/Lua/LuaConstGame.cpp
   trunk/rts/Lua/LuaGaia.cpp
   trunk/rts/Lua/LuaIO.cpp
   trunk/rts/Lua/LuaMaterial.cpp
   trunk/rts/Lua/LuaParser.cpp
   trunk/rts/Lua/LuaPathFinder.cpp
   trunk/rts/Lua/LuaShaders.cpp
   trunk/rts/Lua/LuaSyncedRead.cpp
   trunk/rts/Lua/LuaTextures.cpp
   trunk/rts/Lua/LuaUnitDefs.cpp
   trunk/rts/Lua/LuaUnitRendering.cpp
   trunk/rts/Lua/LuaUtils.cpp
   trunk/rts/Lua/LuaVFS.cpp
   trunk/rts/Lua/LuaWeaponDefs.cpp
   trunk/rts/Map/MapInfo.cpp
   trunk/rts/Map/ReadMap.cpp
   trunk/rts/Map/ReadMap.h
   trunk/rts/Map/SM3/Plane.h
   trunk/rts/Map/SM3/Sm3Map.cpp
   trunk/rts/Map/SM3/terrain/Lightcalc.cpp
   trunk/rts/Map/SM3/terrain/Terrain.cpp
   trunk/rts/Map/SM3/terrain/TerrainTexture.cpp
   trunk/rts/Map/SM3/terrain/TerrainTextureGLSL.cpp
   trunk/rts/Map/SM3/terrain/Textures.cpp
   trunk/rts/Map/SMF/SmfMapFile.cpp
   trunk/rts/Map/SMF/SmfReadMap.cpp
   trunk/rts/Rendering/Env/AdvTreeGenerator.cpp
   trunk/rts/Rendering/Env/BaseTreeDrawer.cpp
   trunk/rts/Rendering/Env/BaseWater.cpp
   trunk/rts/Rendering/Env/BaseWater.h
   trunk/rts/Rendering/Env/BasicTreeDrawer.cpp
   trunk/rts/Rendering/Env/BasicWater.cpp
   trunk/rts/Rendering/Env/BumpWater.cpp
   trunk/rts/Rendering/Env/DynWater.cpp
   trunk/rts/Rendering/Env/GrassDrawer.cpp
   trunk/rts/Rendering/Env/SkyBox.cpp
   trunk/rts/Rendering/GL/glList.cpp
   trunk/rts/Rendering/GL/myGL.cpp
   trunk/rts/Rendering/GroundDecalHandler.cpp
   trunk/rts/Rendering/IconHandler.cpp
   trunk/rts/Rendering/Textures/ColorMap.cpp
   trunk/rts/Rendering/Textures/ColorMap.h
   trunk/rts/Rendering/Textures/NamedTextures.cpp
   trunk/rts/Rendering/Textures/TextureAtlas.cpp
   trunk/rts/Rendering/Textures/TextureHandler.cpp
   trunk/rts/Rendering/UnitModels/3DModelParser.cpp
   trunk/rts/Rendering/UnitModels/3DModelParser.h
   trunk/rts/Rendering/UnitModels/3DOParser.cpp
   trunk/rts/Rendering/UnitModels/s3oParser.cpp
   trunk/rts/Rendering/glFont.cpp
   trunk/rts/Sim/Features/FeatureDef.h
   trunk/rts/Sim/Features/FeatureHandler.cpp
   trunk/rts/Sim/Misc/CategoryHandler.cpp
   trunk/rts/Sim/Misc/CategoryHandler.h
   trunk/rts/Sim/Misc/CollisionHandler.cpp
   trunk/rts/Sim/Misc/CollisionVolume.h
   trunk/rts/Sim/Misc/DamageArray.h
   trunk/rts/Sim/Misc/DamageArrayHandler.cpp
   trunk/rts/Sim/Misc/DamageArrayHandler.h
   trunk/rts/Sim/Misc/GeometricObjects.h
   trunk/rts/Sim/Misc/InterceptHandler.h
   trunk/rts/Sim/Misc/QuadField.h
   trunk/rts/Sim/ModInfo.cpp
   trunk/rts/Sim/MoveTypes/MoveInfo.cpp
   trunk/rts/Sim/MoveTypes/MoveInfo.h
   trunk/rts/Sim/MoveTypes/MoveType.h
   trunk/rts/Sim/Path/PathCache.h
   trunk/rts/Sim/Projectiles/ExplosionGenerator.cpp
   trunk/rts/Sim/Projectiles/PieceProjectile.cpp
   trunk/rts/Sim/Projectiles/ProjectileHandler.cpp
   trunk/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.cpp
   trunk/rts/Sim/Projectiles/Unsynced/BubbleProjectile.cpp
   trunk/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.cpp
   trunk/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.cpp
   trunk/rts/Sim/Projectiles/Unsynced/GfxProjectile.cpp
   trunk/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.cpp
   trunk/rts/Sim/Projectiles/Unsynced/MuzzleFlame.cpp
   trunk/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.cpp
   trunk/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.cpp
   trunk/rts/Sim/Projectiles/Unsynced/TracerProjectile.cpp
   trunk/rts/Sim/Projectiles/Unsynced/WakeProjectile.cpp
   trunk/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.cpp
   trunk/rts/Sim/SideParser.cpp
   trunk/rts/Sim/Units/COB/CobFile.cpp
   trunk/rts/Sim/Units/COB/CobInstance.h
   trunk/rts/Sim/Units/CommandAI/AirCAI.cpp
   trunk/rts/Sim/Units/CommandAI/BuilderCAI.cpp
   trunk/rts/Sim/Units/CommandAI/CommandAI.cpp
   trunk/rts/Sim/Units/CommandAI/CommandAI.h
   trunk/rts/Sim/Units/CommandAI/FactoryCAI.cpp
   trunk/rts/Sim/Units/CommandAI/LineDrawer.cpp
   trunk/rts/Sim/Units/CommandAI/MobileCAI.cpp
   trunk/rts/Sim/Units/UnitDefHandler.cpp
   trunk/rts/Sim/Units/UnitLoader.cpp
   trunk/rts/Sim/Units/UnitTracker.h
   trunk/rts/Sim/Weapons/Weapon.h
   trunk/rts/Sim/Weapons/WeaponDefHandler.cpp
   trunk/rts/System/DemoRecorder.cpp
   trunk/rts/System/EventClient.h
   trunk/rts/System/FPUCheck.h
   trunk/rts/System/FileSystem/Archive7Zip.cpp
   trunk/rts/System/FileSystem/ArchiveBuffered.cpp
   trunk/rts/System/FileSystem/ArchiveDir.cpp
   trunk/rts/System/FileSystem/ArchiveFactory.cpp
   trunk/rts/System/FileSystem/ArchiveHPI.cpp
   trunk/rts/System/FileSystem/ArchiveScanner.cpp
   trunk/rts/System/FileSystem/ArchiveZip.cpp
   trunk/rts/System/FileSystem/FileHandler.cpp
   trunk/rts/System/FileSystem/VFSHandler.cpp
   trunk/rts/System/LoadSaveHandler.cpp
   trunk/rts/System/LogOutput.cpp
   trunk/rts/System/Messages.cpp
   trunk/rts/System/MouseInput.h
   trunk/rts/System/Platform/BaseCmd.cpp
   trunk/rts/System/Platform/Clipboard.h
   trunk/rts/System/Platform/Linux/DataDirLocater.cpp
   trunk/rts/System/Platform/Linux/DotfileHandler.cpp
   trunk/rts/System/Platform/Linux/OpenALSound.cpp
   trunk/rts/System/Script/LuaFunctions.h
   trunk/rts/System/Sound.cpp
   trunk/rts/System/SpringApp.cpp
   trunk/rts/System/StdAfx.h
   trunk/rts/System/Sync/SyncedFloat3.h
   trunk/rts/System/TdfParser.cpp
   trunk/rts/System/TdfParser.h
   trunk/rts/System/creg/STL_Deque.h
   trunk/rts/System/creg/STL_List.h
   trunk/rts/System/creg/STL_Map.h
   trunk/rts/System/creg/STL_Set.h
   trunk/rts/System/creg/Serializer.cpp
   trunk/rts/System/creg/VarTypes.cpp
   trunk/rts/System/creg/creg.cpp
   trunk/tools/unitsync/Syncer.h
   trunk/tools/unitsync/unitsync.cpp
Log:
* removed almost all spring headers from StdAfx.h
* moved content_error to System/Exceptions.h
* moved string utilities (ToLower ...) into System/Util.h



Modified: trunk/AI/Group/CentralBuildAI/GroupAI.cpp
===================================================================
--- trunk/AI/Group/CentralBuildAI/GroupAI.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/AI/Group/CentralBuildAI/GroupAI.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -9,6 +9,7 @@
 #include &quot;ExternalAI/IAICallback.h&quot;
 #include &quot;Sim/Units/UnitDef.h&quot;
 #include &quot;Sim/Units/CommandAI/CommandQueue.h&quot;
+#include &quot;System/Util.h&quot;
 
 //////////////////////////////////////////////////////////////////////
 // Construction/Destruction

Modified: trunk/rts/ExternalAI/GlobalAI.cpp
===================================================================
--- trunk/rts/ExternalAI/GlobalAI.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/ExternalAI/GlobalAI.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -14,6 +14,9 @@
 
 #include &lt;sstream&gt;
 
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
+
 CR_BIND_DERIVED(CGlobalAI, CObject, (0, NULL))
 CR_REG_METADATA(CGlobalAI, (
 	CR_MEMBER(team),

Modified: trunk/rts/ExternalAI/GlobalAIHandler.h
===================================================================
--- trunk/rts/ExternalAI/GlobalAIHandler.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/ExternalAI/GlobalAIHandler.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -3,6 +3,8 @@
 
 #include &quot;Object.h&quot;
 #include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;float3.h&quot;
+#include &quot;GlobalStuff.h&quot;
 #include &lt;map&gt;
 #include &lt;string&gt;
 

Modified: trunk/rts/ExternalAI/GroupHandler.h
===================================================================
--- trunk/rts/ExternalAI/GroupHandler.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/ExternalAI/GroupHandler.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -9,6 +9,7 @@
 #include &lt;vector&gt;
 #include &lt;set&gt;
 #include &quot;ExternalAI/aikey.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 class CGroup;
 class CUnitSet;

Modified: trunk/rts/ExternalAI/aikey.h
===================================================================
--- trunk/rts/ExternalAI/aikey.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/ExternalAI/aikey.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,8 @@
 
 #include &lt;string&gt;
 
+#include &quot;creg/creg.h&quot;
+
 struct AIKey
 {
 	CR_DECLARE_STRUCT(AIKey);

Modified: trunk/rts/Game/Camera.cpp
===================================================================
--- trunk/rts/Game/Camera.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/Camera.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -18,7 +18,10 @@
 
 unsigned int CCamera::billboardList = 0;
 
-CCamera::CCamera() : forward(1.0f, 0.0f, 0.0f), rot(0.0f, 0.0f, 0.0f), pos(2000.0f, 70.0f, 1800.0f), posOffset(0.0f, 0.0f, 0.0f), tiltOffset(0.0f, 0.0f, 0.0f), lppScale(0.0f)
+CCamera::CCamera() :
+	pos(2000.0f, 70.0f, 1800.0f),
+	rot(0.0f, 0.0f, 0.0f),
+	forward(1.0f, 0.0f, 0.0f),   posOffset(0.0f, 0.0f, 0.0f), tiltOffset(0.0f, 0.0f, 0.0f), lppScale(0.0f)
 {
 	// stuff that wont change can be initialised here, it doesn't need to be reinitialised every update
 	modelview[ 3] =  0.0f;

Modified: trunk/rts/Game/Game.cpp
===================================================================
--- trunk/rts/Game/Game.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/Game.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -117,6 +117,8 @@
 #include &quot;StartScripts/Script.h&quot;
 #include &quot;StartScripts/ScriptHandler.h&quot;
 #include &quot;Sync/SyncedPrimitiveIO.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 #include &quot;System/EventHandler.h&quot;
 #include &quot;System/Sound.h&quot;
 #include &quot;System/FileSystem/SimpleParser.h&quot;

Modified: trunk/rts/Game/Game.h
===================================================================
--- trunk/rts/Game/Game.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/Game.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -11,6 +11,7 @@
 #include &quot;SDL_types.h&quot;
 
 #include &quot;GameController.h&quot;
+#include &quot;creg/creg.h&quot;
 
 class CScript;
 class CBaseWater;

Modified: trunk/rts/Game/GameServer.cpp
===================================================================
--- trunk/rts/Game/GameServer.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/GameServer.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -37,6 +37,7 @@
 #include &quot;System/Net/LocalConnection.h&quot;
 #include &quot;System/DemoReader.h&quot;
 #include &quot;System/AutohostInterface.h&quot;
+#include &quot;System/Util.h&quot;
 #include &quot;Platform/ConfigHandler.h&quot;
 #include &quot;FileSystem/CRC.h&quot;
 #include &quot;Player.h&quot;

Modified: trunk/rts/Game/GameSetup.cpp
===================================================================
--- trunk/rts/Game/GameSetup.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/GameSetup.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -18,7 +18,8 @@
 #include &quot;Map/ReadMap.h&quot;
 #include &quot;Rendering/Textures/TAPalette.h&quot;
 #include &quot;System/UnsyncedRNG.h&quot;
-#include &quot;LogOutput.h&quot;
+#include &quot;System/Exceptions.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 using namespace std;

Modified: trunk/rts/Game/PlayerRoster.cpp
===================================================================
--- trunk/rts/Game/PlayerRoster.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/PlayerRoster.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -5,10 +5,12 @@
 #include &quot;StdAfx.h&quot;
 #include &quot;mmgr.h&quot;
 
+#include &lt;assert.h&gt;
+
 #include &quot;PlayerRoster.h&quot;
 #include &quot;Player.h&quot;
 #include &quot;Team.h&quot;
-#include &lt;assert.h&gt;
+#include &quot;Util.h&quot;
 
 static int CompareAllies     (const void* a, const void* b);
 static int CompareTeamIDs    (const void* a, const void* b);

Modified: trunk/rts/Game/PreGame.cpp
===================================================================
--- trunk/rts/Game/PreGame.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/PreGame.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -36,6 +36,7 @@
 #include &quot;StartScripts/ScriptHandler.h&quot;
 #include &quot;UI/InfoConsole.h&quot;
 #include &quot;UI/MouseHandler.h&quot;
+#include &quot;Exceptions.h&quot;
 
 // msvc behaves really strange
 #if _MSC_VER

Modified: trunk/rts/Game/SelectedUnits.cpp
===================================================================
--- trunk/rts/Game/SelectedUnits.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/SelectedUnits.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -37,6 +37,7 @@
 #include &quot;Player.h&quot;
 #include &quot;Camera.h&quot;
 #include &quot;Sound.h&quot;
+#include &quot;Util.h&quot;
 
 extern Uint8 *keys;
 
@@ -50,8 +51,8 @@
 CSelectedUnits::CSelectedUnits()
 : selectionChanged(false),
 	possibleCommandsChanged(true),
-	selectedGroup(-1),
-	buildIconsFirst(false)
+	buildIconsFirst(false),
+	selectedGroup(-1)
 {
 }
 

Modified: trunk/rts/Game/StartScripts/AirScript.h
===================================================================
--- trunk/rts/Game/StartScripts/AirScript.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/StartScripts/AirScript.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -6,6 +6,7 @@
 
 #include &lt;deque&gt;
 #include &quot;Script.h&quot;
+#include &quot;float3.h&quot;
 
 class CAirScript :
 	public CScript

Modified: trunk/rts/Game/StartScripts/CommanderScript.cpp
===================================================================
--- trunk/rts/Game/StartScripts/CommanderScript.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/StartScripts/CommanderScript.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -20,6 +20,7 @@
 #include &quot;Sim/Units/UnitDefHandler.h&quot;
 #include &quot;Sim/Units/UnitLoader.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;Exceptions.h&quot;
 
 
 

Modified: trunk/rts/Game/StartScripts/CommanderScript2.cpp
===================================================================
--- trunk/rts/Game/StartScripts/CommanderScript2.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/StartScripts/CommanderScript2.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -9,6 +9,7 @@
 #include &quot;Sim/SideParser.h&quot;
 #include &quot;Sim/Units/UnitLoader.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;Exceptions.h&quot;
 
 
 extern std::string stupidGlobalMapname;

Modified: trunk/rts/Game/StartScripts/GlobalAITestScript.cpp
===================================================================
--- trunk/rts/Game/StartScripts/GlobalAITestScript.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/StartScripts/GlobalAITestScript.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -14,6 +14,7 @@
 #include &quot;System/Platform/FileSystem.h&quot;
 #include &quot;Game/GameSetup.h&quot;
 #include &quot;mmgr.h&quot;
+#include &quot;Exceptions.h&quot;
 
 
 extern std::string stupidGlobalMapname;

Modified: trunk/rts/Game/StartScripts/ScriptHandler.cpp
===================================================================
--- trunk/rts/Game/StartScripts/ScriptHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/StartScripts/ScriptHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -18,6 +18,7 @@
 #include &quot;EmptyScript.h&quot;
 #include &quot;TestScript.h&quot;
 #include &quot;Platform/SharedLib.h&quot;
+#include &quot;Exceptions.h&quot;
 #ifndef NO_LUA
 #  include &quot;System/Platform/errorhandler.h&quot;
 #endif

Modified: trunk/rts/Game/StartScripts/SpawnScript.h
===================================================================
--- trunk/rts/Game/StartScripts/SpawnScript.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/StartScripts/SpawnScript.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -6,6 +6,8 @@
 #include &lt;list&gt;
 #include &lt;vector&gt;
 #include &quot;FileSystem/FileHandler.h&quot;
+#include &quot;float3.h&quot;
+#include &quot;Exceptions.h&quot;
 
 class CSpawnScript :
 	public CScript

Modified: trunk/rts/Game/UI/CommandColors.cpp
===================================================================
--- trunk/rts/Game/UI/CommandColors.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/UI/CommandColors.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -15,6 +15,7 @@
 #include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;System/FileSystem/FileHandler.h&quot;
 #include &quot;System/FileSystem/SimpleParser.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 /******************************************************************************/
@@ -23,15 +24,6 @@
 CCommandColors cmdColors;
 
 
-static void InitColor(float color[4], float r, float g, float b, float a)
-{
-	color[0] = r;
-	color[1] = g;
-	color[2] = b;
-	color[3] = a;
-}
-
-
 CCommandColors::CCommandColors()
 {
 	alwaysDrawQueue = false;

Modified: trunk/rts/Game/UI/EndGameBox.cpp
===================================================================
--- trunk/rts/Game/UI/EndGameBox.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/UI/EndGameBox.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -14,6 +14,7 @@
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;LogOutput.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 
 extern bool globalQuit;

Modified: trunk/rts/Game/UI/GuiHandler.cpp
===================================================================
--- trunk/rts/Game/UI/GuiHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/UI/GuiHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -54,6 +54,7 @@
 #include &quot;System/FileSystem/SimpleParser.h&quot;
 #include &quot;System/LogOutput.h&quot;
 #include &quot;System/Platform/ConfigHandler.h&quot;
+#include &quot;System/Util.h&quot;
 
 extern Uint8 *keys;
 

Modified: trunk/rts/Game/UI/KeyAutoBinder.cpp
===================================================================
--- trunk/rts/Game/UI/KeyAutoBinder.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/UI/KeyAutoBinder.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -26,6 +26,7 @@
 #include &quot;Sim/Weapons/WeaponDefHandler.h&quot;
 #include &quot;System/FileSystem/SimpleParser.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 #if (LUA_VERSION_NUM &lt; 500)

Modified: trunk/rts/Game/UI/KeyBindings.cpp
===================================================================
--- trunk/rts/Game/UI/KeyBindings.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/UI/KeyBindings.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -19,6 +19,7 @@
 #include &quot;System/FileSystem/FileHandler.h&quot;
 #include &quot;System/FileSystem/SimpleParser.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 CKeyBindings* keyBindings = NULL;

Modified: trunk/rts/Game/UI/KeyCodes.cpp
===================================================================
--- trunk/rts/Game/UI/KeyCodes.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/UI/KeyCodes.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -9,6 +9,7 @@
 #include &quot;KeyCodes.h&quot;
 #include &quot;SDL_keysym.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 CKeyCodes* keyCodes = NULL;

Modified: trunk/rts/Game/UI/KeySet.cpp
===================================================================
--- trunk/rts/Game/UI/KeySet.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/UI/KeySet.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -12,6 +12,7 @@
 #include &quot;SDL_types.h&quot;
 
 #include &quot;System/LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
 
 extern Uint8* keys; // from System/Main.cpp
 

Modified: trunk/rts/Game/UI/LuaUI.cpp
===================================================================
--- trunk/rts/Game/UI/LuaUI.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/UI/LuaUI.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -74,6 +74,7 @@
 #include &quot;System/FileSystem/VFSHandler.h&quot;
 #include &quot;System/Platform/ConfigHandler.h&quot;
 #include &quot;System/Platform/FileSystem.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 #if (LUA_VERSION_NUM &lt; 500)

Modified: trunk/rts/Game/UI/MiniMap.cpp
===================================================================
--- trunk/rts/Game/UI/MiniMap.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/UI/MiniMap.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -56,6 +56,7 @@
 #include &quot;System/EventHandler.h&quot;
 #include &quot;System/Sound.h&quot;
 #include &quot;System/FileSystem/SimpleParser.h&quot;
+#include &quot;System/Util.h&quot;
 #include &quot;TimeProfiler.h&quot;
 #include &quot;TooltipConsole.h&quot;
 

Modified: trunk/rts/Game/UI/MouseCursor.cpp
===================================================================
--- trunk/rts/Game/UI/MouseCursor.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/UI/MouseCursor.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -6,6 +6,7 @@
 #include &quot;FileSystem/FileHandler.h&quot;
 #include &quot;FileSystem/SimpleParser.h&quot;
 #include &quot;LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
 #include &quot;MouseCursor.h&quot;
 #include &quot;HwMouseCursor.h&quot;
 #include &quot;myMath.h&quot;

Modified: trunk/rts/Game/UI/TooltipConsole.cpp
===================================================================
--- trunk/rts/Game/UI/TooltipConsole.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/UI/TooltipConsole.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -20,6 +20,7 @@
 #include &quot;Sim/Units/UnitHandler.h&quot;
 #include &quot;System/EventHandler.h&quot;
 #include &quot;System/Platform/ConfigHandler.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 CTooltipConsole* tooltip = 0;

Modified: trunk/rts/Game/WaitCommandsAI.cpp
===================================================================
--- trunk/rts/Game/WaitCommandsAI.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Game/WaitCommandsAI.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -24,6 +24,7 @@
 #include &quot;UI/CursorIcons.h&quot;
 #include &quot;creg/STL_Map.h&quot;
 #include &quot;creg/STL_List.h&quot;
+#include &quot;Util.h&quot;
 #include &lt;assert.h&gt;
 
 CWaitCommandsAI waitCommandsAI;

Modified: trunk/rts/Lua/LuaConstGame.cpp
===================================================================
--- trunk/rts/Lua/LuaConstGame.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaConstGame.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -23,6 +23,7 @@
 #include &quot;Sim/Units/UnitDef.h&quot; // MAX_UNITS
 #include &quot;Sim/Units/CommandAI/Command.h&quot;
 #include &quot;System/FileSystem/ArchiveScanner.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 /******************************************************************************/

Modified: trunk/rts/Lua/LuaGaia.cpp
===================================================================
--- trunk/rts/Lua/LuaGaia.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaGaia.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -27,6 +27,7 @@
 #include &quot;System/LogOutput.h&quot;
 #include &quot;System/FileSystem/FileHandler.h&quot;
 #include &quot;System/Platform/FileSystem.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 CLuaGaia* luaGaia = NULL;

Modified: trunk/rts/Lua/LuaIO.cpp
===================================================================
--- trunk/rts/Lua/LuaIO.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaIO.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -20,6 +20,7 @@
 #include &quot;LuaHandle.h&quot;
 #include &quot;LuaInclude.h&quot;
 #include &quot;System/Platform/FileSystem.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 /******************************************************************************/

Modified: trunk/rts/Lua/LuaMaterial.cpp
===================================================================
--- trunk/rts/Lua/LuaMaterial.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaMaterial.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -22,6 +22,7 @@
 #include &quot;Rendering/UnitModels/UnitDrawer.h&quot;
 #include &quot;Sim/Units/Unit.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 LuaMatHandler LuaMatHandler::handler;

Modified: trunk/rts/Lua/LuaParser.cpp
===================================================================
--- trunk/rts/Lua/LuaParser.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaParser.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -24,6 +24,7 @@
 #include &quot;System/FileSystem/VFSHandler.h&quot;
 #include &quot;System/Platform/FileSystem.h&quot;
 #include &quot;System/Platform/errorhandler.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 #if (LUA_VERSION_NUM &lt; 500)

Modified: trunk/rts/Lua/LuaPathFinder.cpp
===================================================================
--- trunk/rts/Lua/LuaPathFinder.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaPathFinder.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -18,6 +18,7 @@
 #include &quot;LuaUtils.h&quot;
 #include &quot;Sim/MoveTypes/MoveInfo.h&quot;
 #include &quot;Sim/Path/PathManager.h&quot;
+#include &quot;GlobalStuff.h&quot;
 
 
 static void CreatePathMetatable(lua_State* L);

Modified: trunk/rts/Lua/LuaShaders.cpp
===================================================================
--- trunk/rts/Lua/LuaShaders.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaShaders.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -22,6 +22,7 @@
 #include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;Rendering/ShadowHandler.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 int LuaShaders::activeShaderDepth = 0;

Modified: trunk/rts/Lua/LuaSyncedRead.cpp
===================================================================
--- trunk/rts/Lua/LuaSyncedRead.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaSyncedRead.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -68,6 +68,7 @@
 #include &quot;System/FileSystem/FileHandler.h&quot;
 #include &quot;System/FileSystem/VFSHandler.h&quot;
 #include &quot;System/Platform/FileSystem.h&quot;
+#include &quot;System/Util.h&quot;
 
 using namespace std;
 

Modified: trunk/rts/Lua/LuaTextures.cpp
===================================================================
--- trunk/rts/Lua/LuaTextures.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaTextures.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -8,6 +8,7 @@
 #include &quot;LuaTextures.h&quot;
 
 #include &quot;Rendering/GL/myGL.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 /******************************************************************************/

Modified: trunk/rts/Lua/LuaUnitDefs.cpp
===================================================================
--- trunk/rts/Lua/LuaUnitDefs.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaUnitDefs.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -52,6 +52,7 @@
 #include &quot;System/FileSystem/FileHandler.h&quot;
 #include &quot;System/FileSystem/SimpleParser.h&quot;
 #include &quot;System/Platform/FileSystem.h&quot;
+#include &quot;System/Util.h&quot;
 
 using namespace std;
 

Modified: trunk/rts/Lua/LuaUnitRendering.cpp
===================================================================
--- trunk/rts/Lua/LuaUnitRendering.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaUnitRendering.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -25,6 +25,7 @@
 #include &quot;Sim/Units/UnitHandler.h&quot;
 #include &quot;Sim/Units/UnitDefHandler.h&quot;
 #include &quot;LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 using std::min;

Modified: trunk/rts/Lua/LuaUtils.cpp
===================================================================
--- trunk/rts/Lua/LuaUtils.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaUtils.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -11,6 +11,7 @@
 #include &quot;LuaUtils.h&quot;
 
 #include &quot;LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 static       int depth = 0;

Modified: trunk/rts/Lua/LuaVFS.cpp
===================================================================
--- trunk/rts/Lua/LuaVFS.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaVFS.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -24,6 +24,7 @@
 #include &quot;System/FileSystem/FileHandler.h&quot;
 #include &quot;System/FileSystem/VFSHandler.h&quot;
 #include &quot;System/Platform/FileSystem.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 /******************************************************************************/

Modified: trunk/rts/Lua/LuaWeaponDefs.cpp
===================================================================
--- trunk/rts/Lua/LuaWeaponDefs.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Lua/LuaWeaponDefs.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -26,6 +26,8 @@
 #include &quot;Sim/Weapons/WeaponDefHandler.h&quot;
 #include &quot;System/FileSystem/SimpleParser.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 using namespace std;
 

Modified: trunk/rts/Map/MapInfo.cpp
===================================================================
--- trunk/rts/Map/MapInfo.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/MapInfo.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -8,6 +8,8 @@
 #include &quot;Lua/LuaParser.h&quot;
 #include &quot;System/LogOutput.h&quot;
 #include &quot;System/FileSystem/FileHandler.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 
 using namespace std;

Modified: trunk/rts/Map/ReadMap.cpp
===================================================================
--- trunk/rts/Map/ReadMap.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/ReadMap.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -25,6 +25,7 @@
 #include &quot;System/LoadSaveInterface.h&quot;
 #include &quot;System/LogOutput.h&quot;
 #include &quot;System/Platform/errorhandler.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using namespace std;
 

Modified: trunk/rts/Map/ReadMap.h
===================================================================
--- trunk/rts/Map/ReadMap.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/ReadMap.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,7 @@
 #include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;creg/creg.h&quot;
 #include &quot;float3.h&quot;
+#include &quot;GlobalStuff.h&quot;
 
 class CMetalMap;
 class CCamera;

Modified: trunk/rts/Map/SM3/Plane.h
===================================================================
--- trunk/rts/Map/SM3/Plane.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/SM3/Plane.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,7 @@
 #ifndef C_MATHLIB_H
 #define C_MATHLIB_H
 
+#include &quot;float3.h&quot;
 typedef float3 Vector3;
 
 #define EPSILON (0.01f)

Modified: trunk/rts/Map/SM3/Sm3Map.cpp
===================================================================
--- trunk/rts/Map/SM3/Sm3Map.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/SM3/Sm3Map.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -15,6 +15,7 @@
 #include &quot;Platform/byteorder.h&quot;
 #include &quot;FileSystem/FileHandler.h&quot;
 #include &quot;TdfParser.h&quot;
+#include &quot;System/Util.h&quot;
 
 #include &quot;terrain/TerrainNode.h&quot;
 #include &quot;Game/Camera.h&quot;

Modified: trunk/rts/Map/SM3/terrain/Lightcalc.cpp
===================================================================
--- trunk/rts/Map/SM3/terrain/Lightcalc.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/SM3/terrain/Lightcalc.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -34,6 +34,7 @@
 #include &quot;Lightcalc.h&quot;
 #include &quot;Map/ReadMap.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
+#include &quot;System/Util.h&quot;
 
 #include &lt;SDL.h&gt;
 #include &lt;IL/il.h&gt;

Modified: trunk/rts/Map/SM3/terrain/Terrain.cpp
===================================================================
--- trunk/rts/Map/SM3/terrain/Terrain.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/SM3/terrain/Terrain.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -43,6 +43,7 @@
 #include &quot;TerrainTexture.h&quot;
 #include &quot;TerrainNode.h&quot;
 #include &quot;FileSystem/FileHandler.h&quot;
+#include &quot;System/Util.h&quot;
 #include &lt;assert.h&gt;
 
 // define this for big endian machines

Modified: trunk/rts/Map/SM3/terrain/TerrainTexture.cpp
===================================================================
--- trunk/rts/Map/SM3/terrain/TerrainTexture.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/SM3/terrain/TerrainTexture.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -42,6 +42,7 @@
 #include &quot;TerrainTexEnvCombine.h&quot;
 #include &quot;TerrainTextureGLSL.h&quot;
 #include &quot;Lightcalc.h&quot;
+#include &quot;System/Util.h&quot;
 
 #include &lt;SDL_keysym.h&gt;
 extern unsigned char *keys;

Modified: trunk/rts/Map/SM3/terrain/TerrainTextureGLSL.cpp
===================================================================
--- trunk/rts/Map/SM3/terrain/TerrainTextureGLSL.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/SM3/terrain/TerrainTextureGLSL.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -37,6 +37,9 @@
 #include &quot;FileSystem/FileHandler.h&quot;
 #include &quot;Platform/FileSystem.h&quot;
 #include &quot;bitops.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 #include &lt;fstream&gt;
 #include &lt;list&gt;

Modified: trunk/rts/Map/SM3/terrain/Textures.cpp
===================================================================
--- trunk/rts/Map/SM3/terrain/Textures.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/SM3/terrain/Textures.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -39,6 +39,7 @@
 #include &quot;Textures.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;Platform/FileSystem.h&quot;
+#include &quot;System/float3.h&quot;
 
 
 namespace terrain {

Modified: trunk/rts/Map/SMF/SmfMapFile.cpp
===================================================================
--- trunk/rts/Map/SMF/SmfMapFile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/SMF/SmfMapFile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -5,7 +5,7 @@
 #include &quot;SmfMapFile.h&quot;
 #include &quot;mapfile.h&quot;
 #include &quot;mmgr.h&quot;
-#include &lt;assert.h&gt;
+#include &quot;System/Exceptions.h&quot;
 
 using std::string;
 

Modified: trunk/rts/Map/SMF/SmfReadMap.cpp
===================================================================
--- trunk/rts/Map/SMF/SmfReadMap.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Map/SMF/SmfReadMap.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -15,6 +15,8 @@
 #include &quot;Game/Camera.h&quot;
 #include &quot;bitops.h&quot;
 #include &quot;mmgr.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using namespace std;
 

Modified: trunk/rts/Rendering/Env/AdvTreeGenerator.cpp
===================================================================
--- trunk/rts/Rendering/Env/AdvTreeGenerator.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Env/AdvTreeGenerator.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -15,6 +15,7 @@
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using std::max;
 using std::min;

Modified: trunk/rts/Rendering/Env/BaseTreeDrawer.cpp
===================================================================
--- trunk/rts/Rendering/Env/BaseTreeDrawer.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Env/BaseTreeDrawer.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,7 @@
 #include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;Platform/ConfigHandler.h&quot;
 #include &quot;Game/Camera.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 CBaseTreeDrawer* treeDrawer=0;
 

Modified: trunk/rts/Rendering/Env/BaseWater.cpp
===================================================================
--- trunk/rts/Rendering/Env/BaseWater.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Env/BaseWater.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -10,6 +10,7 @@
 #include &quot;LogOutput.h&quot;
 #include &quot;DynWater.h&quot;
 #include &quot;RefractWater.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 CBaseWater* water=0;
 

Modified: trunk/rts/Rendering/Env/BaseWater.h
===================================================================
--- trunk/rts/Rendering/Env/BaseWater.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Env/BaseWater.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,6 +1,7 @@
 #ifndef __BASE_WATER_H__
 #define __BASE_WATER_H__
 
+#include &quot;float3.h&quot;
 class CGame;
 
 class CBaseWater

Modified: trunk/rts/Rendering/Env/BasicTreeDrawer.cpp
===================================================================
--- trunk/rts/Rendering/Env/BasicTreeDrawer.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Env/BasicTreeDrawer.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -14,6 +14,7 @@
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 //////////////////////////////////////////////////////////////////////
 // Construction/Destruction

Modified: trunk/rts/Rendering/Env/BasicWater.cpp
===================================================================
--- trunk/rts/Rendering/Env/BasicWater.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Env/BasicWater.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -10,6 +10,7 @@
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;Map/MapInfo.h&quot;
 #include &quot;Map/ReadMap.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 //////////////////////////////////////////////////////////////////////
 // Construction/Destruction

Modified: trunk/rts/Rendering/Env/BumpWater.cpp
===================================================================
--- trunk/rts/Rendering/Env/BumpWater.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Env/BumpWater.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -32,6 +32,7 @@
 #include &quot;System/Platform/ConfigHandler.h&quot;
 #include &quot;TimeProfiler.h&quot;
 #include &quot;LogOutput.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using std::string;
 using std::vector;
@@ -811,8 +812,8 @@
 		int xmax = min(x2 + 10*2,gs-&gt;mapx);
 		int ymin = max(y1 - 10*2,0);
 		int ymax = min(y2 + 10*2,gs-&gt;mapy);
-		int xsize = xmax - xmin;
-		int ysize = ymax - ymin;
+		//int xsize = xmax - xmin;
+		//int ysize = ymax - ymin;
 
 		glUniform2f(blurDirLoc,1.0f/gs-&gt;mapx,0.0f);
 		glDrawBuffer(GL_COLOR_ATTACHMENT0_EXT);

Modified: trunk/rts/Rendering/Env/DynWater.cpp
===================================================================
--- trunk/rts/Rendering/Env/DynWater.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Env/DynWater.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -23,15 +23,16 @@
 #include &quot;Sim/Units/Unit.h&quot;
 #include &quot;Sim/Units/UnitDef.h&quot;
 #include &quot;System/EventHandler.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 #define W_SIZE 5
 #define WF_SIZE 5120
 #define WH_SIZE 2560
-/*/
+/*
 #define W_SIZE 4
 #define WF_SIZE 4096
 #define WH_SIZE 2048
-/**/
+*/
 CDynWater::CDynWater(void)
 {
 	lastWaveFrame=0;

Modified: trunk/rts/Rendering/Env/GrassDrawer.cpp
===================================================================
--- trunk/rts/Rendering/Env/GrassDrawer.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Env/GrassDrawer.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -18,6 +18,8 @@
 #include &quot;Map/MapInfo.h&quot;
 #include &quot;Map/ReadMap.h&quot;
 #include &quot;Rendering/ShadowHandler.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 //#include &quot;TimeProfiler.h&quot;
 
 static const float turfSize=20;				//single turf size

Modified: trunk/rts/Rendering/Env/SkyBox.cpp
===================================================================
--- trunk/rts/Rendering/Env/SkyBox.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Env/SkyBox.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -10,6 +10,7 @@
 #include &quot;Map/MapInfo.h&quot;
 #include &quot;Map/ReadMap.h&quot;
 #include &quot;Rendering/UnitModels/UnitDrawer.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 CSkyBox::CSkyBox(std::string texture)
 {

Modified: trunk/rts/Rendering/GL/glList.cpp
===================================================================
--- trunk/rts/Rendering/GL/glList.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/GL/glList.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -12,6 +12,7 @@
 #include &quot;Game/UI/MouseHandler.h&quot;
 #include &quot;Rendering/glFont.h&quot;
 #include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;System/Util.h&quot;
 
 const float itemFontScale = 1.5f;
 const float itemXMargin = 0.02f;

Modified: trunk/rts/Rendering/GL/myGL.cpp
===================================================================
--- trunk/rts/Rendering/GL/myGL.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/GL/myGL.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -16,6 +16,8 @@
 #include &quot;LogOutput.h&quot;
 #include &quot;FPUCheck.h&quot;
 #include &quot;System/GlobalStuff.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 #include &quot;IFramebuffer.h&quot;
 

Modified: trunk/rts/Rendering/GroundDecalHandler.cpp
===================================================================
--- trunk/rts/Rendering/GroundDecalHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/GroundDecalHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -19,6 +19,8 @@
 #include &quot;Sim/Units/UnitDef.h&quot;
 #include &quot;Sim/Units/UnitTypes/Building.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using std::list;
 using std::min;

Modified: trunk/rts/Rendering/IconHandler.cpp
===================================================================
--- trunk/rts/Rendering/IconHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/IconHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -14,6 +14,7 @@
 #include &quot;IconHandler.h&quot;
 #include &quot;Lua/LuaParser.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using std::string;
 

Modified: trunk/rts/Rendering/Textures/ColorMap.cpp
===================================================================
--- trunk/rts/Rendering/Textures/ColorMap.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Textures/ColorMap.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -6,6 +6,8 @@
 #include &quot;Bitmap.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;FileSystem/FileHandler.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 std::vector&lt;CColorMap *&gt; CColorMap::colorMaps;
 std::map&lt;std::string, CColorMap *&gt; CColorMap::colorMapsMap;

Modified: trunk/rts/Rendering/Textures/ColorMap.h
===================================================================
--- trunk/rts/Rendering/Textures/ColorMap.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Textures/ColorMap.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -6,6 +6,8 @@
 #include &lt;list&gt;
 #include &lt;map&gt;
 
+#include &quot;creg/creg.h&quot;
+
 //Simple class to interpolate between 32bit RGBA colors
 //Do not delete an instance of this class created by any Load function, they are deleted automaticly
 class CColorMap

Modified: trunk/rts/Rendering/Textures/NamedTextures.cpp
===================================================================
--- trunk/rts/Rendering/Textures/NamedTextures.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Textures/NamedTextures.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -9,6 +9,7 @@
 #include &quot;NamedTextures.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 
 map&lt;string, CNamedTextures::TexInfo&gt; CNamedTextures::texMap;

Modified: trunk/rts/Rendering/Textures/TextureAtlas.cpp
===================================================================
--- trunk/rts/Rendering/Textures/TextureAtlas.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Textures/TextureAtlas.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,9 @@
 #include &quot;FileSystem/FileHandler.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 CR_BIND(AtlasedTexture, );
 CR_BIND_DERIVED(GroundFXTexture, AtlasedTexture, );

Modified: trunk/rts/Rendering/Textures/TextureHandler.cpp
===================================================================
--- trunk/rts/Rendering/Textures/TextureHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/Textures/TextureHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -22,6 +22,8 @@
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;Rendering/UnitModels/UnitDrawer.h&quot;
 #include &quot;TAPalette.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 //////////////////////////////////////////////////////////////////////
 // Construction/Destruction

Modified: trunk/rts/Rendering/UnitModels/3DModelParser.cpp
===================================================================
--- trunk/rts/Rendering/UnitModels/3DModelParser.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/UnitModels/3DModelParser.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,7 @@
 #include &quot;3DOParser.h&quot;
 #include &quot;s3oParser.h&quot;
 #include &quot;Sim/Units/COB/CobInstance.h&quot;
+#include &quot;System/Util.h&quot;
 
 C3DModelParser* modelParser=0;
 

Modified: trunk/rts/Rendering/UnitModels/3DModelParser.h
===================================================================
--- trunk/rts/Rendering/UnitModels/3DModelParser.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/UnitModels/3DModelParser.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -4,6 +4,7 @@
 #include &lt;vector&gt;
 #include &lt;string&gt;
 #include &quot;Matrix44f.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 struct S3DO;
 struct SS3O;

Modified: trunk/rts/Rendering/UnitModels/3DOParser.cpp
===================================================================
--- trunk/rts/Rendering/UnitModels/3DOParser.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/UnitModels/3DOParser.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -29,6 +29,8 @@
 #include &quot;Platform/byteorder.h&quot;
 #include &quot;SDL_types.h&quot;
 #include &quot;s3oParser.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using namespace std;
 

Modified: trunk/rts/Rendering/UnitModels/s3oParser.cpp
===================================================================
--- trunk/rts/Rendering/UnitModels/s3oParser.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/UnitModels/s3oParser.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -18,6 +18,8 @@
 #include &quot;Rendering/Textures/TextureHandler.h&quot;
 #include &quot;Platform/byteorder.h&quot;
 #include &quot;Platform/errorhandler.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 void SS3O::DrawStatic()
 {

Modified: trunk/rts/Rendering/glFont.cpp
===================================================================
--- trunk/rts/Rendering/glFont.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Rendering/glFont.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -12,6 +12,8 @@
 #include &quot;Game/Camera.h&quot;
 #include &quot;myMath.h&quot;
 #include &quot;Platform/FileSystem.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using namespace std;
 

Modified: trunk/rts/Sim/Features/FeatureDef.h
===================================================================
--- trunk/rts/Sim/Features/FeatureDef.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Features/FeatureDef.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -4,6 +4,7 @@
 #include &lt;string&gt;
 #include &lt;map&gt;
 
+#include &quot;float3.h&quot;
 
 #define DRAWTYPE_3DO 0
 #define DRAWTYPE_TREE 1
@@ -40,11 +41,6 @@
 
 	/// used to see if the object can be overrun
 	float mass;
-	/*
-	float collisionSphereScale;
-	float3 collisionSphereOffset;
-	bool useCSOffset;
-	*/
 
 	std::string collisionVolumeType;  /// can be &quot;Ell&quot;, &quot;CylT&quot; (where T is one of &quot;XYZ&quot;), or &quot;Box&quot;
 	float3 collisionVolumeScales;     /// the collision volume's full axis lengths

Modified: trunk/rts/Sim/Features/FeatureHandler.cpp
===================================================================
--- trunk/rts/Sim/Features/FeatureHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Features/FeatureHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -30,6 +30,7 @@
 #include &quot;System/Platform/ConfigHandler.h&quot;
 #include &quot;creg/STL_List.h&quot;
 #include &quot;creg/STL_Set.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using namespace std;
 

Modified: trunk/rts/Sim/Misc/CategoryHandler.cpp
===================================================================
--- trunk/rts/Sim/Misc/CategoryHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Misc/CategoryHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -6,6 +6,7 @@
 #include &quot;CategoryHandler.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;creg/STL_Map.h&quot;
+#include &quot;System/Util.h&quot;
 
 CR_BIND(CCategoryHandler, );
 

Modified: trunk/rts/Sim/Misc/CategoryHandler.h
===================================================================
--- trunk/rts/Sim/Misc/CategoryHandler.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Misc/CategoryHandler.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -5,6 +5,7 @@
 #include &lt;vector&gt;
 #include &lt;map&gt;
 #include &lt;boost/noncopyable.hpp&gt;
+#include &quot;creg/creg.h&quot;
 
 class CCategoryHandler : public boost::noncopyable
 {

Modified: trunk/rts/Sim/Misc/CollisionHandler.cpp
===================================================================
--- trunk/rts/Sim/Misc/CollisionHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Misc/CollisionHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -237,8 +237,8 @@
 	bool intersect = false;
 
 	// minimum and maximum (x, y, z) coordinates of transformed ray
-	const float rminx = MIN(pi0.x, pi1.x), rminy = MIN(pi0.y, pi1.y), rminz = MIN(pi0.z, pi1.z);
-	const float rmaxx = MAX(pi0.x, pi1.x), rmaxy = MAX(pi0.y, pi1.y), rmaxz = MAX(pi0.z, pi1.z);
+	const float rminx = std::min(pi0.x, pi1.x), rminy = std::min(pi0.y, pi1.y), rminz = std::min(pi0.z, pi1.z);
+	const float rmaxx = std::max(pi0.x, pi1.x), rmaxy = std::max(pi0.y, pi1.y), rmaxz = std::max(pi0.z, pi1.z);
 
 	// minimum and maximum (x, y, z) coordinates of (bounding box around) volume
 	const float vminx = -v-&gt;axisHScales.x, vminy = -v-&gt;axisHScales.y, vminz = -v-&gt;axisHScales.z;

Modified: trunk/rts/Sim/Misc/CollisionVolume.h
===================================================================
--- trunk/rts/Sim/Misc/CollisionVolume.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Misc/CollisionVolume.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -2,10 +2,9 @@
 #define COLLISION_VOLUME_H
 
 #include &quot;creg/creg.h&quot;
+#include &quot;Util.h&quot;
 
-#define EPS 0.000001f
-#define MIN(a, b) std::min((a), (b))
-#define MAX(a, b) std::max((a), (b))
+const float EPS = 0.000001f;
 
 enum COLVOL_TYPES {COLVOL_TYPE_ELLIPSOID, COLVOL_TYPE_CYLINDER, COLVOL_TYPE_BOX};
 enum COLVOL_AXES {COLVOL_AXIS_X, COLVOL_AXIS_Y, COLVOL_AXIS_Z};
@@ -126,17 +125,17 @@
 				const float prhs = axisHScales[primaryAxis     ];	// primary axis half-scale
 				const float sahs = axisHScales[secondaryAxes[0]];	// 1st secondary axis half-scale
 				const float sbhs = axisHScales[secondaryAxes[1]];	// 2nd secondary axis half-scale
-				const float mshs = MAX(sahs, sbhs);					// max. secondary axis half-scale
+				const float mshs = std::max(sahs, sbhs);					// max. secondary axis half-scale
 
 				volumeBoundingRadiusSq = prhs * prhs + mshs * mshs;
 				volumeBoundingRadius = streflop::sqrtf(volumeBoundingRadiusSq);
 			} break;
 			case COLVOL_TYPE_ELLIPSOID: {
 				if (spherical) {
-					// MAX(x, y, z) would suffice here too
+					// std::max(x, y, z) would suffice here too
 					volumeBoundingRadius = axisHScales.x;
 				} else {
-					volumeBoundingRadius = MAX(axisHScales.x, MAX(axisHScales.y, axisHScales.z));
+					volumeBoundingRadius = std::max(axisHScales.x, std::max(axisHScales.y, axisHScales.z));
 				}
 
 				volumeBoundingRadiusSq = volumeBoundingRadius * volumeBoundingRadius;

Modified: trunk/rts/Sim/Misc/DamageArray.h
===================================================================
--- trunk/rts/Sim/Misc/DamageArray.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Misc/DamageArray.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,6 +1,9 @@
 #ifndef __DAMAGE_ARRAY_H__
 #define __DAMAGE_ARRAY_H__
 
+#include &lt;algorithm&gt;
+#include &quot;creg/creg.h&quot;
+
 struct DamageArray
 {
 	CR_DECLARE_STRUCT(DamageArray);
@@ -18,8 +21,7 @@
 		craterMult = other.craterMult;
 		craterBoost = other.craterBoost;
 		numTypes = other.numTypes;
-		for(int a = 0; a &lt; numTypes; ++a)
-			damages[a] = other.damages[a];
+		std::copy(other.damages, other.damages + numTypes, damages);
 	}
 	float&amp; operator[](int i) { return damages[i]; }
 	float operator[](int i) const { return damages[i]; }

Modified: trunk/rts/Sim/Misc/DamageArrayHandler.cpp
===================================================================
--- trunk/rts/Sim/Misc/DamageArrayHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Misc/DamageArrayHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -10,6 +10,8 @@
 #include &quot;Game/Game.h&quot;
 #include &quot;Lua/LuaParser.h&quot;
 #include &quot;creg/STL_Map.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using namespace std;
 

Modified: trunk/rts/Sim/Misc/DamageArrayHandler.h
===================================================================
--- trunk/rts/Sim/Misc/DamageArrayHandler.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Misc/DamageArrayHandler.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -5,6 +5,7 @@
 #include &lt;vector&gt;
 #include &lt;map&gt;
 #include &lt;boost/noncopyable.hpp&gt;
+#include &quot;creg/creg.h&quot;
 
 class CDamageArrayHandler : public boost::noncopyable
 {

Modified: trunk/rts/Sim/Misc/GeometricObjects.h
===================================================================
--- trunk/rts/Sim/Misc/GeometricObjects.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Misc/GeometricObjects.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -4,6 +4,8 @@
 #include &lt;map&gt;
 #include &lt;vector&gt;
 #include &lt;boost/noncopyable.hpp&gt;
+#include &quot;creg/creg.h&quot;
+#include &quot;float3.h&quot;
 
 
 class CGeoSquareProjectile;

Modified: trunk/rts/Sim/Misc/InterceptHandler.h
===================================================================
--- trunk/rts/Sim/Misc/InterceptHandler.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Misc/InterceptHandler.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -5,6 +5,7 @@
 
 #include &lt;list&gt;
 #include &lt;boost/noncopyable.hpp&gt;
+#include &quot;float3.h&quot;
 
 class CWeapon;
 class CWeaponProjectile;

Modified: trunk/rts/Sim/Misc/QuadField.h
===================================================================
--- trunk/rts/Sim/Misc/QuadField.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Misc/QuadField.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -9,6 +9,10 @@
 #include &lt;list&gt;
 #include &lt;boost/noncopyable.hpp&gt;
 
+#include &quot;creg/creg.h&quot;
+#include &quot;float3.h&quot;
+#include &quot;GlobalStuff.h&quot;
+
 class CUnit;
 class CWorldObject;
 class CFeature;

Modified: trunk/rts/Sim/ModInfo.cpp
===================================================================
--- trunk/rts/Sim/ModInfo.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/ModInfo.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -12,6 +12,7 @@
 #include &quot;System/LogOutput.h&quot;
 #include &quot;System/Platform/ConfigHandler.h&quot;
 #include &quot;System/FileSystem/ArchiveScanner.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 
 CModInfo modInfo;

Modified: trunk/rts/Sim/MoveTypes/MoveInfo.cpp
===================================================================
--- trunk/rts/Sim/MoveTypes/MoveInfo.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/MoveTypes/MoveInfo.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -11,6 +11,7 @@
 #include &quot;MoveMath/MoveMath.h&quot;
 #include &quot;creg/STL_Deque.h&quot;
 #include &quot;creg/STL_Map.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using std::min;
 using std::max;

Modified: trunk/rts/Sim/MoveTypes/MoveInfo.h
===================================================================
--- trunk/rts/Sim/MoveTypes/MoveInfo.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/MoveTypes/MoveInfo.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -4,6 +4,7 @@
 #include &lt;vector&gt;
 #include &lt;map&gt;
 #include &lt;string&gt;
+#include &quot;creg/creg.h&quot;
 
 class CMoveMath;
 

Modified: trunk/rts/Sim/MoveTypes/MoveType.h
===================================================================
--- trunk/rts/Sim/MoveTypes/MoveType.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/MoveTypes/MoveType.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,6 +1,7 @@
 #ifndef MOVETYPE_H
 #define MOVETYPE_H
 
+#include &quot;creg/creg.h&quot;
 #include &quot;Object.h&quot;
 #include &quot;Sim/Misc/AirBaseHandler.h&quot;
 #include &quot;System/float3.h&quot;

Modified: trunk/rts/Sim/Path/PathCache.h
===================================================================
--- trunk/rts/Sim/Path/PathCache.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Path/PathCache.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,10 +1,12 @@
 #ifndef PATHCACHE_H
 #define PATHCACHE_H
 
-#include &quot;IPath.h&quot;
 #include &lt;map&gt;
 #include &lt;list&gt;
 
+#include &quot;IPath.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
+
 class CPathCache
 {
 public:

Modified: trunk/rts/Sim/Projectiles/ExplosionGenerator.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/ExplosionGenerator.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/ExplosionGenerator.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -24,6 +24,7 @@
 #include &quot;Sim/Projectiles/Unsynced/WakeProjectile.h&quot;
 #include &quot;Sim/Projectiles/Unsynced/WreckProjectile.h&quot;
 #include &lt;assert.h&gt;
+#include &quot;System/Exceptions.h&quot;
 
 using std::min;
 using std::max;

Modified: trunk/rts/Sim/Projectiles/PieceProjectile.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/PieceProjectile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/PieceProjectile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -21,6 +21,7 @@
 #include &quot;Sync/SyncTracer.h&quot;
 #include &quot;Unsynced/SmokeProjectile.h&quot;
 #include &quot;Unsynced/SmokeTrailProjectile.h&quot;
+#include &quot;System/Util.h&quot;
 
 static const float Smoke_Time = 40;
 

Modified: trunk/rts/Sim/Projectiles/ProjectileHandler.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/ProjectileHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/ProjectileHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -38,6 +38,7 @@
 #include &quot;System/TimeProfiler.h&quot;
 #include &quot;System/creg/STL_Map.h&quot;
 #include &quot;System/creg/STL_List.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 
 CProjectileHandler* ph;

Modified: trunk/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/Unsynced/BitmapMuzzleFlame.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -6,6 +6,7 @@
 #include &quot;Rendering/Textures/ColorMap.h&quot;
 #include &quot;Rendering/Textures/TextureAtlas.h&quot;
 #include &quot;Sim/Projectiles/ProjectileHandler.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 CR_BIND_DERIVED(CBitmapMuzzleFlame, CProjectile, );
 

Modified: trunk/rts/Sim/Projectiles/Unsynced/BubbleProjectile.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/Unsynced/BubbleProjectile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/Unsynced/BubbleProjectile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -5,6 +5,7 @@
 #include &quot;Game/Camera.h&quot;
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;Sim/Projectiles/ProjectileHandler.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 CR_BIND_DERIVED(CBubbleProjectile, CProjectile, (float3(0,0,0),float3(0,0,0),0,0,0,NULL,0));
 

Modified: trunk/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/Unsynced/ExploSpikeProjectile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -5,6 +5,7 @@
 #include &quot;Game/Camera.h&quot;
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;Sim/Projectiles/ProjectileHandler.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 CR_BIND_DERIVED(CExploSpikeProjectile, CProjectile, );
 

Modified: trunk/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/Unsynced/GeoSquareProjectile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -5,6 +5,7 @@
 #include &quot;GeoSquareProjectile.h&quot;
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;Sim/Projectiles/ProjectileHandler.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 CR_BIND_DERIVED(CGeoSquareProjectile, CProjectile, (float3(0,0,0),float3(0,0,0),float3(0,0,0),float3(0,0,0),0,0));
 

Modified: trunk/rts/Sim/Projectiles/Unsynced/GfxProjectile.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/Unsynced/GfxProjectile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/Unsynced/GfxProjectile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -8,6 +8,7 @@
 #include &quot;GfxProjectile.h&quot;
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;Sim/Projectiles/ProjectileHandler.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 CR_BIND_DERIVED(CGfxProjectile, CProjectile, );
 

Modified: trunk/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/Unsynced/HeatCloudProjectile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -8,6 +8,7 @@
 #include &quot;HeatCloudProjectile.h&quot;
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;Sim/Projectiles/ProjectileHandler.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 CR_BIND_DERIVED(CHeatCloudProjectile, CProjectile, );
 

Modified: trunk/rts/Sim/Projectiles/Unsynced/MuzzleFlame.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/Unsynced/MuzzleFlame.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/Unsynced/MuzzleFlame.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -5,6 +5,7 @@
 #include &quot;MuzzleFlame.h&quot;
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;Sim/Projectiles/ProjectileHandler.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 
 CR_BIND_DERIVED(CMuzzleFlame, CProjectile, (float3(0,0,0),float3(0,0,0),float3(0,0,0),0));

Modified: trunk/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/Unsynced/ShieldPartProjectile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -6,6 +6,7 @@
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;Sim/Projectiles/ProjectileHandler.h&quot;
 #include &quot;Rendering/Textures/TextureAtlas.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 CR_BIND_DERIVED(CShieldPartProjectile, CProjectile, (float3(0,0,0),0,0,0,float3(0,0,0),0,NULL,NULL));
 

Modified: trunk/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/Unsynced/SpherePartProjectile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -6,6 +6,7 @@
 #include &quot;Rendering/GL/VertexArray.h&quot;
 #include &quot;Sim/Projectiles/ProjectileHandler.h&quot;
 #include &quot;SpherePartProjectile.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 using std::min;
 

Modified: trunk/rts/Sim/Projectiles/Unsynced/TracerProjectile.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/Unsynced/TracerProjectile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/Unsynced/TracerProjectile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,7 @@
 
 #include &quot;TracerProjectile.h&quot;
 #include &quot;Rendering/GL/myGL.h&quot;			// Header File For The OpenGL32 Library
+#include &quot;System/GlobalStuff.h&quot;
 
 CR_BIND_DERIVED(CTracerProjectile, CProjectile, )
 

Modified: trunk/rts/Sim/Projectiles/Unsynced/WakeProjectile.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/Unsynced/WakeProjectile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/Unsynced/WakeProjectile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,7 @@
 #include &quot;Sim/Misc/Wind.h&quot;
 #include &quot;Sim/Projectiles/ProjectileHandler.h&quot;
 #include &quot;WakeProjectile.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 CR_BIND_DERIVED(CWakeProjectile, CProjectile, (float3(0,0,0),float3(0,0,0),0,0,NULL,0,0,0));
 

Modified: trunk/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.cpp
===================================================================
--- trunk/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Projectiles/WeaponProjectiles/LightingProjectile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,7 @@
 #include &quot;Sim/Weapons/Weapon.h&quot;
 #include &quot;Sim/Projectiles/ProjectileHandler.h&quot;
 #include &quot;Sim/Weapons/WeaponDefHandler.h&quot;
+#include &quot;System/GlobalStuff.h&quot;
 
 #ifdef TRACE_SYNC
 	#include &quot;Sync/SyncTracer.h&quot;

Modified: trunk/rts/Sim/SideParser.cpp
===================================================================
--- trunk/rts/Sim/SideParser.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/SideParser.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -12,6 +12,7 @@
 #include &quot;Lua/LuaParser.h&quot;
 #include &quot;Lua/LuaSyncedRead.h&quot;
 #include &quot;System/LogOutput.h&quot;
+#include &quot;System/Util.h&quot;
 
 
 SideParser sideParser;

Modified: trunk/rts/Sim/Units/COB/CobFile.cpp
===================================================================
--- trunk/rts/Sim/Units/COB/CobFile.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/COB/CobFile.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -10,6 +10,7 @@
 #include &quot;LogOutput.h&quot;
 #include &quot;Sound.h&quot;
 #include &quot;Platform/byteorder.h&quot;
+#include &quot;System/Util.h&quot;
 
 //The following structure is taken from <A HREF="http://visualta.tauniverse.com/Downloads/ta-cob-fmt.txt">http://visualta.tauniverse.com/Downloads/ta-cob-fmt.txt</A>
 //Information on missing fields from Format_Cob.pas

Modified: trunk/rts/Sim/Units/COB/CobInstance.h
===================================================================
--- trunk/rts/Sim/Units/COB/CobInstance.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/COB/CobInstance.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -4,19 +4,20 @@
 #include &lt;string&gt;
 #include &lt;vector&gt;
 #include &lt;list&gt;
-#include &quot;SDL_types.h&quot;
+#include &lt;SDL_types.h&gt;
 
-#define TAANG2RAD 10430.219207445624753419256949178f
-#define RAD2TAANG 9.587526207370107576104371709781e-5f
+const float TAANG2RAD = 10430.219207445624753419256949178f;
+const float  RAD2TAANG = 9.587526207370107576104371709781e-5f;
 
 #include &quot;Object.h&quot;
+#include &quot;GlobalStuff.h&quot;
 
 
 #define PACKXZ(x,z) (((int)(x) &lt;&lt; 16)+((int)(z) &amp; 0xffff))
 #define UNPACKX(xz) ((signed short)((Uint32)(xz) &gt;&gt; 16))
 #define UNPACKZ(xz) ((signed short)((Uint32)(xz) &amp; 0xffff))
 
-#define COBSCALE 65536
+const int COBSCALE = 65536;
 
 
 class CCobThread;

Modified: trunk/rts/Sim/Units/CommandAI/AirCAI.cpp
===================================================================
--- trunk/rts/Sim/Units/CommandAI/AirCAI.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/CommandAI/AirCAI.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -18,6 +18,7 @@
 #include &quot;System/myMath.h&quot;
 #include &quot;System/LogOutput.h&quot;
 #include &lt;assert.h&gt;
+#include &quot;System/Util.h&quot;
 
 
 CR_BIND_DERIVED(CAirCAI,CMobileCAI , );

Modified: trunk/rts/Sim/Units/CommandAI/BuilderCAI.cpp
===================================================================
--- trunk/rts/Sim/Units/CommandAI/BuilderCAI.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/CommandAI/BuilderCAI.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -2,6 +2,9 @@
 #include &quot;mmgr.h&quot;
 
 #include &quot;BuilderCAI.h&quot;
+
+#include &lt;assert.h&gt;
+
 #include &quot;TransportCAI.h&quot;
 #include &quot;LineDrawer.h&quot;
 #include &quot;ExternalAI/Group.h&quot;
@@ -33,7 +36,8 @@
 #include &quot;Sim/Units/UnitTypes/TransportUnit.h&quot;
 #include &quot;myMath.h&quot;
 #include &quot;creg/STL_Map.h&quot;
-#include &lt;assert.h&gt;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 
 CR_BIND_DERIVED(CBuilderCAI ,CMobileCAI , );

Modified: trunk/rts/Sim/Units/CommandAI/CommandAI.cpp
===================================================================
--- trunk/rts/Sim/Units/CommandAI/CommandAI.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/CommandAI/CommandAI.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -33,8 +33,9 @@
 #include &quot;creg/STL_Set.h&quot;
 #include &quot;creg/STL_Deque.h&quot;
 #include &lt;assert.h&gt;
+#include &quot;System/Util.h&quot;
 
-#define TARGET_LOST_TIMER 120	// in calls to SlowUpdate() (approx. once every second)
+const int TARGET_LOST_TIMER =120;	// in calls to SlowUpdate() (approx. once every second)
 
 CR_BIND(CCommandQueue, );
 

Modified: trunk/rts/Sim/Units/CommandAI/CommandAI.h
===================================================================
--- trunk/rts/Sim/Units/CommandAI/CommandAI.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/CommandAI/CommandAI.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,12 +1,14 @@
 #ifndef __COMMAND_AI_H__
 #define __COMMAND_AI_H__
 
-#include &quot;Object.h&quot;
-#include &quot;Sim/Units/CommandAI/Command.h&quot;
 #include &lt;vector&gt;
 #include &lt;deque&gt;
 #include &lt;set&gt;
+
+#include &quot;Object.h&quot;
+#include &quot;Sim/Units/CommandAI/Command.h&quot;
 #include &quot;CommandQueue.h&quot;
+#include &quot;float3.h&quot;
 
 class CUnit;
 class CFeature;

Modified: trunk/rts/Sim/Units/CommandAI/FactoryCAI.cpp
===================================================================
--- trunk/rts/Sim/Units/CommandAI/FactoryCAI.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/CommandAI/FactoryCAI.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -20,6 +20,8 @@
 #include &quot;Sim/Units/UnitTypes/Factory.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;creg/STL_Map.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 CR_BIND_DERIVED(CFactoryCAI ,CCommandAI , );
 

Modified: trunk/rts/Sim/Units/CommandAI/LineDrawer.cpp
===================================================================
--- trunk/rts/Sim/Units/CommandAI/LineDrawer.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/CommandAI/LineDrawer.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,6 +1,7 @@
 #include &quot;StdAfx.h&quot;
 #include &quot;LineDrawer.h&quot;
 #include &quot;Game/UI/CommandColors.h&quot;
+#include &quot;GlobalStuff.h&quot;
 
 CLineDrawer lineDrawer;
 

Modified: trunk/rts/Sim/Units/CommandAI/MobileCAI.cpp
===================================================================
--- trunk/rts/Sim/Units/CommandAI/MobileCAI.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/CommandAI/MobileCAI.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -24,6 +24,7 @@
 #include &quot;System/LogOutput.h&quot;
 #include &quot;myMath.h&quot;
 #include &lt;assert.h&gt;
+#include &quot;System/Util.h&quot;
 
 CR_BIND_DERIVED(CMobileCAI ,CCommandAI , );
 

Modified: trunk/rts/Sim/Units/UnitDefHandler.cpp
===================================================================
--- trunk/rts/Sim/Units/UnitDefHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/UnitDefHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -32,6 +32,7 @@
 #include &quot;Sim/Weapons/WeaponDefHandler.h&quot;
 #include &quot;System/LogOutput.h&quot;
 #include &quot;System/Sound.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 const char YARDMAP_CHAR = 'c';		//Need to be low case.
 

Modified: trunk/rts/Sim/Units/UnitLoader.cpp
===================================================================
--- trunk/rts/Sim/Units/UnitLoader.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/UnitLoader.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -51,6 +51,7 @@
 #include &quot;Sound.h&quot;
 #include &quot;myMath.h&quot;
 #include &quot;LogOutput.h&quot;
+#include &quot;Exceptions.h&quot;
 #include &quot;TimeProfiler.h&quot;
 
 //////////////////////////////////////////////////////////////////////

Modified: trunk/rts/Sim/Units/UnitTracker.h
===================================================================
--- trunk/rts/Sim/Units/UnitTracker.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Units/UnitTracker.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -2,7 +2,7 @@
 #define UNITTRACKER_H
 
 #include &lt;set&gt;
-#include &quot;float.h&quot;
+#include &quot;float3.h&quot;
 
 class CUnit;
 

Modified: trunk/rts/Sim/Weapons/Weapon.h
===================================================================
--- trunk/rts/Sim/Weapons/Weapon.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Weapons/Weapon.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -4,9 +4,11 @@
 //
 //////////////////////////////////////////////////////////////////////
 
+#include &lt;list&gt;
+
 #include &quot;Object.h&quot;
 #include &quot;Sim/Misc/DamageArray.h&quot;
-#include &lt;list&gt;
+#include &quot;float3.h&quot;
 
 class CUnit;
 class CWeaponProjectile;

Modified: trunk/rts/Sim/Weapons/WeaponDefHandler.cpp
===================================================================
--- trunk/rts/Sim/Weapons/WeaponDefHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/Sim/Weapons/WeaponDefHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -18,6 +18,8 @@
 #include &quot;System/LogOutput.h&quot;
 #include &quot;System/Sound.h&quot;
 #include &quot;mmgr.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 using std::min;
 using std::max;

Modified: trunk/rts/System/DemoRecorder.cpp
===================================================================
--- trunk/rts/System/DemoRecorder.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/DemoRecorder.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -12,6 +12,7 @@
 #include &quot;FileSystem/FileHandler.h&quot;
 #include &quot;Game/GameVersion.h&quot;
 #include &quot;Game/GameSetup.h&quot;
+#include &quot;System/Util.h&quot;
 
 #include &quot;LogOutput.h&quot;
 

Modified: trunk/rts/System/EventClient.h
===================================================================
--- trunk/rts/System/EventClient.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/EventClient.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,9 @@
 #include &lt;string&gt;
 #include &lt;vector&gt;
 #include &lt;map&gt;
+
+#include &quot;float3.h&quot;
+
 using std::string;
 using std::vector;
 using std::map;

Added: trunk/rts/System/Exceptions.h
===================================================================
--- trunk/rts/System/Exceptions.h	                        (rev 0)
+++ trunk/rts/System/Exceptions.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -0,0 +1,27 @@
+#ifndef EXCEPTIONS_H
+#define EXCEPTIONS_H
+
+#include &lt;stdexcept&gt;
+
+
+/** @brief Compile time assertion
+    @param condition Condition to test for.
+    @param message Message to include in the compile error if the assert fails.
+    This must be a valid C++ symbol. */
+#define COMPILE_TIME_ASSERT(condition, message) \
+	typedef int _compile_time_assertion_failed__ ## message [(condition) ? 1 : -1]
+
+
+/**
+ * content_error
+ *   thrown when content couldn't be found/loaded.
+ *   any other type of exception will cause a crashreport box appearing
+ *     (if it is installed).
+ */
+class content_error : public std::runtime_error
+{
+public:
+	content_error(const std::string&amp; msg) : std::runtime_error(msg) {};
+};
+
+#endif

Modified: trunk/rts/System/FPUCheck.h
===================================================================
--- trunk/rts/System/FPUCheck.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/FPUCheck.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -14,6 +14,7 @@
 #define FPUCHECK_H
 
 #include &quot;LogOutput.h&quot;
+#include &quot;lib/streflop/streflop_cond.h&quot;
 
 /**
 	@brief checks FPU control registers.

Modified: trunk/rts/System/FileSystem/Archive7Zip.cpp
===================================================================
--- trunk/rts/System/FileSystem/Archive7Zip.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/FileSystem/Archive7Zip.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,9 +1,12 @@
 #include &quot;StdAfx.h&quot;
-#include &lt;algorithm&gt;
-#include &lt;string.h&gt;
 #include &quot;mmgr.h&quot;
 #include &quot;Archive7Zip.h&quot;
 
+#include &lt;algorithm&gt;
+#include &lt;string.h&gt;
+
+#include &quot;Util.h&quot;
+
 // Most of this code is taken from 7zMain.c
 
 SZ_RESULT SzFileReadImp(void *object, void *buffer, size_t size, size_t *processedSize)

Modified: trunk/rts/System/FileSystem/ArchiveBuffered.cpp
===================================================================
--- trunk/rts/System/FileSystem/ArchiveBuffered.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/FileSystem/ArchiveBuffered.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,9 +1,11 @@
 #include &quot;StdAfx.h&quot;
-#include &lt;string.h&gt;
 #include &quot;mmgr.h&quot;
 
 #include &quot;ArchiveBuffered.h&quot;
 
+#include &lt;string.h&gt;
+#include &lt;cstdlib&gt;
+
 CArchiveBuffered::CArchiveBuffered(const std::string&amp; name):
 	CArchiveBase(name),
 	curFileHandle(1)

Modified: trunk/rts/System/FileSystem/ArchiveDir.cpp
===================================================================
--- trunk/rts/System/FileSystem/ArchiveDir.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/FileSystem/ArchiveDir.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,7 @@
 #include &quot;ArchiveDir.h&quot;
 #include &quot;Platform/FileSystem.h&quot;
 
+#include &quot;Util.h&quot;
 
 inline CFileHandler* CArchiveDir::GetFileHandler(int handle)
 {

Modified: trunk/rts/System/FileSystem/ArchiveFactory.cpp
===================================================================
--- trunk/rts/System/FileSystem/ArchiveFactory.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/FileSystem/ArchiveFactory.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -9,6 +9,7 @@
 #include &quot;Archive7Zip.h&quot;
 #include &quot;Platform/FileSystem.h&quot;
 
+#include &quot;Util.h&quot;
 
 // Returns true if the indicated file is in fact an archive
 bool CArchiveFactory::IsScanArchive(const std::string&amp; fileName)

Modified: trunk/rts/System/FileSystem/ArchiveHPI.cpp
===================================================================
--- trunk/rts/System/FileSystem/ArchiveHPI.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/FileSystem/ArchiveHPI.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -4,6 +4,7 @@
 
 #include &quot;ArchiveHPI.h&quot;
 
+#include &quot;Util.h&quot;
 using namespace hpiutil;
 
 CArchiveHPI::CArchiveHPI(const std::string&amp; name):

Modified: trunk/rts/System/FileSystem/ArchiveScanner.cpp
===================================================================
--- trunk/rts/System/FileSystem/ArchiveScanner.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/FileSystem/ArchiveScanner.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -18,6 +18,8 @@
 #include &quot;System/FileSystem/FileFilter.h&quot;
 #include &quot;System/FileSystem/FileHandler.h&quot;
 #include &quot;System/Platform/FileSystem.h&quot;
+#include &quot;Util.h&quot;
+#include &quot;Exceptions.h&quot;
 
 using std::string;
 using std::vector;

Modified: trunk/rts/System/FileSystem/ArchiveZip.cpp
===================================================================
--- trunk/rts/System/FileSystem/ArchiveZip.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/FileSystem/ArchiveZip.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -4,6 +4,8 @@
 
 #include &quot;ArchiveZip.h&quot;
 
+#include &quot;Util.h&quot;
+
 CArchiveZip::CArchiveZip(const std::string&amp; name):
 	CArchiveBuffered(name),
 	curSearchHandle(1)

Modified: trunk/rts/System/FileSystem/FileHandler.cpp
===================================================================
--- trunk/rts/System/FileSystem/FileHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/FileSystem/FileHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -10,6 +10,7 @@
 #include &quot;VFSHandler.h&quot;
 #include &quot;Platform/FileSystem.h&quot;
 
+#include &quot;Util.h&quot;
 using namespace std;
 
 

Modified: trunk/rts/System/FileSystem/VFSHandler.cpp
===================================================================
--- trunk/rts/System/FileSystem/VFSHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/FileSystem/VFSHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -8,6 +8,7 @@
 #include &quot;ArchiveBase.h&quot;
 #include &quot;ArchiveDir.h&quot; // for FileData::dynamic
 #include &quot;Platform/FileSystem.h&quot;
+#include &quot;Util.h&quot;
 
 
 CVFSHandler* vfsHandler = NULL;

Modified: trunk/rts/System/LoadSaveHandler.cpp
===================================================================
--- trunk/rts/System/LoadSaveHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/LoadSaveHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -30,6 +30,7 @@
 #include &quot;Sim/Units/CommandAI/BuilderCAI.h&quot;
 #include &quot;Game/GameServer.h&quot;
 #include &quot;Rendering/InMapDraw.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 extern std::string stupidGlobalMapname;
 

Modified: trunk/rts/System/LogOutput.cpp
===================================================================
--- trunk/rts/System/LogOutput.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/LogOutput.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,5 +1,7 @@
+#include &quot;StdAfx.h&quot;
 
-#include &quot;StdAfx.h&quot;
+#include &quot;LogOutput.h&quot;
+
 #include &lt;assert.h&gt;
 #include &lt;cstdarg&gt;
 #include &lt;fstream&gt;
@@ -11,8 +13,10 @@
 #endif
 
 #include &quot;mmgr.h&quot;
+#include &quot;Util.h&quot;
+#include &quot;float3.h&quot;
+#include &quot;GlobalStuff.h&quot;
 
-#include &quot;LogOutput.h&quot;
 
 static std::ofstream* filelog = 0;
 static bool initialized = false;

Modified: trunk/rts/System/Messages.cpp
===================================================================
--- trunk/rts/System/Messages.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/Messages.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -14,6 +14,7 @@
 #include &quot;LogOutput.h&quot;
 #include &quot;Messages.h&quot;
 #include &quot;Lua/LuaParser.h&quot;
+#include &quot;System/Util.h&quot;
 
 using std::string;
 using std::vector;

Modified: trunk/rts/System/MouseInput.h
===================================================================
--- trunk/rts/System/MouseInput.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/MouseInput.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -3,6 +3,8 @@
 
 #include &lt;SDL_events.h&gt;
 
+#include &quot;GlobalStuff.h&quot;
+
 class IMouseInput
 {
 public:

Modified: trunk/rts/System/Platform/BaseCmd.cpp
===================================================================
--- trunk/rts/System/Platform/BaseCmd.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/Platform/BaseCmd.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -11,6 +11,7 @@
 #include &quot;BaseCmd.h&quot;
 
 #include &lt;iostream&gt;
+#include &lt;cstdlib&gt;
 
 #ifdef _WIN32
 #include &quot;Win/Win32Cmd.h&quot;

Modified: trunk/rts/System/Platform/Clipboard.h
===================================================================
--- trunk/rts/System/Platform/Clipboard.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/Platform/Clipboard.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -3,6 +3,8 @@
 #ifndef CLIPBOARD_H
 #define CLIPBOARD_H
 
+#include &lt;string&gt;
+
 class CClipboard
 {
 	public:

Modified: trunk/rts/System/Platform/Linux/DataDirLocater.cpp
===================================================================
--- trunk/rts/System/Platform/Linux/DataDirLocater.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/Platform/Linux/DataDirLocater.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -8,6 +8,8 @@
 
 #include &quot;StdAfx.h&quot;
 #include &quot;DataDirLocater.h&quot;
+
+#include &lt;cstdlib&gt;
 #ifdef WIN32
 	#include &lt;io.h&gt;
   #include &lt;direct.h&gt;
@@ -25,6 +27,7 @@
 #include &quot;System/Platform/ConfigHandler.h&quot;
 #include &quot;System/Platform/FileSystem.h&quot;
 #include &quot;mmgr.h&quot;
+#include &quot;Exceptions.h&quot;
 
 /**
  * @brief construct a data directory object

Modified: trunk/rts/System/Platform/Linux/DotfileHandler.cpp
===================================================================
--- trunk/rts/System/Platform/Linux/DotfileHandler.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/Platform/Linux/DotfileHandler.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -16,6 +16,7 @@
 #include &lt;stdlib.h&gt;
 #include &lt;string.h&gt;
 #include &quot;Game/GameVersion.h&quot;
+#include &quot;Exceptions.h&quot;
 
 
 /**

Modified: trunk/rts/System/Platform/Linux/OpenALSound.cpp
===================================================================
--- trunk/rts/System/Platform/Linux/OpenALSound.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/Platform/Linux/OpenALSound.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -16,6 +16,7 @@
 #include &quot;OpenALSound.h&quot;
 #include &quot;OggStream.h&quot;
 #include &quot;mmgr.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 // Ogg-Vorbis audio stream object
 COggStream oggStream;

Modified: trunk/rts/System/Script/LuaFunctions.h
===================================================================
--- trunk/rts/System/Script/LuaFunctions.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/Script/LuaFunctions.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -9,6 +9,7 @@
 struct Command;
 class float3;
 class CUnit;
+class CTeam;
 class CFeature;
 struct UnitDef;
 

Modified: trunk/rts/System/Sound.cpp
===================================================================
--- trunk/rts/System/Sound.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/Sound.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -5,6 +5,7 @@
 #include &quot;Sim/Units/Unit.h&quot;
 #include &quot;LogOutput.h&quot;
 #include &quot;Platform/ConfigHandler.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 #ifdef _WIN32
 #include &quot;Platform/Win/DxSound.h&quot;

Modified: trunk/rts/System/SpringApp.cpp
===================================================================
--- trunk/rts/System/SpringApp.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/SpringApp.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -39,6 +39,8 @@
 #include &quot;MouseInput.h&quot;
 #include &quot;bitops.h&quot;
 #include &quot;Sync/Syncify.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 #include &quot;mmgr.h&quot;
 

Modified: trunk/rts/System/StdAfx.h
===================================================================
--- trunk/rts/System/StdAfx.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/StdAfx.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -9,115 +9,17 @@
 #define VC_EXTRALEAN		// Exclude rarely-used stuff from Windows headers
 #endif
 
-#ifdef _MSC_VER
-/*
-Microsoft Visual C++ 7.1: MSC_VER = 1310
-Microsoft Visual C++ 7.0: MSC_VER = 1300
-*/
-	#if _MSC_VER &gt; 1310 // &gt;= Visual Studio 2005
-		#define SNPRINTF sprintf_s
-		#define VSNPRINTF vsprintf_s
-	#else              // Visual Studio 2003
-		#define SNPRINTF _snprintf
-		#define VSNPRINTF _vsnprintf
-	#endif
-	#define STRCASECMP stricmp
-#else
-	// assuming GCC
-	#define SNPRINTF snprintf
-	#define VSNPRINTF vsnprintf
-	#define STRCASECMP strcasecmp
-#endif
 
-
-#ifdef _MSC_VER
-	#define SPRING_HASH_SET stdext::hash_set
-	#define SPRING_HASH_SET_H &lt;hash_set&gt;
-
-	#define SPRING_HASH_MAP stdext::hash_map
-	#define SPRING_HASH_MAP_H &lt;hash_map&gt;
-#elif __GNUG__
-	#define SPRING_HASH_SET __gnu_cxx::hash_set
-	#define SPRING_HASH_SET_H &lt;ext/hash_set&gt;
-
-	#define SPRING_HASH_MAP __gnu_cxx::hash_map
-	#define SPRING_HASH_MAP_H &lt;ext/hash_map&gt;
-#else
-	#error Unsupported compiler
-#endif
-
-
-/** @brief Compile time assertion
-    @param condition Condition to test for.
-    @param message Message to include in the compile error if the assert fails.
-    This must be a valid C++ symbol. */
-#define COMPILE_TIME_ASSERT(condition, message) \
-	typedef int _compile_time_assertion_failed__ ## message [(condition) ? 1 : -1]
-
-
 // This reduces compile-time with precompiled headers on msvc
 // It used to increase compile-time with precompiled headers on gcc
 #if defined(_MSC_VER) || defined(USE_PRECOMPILED_HEADER)
 #include &lt;vector&gt;
 #include &lt;map&gt;
 #include &lt;set&gt;
+#include &lt;string&gt;
 #endif
 
-// need this to support boost 1.36+
-#ifdef USE_GML
-# ifndef BOOST_DETAIL_ATOMIC_COUNT_HPP_INCLUDED
-#  define GML_COMPATIBLE_ATOMIC_COUNT
-#  define private public
-#  include &lt;boost/detail/atomic_count.hpp&gt;
-#  undef private
-# endif
-#endif
-
-#include &lt;algorithm&gt;
-#include &lt;stdexcept&gt;
-#include &lt;string&gt;
-#include &lt;cctype&gt;
-#include &lt;cstring&gt;
-#include &lt;cmath&gt;
-
+// maybe we should remove syncify altogether?
 #include &quot;Sync/Syncify.h&quot;
-#include &quot;creg/creg.h&quot;
-#include &quot;float3.h&quot;
-#include &quot;GlobalStuff.h&quot;
 
-
-/**
- * content_error
- *   thrown when content couldn't be found/loaded.
- *   any other type of exception will cause a crashreport box appearing
- *     (if it is installed).
- */
-class content_error : public std::runtime_error
-{
-	public:
-		content_error(const std::string&amp; msg) : std::runtime_error(msg) {}
-};
-
-
-static inline void StringToLowerInPlace(std::string &amp;s)
-{
-	std::transform(s.begin(), s.end(), s.begin(), (int (*)(int))tolower);
-}
-
-
-static inline std::string StringToLower(std::string s)
-{
-	StringToLowerInPlace(s);
-	return s;
-}
-
-
-static inline std::string IntToString(int i, const std::string&amp; format = &quot;%i&quot;)
-{
-	char buf[64];
-	SNPRINTF(buf, sizeof(buf), format.c_str(), i);
-	return std::string(buf);
-}
-
-
 #endif // __STD_AFX_H__

Modified: trunk/rts/System/Sync/SyncedFloat3.h
===================================================================
--- trunk/rts/System/Sync/SyncedFloat3.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/Sync/SyncedFloat3.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -10,6 +10,7 @@
 #if defined(SYNCDEBUG) || defined(SYNCCHECK)
 
 #include &quot;lib/streflop/streflop_cond.h&quot;
+#include &quot;float3.h&quot;
 
 /**
  * @brief SyncedFloat3 class

Modified: trunk/rts/System/TdfParser.cpp
===================================================================
--- trunk/rts/System/TdfParser.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/TdfParser.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -24,6 +24,7 @@
 #include &lt;boost/spirit/phoenix/binders.hpp&gt;
 #include &lt;boost/spirit/error_handling/exceptions.hpp&gt;
 #include &quot;mmgr.h&quot;
+#include &quot;Util.h&quot;
 
 #include &quot;TdfParser.h&quot;
 #include &quot;tdf_grammar.hpp&quot;

Modified: trunk/rts/System/TdfParser.h
===================================================================
--- trunk/rts/System/TdfParser.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/TdfParser.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,8 +7,9 @@
 #include &lt;vector&gt;
 #include &lt;map&gt;
 #include &lt;sstream&gt;
-#include &lt;stdexcept&gt;
 #include &quot;Sync/SyncedPrimitiveIO.h&quot;
+#include &quot;Exceptions.h&quot;
+#include &quot;float3.h&quot;
 
 class TdfParser
 {

Added: trunk/rts/System/Util.h
===================================================================
--- trunk/rts/System/Util.h	                        (rev 0)
+++ trunk/rts/System/Util.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -0,0 +1,48 @@
+#ifndef UTIL_H
+#define UTIL_H
+
+#include &lt;string&gt;
+#include &lt;algorithm&gt;
+#include &lt;stdio.h&gt;
+
+#ifdef _MSC_VER
+	/*
+	Microsoft Visual C++ 7.1: MSC_VER = 1310
+	Microsoft Visual C++ 7.0: MSC_VER = 1300
+	*/
+	#if _MSC_VER &gt; 1310 // &gt;= Visual Studio 2005
+		#define SNPRINTF sprintf_s
+		#define VSNPRINTF vsprintf_s
+	#else              // Visual Studio 2003
+		#define SNPRINTF _snprintf
+		#define VSNPRINTF _vsnprintf
+	#endif
+	#define STRCASECMP stricmp
+#else
+	// assuming GCC
+	#define SNPRINTF snprintf
+	#define VSNPRINTF vsnprintf
+	#define STRCASECMP strcasecmp
+#endif
+
+static inline void StringToLowerInPlace(std::string &amp;s)
+{
+	std::transform(s.begin(), s.end(), s.begin(), (int (*)(int))tolower);
+}
+
+
+static inline std::string StringToLower(std::string s)
+{
+	StringToLowerInPlace(s);
+	return s;
+}
+
+
+static inline std::string IntToString(int i, const std::string&amp; format = &quot;%i&quot;)
+{
+	char buf[64];
+	SNPRINTF(buf, sizeof(buf), format.c_str(), i);
+	return std::string(buf);
+}
+
+#endif

Modified: trunk/rts/System/creg/STL_Deque.h
===================================================================
--- trunk/rts/System/creg/STL_Deque.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/creg/STL_Deque.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -3,6 +3,8 @@
 
 #include &lt;deque&gt;
 
+#include &quot;creg.h&quot;
+
 namespace creg
 {
 	// Deque type (uses vector implementation)

Modified: trunk/rts/System/creg/STL_List.h
===================================================================
--- trunk/rts/System/creg/STL_List.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/creg/STL_List.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,7 +1,10 @@
 #ifndef CR_LIST_TYPE_IMPL_H
 #define CR_LIST_TYPE_IMPL_H
+
 #include &lt;list&gt;
 
+#include &quot;creg.h&quot;
+
 namespace creg {
 
 	// IType implemention for std::list

Modified: trunk/rts/System/creg/STL_Map.h
===================================================================
--- trunk/rts/System/creg/STL_Map.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/creg/STL_Map.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,6 +1,19 @@
 #ifndef CR_MAP_TYPE_IMPL_H
 #define CR_MAP_TYPE_IMPL_H
 
+#include &quot;creg.h&quot;
+
+///@TODO gcc hash_map declared as deprecated, port to hash_map
+#ifdef _MSC_VER
+	#define SPRING_HASH_MAP stdext::hash_map
+	#define SPRING_HASH_MAP_H &lt;hash_map&gt;
+#elif __GNUG__
+	#define SPRING_HASH_MAP __gnu_cxx::hash_map
+	#define SPRING_HASH_MAP_H &lt;ext/hash_map&gt;
+#else
+	#error Unsupported compiler
+#endif
+
 #include &lt;map&gt;
 // hash_map, defined in stdafx.h
 #include SPRING_HASH_MAP_H
@@ -33,7 +46,7 @@
 	template&lt;typename T&gt;
 	struct MapType : public IType
 	{
-		IType *mappedType, *keyType;
+		IType *keyType, *mappedType;
 		typedef typename T::iterator iterator;
 
 		MapType (IType *keyType,IType *mappedType) :

Modified: trunk/rts/System/creg/STL_Set.h
===================================================================
--- trunk/rts/System/creg/STL_Set.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/creg/STL_Set.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,6 +1,17 @@
 #ifndef CR_SET_TYPE_IMPL_H
 #define CR_SET_TYPE_IMPL_H
 
+///@TODO gcc hash_set declared as deprecated, port to unordered_set
+#ifdef _MSC_VER
+	#define SPRING_HASH_SET stdext::hash_set
+	#define SPRING_HASH_SET_H &lt;hash_set&gt;
+#elif __GNUG__
+	#define SPRING_HASH_SET __gnu_cxx::hash_set
+	#define SPRING_HASH_SET_H &lt;ext/hash_set&gt;
+#else
+	#error Unsupported compiler
+#endif
+
 #include &lt;set&gt;
 // hash_set, defined in stdafx.h
 #include &quot;System/StdAfx.h&quot;

Modified: trunk/rts/System/creg/Serializer.cpp
===================================================================
--- trunk/rts/System/creg/Serializer.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/creg/Serializer.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -15,6 +15,8 @@
 #include &lt;string.h&gt;
 //#include &quot;LogOutput.h&quot;
 
+#include &quot;Exceptions.h&quot;
+
 using namespace std;
 using namespace creg;
 

Modified: trunk/rts/System/creg/VarTypes.cpp
===================================================================
--- trunk/rts/System/creg/VarTypes.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/creg/VarTypes.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -7,6 +7,7 @@
 #include &quot;mmgr.h&quot;
 
 #include &quot;VarTypes.h&quot;
+#include &quot;Util.h&quot;
 
 using namespace std;
 using namespace creg;

Modified: trunk/rts/System/creg/creg.cpp
===================================================================
--- trunk/rts/System/creg/creg.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/rts/System/creg/creg.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -3,10 +3,13 @@
 Copyright 2005 Jelmer Cnossen 
 */
 #include &quot;StdAfx.h&quot;
+
+#include &quot;creg.h&quot;
+
 #include &lt;map&gt;
 #include &lt;string.h&gt;
 
-#include &quot;creg.h&quot;
+#include &quot;System/Util.h&quot;
 
 using namespace creg;
 using namespace std;

Modified: trunk/tools/unitsync/Syncer.h
===================================================================
--- trunk/tools/unitsync/Syncer.h	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/tools/unitsync/Syncer.h	2008-10-04 13:28:55 UTC (rev 6518)
@@ -4,6 +4,7 @@
 #include &lt;map&gt;
 #include &lt;vector&gt;
 #include &lt;set&gt;
+#include &lt;string&gt;
 
 typedef unsigned int crc_t;
 

Modified: trunk/tools/unitsync/unitsync.cpp
===================================================================
--- trunk/tools/unitsync/unitsync.cpp	2008-10-04 09:38:13 UTC (rev 6517)
+++ trunk/tools/unitsync/unitsync.cpp	2008-10-04 13:28:55 UTC (rev 6518)
@@ -1,6 +1,14 @@
 #include &quot;StdAfx.h&quot;
 #include &quot;unitsync.h&quot;
 
+#include &lt;string&gt;
+#include &lt;string.h&gt;
+#include &lt;vector&gt;
+#include &lt;set&gt;
+#include &lt;algorithm&gt;
+#include &lt;cstdio&gt;
+#include &lt;cstdarg&gt;
+
 #include &quot;LuaInclude.h&quot;
 #include &quot;FileSystem/ArchiveFactory.h&quot;
 #include &quot;FileSystem/ArchiveScanner.h&quot;
@@ -14,19 +22,14 @@
 #include &quot;Platform/FileSystem.h&quot;
 #include &quot;Rendering/Textures/Bitmap.h&quot;
 #include &quot;Sim/SideParser.h&quot;
+#include &quot;System/Util.h&quot;
+#include &quot;System/Exceptions.h&quot;
 
 #include &quot;LuaParserAPI.h&quot;
 #include &quot;Syncer.h&quot;
 #include &quot;SyncServer.h&quot;
 #include &quot;unitsyncLogOutput.h&quot;
 
-#include &lt;string&gt;
-#include &lt;string.h&gt;
-#include &lt;vector&gt;
-#include &lt;set&gt;
-#include &lt;algorithm&gt;
-#include &lt;cstdio&gt;
-#include &lt;cstdarg&gt;
 
 using std::string;
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001287.html">[Taspring-linux-commit] r6517 - trunk/rts/System/Platform
</A></li>
	<LI>Next message: <A HREF="001289.html">[Taspring-linux-commit] r6519 - trunk/rts/System
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1288">[ date ]</a>
              <a href="thread.html#1288">[ thread ]</a>
              <a href="subject.html#1288">[ subject ]</a>
              <a href="author.html#1288">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
