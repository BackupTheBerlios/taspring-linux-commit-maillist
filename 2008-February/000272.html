<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Taspring-linux-commit] r5465 - trunk/Lobby/TASClient
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/taspring-linux-commit/2008-February/index.html" >
   <LINK REL="made" HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r5465%20-%20trunk/Lobby/TASClient&In-Reply-To=%3CE1JNX5H-0007Mb-3P%40proserver.fnord.lan%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000271.html">
   <LINK REL="Next"  HREF="000273.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Taspring-linux-commit] r5465 - trunk/Lobby/TASClient</H1>
    <B>taspring-linux-commit at lists.berlios.de</B> 
    <A HREF="mailto:taspring-linux-commit%40lists.berlios.de?Subject=Re%3A%20%5BTaspring-linux-commit%5D%20r5465%20-%20trunk/Lobby/TASClient&In-Reply-To=%3CE1JNX5H-0007Mb-3P%40proserver.fnord.lan%3E"
       TITLE="[Taspring-linux-commit] r5465 - trunk/Lobby/TASClient">taspring-linux-commit at lists.berlios.de
       </A><BR>
    <I>Fri Feb  8 18:32:19 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000271.html">[Taspring-linux-commit] r5464 - in trunk/rts: Game	System/Platform/Win
</A></li>
        <LI>Next message: <A HREF="000273.html">[Taspring-linux-commit] r5466 - in trunk/rts: Game Game/UI System
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#272">[ date ]</a>
              <a href="thread.html#272">[ thread ]</a>
              <a href="subject.html#272">[ subject ]</a>
              <a href="author.html#272">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: satirik
Date: 2008-02-08 18:32:18 +0100 (Fri, 08 Feb 2008)
New Revision: 5465

Modified:
   trunk/Lobby/TASClient/BattleFormUnit.dfm
   trunk/Lobby/TASClient/BattleFormUnit.pas
   trunk/Lobby/TASClient/ColorPicker.dfm
   trunk/Lobby/TASClient/ColorPicker.pas
   trunk/Lobby/TASClient/HelpUnit.dfm
   trunk/Lobby/TASClient/MainUnit.dfm
   trunk/Lobby/TASClient/MainUnit.pas
   trunk/Lobby/TASClient/ManageGroups.dfm
   trunk/Lobby/TASClient/ManageGroups.pas
   trunk/Lobby/TASClient/Misc.pas
   trunk/Lobby/TASClient/PreferencesFormUnit.dfm
   trunk/Lobby/TASClient/PreferencesFormUnit.pas
   trunk/Lobby/TASClient/TASClient.dof
   trunk/Lobby/TASClient/TASClient.res
Log:
- customizing your color in battle window will change your color instead of just changing it in the color palette
- manage groups button added in options -&gt; program
- add player button added to manage groups form
- ladder help updated

Modified: trunk/Lobby/TASClient/BattleFormUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/BattleFormUnit.dfm	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/BattleFormUnit.dfm	2008-02-08 17:32:18 UTC (rev 5465)
@@ -1,6 +1,6 @@
 object BattleForm: TBattleForm
-  Left = 562
-  Top = 247
+  Left = 350
+  Top = 118
   Width = 758
   Height = 548
   Caption = 'Battle window'
@@ -4379,18 +4379,18 @@
         Height = 257
         Anchors = [akLeft, akTop, akRight]
         Color = clBtnFace
-        ActiveTabIndex = 0
+        ActiveTabIndex = 2
         OnActiveTabChange = SpTBXTabControl1ActiveTabChange
         HiddenItems = &lt;&gt;
         object GameOptionsTab: TSpTBXTabItem
           Caption = 'Game options'
-          Checked = True
         end
         object DisabledUnitsTab: TSpTBXTabItem
           Caption = 'Disabled Units (0)'
         end
         object MapTab: TSpTBXTabItem
           Caption = 'Map options'
+          Checked = True
         end
         object ModTab: TSpTBXTabItem
           Caption = 'Mod options'
@@ -4437,34 +4437,6 @@
             end
           end
         end
-        object MapTabSheet: TSpTBXTabSheet
-          Left = 0
-          Top = 23
-          Width = 393
-          Height = 234
-          Caption = 'Map options'
-          ImageIndex = -1
-          TabItem = 'MapTab'
-          object Bevel4: TBevel
-            Left = 2
-            Top = 0
-            Width = 389
-            Height = 4
-            Align = alTop
-            Shape = bsSpacer
-          end
-          object MapOptionsScrollBox: TTntScrollBox
-            Left = 2
-            Top = 4
-            Width = 389
-            Height = 228
-            VertScrollBar.Smooth = True
-            VertScrollBar.Tracking = True
-            Align = alClient
-            BorderStyle = bsNone
-            TabOrder = 0
-          end
-        end
         object ModTabSheet: TSpTBXTabSheet
           Left = 0
           Top = 23
@@ -4763,6 +4735,41 @@
             LinkFont.Style = [fsUnderline]
           end
         end
+        object MapTabSheet: TSpTBXTabSheet
+          Left = 0
+          Top = 23
+          Width = 393
+          Height = 234
+          Caption = 'Map options'
+          ImageIndex = -1
+          TabItem = 'MapTab'
+          object Bevel4: TBevel
+            Left = 2
+            Top = 0
+            Width = 389
+            Height = 4
+            Align = alTop
+            Shape = bsSpacer
+          end
+          object MapOptionsScrollBox: TTntScrollBox
+            Left = 2
+            Top = 4
+            Width = 389
+            Height = 228
+            VertScrollBar.Smooth = True
+            VertScrollBar.Tracking = True
+            Align = alClient
+            BiDiMode = bdLeftToRight
+            BorderStyle = bsNone
+            Color = clBtnFace
+            Ctl3D = True
+            ParentBiDiMode = False
+            ParentBackground = True
+            ParentColor = False
+            ParentCtl3D = False
+            TabOrder = 0
+          end
+        end
       end
       object lblTeamNbr: TSpTBXLabel
         Left = 445

Modified: trunk/Lobby/TASClient/BattleFormUnit.pas
===================================================================
--- trunk/Lobby/TASClient/BattleFormUnit.pas	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/BattleFormUnit.pas	2008-02-08 17:32:18 UTC (rev 5465)
@@ -3858,10 +3858,13 @@
       case WhatToDraw of
         NormalClient:
         begin
-          // Country Flag:
-          FlagBitmap := MainForm.GetFlagBitmap(TClient(BattleState.Battle.Clients[RealIndex]).Country);
-          Canvas.Draw(R.Left, R.Top + 16 div 2 - FlagBitmap.Height div 2, FlagBitmap);
-           Inc(Pos, FlagBitmap.Width + 4);
+          if Preferences.ShowFlags then
+          begin
+            // Country Flag:
+            FlagBitmap := MainForm.GetFlagBitmap(TClient(BattleState.Battle.Clients[RealIndex]).Country);
+            Canvas.Draw(R.Left, R.Top + 16 div 2 - FlagBitmap.Height div 2, FlagBitmap);
+            Inc(Pos, FlagBitmap.Width + 4);
+          end;
           // side:
           if TClient(BattleState.Battle.Clients[RealIndex]).GetMode = 1 then
             SideImageList.Draw(PaintInfo.Canvas, R.Left + Pos, R.Top, Min(TClient(BattleState.Battle.Clients[RealIndex]).GetSide, SideList.Count-1));
@@ -3921,10 +3924,13 @@
         end;
         OriginalClient:
         begin
-          // Country Flag:
-          FlagBitmap := MainForm.GetFlagBitmap(TClient(BattleReplayInfo.OriginalClients[RealIndex]).Country);
-          Canvas.Draw(R.Left, R.Top + 16 div 2 - FlagBitmap.Height div 2, FlagBitmap);
-           Inc(Pos, FlagBitmap.Width + 4);
+          if Preferences.ShowFlags then
+          begin
+            // Country Flag:
+            FlagBitmap := MainForm.GetFlagBitmap(TClient(BattleReplayInfo.OriginalClients[RealIndex]).Country);
+            Canvas.Draw(R.Left, R.Top + 16 div 2 - FlagBitmap.Height div 2, FlagBitmap);
+            Inc(Pos, FlagBitmap.Width + 4);
+          end;
           // side:
           if TClient(BattleReplayInfo.OriginalClients[RealIndex]).GetMode = 1 then
             SideImageList.Draw(Canvas, R.Left + Pos, R.Top, Min(TClient(BattleReplayInfo.OriginalClients[RealIndex]).GetSide, SideList.Count-1));
@@ -4526,9 +4532,8 @@
 
 procedure TBattleForm.SpTBXItem4Click(Sender: TObject);
 begin
-  //CustomColorForm.ShowModal;
-  ColorPickerForm.SpTBXTitleBar1.Caption := 'Color Picker';
-  ColorPickerForm.ShowModal;
+  Misc.InputColor('Color Picker',Status.Me.TeamColor);
+  ChangeTeamColor(MyTeamColorIndex, True);
 end;
 
 procedure TBattleForm.SpTBXItem7Click(Sender: TObject);

Modified: trunk/Lobby/TASClient/ColorPicker.dfm
===================================================================
--- trunk/Lobby/TASClient/ColorPicker.dfm	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/ColorPicker.dfm	2008-02-08 17:32:18 UTC (rev 5465)
@@ -1,6 +1,6 @@
 object ColorPickerForm: TColorPickerForm
-  Left = 453
-  Top = 132
+  Left = 838
+  Top = 320
   BorderStyle = bsDialog
   Caption = 'ColorPickerForm'
   ClientHeight = 398

Modified: trunk/Lobby/TASClient/ColorPicker.pas
===================================================================
--- trunk/Lobby/TASClient/ColorPicker.pas	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/ColorPicker.pas	2008-02-08 17:32:18 UTC (rev 5465)
@@ -83,6 +83,7 @@
     procedure RefreshHSLColor;
     procedure RefreshRGBColor;
   public
+
     procedure SetColor(Color : TColor);
     { Public declarations }
   end;
@@ -391,11 +392,19 @@
 end;
 
 procedure TColorPickerForm.SetColor(Color : TColor);
+var
+  i:integer;
 begin
     txtR.Text := IntToStr(Misc.ColorToR(Color));
     txtG.Text := IntToStr(Misc.ColorToG(Color));
     txtB.Text := IntToStr(Misc.ColorToB(Color));
-    RefreshRGBColor; 
+    RefreshRGBColor;
+    for i:=0 to 9 do
+    if MainUnit.TeamColors[i] = Color then
+    begin
+      FSelectedColorIndex := i;
+      Break;
+    end;
 end;
 
 procedure TColorPickerForm.txtBKeyUp(Sender: TObject; var Key: Word;

Modified: trunk/Lobby/TASClient/HelpUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/HelpUnit.dfm	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/HelpUnit.dfm	2008-02-08 17:32:18 UTC (rev 5465)
@@ -35,20 +35,20 @@
       Width = 601
       Height = 401
       Color = clBtnFace
-      ActiveTabIndex = 1
+      ActiveTabIndex = 3
       HiddenItems = &lt;&gt;
       object SpTBXTabItem3: TSpTBXTabItem
         Caption = 'Page 1'
       end
       object SpTBXTabItem2: TSpTBXTabItem
         Caption = 'Page 2'
-        Checked = True
       end
       object SpTBXTabItem1: TSpTBXTabItem
         Caption = 'Page 3'
       end
       object SpTBXTabItem4: TSpTBXTabItem
         Caption = 'Page 4'
+        Checked = True
       end
       object SpTBXTabSheet1: TSpTBXTabSheet
         Left = 0
@@ -305,233 +305,6 @@
           LinkFont.Style = [fsUnderline]
         end
       end
-      object SpTBXTabSheet4: TSpTBXTabSheet
-        Left = 0
-        Top = 23
-        Width = 601
-        Height = 378
-        Caption = 'Page 4'
-        ImageIndex = -1
-        TabItem = 'SpTBXTabItem4'
-        object Image12: TImage
-          Left = 56
-          Top = 56
-          Width = 17
-          Height = 17
-          Picture.Data = {
-            07544269746D617036050000424D360500000000000036040000280000001000
-            000010000000010008000000000000010000130B0000130B0000000100000001
-            00000793AC0000D2FE0000E0FE008EFEFE0000E1FE000098A70000F3FE0000E9
-            DC000490CA0000D7FE00E1FCEC0000C5FB0000A0A6000492AB0076EBDA000091
-            CC00029EE900009CD200A0E9F100D1ECFE00DDFEE10000ECFE009EFEFE0000CE
-            FE0001F3FE0000ACA80001DEF00047E6F30001ECE00000E2F00090FBFE000084
-            CA0000E7FE0000B1A4000AE1FE0000A9AA0001DEE80000DEF60000D0CE00B2FE
-            F5000085BE0000CFFE0085EDFE0000E3DE00FFFFFF0000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            00002C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C0000000000002C2C2C
-            2C2C2C2C2C2C2C001C032421002C2C2C2C2C2C2C2C2C2C2C000000002C2C2C2C
-            2C2C2C2C2C2C2C2C2C00002C2C2C2C2C2C2C2C2C2C2C2C2C2C00002C2C2C2C2C
-            2C2C2C2C2C2C2C2C00190D002C2C2C2C2C2C2C2C2C2C2C0002010F05002C2C2C
-            2C2C2C2C2C2C00042B1626101F002C2C2C2C2C2C2C0000201E0E18010800002C
-            2C2C2C2C002C00221B271D250C002C002C2C2C002C2C000B03141A0911002C2C
-            002C2C002C2C00062A0A172928002C2C002C2C2C000000071312150223000000
-            2C2C2C2C2C2C00000000000000002C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C
-            2C2C}
-          Transparent = True
-        end
-        object Image13: TImage
-          Left = 56
-          Top = 80
-          Width = 17
-          Height = 17
-          Picture.Data = {
-            07544269746D617036050000424D360500000000000036040000280000001000
-            000010000000010008000000000000010000130B0000130B0000000100000001
-            0000FFFFFF00898A8A007070710097979800A2A2A30071727200B0B1B1007778
-            78008B8B8C009E9F9F009F9FA000A5A5A600959696007C7C7D00676767009A9A
-            9A0060606000F2F3F40062626300909091008B8C8C0084858500A8A9AA00696A
-            6A00AEAEAF007B7B7C0092929300ADAEAE008989890068686900A0A1A1008383
-            84006F7070008B8B8B009B9C9C009C9D9D00A9A9AA00C9C9CA00888888006A6A
-            6B00747575007A7B7B009C9C9D00ADADAE008A8A8B0074747500A2A2A2007D7D
-            7D00949495007576760087888800ACADAE00AAABAB0065656500838383007373
-            730080808000A6A7A700C5C5C6009FA0A0009A9B9B0070707000818182006969
-            6A00767676007D7E7E007B7C7C00787979007A7A7B006A6B6B00EEEFEF007D7D
-            7E0078787900525252008E8F8F006B6C6C00FFFFFF0000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            00004C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4527171D0E354C4C4C
-            4C4C4C4C4C4C4C02072531493F4C4C4C4C4C4C4C4C4C4C4C2D3705204C4C4C4C
-            4C4C4C4C4C4C4C4C4C07404C4C4C4C4C4C4C4C4C4C4C4C4C4C0D444C4C4C4C4C
-            4C4C4C4C4C4C4C4C3610430D4C4C4C4C4C4C4C4C4C4C4C0101323D4B474C4C4C
-            4C4C4C4C4C4C130F1C00283005414C4C4C4C4C4C4C030C0C00112E2C083E2F4C
-            4C4C4C4C094C3C3A4600210812154C194C4C4C394C4C3B090000042242264C4C
-            484C4C334C4C0B1B0000242338144C4C294C4C4C0618340A00000A04024A011F
-            4C4C4C4C4C4C062B160B1E2A031A4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C
-            4C4C}
-          Transparent = True
-        end
-        object Image14: TImage
-          Left = 56
-          Top = 104
-          Width = 17
-          Height = 17
-          Picture.Data = {
-            07544269746D617036050000424D360500000000000036040000280000001000
-            000010000000010008000000000000010000130B0000130B0000000100000001
-            00000159A8000095DE0063C3DE0000B7DE0000A3DE0000ADC80000AFCB0000AF
-            DE000075A2007CC3D800004CB4000070A40000A2D50000A4DE005DB1DE0099C3
-            CB0092AFDE0053AEC7000061C2009CC0D200009ADE00006DA6000056BC0002A4
-            DE0064BFDE000091DE0000ABDE000092DE000058A7000088DC0000A2D0006FC3
-            DE00005DA30000A5D5000057BE000093BF000064A30000A2D90000A7CA0030A9
-            D7000062D100004BBC0070ADD600FFFFFF000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            0000000000000000000000000000000000000000000000000000000000000000
-            00002B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B0000000000002B2B2B
-            2B2B2B2B2B2B2B0006021E08002B2B2B2B2B2B2B2B2B2B2B000000002B2B2B2B
-            2B2B2B2B2B2B2B2B2B00002B2B2B2B2B2B2B2B2B2B2B2B2B2B00002B2B2B2B2B
-            2B2B2B2B2B2B2B2B000B1C002B2B2B2B2B2B2B2B2B2B2B0004012220002B2B2B
-            2B2B2B2B2B2B000D261F232829002B2B2B2B2B2B2B00001A181103011600002B
-            2B2B2B2B002B00172709212524002B002B2B2B002B2B001D020F0C1412002B2B
-            002B2B002B2B00030E13191B0A002B2B002B2B2B00000005102A070415000000
-            2B2B2B2B2B2B00000000000000002B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B
-            2B2B}
-          Transparent = True
-        end
-        object SpTBXLabel10: TSpTBXLabel
-          Left = 32
-          Top = 32
-          Width = 79
-          Height = 13
-          Caption = 'Ladder rewards :'
-          LinkFont.Charset = DEFAULT_CHARSET
-          LinkFont.Color = clBlue
-          LinkFont.Height = -11
-          LinkFont.Name = 'MS Sans Serif'
-          LinkFont.Style = [fsUnderline]
-        end
-        object SpTBXLabel11: TSpTBXLabel
-          Left = 88
-          Top = 56
-          Width = 165
-          Height = 13
-          Caption = 'Gold cup for the best ladder player.'
-          LinkFont.Charset = DEFAULT_CHARSET
-          LinkFont.Color = clBlue
-          LinkFont.Height = -11
-          LinkFont.Name = 'MS Sans Serif'
-          LinkFont.Style = [fsUnderline]
-        end
-        object SpTBXLabel12: TSpTBXLabel
-          Left = 88
-          Top = 80
-          Width = 104
-          Height = 13
-          Caption = 'Silver cup for the 2nd.'
-          LinkFont.Charset = DEFAULT_CHARSET
-          LinkFont.Color = clBlue
-          LinkFont.Height = -11
-          LinkFont.Name = 'MS Sans Serif'
-          LinkFont.Style = [fsUnderline]
-        end
-        object SpTBXLabel13: TSpTBXLabel
-          Left = 88
-          Top = 104
-          Width = 108
-          Height = 13
-          Caption = 'Bronze cup for the 3rd.'
-          LinkFont.Charset = DEFAULT_CHARSET
-          LinkFont.Color = clBlue
-          LinkFont.Height = -11
-          LinkFont.Name = 'MS Sans Serif'
-          LinkFont.Style = [fsUnderline]
-        end
-        object SpTBXLabel14: TSpTBXLabel
-          Left = 32
-          Top = 136
-          Width = 233
-          Height = 49
-          Caption = 
-            'Players can have 1 cup per active ladder. To see the complete li' +
-            'st of ladders, see the rules, the maps and the ranking page of e' +
-            'ach ladder, visit the ladder web site.'
-          AutoSize = False
-          Wrapping = twWrap
-          LinkFont.Charset = DEFAULT_CHARSET
-          LinkFont.Color = clBlue
-          LinkFont.Height = -11
-          LinkFont.Name = 'MS Sans Serif'
-          LinkFont.Style = [fsUnderline]
-        end
-      end
       object SpTBXTabSheet3: TSpTBXTabSheet
         Left = 0
         Top = 23
@@ -2789,6 +2562,233 @@
           LinkFont.Style = [fsUnderline]
         end
       end
+      object SpTBXTabSheet4: TSpTBXTabSheet
+        Left = 0
+        Top = 23
+        Width = 601
+        Height = 378
+        Caption = 'Page 4'
+        ImageIndex = -1
+        TabItem = 'SpTBXTabItem4'
+        object Image12: TImage
+          Left = 56
+          Top = 56
+          Width = 17
+          Height = 17
+          Picture.Data = {
+            07544269746D617036050000424D360500000000000036040000280000001000
+            000010000000010008000000000000010000130B0000130B0000000100000001
+            00000793AC0000D2FE0000E0FE008EFEFE0000E1FE000098A70000F3FE0000E9
+            DC000490CA0000D7FE00E1FCEC0000C5FB0000A0A6000492AB0076EBDA000091
+            CC00029EE900009CD200A0E9F100D1ECFE00DDFEE10000ECFE009EFEFE0000CE
+            FE0001F3FE0000ACA80001DEF00047E6F30001ECE00000E2F00090FBFE000084
+            CA0000E7FE0000B1A4000AE1FE0000A9AA0001DEE80000DEF60000D0CE00B2FE
+            F5000085BE0000CFFE0085EDFE0000E3DE00FFFFFF0000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            00002C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C0000000000002C2C2C
+            2C2C2C2C2C2C2C001C032421002C2C2C2C2C2C2C2C2C2C2C000000002C2C2C2C
+            2C2C2C2C2C2C2C2C2C00002C2C2C2C2C2C2C2C2C2C2C2C2C2C00002C2C2C2C2C
+            2C2C2C2C2C2C2C2C00190D002C2C2C2C2C2C2C2C2C2C2C0002010F05002C2C2C
+            2C2C2C2C2C2C00042B1626101F002C2C2C2C2C2C2C0000201E0E18010800002C
+            2C2C2C2C002C00221B271D250C002C002C2C2C002C2C000B03141A0911002C2C
+            002C2C002C2C00062A0A172928002C2C002C2C2C000000071312150223000000
+            2C2C2C2C2C2C00000000000000002C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C
+            2C2C}
+          Transparent = True
+        end
+        object Image13: TImage
+          Left = 56
+          Top = 80
+          Width = 17
+          Height = 17
+          Picture.Data = {
+            07544269746D617036050000424D360500000000000036040000280000001000
+            000010000000010008000000000000010000130B0000130B0000000100000001
+            0000FFFFFF00898A8A007070710097979800A2A2A30071727200B0B1B1007778
+            78008B8B8C009E9F9F009F9FA000A5A5A600959696007C7C7D00676767009A9A
+            9A0060606000F2F3F40062626300909091008B8C8C0084858500A8A9AA00696A
+            6A00AEAEAF007B7B7C0092929300ADAEAE008989890068686900A0A1A1008383
+            84006F7070008B8B8B009B9C9C009C9D9D00A9A9AA00C9C9CA00888888006A6A
+            6B00747575007A7B7B009C9C9D00ADADAE008A8A8B0074747500A2A2A2007D7D
+            7D00949495007576760087888800ACADAE00AAABAB0065656500838383007373
+            730080808000A6A7A700C5C5C6009FA0A0009A9B9B0070707000818182006969
+            6A00767676007D7E7E007B7C7C00787979007A7A7B006A6B6B00EEEFEF007D7D
+            7E0078787900525252008E8F8F006B6C6C00FFFFFF0000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            00004C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4527171D0E354C4C4C
+            4C4C4C4C4C4C4C02072531493F4C4C4C4C4C4C4C4C4C4C4C2D3705204C4C4C4C
+            4C4C4C4C4C4C4C4C4C07404C4C4C4C4C4C4C4C4C4C4C4C4C4C0D444C4C4C4C4C
+            4C4C4C4C4C4C4C4C3610430D4C4C4C4C4C4C4C4C4C4C4C0101323D4B474C4C4C
+            4C4C4C4C4C4C130F1C00283005414C4C4C4C4C4C4C030C0C00112E2C083E2F4C
+            4C4C4C4C094C3C3A4600210812154C194C4C4C394C4C3B090000042242264C4C
+            484C4C334C4C0B1B0000242338144C4C294C4C4C0618340A00000A04024A011F
+            4C4C4C4C4C4C062B160B1E2A031A4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C
+            4C4C}
+          Transparent = True
+        end
+        object Image14: TImage
+          Left = 56
+          Top = 104
+          Width = 17
+          Height = 17
+          Picture.Data = {
+            07544269746D617036050000424D360500000000000036040000280000001000
+            000010000000010008000000000000010000130B0000130B0000000100000001
+            00000159A8000095DE0063C3DE0000B7DE0000A3DE0000ADC80000AFCB0000AF
+            DE000075A2007CC3D800004CB4000070A40000A2D50000A4DE005DB1DE0099C3
+            CB0092AFDE0053AEC7000061C2009CC0D200009ADE00006DA6000056BC0002A4
+            DE0064BFDE000091DE0000ABDE000092DE000058A7000088DC0000A2D0006FC3
+            DE00005DA30000A5D5000057BE000093BF000064A30000A2D90000A7CA0030A9
+            D7000062D100004BBC0070ADD600FFFFFF000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            0000000000000000000000000000000000000000000000000000000000000000
+            00002B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B0000000000002B2B2B
+            2B2B2B2B2B2B2B0006021E08002B2B2B2B2B2B2B2B2B2B2B000000002B2B2B2B
+            2B2B2B2B2B2B2B2B2B00002B2B2B2B2B2B2B2B2B2B2B2B2B2B00002B2B2B2B2B
+            2B2B2B2B2B2B2B2B000B1C002B2B2B2B2B2B2B2B2B2B2B0004012220002B2B2B
+            2B2B2B2B2B2B000D261F232829002B2B2B2B2B2B2B00001A181103011600002B
+            2B2B2B2B002B00172709212524002B002B2B2B002B2B001D020F0C1412002B2B
+            002B2B002B2B00030E13191B0A002B2B002B2B2B00000005102A070415000000
+            2B2B2B2B2B2B00000000000000002B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B2B
+            2B2B}
+          Transparent = True
+        end
+        object SpTBXLabel10: TSpTBXLabel
+          Left = 32
+          Top = 32
+          Width = 79
+          Height = 13
+          Caption = 'Ladder rewards :'
+          LinkFont.Charset = DEFAULT_CHARSET
+          LinkFont.Color = clBlue
+          LinkFont.Height = -11
+          LinkFont.Name = 'MS Sans Serif'
+          LinkFont.Style = [fsUnderline]
+        end
+        object SpTBXLabel11: TSpTBXLabel
+          Left = 88
+          Top = 56
+          Width = 165
+          Height = 13
+          Caption = 'Gold cup for the best ladder player.'
+          LinkFont.Charset = DEFAULT_CHARSET
+          LinkFont.Color = clBlue
+          LinkFont.Height = -11
+          LinkFont.Name = 'MS Sans Serif'
+          LinkFont.Style = [fsUnderline]
+        end
+        object SpTBXLabel12: TSpTBXLabel
+          Left = 88
+          Top = 80
+          Width = 104
+          Height = 13
+          Caption = 'Silver cup for the 2nd.'
+          LinkFont.Charset = DEFAULT_CHARSET
+          LinkFont.Color = clBlue
+          LinkFont.Height = -11
+          LinkFont.Name = 'MS Sans Serif'
+          LinkFont.Style = [fsUnderline]
+        end
+        object SpTBXLabel13: TSpTBXLabel
+          Left = 88
+          Top = 104
+          Width = 108
+          Height = 13
+          Caption = 'Bronze cup for the 3rd.'
+          LinkFont.Charset = DEFAULT_CHARSET
+          LinkFont.Color = clBlue
+          LinkFont.Height = -11
+          LinkFont.Name = 'MS Sans Serif'
+          LinkFont.Style = [fsUnderline]
+        end
+        object SpTBXLabel14: TSpTBXLabel
+          Left = 32
+          Top = 136
+          Width = 233
+          Height = 49
+          Caption = 
+            'Players can have 1 cup per active ladder. To see  the rules, the' +
+            ' maps and the ranking page of each ladder, visit the ladder web ' +
+            'site.'
+          AutoSize = False
+          Wrapping = twWrap
+          LinkFont.Charset = DEFAULT_CHARSET
+          LinkFont.Color = clBlue
+          LinkFont.Height = -11
+          LinkFont.Name = 'MS Sans Serif'
+          LinkFont.Style = [fsUnderline]
+        end
+      end
     end
     object Button3: TSpTBXButton
       Left = 360

Modified: trunk/Lobby/TASClient/MainUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/MainUnit.dfm	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/MainUnit.dfm	2008-02-08 17:32:18 UTC (rev 5465)
@@ -6314,7 +6314,7 @@
       000000000000}
   end
   object LadderCupsRefresh: TTimer
-    Interval = 60000
+    Interval = 120000
     OnTimer = LadderCupsRefreshTimer
     Left = 388
     Top = 166

Modified: trunk/Lobby/TASClient/MainUnit.pas
===================================================================
--- trunk/Lobby/TASClient/MainUnit.pas	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/MainUnit.pas	2008-02-08 17:32:18 UTC (rev 5465)
@@ -5160,7 +5160,7 @@
 
       Client.StatusRefreshed := False;
 
-      if (not Application.Active) or (not BattleForm.Active) then
+      if ((not Application.Active) or (not BattleForm.Active)) and not Status.ReceivingLoginInfo then
         if (not ((BattleForm.IsBattleActive) and (Battle.ID = BattleState.Battle.ID) and (NotificationsForm.FindNotification(nfJoinedBattle, [])))) then
           if NotificationsForm.FindNotification(nfStatusInBattle, [Client.Name]) or ((Client.GetGroup &gt; -1) and TClientGroup(ClientGroups[Client.GetGroup]).NotifyOnHost and (Battle.ID &lt;&gt; Status.Me.GetBattleId)) then AddNotification('Player joined battle', '&lt;' + Client.Name + '&gt; has joined ' + TClient(Battle.Clients[0]).Name + '''s battle.' , 4000,true,Battle.ID);
 

Modified: trunk/Lobby/TASClient/ManageGroups.dfm
===================================================================
--- trunk/Lobby/TASClient/ManageGroups.dfm	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/ManageGroups.dfm	2008-02-08 17:32:18 UTC (rev 5465)
@@ -1,6 +1,6 @@
 object ManageGroupsForm: TManageGroupsForm
-  Left = 507
-  Top = 281
+  Left = 871
+  Top = 171
   BorderStyle = bsDialog
   Caption = 'ManageGroupsForm'
   ClientHeight = 374
@@ -14,6 +14,7 @@
   Font.Name = 'MS Sans Serif'
   Font.Style = []
   OldCreateOrder = False
+  Position = poScreenCenter
   Scaled = False
   OnCreate = FormCreate
   OnShow = FormShow
@@ -56,7 +57,7 @@
         456
         41)
       object btRemove: TSpTBXButton
-        Left = 8
+        Left = 104
         Top = 8
         Width = 89
         Height = 25
@@ -71,9 +72,9 @@
         ThemeType = thtTBX
       end
       object btRemoveGroup: TSpTBXButton
-        Left = 102
+        Left = 200
         Top = 8
-        Width = 97
+        Width = 89
         Height = 25
         Caption = 'Remove group'
         TabOrder = 1
@@ -99,6 +100,20 @@
         LinkFont.Name = 'MS Sans Serif'
         LinkFont.Style = [fsUnderline]
       end
+      object btAddPlayer: TSpTBXButton
+        Left = 8
+        Top = 8
+        Width = 89
+        Height = 25
+        Caption = 'Add player'
+        TabOrder = 3
+        OnClick = btAddPlayerClick
+        LinkFont.Charset = DEFAULT_CHARSET
+        LinkFont.Color = clBlue
+        LinkFont.Height = -11
+        LinkFont.Name = 'MS Sans Serif'
+        LinkFont.Style = [fsUnderline]
+      end
     end
     object SpTBXPanel2: TSpTBXPanel
       Left = 240

Modified: trunk/Lobby/TASClient/ManageGroups.pas
===================================================================
--- trunk/Lobby/TASClient/ManageGroups.pas	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/ManageGroups.pas	2008-02-08 17:32:18 UTC (rev 5465)
@@ -36,6 +36,7 @@
     txtName: TSpTBXEdit;
     SpTBXLabel9: TSpTBXLabel;
     HighlightBattlesCheckbox: TSpTBXCheckBox;
+    btAddPlayer: TSpTBXButton;
     procedure FormShow(Sender: TObject);
     procedure cmbGroupsChange(Sender: TObject);
     procedure btRemoveClick(Sender: TObject);
@@ -52,6 +53,7 @@
     procedure NotifyOnConnectCheckBoxClick(Sender: TObject);
     procedure FormCreate(Sender: TObject);
     procedure HighlightBattlesCheckboxClick(Sender: TObject);
+    procedure btAddPlayerClick(Sender: TObject);
   private
     { Private declarations }
   public
@@ -208,4 +210,17 @@
   TClientGroup(ClientGroups[cmbGroups.ItemIndex]).HighlightBattles := HighlightBattlesCheckbox.Checked;
 end;
 
+procedure TManageGroupsForm.btAddPlayerClick(Sender: TObject);
+var
+  InputString: string;
+begin
+  InputString := '';
+  if InputQuery('New group ...', 'Enter the group name :', InputString) and (InputString &lt;&gt; '') then
+  begin
+    TClientGroup(ClientGroups[cmbGroups.ItemIndex]).Clients.Add(InputString);
+    lstClients.Items.Add(InputString);
+    lstClients.Refresh;
+  end;
+end;
+
 end.

Modified: trunk/Lobby/TASClient/Misc.pas
===================================================================
--- trunk/Lobby/TASClient/Misc.pas	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/Misc.pas	2008-02-08 17:32:18 UTC (rev 5465)
@@ -1628,9 +1628,12 @@
 end;
 
 function InputColor(title: String; defaultColor: TColor):TColor;
+var
+  i: integer;
 begin
   ColorPickerForm.SpTBXTitleBar1.Caption := title;
   ColorPickerForm.SetColor(defaultColor);
+
   if ColorPickerForm.ShowModal = mrOK then
     Result := ColorPickerForm.ColorPanel.Color
   else

Modified: trunk/Lobby/TASClient/PreferencesFormUnit.dfm
===================================================================
--- trunk/Lobby/TASClient/PreferencesFormUnit.dfm	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/PreferencesFormUnit.dfm	2008-02-08 17:32:18 UTC (rev 5465)
@@ -1,9 +1,9 @@
 object PreferencesForm: TPreferencesForm
-  Left = 250
-  Top = 368
+  Left = 516
+  Top = 232
   BorderStyle = bsDialog
   Caption = 'Preferences'
-  ClientHeight = 376
+  ClientHeight = 392
   ClientWidth = 377
   Color = clBtnFace
   Constraints.MaxHeight = 1000
@@ -25,7 +25,7 @@
     Left = 0
     Top = 0
     Width = 377
-    Height = 376
+    Height = 392
     Caption = 'Preferences'
     FixedSize = True
     Options.Minimize = False
@@ -35,7 +35,7 @@
       Left = 8
       Top = 40
       Width = 361
-      Height = 281
+      Height = 305
       Color = clBtnFace
       ActiveTabIndex = 2
       TabAutofit = True
@@ -69,7 +69,7 @@
         Left = 0
         Top = 23
         Width = 361
-        Height = 258
+        Height = 282
         Caption = 'Skins'
         ImageIndex = -1
         TabItem = 'SpTBXTabItem1'
@@ -77,7 +77,7 @@
           Left = 16
           Top = 8
           Width = 329
-          Height = 233
+          Height = 257
           Caption = 'Skin manager'
           Color = clNone
           ParentColor = False
@@ -151,7 +151,7 @@
         Left = 0
         Top = 23
         Width = 361
-        Height = 258
+        Height = 282
         Caption = 'HTTP'
         ImageIndex = -1
         TabItem = 'SpTBXTabItem2'
@@ -159,7 +159,7 @@
           Left = 16
           Top = 8
           Width = 329
-          Height = 233
+          Height = 257
           Caption = 'Proxy settings'
           Color = clNone
           ParentColor = False
@@ -267,11 +267,113 @@
           end
         end
       end
+      object SpTBXTabSheet3: TSpTBXTabSheet
+        Left = 0
+        Top = 23
+        Width = 361
+        Height = 282
+        Caption = 'Interface'
+        ImageIndex = -1
+        TabItem = 'SpTBXTabItem3'
+        object GroupBox4: TSpTBXGroupBox
+          Left = 16
+          Top = 8
+          Width = 329
+          Height = 257
+          Caption = 'Interface preferences'
+          Color = clNone
+          ParentColor = False
+          TabOrder = 0
+          object CheckBox1: TSpTBXCheckBox
+            Left = 24
+            Top = 40
+            Width = 104
+            Height = 15
+            Caption = 'Timestamp events'
+            TabOrder = 0
+            Checked = True
+            State = cbChecked
+          end
+          object CheckBox3: TSpTBXCheckBox
+            Left = 24
+            Top = 56
+            Width = 128
+            Height = 15
+            Caption = 'Filter join/left messages'
+            TabOrder = 1
+          end
+          object CheckBox4: TSpTBXCheckBox
+            Left = 24
+            Top = 72
+            Width = 108
+            Height = 15
+            Caption = 'Show country flags'
+            TabOrder = 2
+            Checked = True
+            State = cbChecked
+          end
+          object CheckBox5: TSpTBXCheckBox
+            Left = 24
+            Top = 88
+            Width = 147
+            Height = 15
+            Caption = 'Mark unknown maps/mods'
+            TabOrder = 3
+            Checked = True
+            State = cbChecked
+          end
+          object CheckBox6: TSpTBXCheckBox
+            Left = 24
+            Top = 104
+            Width = 251
+            Height = 15
+            Caption = 'Use taskbar button for each form (requires restart)'
+            TabOrder = 4
+          end
+          object WarnNATCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 120
+            Width = 271
+            Height = 15
+            Caption = 'Display warning icons on battles using NAT traversing'
+            TabOrder = 5
+            Checked = True
+            State = cbChecked
+          end
+          object AutoFocusOnPMCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 136
+            Width = 262
+            Height = 15
+            Caption = 'Automatically switch focus to new private messages'
+            TabOrder = 6
+            Checked = True
+            State = cbChecked
+          end
+          object DisableAllSoundsCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 152
+            Width = 103
+            Height = 15
+            Caption = 'Disable all sounds'
+            TabOrder = 7
+          end
+          object UploadReplayCheckBox: TSpTBXCheckBox
+            Left = 24
+            Top = 168
+            Width = 245
+            Height = 15
+            Caption = 'Ask to upload replay after the end of each battle'
+            TabOrder = 8
+            Visible = False
+          end
+        end
+      end
       object SpTBXTabSheet5: TSpTBXTabSheet
         Left = 0
         Top = 23
         Width = 361
-        Height = 258
+        Height = 282
         Caption = 'Account'
         ImageIndex = -1
         TabItem = 'SpTBXTabItem5'
@@ -279,7 +381,7 @@
           Left = 16
           Top = 8
           Width = 329
-          Height = 233
+          Height = 257
           Caption = 'Account details'
           Color = clNone
           ParentColor = False
@@ -392,7 +494,7 @@
         Left = 0
         Top = 23
         Width = 361
-        Height = 258
+        Height = 282
         Caption = 'Server'
         ImageIndex = -1
         TabItem = 'SpTBXTabItem6'
@@ -400,7 +502,7 @@
           Left = 16
           Top = 8
           Width = 329
-          Height = 233
+          Height = 257
           Caption = 'Server settings'
           Color = clNone
           ParentColor = False
@@ -499,113 +601,11 @@
           end
         end
       end
-      object SpTBXTabSheet3: TSpTBXTabSheet
-        Left = 0
-        Top = 23
-        Width = 361
-        Height = 258
-        Caption = 'Interface'
-        ImageIndex = -1
-        TabItem = 'SpTBXTabItem3'
-        object GroupBox4: TSpTBXGroupBox
-          Left = 16
-          Top = 8
-          Width = 329
-          Height = 233
-          Caption = 'Interface preferences'
-          Color = clNone
-          ParentColor = False
-          TabOrder = 0
-          object CheckBox1: TSpTBXCheckBox
-            Left = 24
-            Top = 40
-            Width = 104
-            Height = 15
-            Caption = 'Timestamp events'
-            TabOrder = 0
-            Checked = True
-            State = cbChecked
-          end
-          object CheckBox3: TSpTBXCheckBox
-            Left = 24
-            Top = 56
-            Width = 128
-            Height = 15
-            Caption = 'Filter join/left messages'
-            TabOrder = 1
-          end
-          object CheckBox4: TSpTBXCheckBox
-            Left = 24
-            Top = 72
-            Width = 108
-            Height = 15
-            Caption = 'Show country flags'
-            TabOrder = 2
-            Checked = True
-            State = cbChecked
-          end
-          object CheckBox5: TSpTBXCheckBox
-            Left = 24
-            Top = 88
-            Width = 147
-            Height = 15
-            Caption = 'Mark unknown maps/mods'
-            TabOrder = 3
-            Checked = True
-            State = cbChecked
-          end
-          object CheckBox6: TSpTBXCheckBox
-            Left = 24
-            Top = 104
-            Width = 251
-            Height = 15
-            Caption = 'Use taskbar button for each form (requires restart)'
-            TabOrder = 4
-          end
-          object WarnNATCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 120
-            Width = 271
-            Height = 15
-            Caption = 'Display warning icons on battles using NAT traversing'
-            TabOrder = 5
-            Checked = True
-            State = cbChecked
-          end
-          object AutoFocusOnPMCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 136
-            Width = 262
-            Height = 15
-            Caption = 'Automatically switch focus to new private messages'
-            TabOrder = 6
-            Checked = True
-            State = cbChecked
-          end
-          object DisableAllSoundsCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 152
-            Width = 103
-            Height = 15
-            Caption = 'Disable all sounds'
-            TabOrder = 7
-          end
-          object UploadReplayCheckBox: TSpTBXCheckBox
-            Left = 24
-            Top = 168
-            Width = 245
-            Height = 15
-            Caption = 'Ask to upload replay after the end of each battle'
-            TabOrder = 8
-            Visible = False
-          end
-        end
-      end
       object SpTBXTabSheet4: TSpTBXTabSheet
         Left = 0
         Top = 23
         Width = 361
-        Height = 258
+        Height = 282
         Caption = 'Program'
         ImageIndex = -1
         TabItem = 'SpTBXTabItem4'
@@ -613,14 +613,14 @@
           Left = 16
           Top = 8
           Width = 329
-          Height = 233
+          Height = 257
           Caption = 'Program settings'
           Color = clNone
           ParentColor = False
           TabOrder = 0
           object ResetRegistryButton: TSpTBXSpeedButton
             Left = 200
-            Top = 200
+            Top = 224
             Width = 113
             Height = 22
             Caption = 'Reset registry data'
@@ -702,6 +702,8 @@
             Height = 15
             Caption = 'tabs'
             TabOrder = 0
+            TabStop = True
+            Checked = True
           end
           object RadioButton5: TSpTBXRadioButton
             Left = 16
@@ -718,12 +720,10 @@
             Height = 15
             Caption = 'flat buttons'
             TabOrder = 2
-            TabStop = True
-            Checked = True
           end
           object CheckBox8: TSpTBXCheckBox
             Left = 16
-            Top = 208
+            Top = 232
             Width = 88
             Height = 15
             Caption = 'Enable logging'
@@ -733,7 +733,7 @@
           end
           object CheckBox9: TSpTBXCheckBox
             Left = 16
-            Top = 192
+            Top = 216
             Width = 128
             Height = 15
             Caption = 'Use sound notifications'
@@ -756,7 +756,7 @@
           end
           object CheckForNewVersionCheckBox: TSpTBXCheckBox
             Left = 16
-            Top = 176
+            Top = 200
             Width = 176
             Height = 15
             Caption = 'Check for new beta lobby version'
@@ -776,12 +776,26 @@
             LinkFont.Name = 'MS Sans Serif'
             LinkFont.Style = [fsUnderline]
           end
+          object ManageGroupsButton: TSpTBXButton
+            Left = 200
+            Top = 168
+            Width = 113
+            Height = 22
+            Caption = 'Manage groups ...'
+            TabOrder = 14
+            OnClick = ManageGroupsButtonClick
+            LinkFont.Charset = DEFAULT_CHARSET
+            LinkFont.Color = clBlue
+            LinkFont.Height = -11
+            LinkFont.Name = 'MS Sans Serif'
+            LinkFont.Style = [fsUnderline]
+          end
         end
       end
     end
     object ApplyAndCloseButton: TSpTBXButton
       Left = 16
-      Top = 336
+      Top = 352
       Width = 145
       Height = 25
       Caption = 'Apply and close'
@@ -795,7 +809,7 @@
     end
     object CancelAndCloseButton: TSpTBXButton
       Left = 208
-      Top = 336
+      Top = 352
       Width = 145
       Height = 25
       Caption = 'Cancel and close'

Modified: trunk/Lobby/TASClient/PreferencesFormUnit.pas
===================================================================
--- trunk/Lobby/TASClient/PreferencesFormUnit.pas	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/PreferencesFormUnit.pas	2008-02-08 17:32:18 UTC (rev 5465)
@@ -149,6 +149,7 @@
     CheckForNewVersionCheckBox: TSpTBXCheckBox;
     JvXPButton1: TSpTBXButton;
     ColorsButton: TSpTBXButton;
+    ManageGroupsButton: TSpTBXButton;
 
     function BattleSortStyleToColumn(SortStyle: Integer): Integer;
     function ColumnToBattleSortStyle(Column: Integer): Integer;
@@ -190,6 +191,7 @@
     procedure UsernameEditChange(Sender: TObject);
     procedure RegisterLadderAccountButtonClick(Sender: TObject);
     procedure ColorsButtonClick(Sender: TObject);
+    procedure ManageGroupsButtonClick(Sender: TObject);
   private
     { Private declarations }
   public
@@ -267,7 +269,8 @@
 
 uses Misc, ShellAPI, Registry, BattleFormUnit, HostBattleFormUnit, Math,
   OnlineMapsUnit, NotificationsUnit, PerformFormUnit, HighlightingUnit,
-  NewAccountUnit, IgnoreListUnit, MapListFormUnit, ColorsPreferenceUnit;
+  NewAccountUnit, IgnoreListUnit, MapListFormUnit, ColorsPreferenceUnit,
+  ManageGroups;
 
 {$R *.dfm}
 
@@ -1261,4 +1264,14 @@
   ColorsPreference.showmodal;
 end;
 
+procedure TPreferencesForm.ManageGroupsButtonClick(Sender: TObject);
+begin
+  if ClientGroups.Count = 0 then
+  begin
+    MessageDlg('There is no player group to manage. To make a new group use the player context menu.',mtInformation,[mbOk],0);
+    Exit;
+  end;
+  ManageGroupsForm.Showmodal;
+end;
+
 end.

Modified: trunk/Lobby/TASClient/TASClient.dof
===================================================================
--- trunk/Lobby/TASClient/TASClient.dof	2008-02-08 14:06:19 UTC (rev 5464)
+++ trunk/Lobby/TASClient/TASClient.dof	2008-02-08 17:32:18 UTC (rev 5465)
@@ -115,7 +115,7 @@
 MajorVer=0
 MinorVer=3
 Release=0
-Build=214
+Build=217
 Debug=0
 PreRelease=0
 Special=0
@@ -126,7 +126,7 @@
 [Version Info Keys]
 CompanyName=
 FileDescription=TA Spring lobby client
-FileVersion=0.3.0.214
+FileVersion=0.3.0.217
 InternalName=
 LegalCopyright=
 LegalTrademarks=

Modified: trunk/Lobby/TASClient/TASClient.res
===================================================================
(Binary files differ)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000271.html">[Taspring-linux-commit] r5464 - in trunk/rts: Game	System/Platform/Win
</A></li>
	<LI>Next message: <A HREF="000273.html">[Taspring-linux-commit] r5466 - in trunk/rts: Game Game/UI System
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#272">[ date ]</a>
              <a href="thread.html#272">[ thread ]</a>
              <a href="subject.html#272">[ subject ]</a>
              <a href="author.html#272">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/taspring-linux-commit">More information about the Taspring-linux-commit
mailing list</a><br>
</body></html>
